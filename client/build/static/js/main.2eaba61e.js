/*! For license information please see main.2eaba61e.js.LICENSE.txt */
(()=>{var __webpack_modules__={75:(e,t,n)=>{"use strict";n.d(t,{B:()=>s,t:()=>r});var i=console;function r(){return i}function s(e){i=e}},217:e=>{"use strict";function t(e){return"undefined"!==typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),i=128===n[3];function r(e,i,r){t[0]=e,i[r]=n[0],i[r+1]=n[1],i[r+2]=n[2],i[r+3]=n[3]}function s(e,i,r){t[0]=e,i[r]=n[3],i[r+1]=n[2],i[r+2]=n[1],i[r+3]=n[0]}function o(e,i){return n[0]=e[i],n[1]=e[i+1],n[2]=e[i+2],n[3]=e[i+3],t[0]}function a(e,i){return n[3]=e[i],n[2]=e[i+1],n[1]=e[i+2],n[0]=e[i+3],t[0]}e.writeFloatLE=i?r:s,e.writeFloatBE=i?s:r,e.readFloatLE=i?o:a,e.readFloatBE=i?a:o}():function(){function t(e,t,n,i){var r=t<0?1:0;if(r&&(t=-t),0===t)e(1/t>0?0:2147483648,n,i);else if(isNaN(t))e(2143289344,n,i);else if(t>34028234663852886e22)e((r<<31|2139095040)>>>0,n,i);else if(t<11754943508222875e-54)e((r<<31|Math.round(t/1401298464324817e-60))>>>0,n,i);else{var s=Math.floor(Math.log(t)/Math.LN2);e((r<<31|s+127<<23|8388607&Math.round(t*Math.pow(2,-s)*8388608))>>>0,n,i)}}function o(e,t,n){var i=e(t,n),r=2*(i>>31)+1,s=i>>>23&255,o=8388607&i;return 255===s?o?NaN:r*(1/0):0===s?1401298464324817e-60*r*o:r*Math.pow(2,s-150)*(o+8388608)}e.writeFloatLE=t.bind(null,n),e.writeFloatBE=t.bind(null,i),e.readFloatLE=o.bind(null,r),e.readFloatBE=o.bind(null,s)}(),"undefined"!==typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),i=128===n[7];function r(e,i,r){t[0]=e,i[r]=n[0],i[r+1]=n[1],i[r+2]=n[2],i[r+3]=n[3],i[r+4]=n[4],i[r+5]=n[5],i[r+6]=n[6],i[r+7]=n[7]}function s(e,i,r){t[0]=e,i[r]=n[7],i[r+1]=n[6],i[r+2]=n[5],i[r+3]=n[4],i[r+4]=n[3],i[r+5]=n[2],i[r+6]=n[1],i[r+7]=n[0]}function o(e,i){return n[0]=e[i],n[1]=e[i+1],n[2]=e[i+2],n[3]=e[i+3],n[4]=e[i+4],n[5]=e[i+5],n[6]=e[i+6],n[7]=e[i+7],t[0]}function a(e,i){return n[7]=e[i],n[6]=e[i+1],n[5]=e[i+2],n[4]=e[i+3],n[3]=e[i+4],n[2]=e[i+5],n[1]=e[i+6],n[0]=e[i+7],t[0]}e.writeDoubleLE=i?r:s,e.writeDoubleBE=i?s:r,e.readDoubleLE=i?o:a,e.readDoubleBE=i?a:o}():function(){function t(e,t,n,i,r,s){var o=i<0?1:0;if(o&&(i=-i),0===i)e(0,r,s+t),e(1/i>0?0:2147483648,r,s+n);else if(isNaN(i))e(0,r,s+t),e(2146959360,r,s+n);else if(i>17976931348623157e292)e(0,r,s+t),e((o<<31|2146435072)>>>0,r,s+n);else{var a;if(i<22250738585072014e-324)e((a=i/5e-324)>>>0,r,s+t),e((o<<31|a/4294967296)>>>0,r,s+n);else{var c=Math.floor(Math.log(i)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(a=i*Math.pow(2,-c))>>>0,r,s+t),e((o<<31|c+1023<<20|1048576*a&1048575)>>>0,r,s+n)}}}function o(e,t,n,i,r){var s=e(i,r+t),o=e(i,r+n),a=2*(o>>31)+1,c=o>>>20&2047,l=4294967296*(1048575&o)+s;return 2047===c?l?NaN:a*(1/0):0===c?5e-324*a*l:a*Math.pow(2,c-1075)*(l+4503599627370496)}e.writeDoubleLE=t.bind(null,n,0,4),e.writeDoubleBE=t.bind(null,i,4,0),e.readDoubleLE=o.bind(null,r,0,4),e.readDoubleBE=o.bind(null,s,4,0)}(),e}function n(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function i(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function r(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function s(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=t(t)},360:(e,t,n)=>{"use strict";e.exports=s;var i=n(6046);((s.prototype=Object.create(i.prototype)).constructor=s).className="Method";var r=n(9469);function s(e,t,n,s,o,a,c,l,u){if(r.isObject(o)?(c=o,o=a=void 0):r.isObject(a)&&(c=a,a=void 0),void 0!==t&&!r.isString(t))throw TypeError("type must be a string");if(!r.isString(n))throw TypeError("requestType must be a string");if(!r.isString(s))throw TypeError("responseType must be a string");i.call(this,e,c),this.type=t||"rpc",this.requestType=n,this.requestStream=!!o||void 0,this.responseType=s,this.responseStream=!!a||void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=l,this.parsedOptions=u}s.fromJSON=function(e,t){return new s(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment,t.parsedOptions)},s.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return r.toObject(["type","rpc"!==this.type&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:void 0,"parsedOptions",this.parsedOptions])},s.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),i.prototype.resolve.call(this))}},579:(e,t,n)=>{"use strict";e.exports=n(1153)},643:(e,t,n)=>{"use strict";e.exports=s;var i=n(4762),r=n(4882)("fs");function s(e,t,n){return"function"===typeof t?(n=t,t={}):t||(t={}),n?!t.xhr&&r&&r.readFile?r.readFile(e,function(i,r){return i&&"undefined"!==typeof XMLHttpRequest?s.xhr(e,t,n):i?n(i):n(null,t.binary?r:r.toString("utf8"))}):s.xhr(e,t,n):i(s,this,e,t)}s.xhr=function(e,t,n){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(4===i.readyState){if(0!==i.status&&200!==i.status)return n(Error("status "+i.status));if(t.binary){var e=i.response;if(!e){e=[];for(var r=0;r<i.responseText.length;++r)e.push(255&i.responseText.charCodeAt(r))}return n(null,"undefined"!==typeof Uint8Array?new Uint8Array(e):e)}return n(null,i.responseText)}},t.binary&&("overrideMimeType"in i&&i.overrideMimeType("text/plain; charset=x-user-defined"),i.responseType="arraybuffer"),i.open("GET",e),i.send()}},908:e=>{"use strict";e.exports=i;var t,n=/\/|\./;function i(e,t){n.test(e)||(e="google/protobuf/"+e+".proto",t={nested:{google:{nested:{protobuf:{nested:t}}}}}),i[e]=t}i("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}}),i("duration",{Duration:t={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}}),i("timestamp",{Timestamp:t}),i("empty",{Empty:{fields:{}}}),i("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}}),i("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}}),i("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}}),i.get=function(e){return i[e]||null}},1153:(e,t,n)=>{"use strict";var i=n(5043),r=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var i,s={},l=null,u=null;for(i in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)o.call(t,i)&&!c.hasOwnProperty(i)&&(s[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===s[i]&&(s[i]=t[i]);return{$$typeof:r,type:e,key:l,ref:u,props:s,_owner:a.current}}t.Fragment=s,t.jsx=l,t.jsxs=l},1220:(e,t,n)=>{"use strict";e.exports=o;var i=n(6046);((o.prototype=Object.create(i.prototype)).constructor=o).className="Enum";var r=n(1374),s=n(9469);function o(e,t,n,r,s,o){if(i.call(this,e,n),t&&"object"!==typeof t)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=r,this.comments=s||{},this.valuesOptions=o,this._valuesFeatures={},this.reserved=void 0,t)for(var a=Object.keys(t),c=0;c<a.length;++c)"number"===typeof t[a[c]]&&(this.valuesById[this.values[a[c]]=t[a[c]]]=a[c])}o.prototype._resolveFeatures=function(e){return e=this._edition||e,i.prototype._resolveFeatures.call(this,e),Object.keys(this.values).forEach(e=>{var t=Object.assign({},this._features);this._valuesFeatures[e]=Object.assign(t,this.valuesOptions&&this.valuesOptions[e]&&this.valuesOptions[e].features)}),this},o.fromJSON=function(e,t){var n=new o(e,t.values,t.options,t.comment,t.comments);return n.reserved=t.reserved,t.edition&&(n._edition=t.edition),n._defaultEdition="proto3",n},o.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return s.toObject(["edition",this._editionToJSON(),"options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",t?this.comment:void 0,"comments",t?this.comments:void 0])},o.prototype.add=function(e,t,n,i){if(!s.isString(e))throw TypeError("name must be a string");if(!s.isInteger(t))throw TypeError("id must be an integer");if(void 0!==this.values[e])throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(void 0!==this.valuesById[t]){if(!this.options||!this.options.allow_alias)throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return i&&(void 0===this.valuesOptions&&(this.valuesOptions={}),this.valuesOptions[e]=i||null),this.comments[e]=n||null,this},o.prototype.remove=function(e){if(!s.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(null==t)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this.valuesOptions&&delete this.valuesOptions[e],this},o.prototype.isReservedId=function(e){return r.isReservedId(this.reserved,e)},o.prototype.isReservedName=function(e){return r.isReservedName(this.reserved,e)}},1318:e=>{"use strict";function t(e,n){"string"===typeof e&&(n=e,e=void 0);var i=[];function r(e){if("string"!==typeof e){var n=s();if(t.verbose&&console.log("codegen: "+n),n="return "+n,e){for(var o=Object.keys(e),a=new Array(o.length+1),c=new Array(o.length),l=0;l<o.length;)a[l]=o[l],c[l]=e[o[l++]];return a[l]=n,Function.apply(null,a).apply(null,c)}return Function(n)()}for(var u=new Array(arguments.length-1),d=0;d<u.length;)u[d]=arguments[++d];if(d=0,e=e.replace(/%([%dfijs])/g,function(e,t){var n=u[d++];switch(t){case"d":case"f":return String(Number(n));case"i":return String(Math.floor(n));case"j":return JSON.stringify(n);case"s":return String(n)}return"%"}),d!==u.length)throw Error("parameter count mismatch");return i.push(e),r}function s(t){return"function "+(t||n||"")+"("+(e&&e.join(",")||"")+"){\n  "+i.join("\n  ")+"\n}"}return r.toString=s,r}e.exports=t,t.verbose=!1},1368:e=>{"use strict";e.exports={}},1374:(e,t,n)=>{"use strict";e.exports=d;var i=n(6046);((d.prototype=Object.create(i.prototype)).constructor=d).className="Namespace";var r,s,o,a=n(9229),c=n(9469),l=n(2924);function u(e,t){if(e&&e.length){for(var n={},i=0;i<e.length;++i)n[e[i].name]=e[i].toJSON(t);return n}}function d(e,t){i.call(this,e,t),this.nested=void 0,this._nestedArray=null,this._lookupCache={},this._needsRecursiveFeatureResolution=!0,this._needsRecursiveResolve=!0}function h(e){e._nestedArray=null,e._lookupCache={};for(var t=e;t=t.parent;)t._lookupCache={};return e}d.fromJSON=function(e,t){return new d(e,t.options).addJSON(t.nested)},d.arrayToJSON=u,d.isReservedId=function(e,t){if(e)for(var n=0;n<e.length;++n)if("string"!==typeof e[n]&&e[n][0]<=t&&e[n][1]>t)return!0;return!1},d.isReservedName=function(e,t){if(e)for(var n=0;n<e.length;++n)if(e[n]===t)return!0;return!1},Object.defineProperty(d.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=c.toArray(this.nested))}}),d.prototype.toJSON=function(e){return c.toObject(["options",this.options,"nested",u(this.nestedArray,e)])},d.prototype.addJSON=function(e){if(e)for(var t,n=Object.keys(e),i=0;i<n.length;++i)t=e[n[i]],this.add((void 0!==t.fields?r.fromJSON:void 0!==t.values?o.fromJSON:void 0!==t.methods?s.fromJSON:void 0!==t.id?a.fromJSON:d.fromJSON)(n[i],t));return this},d.prototype.get=function(e){return this.nested&&this.nested[e]||null},d.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof o)return this.nested[e].values;throw Error("no such enum: "+e)},d.prototype.add=function(e){if(!(e instanceof a&&void 0!==e.extend||e instanceof r||e instanceof l||e instanceof o||e instanceof s||e instanceof d))throw TypeError("object must be a valid nested object");if(this.nested){var t=this.get(e.name);if(t){if(!(t instanceof d&&e instanceof d)||t instanceof r||t instanceof s)throw Error("duplicate name '"+e.name+"' in "+this);for(var n=t.nestedArray,i=0;i<n.length;++i)e.add(n[i]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}}else this.nested={};this.nested[e.name]=e,this instanceof r||this instanceof s||this instanceof o||this instanceof a||e._edition||(e._edition=e._defaultEdition),this._needsRecursiveFeatureResolution=!0,this._needsRecursiveResolve=!0;for(var c=this;c=c.parent;)c._needsRecursiveFeatureResolution=!0,c._needsRecursiveResolve=!0;return e.onAdd(this),h(this)},d.prototype.remove=function(e){if(!(e instanceof i))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),h(this)},d.prototype.define=function(e,t){if(c.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&""===e[0])throw Error("path must be relative");for(var n=this;e.length>0;){var i=e.shift();if(n.nested&&n.nested[i]){if(!((n=n.nested[i])instanceof d))throw Error("path conflicts with non-namespace objects")}else n.add(n=new d(i))}return t&&n.addJSON(t),n},d.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;this._resolveFeaturesRecursive(this._edition);var e=this.nestedArray,t=0;for(this.resolve();t<e.length;)e[t]instanceof d?e[t++].resolveAll():e[t++].resolve();return this._needsRecursiveResolve=!1,this},d.prototype._resolveFeaturesRecursive=function(e){return this._needsRecursiveFeatureResolution?(this._needsRecursiveFeatureResolution=!1,e=this._edition||e,i.prototype._resolveFeaturesRecursive.call(this,e),this.nestedArray.forEach(t=>{t._resolveFeaturesRecursive(e)}),this):this},d.prototype.lookup=function(e,t,n){if("boolean"===typeof t?(n=t,t=void 0):t&&!Array.isArray(t)&&(t=[t]),c.isString(e)&&e.length){if("."===e)return this.root;e=e.split(".")}else if(!e.length)return this;var i=e.join(".");if(""===e[0])return this.root.lookup(e.slice(1),t);var r=this.root._fullyQualifiedObjects&&this.root._fullyQualifiedObjects["."+i];if(r&&(!t||t.indexOf(r.constructor)>-1))return r;if((r=this._lookupImpl(e,i))&&(!t||t.indexOf(r.constructor)>-1))return r;if(n)return null;for(var s=this;s.parent;){if((r=s.parent._lookupImpl(e,i))&&(!t||t.indexOf(r.constructor)>-1))return r;s=s.parent}return null},d.prototype._lookupImpl=function(e,t){if(Object.prototype.hasOwnProperty.call(this._lookupCache,t))return this._lookupCache[t];var n=this.get(e[0]),i=null;if(n)1===e.length?i=n:n instanceof d&&(e=e.slice(1),i=n._lookupImpl(e,e.join(".")));else for(var r=0;r<this.nestedArray.length;++r)this._nestedArray[r]instanceof d&&(n=this._nestedArray[r]._lookupImpl(e,t))&&(i=n);return this._lookupCache[t]=i,i},d.prototype.lookupType=function(e){var t=this.lookup(e,[r]);if(!t)throw Error("no such type: "+e);return t},d.prototype.lookupEnum=function(e){var t=this.lookup(e,[o]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t},d.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[r,o]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t},d.prototype.lookupService=function(e){var t=this.lookup(e,[s]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t},d._configure=function(e,t,n){r=e,s=t,o=n}},1509:function(e,t,n){"use strict";var i=t;function r(e,t,n){for(var i=Object.keys(t),r=0;r<i.length;++r)void 0!==e[i[r]]&&n||(e[i[r]]=t[i[r]]);return e}function s(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&r(this,n)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}i.asPromise=n(4762),i.base64=n(6762),i.EventEmitter=n(7351),i.float=n(217),i.inquire=n(4882),i.utf8=n(8626),i.pool=n(6931),i.LongBits=n(6350),i.isNode=Boolean("undefined"!==typeof n.g&&n.g&&n.g.process&&n.g.process.versions&&n.g.process.versions.node),i.global=i.isNode&&n.g||"undefined"!==typeof window&&window||"undefined"!==typeof self&&self||this,i.emptyArray=Object.freeze?Object.freeze([]):[],i.emptyObject=Object.freeze?Object.freeze({}):{},i.isInteger=Number.isInteger||function(e){return"number"===typeof e&&isFinite(e)&&Math.floor(e)===e},i.isString=function(e){return"string"===typeof e||e instanceof String},i.isObject=function(e){return e&&"object"===typeof e},i.isset=i.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!==typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},i.Buffer=function(){try{var e=i.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(t){return null}}(),i._Buffer_from=null,i._Buffer_allocUnsafe=null,i.newBuffer=function(e){return"number"===typeof e?i.Buffer?i._Buffer_allocUnsafe(e):new i.Array(e):i.Buffer?i._Buffer_from(e):"undefined"===typeof Uint8Array?e:new Uint8Array(e)},i.Array="undefined"!==typeof Uint8Array?Uint8Array:Array,i.Long=i.global.dcodeIO&&i.global.dcodeIO.Long||i.global.Long||i.inquire("long"),i.key2Re=/^true|false|0|1$/,i.key32Re=/^-?(?:0|[1-9][0-9]*)$/,i.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,i.longToHash=function(e){return e?i.LongBits.from(e).toHash():i.LongBits.zeroHash},i.longFromHash=function(e,t){var n=i.LongBits.fromHash(e);return i.Long?i.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))},i.merge=r,i.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},i.newError=s,i.ProtocolError=s("ProtocolError"),i.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},i.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},i.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},i._configure=function(){var e=i.Buffer;e?(i._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},i._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):i._Buffer_from=i._Buffer_allocUnsafe=null}},1561:(e,t,n)=>{"use strict";var i=t,r=n(1220),s=n(9469);function o(e,t,n,i){var s=!1;if(t.resolvedType)if(t.resolvedType instanceof r){e("switch(d%s){",i);for(var o=t.resolvedType.values,a=Object.keys(o),c=0;c<a.length;++c)o[a[c]]!==t.typeDefault||s||(e("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',i,i,i),t.repeated||e("break"),s=!0),e("case%j:",a[c])("case %i:",o[a[c]])("m%s=%j",i,o[a[c]])("break");e("}")}else e('if(typeof d%s!=="object")',i)("throw TypeError(%j)",t.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",i,n,i);else{var l=!1;switch(t.type){case"double":case"float":e("m%s=Number(d%s)",i,i);break;case"uint32":case"fixed32":e("m%s=d%s>>>0",i,i);break;case"int32":case"sint32":case"sfixed32":e("m%s=d%s|0",i,i);break;case"uint64":l=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",i,i,l)('else if(typeof d%s==="string")',i)("m%s=parseInt(d%s,10)",i,i)('else if(typeof d%s==="number")',i)("m%s=d%s",i,i)('else if(typeof d%s==="object")',i)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",i,i,i,l?"true":"");break;case"bytes":e('if(typeof d%s==="string")',i)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",i,i,i)("else if(d%s.length >= 0)",i)("m%s=d%s",i,i);break;case"string":e("m%s=String(d%s)",i,i);break;case"bool":e("m%s=Boolean(d%s)",i,i)}}return e}function a(e,t,n,i){if(t.resolvedType)t.resolvedType instanceof r?e("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",i,n,i,i,n,i,i):e("d%s=types[%i].toObject(m%s,o)",i,n,i);else{var s=!1;switch(t.type){case"double":case"float":e("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",i,i,i,i);break;case"uint64":s=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e('if(typeof m%s==="number")',i)("d%s=o.longs===String?String(m%s):m%s",i,i,i)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",i,i,i,i,s?"true":"",i);break;case"bytes":e("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",i,i,i,i,i);break;default:e("d%s=m%s",i,i)}}return e}i.fromObject=function(e){var t=e.fieldsArray,n=s.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!t.length)return n("return new this.ctor");n("var m=new this.ctor");for(var i=0;i<t.length;++i){var a=t[i].resolve(),c=s.safeProp(a.name);a.map?(n("if(d%s){",c)('if(typeof d%s!=="object")',c)("throw TypeError(%j)",a.fullName+": object expected")("m%s={}",c)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",c),o(n,a,i,c+"[ks[i]]")("}")("}")):a.repeated?(n("if(d%s){",c)("if(!Array.isArray(d%s))",c)("throw TypeError(%j)",a.fullName+": array expected")("m%s=[]",c)("for(var i=0;i<d%s.length;++i){",c),o(n,a,i,c+"[i]")("}")("}")):(a.resolvedType instanceof r||n("if(d%s!=null){",c),o(n,a,i,c),a.resolvedType instanceof r||n("}"))}return n("return m")},i.toObject=function(e){var t=e.fieldsArray.slice().sort(s.compareFieldsById);if(!t.length)return s.codegen()("return {}");for(var n=s.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),i=[],o=[],c=[],l=0;l<t.length;++l)t[l].partOf||(t[l].resolve().repeated?i:t[l].map?o:c).push(t[l]);if(i.length){for(n("if(o.arrays||o.defaults){"),l=0;l<i.length;++l)n("d%s=[]",s.safeProp(i[l].name));n("}")}if(o.length){for(n("if(o.objects||o.defaults){"),l=0;l<o.length;++l)n("d%s={}",s.safeProp(o[l].name));n("}")}if(c.length){for(n("if(o.defaults){"),l=0;l<c.length;++l){var u=c[l],d=s.safeProp(u.name);if(u.resolvedType instanceof r)n("d%s=o.enums===String?%j:%j",d,u.resolvedType.valuesById[u.typeDefault],u.typeDefault);else if(u.long)n("if(util.Long){")("var n=new util.Long(%i,%i,%j)",u.typeDefault.low,u.typeDefault.high,u.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",d)("}else")("d%s=o.longs===String?%j:%i",d,u.typeDefault.toString(),u.typeDefault.toNumber());else if(u.bytes){var h="["+Array.prototype.slice.call(u.typeDefault).join(",")+"]";n("if(o.bytes===String)d%s=%j",d,String.fromCharCode.apply(String,u.typeDefault))("else{")("d%s=%s",d,h)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",d,d)("}")}else n("d%s=%j",d,u.typeDefault)}n("}")}var p=!1;for(l=0;l<t.length;++l){u=t[l];var f=e._fieldsArray.indexOf(u);d=s.safeProp(u.name);u.map?(p||(p=!0,n("var ks2")),n("if(m%s&&(ks2=Object.keys(m%s)).length){",d,d)("d%s={}",d)("for(var j=0;j<ks2.length;++j){"),a(n,u,f,d+"[ks2[j]]")("}")):u.repeated?(n("if(m%s&&m%s.length){",d,d)("d%s=[]",d)("for(var j=0;j<m%s.length;++j){",d),a(n,u,f,d+"[j]")("}")):(n("if(m%s!=null&&m.hasOwnProperty(%j)){",d,u.name),a(n,u,f,d),u.partOf&&n("if(o.oneofs)")("d%s=%j",s.safeProp(u.partOf.name),u.name)),n("}")}return n("return d")}},1752:e=>{"use strict";e.exports=d;var t=/[\s{}=;:[\],'"()<>]/g,n=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,i=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,r=/^ *[*/]+ */,s=/^\s*\*?\/*/,o=/\n/g,a=/\s/,c=/\\(.?)/g,l={0:"\0",r:"\r",n:"\n",t:"\t"};function u(e){return e.replace(c,function(e,t){switch(t){case"\\":case"":return t;default:return l[t]||""}})}function d(e,c){e=e.toString();var l=0,d=e.length,h=1,p=0,f={},m=[],g=null;function v(e){return Error("illegal "+e+" (line "+h+")")}function y(t){return e.charAt(t)}function b(t,n,i){var a,l={type:e.charAt(t++),lineEmpty:!1,leading:i},u=t-(c?2:3);do{if(--u<0||"\n"===(a=e.charAt(u))){l.lineEmpty=!0;break}}while(" "===a||"\t"===a);for(var d=e.substring(t,n).split(o),m=0;m<d.length;++m)d[m]=d[m].replace(c?s:r,"").trim();l.text=d.join("\n").trim(),f[h]=l,p=h}function k(t){var n=w(t),i=e.substring(t,n);return/^\s*\/\//.test(i)}function w(e){for(var t=e;t<d&&"\n"!==y(t);)t++;return t}function S(){if(m.length>0)return m.shift();if(g)return function(){var t="'"===g?i:n;t.lastIndex=l-1;var r=t.exec(e);if(!r)throw v("string");return l=t.lastIndex,T(g),g=null,u(r[1])}();var r,s,o,p,f,S=0===l;do{if(l===d)return null;for(r=!1;a.test(o=y(l));)if("\n"===o&&(S=!0,++h),++l===d)return null;if("/"===y(l)){if(++l===d)throw v("comment");if("/"===y(l))if(c){if(p=l,f=!1,k(l-1)){f=!0;do{if((l=w(l))===d)break;if(l++,!S)break}while(k(l))}else l=Math.min(d,w(l)+1);f&&(b(p,l,S),S=!0),h++,r=!0}else{for(f="/"===y(p=l+1);"\n"!==y(++l);)if(l===d)return null;++l,f&&(b(p,l-1,S),S=!0),++h,r=!0}else{if("*"!==(o=y(l)))return"/";p=l+1,f=c||"*"===y(p);do{if("\n"===o&&++h,++l===d)throw v("comment");s=o,o=y(l)}while("*"!==s||"/"!==o);++l,f&&(b(p,l-2,S),S=!0),r=!0}}}while(r);var C=l;if(t.lastIndex=0,!t.test(y(C++)))for(;C<d&&!t.test(y(C));)++C;var x=e.substring(l,l=C);return'"'!==x&&"'"!==x||(g=x),x}function T(e){m.push(e)}function C(){if(!m.length){var e=S();if(null===e)return null;T(e)}return m[0]}return Object.defineProperty({next:S,peek:C,push:T,skip:function(e,t){var n=C();if(n===e)return S(),!0;if(!t)throw v("token '"+n+"', '"+e+"' expected");return!1},cmnt:function(e){var t,n=null;return void 0===e?(t=f[h-1],delete f[h-1],t&&(c||"*"===t.type||t.lineEmpty)&&(n=t.leading?t.text:null)):(p<e&&C(),t=f[e],delete f[e],!t||t.lineEmpty||!c&&"/"!==t.type||(n=t.leading?null:t.text)),n}},"line",{get:function(){return h}})}d.unescape=u},1985:(e,t,n)=>{"use strict";e.exports=function(e){for(var t=s.codegen(["r","l","e"],e.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(e.fieldsArray.filter(function(e){return e.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()")("if(t===e)")("break")("switch(t>>>3){"),n=0;n<e.fieldsArray.length;++n){var a=e._fieldsArray[n].resolve(),c=a.resolvedType instanceof i?"int32":a.type,l="m"+s.safeProp(a.name);t("case %i: {",a.id),a.map?(t("if(%s===util.emptyObject)",l)("%s={}",l)("var c2 = r.uint32()+r.pos"),void 0!==r.defaults[a.keyType]?t("k=%j",r.defaults[a.keyType]):t("k=null"),void 0!==r.defaults[c]?t("value=%j",r.defaults[c]):t("value=null"),t("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",a.keyType)("case 2:"),void 0===r.basic[c]?t("value=types[%i].decode(r,r.uint32())",n):t("value=r.%s()",c),t("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),void 0!==r.long[a.keyType]?t('%s[typeof k==="object"?util.longToHash(k):k]=value',l):t("%s[k]=value",l)):a.repeated?(t("if(!(%s&&%s.length))",l,l)("%s=[]",l),void 0!==r.packed[c]&&t("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",l,c)("}else"),void 0===r.basic[c]?t(a.delimited?"%s.push(types[%i].decode(r,undefined,((t&~7)|4)))":"%s.push(types[%i].decode(r,r.uint32()))",l,n):t("%s.push(r.%s())",l,c)):void 0===r.basic[c]?t(a.delimited?"%s=types[%i].decode(r,undefined,((t&~7)|4))":"%s=types[%i].decode(r,r.uint32())",l,n):t("%s=r.%s()",l,c),t("break")("}")}for(t("default:")("r.skipType(t&7)")("break")("}")("}"),n=0;n<e._fieldsArray.length;++n){var u=e._fieldsArray[n];u.required&&t("if(!m.hasOwnProperty(%j))",u.name)("throw util.ProtocolError(%j,{instance:m})",o(u))}return t("return m")};var i=n(1220),r=n(9876),s=n(9469);function o(e){return"missing required '"+e.name+"'"}},1991:(e,t,n)=>{"use strict";n.d(t,{j:()=>r});var i=n(8870),r=new(function(){function e(){this.queue=[],this.transactions=0,this.notifyFn=function(e){e()},this.batchNotifyFn=function(e){e()}}var t=e.prototype;return t.batch=function(e){var t;this.transactions++;try{t=e()}finally{this.transactions--,this.transactions||this.flush()}return t},t.schedule=function(e){var t=this;this.transactions?this.queue.push(e):(0,i.G6)(function(){t.notifyFn(e)})},t.batchCalls=function(e){var t=this;return function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];t.schedule(function(){e.apply(void 0,i)})}},t.flush=function(){var e=this,t=this.queue;this.queue=[],t.length&&(0,i.G6)(function(){e.batchNotifyFn(function(){t.forEach(function(t){e.notifyFn(t)})})})},t.setNotifyFunction=function(e){this.notifyFn=e},t.setBatchNotifyFunction=function(e){this.batchNotifyFn=e},e}())},2225:(e,t,n)=>{"use strict";e.exports=y;var i=n(1374);((y.prototype=Object.create(i.prototype)).constructor=y).className="Type";var r=n(1220),s=n(2924),o=n(9229),a=n(4635),c=n(6366),l=n(7886),u=n(3338),d=n(5850),h=n(9469),p=n(7573),f=n(1985),m=n(9875),g=n(1561),v=n(9297);function y(e,t){i.call(this,e,t),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function b(e){return e._fieldsById=e._fieldsArray=e._oneofsArray=null,delete e.encode,delete e.decode,delete e.verify,e}Object.defineProperties(y.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var e=Object.keys(this.fields),t=0;t<e.length;++t){var n=this.fields[e[t]],i=n.id;if(this._fieldsById[i])throw Error("duplicate id "+i+" in "+this);this._fieldsById[i]=n}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=h.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=h.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=y.generateConstructor(this)())},set:function(e){var t=e.prototype;t instanceof l||((e.prototype=new l).constructor=e,h.merge(e.prototype,t)),e.$type=e.prototype.$type=this,h.merge(e,l,!0),this._ctor=e;for(var n=0;n<this.fieldsArray.length;++n)this._fieldsArray[n].resolve();var i={};for(n=0;n<this.oneofsArray.length;++n)i[this._oneofsArray[n].resolve().name]={get:h.oneOfGetter(this._oneofsArray[n].oneof),set:h.oneOfSetter(this._oneofsArray[n].oneof)};n&&Object.defineProperties(e.prototype,i)}}}),y.generateConstructor=function(e){for(var t,n=h.codegen(["p"],e.name),i=0;i<e.fieldsArray.length;++i)(t=e._fieldsArray[i]).map?n("this%s={}",h.safeProp(t.name)):t.repeated&&n("this%s=[]",h.safeProp(t.name));return n("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")},y.fromJSON=function(e,t){var n=new y(e,t.options);n.extensions=t.extensions,n.reserved=t.reserved;for(var l=Object.keys(t.fields),u=0;u<l.length;++u)n.add(("undefined"!==typeof t.fields[l[u]].keyType?a.fromJSON:o.fromJSON)(l[u],t.fields[l[u]]));if(t.oneofs)for(l=Object.keys(t.oneofs),u=0;u<l.length;++u)n.add(s.fromJSON(l[u],t.oneofs[l[u]]));if(t.nested)for(l=Object.keys(t.nested),u=0;u<l.length;++u){var d=t.nested[l[u]];n.add((void 0!==d.id?o.fromJSON:void 0!==d.fields?y.fromJSON:void 0!==d.values?r.fromJSON:void 0!==d.methods?c.fromJSON:i.fromJSON)(l[u],d))}return t.extensions&&t.extensions.length&&(n.extensions=t.extensions),t.reserved&&t.reserved.length&&(n.reserved=t.reserved),t.group&&(n.group=!0),t.comment&&(n.comment=t.comment),t.edition&&(n._edition=t.edition),n._defaultEdition="proto3",n},y.prototype.toJSON=function(e){var t=i.prototype.toJSON.call(this,e),n=!!e&&Boolean(e.keepComments);return h.toObject(["edition",this._editionToJSON(),"options",t&&t.options||void 0,"oneofs",i.arrayToJSON(this.oneofsArray,e),"fields",i.arrayToJSON(this.fieldsArray.filter(function(e){return!e.declaringField}),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",t&&t.nested||void 0,"comment",n?this.comment:void 0])},y.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;i.prototype.resolveAll.call(this);var e=this.oneofsArray;for(n=0;n<e.length;)e[n++].resolve();for(var t=this.fieldsArray,n=0;n<t.length;)t[n++].resolve();return this},y.prototype._resolveFeaturesRecursive=function(e){return this._needsRecursiveFeatureResolution?(e=this._edition||e,i.prototype._resolveFeaturesRecursive.call(this,e),this.oneofsArray.forEach(t=>{t._resolveFeatures(e)}),this.fieldsArray.forEach(t=>{t._resolveFeatures(e)}),this):this},y.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null},y.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof o&&void 0===e.extend){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),b(this)}return e instanceof s?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),b(this)):i.prototype.add.call(this,e)},y.prototype.remove=function(e){if(e instanceof o&&void 0===e.extend){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),b(this)}if(e instanceof s){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),b(this)}return i.prototype.remove.call(this,e)},y.prototype.isReservedId=function(e){return i.isReservedId(this.reserved,e)},y.prototype.isReservedName=function(e){return i.isReservedName(this.reserved,e)},y.prototype.create=function(e){return new this.ctor(e)},y.prototype.setup=function(){for(var e=this.fullName,t=[],n=0;n<this.fieldsArray.length;++n)t.push(this._fieldsArray[n].resolve().resolvedType);this.encode=p(this)({Writer:d,types:t,util:h}),this.decode=f(this)({Reader:u,types:t,util:h}),this.verify=m(this)({types:t,util:h}),this.fromObject=g.fromObject(this)({types:t,util:h}),this.toObject=g.toObject(this)({types:t,util:h});var i=v[e];if(i){var r=Object.create(this);r.fromObject=this.fromObject,this.fromObject=i.fromObject.bind(r),r.toObject=this.toObject,this.toObject=i.toObject.bind(r)}return this},y.prototype.encode=function(e,t){return this.setup().encode(e,t)},y.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()},y.prototype.decode=function(e,t){return this.setup().decode(e,t)},y.prototype.decodeDelimited=function(e){return e instanceof u||(e=u.create(e)),this.decode(e,e.uint32())},y.prototype.verify=function(e){return this.setup().verify(e)},y.prototype.fromObject=function(e){return this.setup().fromObject(e)},y.prototype.toObject=function(e,t){return this.setup().toObject(e,t)},y.d=function(e){return function(t){h.decorateType(t,e)}}},2730:(e,t,n)=>{"use strict";var i=n(5043),r=n(8853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function c(e,t){l(e,t),l(e+"Capture",t)}function l(e,t){for(a[e]=t,e=0;e<t.length;e++)o.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(e,t,n,i,r,s,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new m(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new m(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new m(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new m(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new m(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,i){var r=g.hasOwnProperty(t)?g[t]:null;(null!==r?0!==r.type:i||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,i){if(null===t||"undefined"===typeof t||function(e,t,n,i){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,r,i)&&(n=null),i||null===r?function(e){return!!d.call(f,e)||!d.call(p,e)&&(h.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=null===n?3!==r.type&&"":n:(t=r.attributeName,i=r.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)});var k=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),S=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),P=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),_=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),A=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var I=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var j=Symbol.iterator;function D(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=j&&e[j]||e["@@iterator"])?e:null}var M,L=Object.assign;function F(e){if(void 0===M)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);M=t&&t[1]||""}return"\n"+M+e}var U=!1;function B(e,t){if(!e||U)return"";U=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var i=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){i=l}e.call(t.prototype)}else{try{throw Error()}catch(l){i=l}e()}}catch(l){if(l&&i&&"string"===typeof l.stack){for(var r=l.stack.split("\n"),s=i.stack.split("\n"),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(1!==o||1!==a)do{if(o--,0>--a||r[o]!==s[a]){var c="\n"+r[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}}while(1<=o&&0<=a);break}}}finally{U=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function V(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=B(e.type,!1);case 11:return e=B(e.type.render,!1);case 1:return e=B(e.type,!0);default:return""}}function q(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case T:return"Fragment";case S:return"Portal";case x:return"Profiler";case C:return"StrictMode";case O:return"Suspense";case _:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case P:return(e.displayName||"Context")+".Consumer";case E:return(e._context.displayName||"Context")+".Provider";case R:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case N:return null!==(t=e.displayName||null)?t:q(e.type)||"Memo";case A:t=e._payload,e=e._init;try{return q(e(t))}catch(n){}}return null}function z(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return q(t);case 8:return t===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function K(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){i=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function $(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=W(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function G(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Q(e,t){var n=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function J(e,t){var n=null==t.defaultValue?"":t.defaultValue,i=null!=t.checked?t.checked:t.defaultChecked;n=H(null!=t.value?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Y(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function X(e,t){Y(e,t);var n=H(t.value),i=t.type;if(null!=n)"number"===i?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===i||"reset"===i)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!("submit"!==i&&"reset"!==i||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&G(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+H(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(i&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ie(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:H(n)}}function se(e,t){var n=H(t.value),i=H(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=i&&(e.defaultValue=""+i)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ce(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var le,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((le=le||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=le.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,i){MSApp.execUnsafeLocalFunction(function(){return ue(e,t)})}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=me(n,t[n],i);"float"===n&&(n="cssFloat"),i?e.setProperty(n,r):e[n]=r}}Object.keys(pe).forEach(function(e){fe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]})});var ve=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ke=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Se=null,Te=null,Ce=null;function xe(e){if(e=br(e)){if("function"!==typeof Se)throw Error(s(280));var t=e.stateNode;t&&(t=wr(t),Se(e.stateNode,e.type,t))}}function Ee(e){Te?Ce?Ce.push(e):Ce=[e]:Te=e}function Pe(){if(Te){var e=Te,t=Ce;if(Ce=Te=null,xe(e),t)for(e=0;e<t.length;e++)xe(t[e])}}function Re(e,t){return e(t)}function Oe(){}var _e=!1;function Ne(e,t,n){if(_e)return e(t,n);_e=!0;try{return Re(e,t,n)}finally{_e=!1,(null!==Te||null!==Ce)&&(Oe(),Pe())}}function Ae(e,t){var n=e.stateNode;if(null===n)return null;var i=wr(n);if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Ie=!1;if(u)try{var je={};Object.defineProperty(je,"passive",{get:function(){Ie=!0}}),window.addEventListener("test",je,je),window.removeEventListener("test",je,je)}catch(ue){Ie=!1}function De(e,t,n,i,r,s,o,a,c){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(u){this.onError(u)}}var Me=!1,Le=null,Fe=!1,Ue=null,Be={onError:function(e){Me=!0,Le=e}};function Ve(e,t,n,i,r,s,o,a,c){Me=!1,Le=null,De.apply(Be,arguments)}function qe(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function ze(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(qe(e)!==e)throw Error(s(188))}function We(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=qe(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(null===r)break;var o=r.alternate;if(null===o){if(null!==(i=r.return)){n=i;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===n)return He(r),e;if(o===i)return He(r),t;o=o.sibling}throw Error(s(188))}if(n.return!==i.return)n=r,i=o;else{for(var a=!1,c=r.child;c;){if(c===n){a=!0,n=r,i=o;break}if(c===i){a=!0,i=r,n=o;break}c=c.sibling}if(!a){for(c=o.child;c;){if(c===n){a=!0,n=o,i=r;break}if(c===i){a=!0,i=o,n=r;break}c=c.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==i)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?Ke(e):null}function Ke(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ke(e);if(null!==t)return t;e=e.sibling}return null}var $e=r.unstable_scheduleCallback,Ge=r.unstable_cancelCallback,Qe=r.unstable_shouldYield,Je=r.unstable_requestPaint,Ye=r.unstable_now,Xe=r.unstable_getCurrentPriorityLevel,Ze=r.unstable_ImmediatePriority,et=r.unstable_UserBlockingPriority,tt=r.unstable_NormalPriority,nt=r.unstable_LowPriority,it=r.unstable_IdlePriority,rt=null,st=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/ct|0)|0},at=Math.log,ct=Math.LN2;var lt=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var i=0,r=e.suspendedLanes,s=e.pingedLanes,o=268435455&n;if(0!==o){var a=o&~r;0!==a?i=dt(a):0!==(s&=o)&&(i=dt(s))}else 0!==(o=n&~r)?i=dt(o):0!==s&&(i=dt(s));if(0===i)return 0;if(0!==t&&t!==i&&0===(t&r)&&((r=i&-i)>=(s=t&-t)||16===r&&0!==(4194240&s)))return t;if(0!==(4&i)&&(i|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)r=1<<(n=31-ot(t)),i|=e[n],t&=~r;return i}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=lt;return 0===(4194240&(lt<<=1))&&(lt=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-ot(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}var bt=0;function kt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,St,Tt,Ct,xt,Et=!1,Pt=[],Rt=null,Ot=null,_t=null,Nt=new Map,At=new Map,It=[],jt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dt(e,t){switch(e){case"focusin":case"focusout":Rt=null;break;case"dragenter":case"dragleave":Ot=null;break;case"mouseover":case"mouseout":_t=null;break;case"pointerover":case"pointerout":Nt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":At.delete(t.pointerId)}}function Mt(e,t,n,i,r,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},null!==t&&(null!==(t=br(t))&&St(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Lt(e){var t=yr(e.target);if(null!==t){var n=qe(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=ze(n)))return e.blockedOn=t,void xt(e.priority,function(){Tt(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=br(n))&&St(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);ke=i,n.target.dispatchEvent(i),ke=null,t.shift()}return!0}function Ut(e,t,n){Ft(e)&&n.delete(t)}function Bt(){Et=!1,null!==Rt&&Ft(Rt)&&(Rt=null),null!==Ot&&Ft(Ot)&&(Ot=null),null!==_t&&Ft(_t)&&(_t=null),Nt.forEach(Ut),At.forEach(Ut)}function Vt(e,t){e.blockedOn===t&&(e.blockedOn=null,Et||(Et=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Bt)))}function qt(e){function t(t){return Vt(t,e)}if(0<Pt.length){Vt(Pt[0],e);for(var n=1;n<Pt.length;n++){var i=Pt[n];i.blockedOn===e&&(i.blockedOn=null)}}for(null!==Rt&&Vt(Rt,e),null!==Ot&&Vt(Ot,e),null!==_t&&Vt(_t,e),Nt.forEach(t),At.forEach(t),n=0;n<It.length;n++)(i=It[n]).blockedOn===e&&(i.blockedOn=null);for(;0<It.length&&null===(n=It[0]).blockedOn;)Lt(n),null===n.blockedOn&&It.shift()}var zt=k.ReactCurrentBatchConfig,Ht=!0;function Wt(e,t,n,i){var r=bt,s=zt.transition;zt.transition=null;try{bt=1,$t(e,t,n,i)}finally{bt=r,zt.transition=s}}function Kt(e,t,n,i){var r=bt,s=zt.transition;zt.transition=null;try{bt=4,$t(e,t,n,i)}finally{bt=r,zt.transition=s}}function $t(e,t,n,i){if(Ht){var r=Qt(e,t,n,i);if(null===r)Hi(e,t,i,Gt,n),Dt(e,i);else if(function(e,t,n,i,r){switch(t){case"focusin":return Rt=Mt(Rt,e,t,n,i,r),!0;case"dragenter":return Ot=Mt(Ot,e,t,n,i,r),!0;case"mouseover":return _t=Mt(_t,e,t,n,i,r),!0;case"pointerover":var s=r.pointerId;return Nt.set(s,Mt(Nt.get(s)||null,e,t,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,At.set(s,Mt(At.get(s)||null,e,t,n,i,r)),!0}return!1}(r,e,t,n,i))i.stopPropagation();else if(Dt(e,i),4&t&&-1<jt.indexOf(e)){for(;null!==r;){var s=br(r);if(null!==s&&wt(s),null===(s=Qt(e,t,n,i))&&Hi(e,t,i,Gt,n),s===r)break;r=s}null!==r&&i.stopPropagation()}else Hi(e,t,i,null,n)}}var Gt=null;function Qt(e,t,n,i){if(Gt=null,null!==(e=yr(e=we(i))))if(null===(t=qe(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=ze(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Gt=e,null}function Jt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case it:return 536870912;default:return 16}default:return 16}}var Yt=null,Xt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Xt,i=n.length,r="value"in Yt?Yt.value:Yt.textContent,s=r.length;for(e=0;e<i&&n[e]===r[e];e++);var o=i-e;for(t=1;t<=o&&n[i-t]===r[s-t];t++);return Zt=r.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,i,r,s){for(var o in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(r):r[o]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,an,cn,ln={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=sn(ln),dn=L({},ln,{view:0,detail:0}),hn=sn(dn),pn=L({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==cn&&(cn&&"mousemove"===e.type?(on=e.screenX-cn.screenX,an=e.screenY-cn.screenY):an=on=0,cn=e),on)},movementY:function(e){return"movementY"in e?e.movementY:an}}),fn=sn(pn),mn=sn(L({},pn,{dataTransfer:0})),gn=sn(L({},dn,{relatedTarget:0})),vn=sn(L({},ln,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=L({},ln,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=sn(yn),kn=sn(L({},ln,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Tn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Tn[e])&&!!t[e]}function xn(){return Cn}var En=L({},dn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Sn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Pn=sn(En),Rn=sn(L({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),On=sn(L({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xn})),_n=sn(L({},ln,{propertyName:0,elapsedTime:0,pseudoElement:0})),Nn=L({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),An=sn(Nn),In=[9,13,27,32],jn=u&&"CompositionEvent"in window,Dn=null;u&&"documentMode"in document&&(Dn=document.documentMode);var Mn=u&&"TextEvent"in window&&!Dn,Ln=u&&(!jn||Dn&&8<Dn&&11>=Dn),Fn=String.fromCharCode(32),Un=!1;function Bn(e,t){switch(e){case"keyup":return-1!==In.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var qn=!1;var zn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!zn[e.type]:"textarea"===t}function Wn(e,t,n,i){Ee(i),0<(t=Ki(t,"onChange")).length&&(n=new un("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var Kn=null,$n=null;function Gn(e){Fi(e,0)}function Qn(e){if($(kr(e)))return e}function Jn(e,t){if("change"===e)return t}var Yn=!1;if(u){var Xn;if(u){var Zn="oninput"in document;if(!Zn){var ei=document.createElement("div");ei.setAttribute("oninput","return;"),Zn="function"===typeof ei.oninput}Xn=Zn}else Xn=!1;Yn=Xn&&(!document.documentMode||9<document.documentMode)}function ti(){Kn&&(Kn.detachEvent("onpropertychange",ni),$n=Kn=null)}function ni(e){if("value"===e.propertyName&&Qn($n)){var t=[];Wn(t,$n,e,we(e)),Ne(Gn,t)}}function ii(e,t,n){"focusin"===e?(ti(),$n=n,(Kn=t).attachEvent("onpropertychange",ni)):"focusout"===e&&ti()}function ri(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn($n)}function si(e,t){if("click"===e)return Qn(t)}function oi(e,t){if("input"===e||"change"===e)return Qn(t)}var ai="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ci(e,t){if(ai(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!d.call(t,r)||!ai(e[r],t[r]))return!1}return!0}function li(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ui(e,t){var n,i=li(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=li(i)}}function di(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?di(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hi(){for(var e=window,t=G();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(i){n=!1}if(!n)break;t=G((e=t.contentWindow).document)}return t}function pi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fi(e){var t=hi(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&di(n.ownerDocument.documentElement,n)){if(null!==i&&pi(n))if(t=i.start,void 0===(e=i.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=void 0===i.end?s:Math.min(i.end,r),!e.extend&&s>i&&(r=i,i=s,s=r),r=ui(n,s);var o=ui(n,i);r&&o&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),s>i?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mi=u&&"documentMode"in document&&11>=document.documentMode,gi=null,vi=null,yi=null,bi=!1;function ki(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;bi||null==gi||gi!==G(i)||("selectionStart"in(i=gi)&&pi(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},yi&&ci(yi,i)||(yi=i,0<(i=Ki(vi,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=gi)))}function wi(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Si={animationend:wi("Animation","AnimationEnd"),animationiteration:wi("Animation","AnimationIteration"),animationstart:wi("Animation","AnimationStart"),transitionend:wi("Transition","TransitionEnd")},Ti={},Ci={};function xi(e){if(Ti[e])return Ti[e];if(!Si[e])return e;var t,n=Si[e];for(t in n)if(n.hasOwnProperty(t)&&t in Ci)return Ti[e]=n[t];return e}u&&(Ci=document.createElement("div").style,"AnimationEvent"in window||(delete Si.animationend.animation,delete Si.animationiteration.animation,delete Si.animationstart.animation),"TransitionEvent"in window||delete Si.transitionend.transition);var Ei=xi("animationend"),Pi=xi("animationiteration"),Ri=xi("animationstart"),Oi=xi("transitionend"),_i=new Map,Ni="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ai(e,t){_i.set(e,t),c(t,[e])}for(var Ii=0;Ii<Ni.length;Ii++){var ji=Ni[Ii];Ai(ji.toLowerCase(),"on"+(ji[0].toUpperCase()+ji.slice(1)))}Ai(Ei,"onAnimationEnd"),Ai(Pi,"onAnimationIteration"),Ai(Ri,"onAnimationStart"),Ai("dblclick","onDoubleClick"),Ai("focusin","onFocus"),Ai("focusout","onBlur"),Ai(Oi,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Di="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mi=new Set("cancel close invalid load scroll toggle".split(" ").concat(Di));function Li(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,i,r,o,a,c,l){if(Ve.apply(this,arguments),Me){if(!Me)throw Error(s(198));var u=Le;Me=!1,Le=null,Fe||(Fe=!0,Ue=u)}}(i,t,void 0,e),e.currentTarget=null}function Fi(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var i=e[n],r=i.event;i=i.listeners;e:{var s=void 0;if(t)for(var o=i.length-1;0<=o;o--){var a=i[o],c=a.instance,l=a.currentTarget;if(a=a.listener,c!==s&&r.isPropagationStopped())break e;Li(r,a,l),s=c}else for(o=0;o<i.length;o++){if(c=(a=i[o]).instance,l=a.currentTarget,a=a.listener,c!==s&&r.isPropagationStopped())break e;Li(r,a,l),s=c}}}if(Fe)throw e=Ue,Fe=!1,Ue=null,e}function Ui(e,t){var n=t[mr];void 0===n&&(n=t[mr]=new Set);var i=e+"__bubble";n.has(i)||(zi(t,e,2,!1),n.add(i))}function Bi(e,t,n){var i=0;t&&(i|=4),zi(n,e,i,t)}var Vi="_reactListening"+Math.random().toString(36).slice(2);function qi(e){if(!e[Vi]){e[Vi]=!0,o.forEach(function(t){"selectionchange"!==t&&(Mi.has(t)||Bi(t,!1,e),Bi(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Vi]||(t[Vi]=!0,Bi("selectionchange",!1,t))}}function zi(e,t,n,i){switch(Jt(t)){case 1:var r=Wt;break;case 4:r=Kt;break;default:r=$t}n=r.bind(null,t,n,e),r=void 0,!Ie||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),i?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Hi(e,t,n,i,r){var s=i;if(0===(1&t)&&0===(2&t)&&null!==i)e:for(;;){if(null===i)return;var o=i.tag;if(3===o||4===o){var a=i.stateNode.containerInfo;if(a===r||8===a.nodeType&&a.parentNode===r)break;if(4===o)for(o=i.return;null!==o;){var c=o.tag;if((3===c||4===c)&&((c=o.stateNode.containerInfo)===r||8===c.nodeType&&c.parentNode===r))return;o=o.return}for(;null!==a;){if(null===(o=yr(a)))return;if(5===(c=o.tag)||6===c){i=s=o;continue e}a=a.parentNode}}i=i.return}Ne(function(){var i=s,r=we(n),o=[];e:{var a=_i.get(e);if(void 0!==a){var c=un,l=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":c=Pn;break;case"focusin":l="focus",c=gn;break;case"focusout":l="blur",c=gn;break;case"beforeblur":case"afterblur":c=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=On;break;case Ei:case Pi:case Ri:c=vn;break;case Oi:c=_n;break;case"scroll":c=hn;break;case"wheel":c=An;break;case"copy":case"cut":case"paste":c=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=Rn}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==a?a+"Capture":null:a;u=[];for(var p,f=i;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==h&&(null!=(m=Ae(f,h))&&u.push(Wi(f,m,p)))),d)break;f=f.return}0<u.length&&(a=new c(a,l,null,n,r),o.push({event:a,listeners:u}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===ke||!(l=n.relatedTarget||n.fromElement)||!yr(l)&&!l[fr])&&(c||a)&&(a=r.window===r?r:(a=r.ownerDocument)?a.defaultView||a.parentWindow:window,c?(c=i,null!==(l=(l=n.relatedTarget||n.toElement)?yr(l):null)&&(l!==(d=qe(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(c=null,l=i),c!==l)){if(u=fn,m="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=Rn,m="onPointerLeave",h="onPointerEnter",f="pointer"),d=null==c?a:kr(c),p=null==l?a:kr(l),(a=new u(m,f+"leave",c,n,r)).target=d,a.relatedTarget=p,m=null,yr(r)===i&&((u=new u(h,f+"enter",l,n,r)).target=p,u.relatedTarget=d,m=u),d=m,c&&l)e:{for(h=l,f=0,p=u=c;p;p=$i(p))f++;for(p=0,m=h;m;m=$i(m))p++;for(;0<f-p;)u=$i(u),f--;for(;0<p-f;)h=$i(h),p--;for(;f--;){if(u===h||null!==h&&u===h.alternate)break e;u=$i(u),h=$i(h)}u=null}else u=null;null!==c&&Gi(o,a,c,u,!1),null!==l&&null!==d&&Gi(o,d,l,u,!0)}if("select"===(c=(a=i?kr(i):window).nodeName&&a.nodeName.toLowerCase())||"input"===c&&"file"===a.type)var g=Jn;else if(Hn(a))if(Yn)g=oi;else{g=ri;var v=ii}else(c=a.nodeName)&&"input"===c.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(g=si);switch(g&&(g=g(e,i))?Wn(o,g,n,r):(v&&v(e,a,i),"focusout"===e&&(v=a._wrapperState)&&v.controlled&&"number"===a.type&&ee(a,"number",a.value)),v=i?kr(i):window,e){case"focusin":(Hn(v)||"true"===v.contentEditable)&&(gi=v,vi=i,yi=null);break;case"focusout":yi=vi=gi=null;break;case"mousedown":bi=!0;break;case"contextmenu":case"mouseup":case"dragend":bi=!1,ki(o,n,r);break;case"selectionchange":if(mi)break;case"keydown":case"keyup":ki(o,n,r)}var y;if(jn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else qn?Bn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Ln&&"ko"!==n.locale&&(qn||"onCompositionStart"!==b?"onCompositionEnd"===b&&qn&&(y=en()):(Xt="value"in(Yt=r)?Yt.value:Yt.textContent,qn=!0)),0<(v=Ki(i,b)).length&&(b=new kn(b,e,null,n,r),o.push({event:b,listeners:v}),y?b.data=y:null!==(y=Vn(n))&&(b.data=y))),(y=Mn?function(e,t){switch(e){case"compositionend":return Vn(t);case"keypress":return 32!==t.which?null:(Un=!0,Fn);case"textInput":return(e=t.data)===Fn&&Un?null:e;default:return null}}(e,n):function(e,t){if(qn)return"compositionend"===e||!jn&&Bn(e,t)?(e=en(),Zt=Xt=Yt=null,qn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ln&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(i=Ki(i,"onBeforeInput")).length&&(r=new kn("onBeforeInput","beforeinput",null,n,r),o.push({event:r,listeners:i}),r.data=y))}Fi(o,t)})}function Wi(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Ki(e,t){for(var n=t+"Capture",i=[];null!==e;){var r=e,s=r.stateNode;5===r.tag&&null!==s&&(r=s,null!=(s=Ae(e,n))&&i.unshift(Wi(e,s,r)),null!=(s=Ae(e,t))&&i.push(Wi(e,s,r))),e=e.return}return i}function $i(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Gi(e,t,n,i,r){for(var s=t._reactName,o=[];null!==n&&n!==i;){var a=n,c=a.alternate,l=a.stateNode;if(null!==c&&c===i)break;5===a.tag&&null!==l&&(a=l,r?null!=(c=Ae(n,s))&&o.unshift(Wi(n,c,a)):r||null!=(c=Ae(n,s))&&o.push(Wi(n,c,a))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Qi=/\r\n?/g,Ji=/\u0000|\uFFFD/g;function Yi(e){return("string"===typeof e?e:""+e).replace(Qi,"\n").replace(Ji,"")}function Xi(e,t,n){if(t=Yi(t),Yi(e)!==t&&n)throw Error(s(425))}function Zi(){}var er=null,tr=null;function nr(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ir="function"===typeof setTimeout?setTimeout:void 0,rr="function"===typeof clearTimeout?clearTimeout:void 0,sr="function"===typeof Promise?Promise:void 0,or="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof sr?function(e){return sr.resolve(null).then(e).catch(ar)}:ir;function ar(e){setTimeout(function(){throw e})}function cr(e,t){var n=t,i=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===i)return e.removeChild(r),void qt(t);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=r}while(n);qt(t)}function lr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ur(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var dr=Math.random().toString(36).slice(2),hr="__reactFiber$"+dr,pr="__reactProps$"+dr,fr="__reactContainer$"+dr,mr="__reactEvents$"+dr,gr="__reactListeners$"+dr,vr="__reactHandles$"+dr;function yr(e){var t=e[hr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fr]||n[hr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ur(e);null!==e;){if(n=e[hr])return n;e=ur(e)}return t}n=(e=n).parentNode}return null}function br(e){return!(e=e[hr]||e[fr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function kr(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function wr(e){return e[pr]||null}var Sr=[],Tr=-1;function Cr(e){return{current:e}}function xr(e){0>Tr||(e.current=Sr[Tr],Sr[Tr]=null,Tr--)}function Er(e,t){Tr++,Sr[Tr]=e.current,e.current=t}var Pr={},Rr=Cr(Pr),Or=Cr(!1),_r=Pr;function Nr(e,t){var n=e.type.contextTypes;if(!n)return Pr;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r,s={};for(r in n)s[r]=t[r];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Ar(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ir(){xr(Or),xr(Rr)}function jr(e,t,n){if(Rr.current!==Pr)throw Error(s(168));Er(Rr,t),Er(Or,n)}function Dr(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,"function"!==typeof i.getChildContext)return n;for(var r in i=i.getChildContext())if(!(r in t))throw Error(s(108,z(e)||"Unknown",r));return L({},n,i)}function Mr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Pr,_r=Rr.current,Er(Rr,e),Er(Or,Or.current),!0}function Lr(e,t,n){var i=e.stateNode;if(!i)throw Error(s(169));n?(e=Dr(e,t,_r),i.__reactInternalMemoizedMergedChildContext=e,xr(Or),xr(Rr),Er(Rr,e)):xr(Or),Er(Or,n)}var Fr=null,Ur=!1,Br=!1;function Vr(e){null===Fr?Fr=[e]:Fr.push(e)}function qr(){if(!Br&&null!==Fr){Br=!0;var e=0,t=bt;try{var n=Fr;for(bt=1;e<n.length;e++){var i=n[e];do{i=i(!0)}while(null!==i)}Fr=null,Ur=!1}catch(r){throw null!==Fr&&(Fr=Fr.slice(e+1)),$e(Ze,qr),r}finally{bt=t,Br=!1}}return null}var zr=[],Hr=0,Wr=null,Kr=0,$r=[],Gr=0,Qr=null,Jr=1,Yr="";function Xr(e,t){zr[Hr++]=Kr,zr[Hr++]=Wr,Wr=e,Kr=t}function Zr(e,t,n){$r[Gr++]=Jr,$r[Gr++]=Yr,$r[Gr++]=Qr,Qr=e;var i=Jr;e=Yr;var r=32-ot(i)-1;i&=~(1<<r),n+=1;var s=32-ot(t)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,Jr=1<<32-ot(t)+r|n<<r|i,Yr=s+e}else Jr=1<<s|n<<r|i,Yr=e}function es(e){null!==e.return&&(Xr(e,1),Zr(e,1,0))}function ts(e){for(;e===Wr;)Wr=zr[--Hr],zr[Hr]=null,Kr=zr[--Hr],zr[Hr]=null;for(;e===Qr;)Qr=$r[--Gr],$r[Gr]=null,Yr=$r[--Gr],$r[Gr]=null,Jr=$r[--Gr],$r[Gr]=null}var ns=null,is=null,rs=!1,ss=null;function os(e,t){var n=Nl(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function as(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ns=e,is=lr(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ns=e,is=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Qr?{id:Jr,overflow:Yr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Nl(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ns=e,is=null,!0);default:return!1}}function cs(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ls(e){if(rs){var t=is;if(t){var n=t;if(!as(e,t)){if(cs(e))throw Error(s(418));t=lr(n.nextSibling);var i=ns;t&&as(e,t)?os(i,n):(e.flags=-4097&e.flags|2,rs=!1,ns=e)}}else{if(cs(e))throw Error(s(418));e.flags=-4097&e.flags|2,rs=!1,ns=e}}}function us(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ns=e}function ds(e){if(e!==ns)return!1;if(!rs)return us(e),rs=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!nr(e.type,e.memoizedProps)),t&&(t=is)){if(cs(e))throw hs(),Error(s(418));for(;t;)os(e,t),t=lr(t.nextSibling)}if(us(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){is=lr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}is=null}}else is=ns?lr(e.stateNode.nextSibling):null;return!0}function hs(){for(var e=is;e;)e=lr(e.nextSibling)}function ps(){is=ns=null,rs=!1}function fs(e){null===ss?ss=[e]:ss.push(e)}var ms=k.ReactCurrentBatchConfig;function gs(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var i=n.stateNode}if(!i)throw Error(s(147,e));var r=i,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=r.refs;null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function vs(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ys(e){return(0,e._init)(e._payload)}function bs(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Il(e,t)).index=0,e.sibling=null,e}function o(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=2,n):i:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function c(e,t,n,i){return null===t||6!==t.tag?((t=Ll(n,e.mode,i)).return=e,t):((t=r(t,n)).return=e,t)}function l(e,t,n,i){var s=n.type;return s===T?d(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===A&&ys(s)===t.type)?((i=r(t,n.props)).ref=gs(e,t,n),i.return=e,i):((i=jl(n.type,n.key,n.props,null,e.mode,i)).ref=gs(e,t,n),i.return=e,i)}function u(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fl(n,e.mode,i)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function d(e,t,n,i,s){return null===t||7!==t.tag?((t=Dl(n,e.mode,i,s)).return=e,t):((t=r(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Ll(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=jl(t.type,t.key,t.props,null,e.mode,n)).ref=gs(e,null,t),n.return=e,n;case S:return(t=Fl(t,e.mode,n)).return=e,t;case A:return h(e,(0,t._init)(t._payload),n)}if(te(t)||D(t))return(t=Dl(t,e.mode,n,null)).return=e,t;vs(e,t)}return null}function p(e,t,n,i){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==r?null:c(e,t,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===r?l(e,t,n,i):null;case S:return n.key===r?u(e,t,n,i):null;case A:return p(e,t,(r=n._init)(n._payload),i)}if(te(n)||D(n))return null!==r?null:d(e,t,n,i,null);vs(e,n)}return null}function f(e,t,n,i,r){if("string"===typeof i&&""!==i||"number"===typeof i)return c(t,e=e.get(n)||null,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case w:return l(t,e=e.get(null===i.key?n:i.key)||null,i,r);case S:return u(t,e=e.get(null===i.key?n:i.key)||null,i,r);case A:return f(e,t,n,(0,i._init)(i._payload),r)}if(te(i)||D(i))return d(t,e=e.get(n)||null,i,r,null);vs(t,i)}return null}function m(r,s,a,c){for(var l=null,u=null,d=s,m=s=0,g=null;null!==d&&m<a.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var v=p(r,d,a[m],c);if(null===v){null===d&&(d=g);break}e&&d&&null===v.alternate&&t(r,d),s=o(v,s,m),null===u?l=v:u.sibling=v,u=v,d=g}if(m===a.length)return n(r,d),rs&&Xr(r,m),l;if(null===d){for(;m<a.length;m++)null!==(d=h(r,a[m],c))&&(s=o(d,s,m),null===u?l=d:u.sibling=d,u=d);return rs&&Xr(r,m),l}for(d=i(r,d);m<a.length;m++)null!==(g=f(d,r,m,a[m],c))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),s=o(g,s,m),null===u?l=g:u.sibling=g,u=g);return e&&d.forEach(function(e){return t(r,e)}),rs&&Xr(r,m),l}function g(r,a,c,l){var u=D(c);if("function"!==typeof u)throw Error(s(150));if(null==(c=u.call(c)))throw Error(s(151));for(var d=u=null,m=a,g=a=0,v=null,y=c.next();null!==m&&!y.done;g++,y=c.next()){m.index>g?(v=m,m=null):v=m.sibling;var b=p(r,m,y.value,l);if(null===b){null===m&&(m=v);break}e&&m&&null===b.alternate&&t(r,m),a=o(b,a,g),null===d?u=b:d.sibling=b,d=b,m=v}if(y.done)return n(r,m),rs&&Xr(r,g),u;if(null===m){for(;!y.done;g++,y=c.next())null!==(y=h(r,y.value,l))&&(a=o(y,a,g),null===d?u=y:d.sibling=y,d=y);return rs&&Xr(r,g),u}for(m=i(r,m);!y.done;g++,y=c.next())null!==(y=f(m,r,g,y.value,l))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),a=o(y,a,g),null===d?u=y:d.sibling=y,d=y);return e&&m.forEach(function(e){return t(r,e)}),rs&&Xr(r,g),u}return function e(i,s,o,c){if("object"===typeof o&&null!==o&&o.type===T&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case w:e:{for(var l=o.key,u=s;null!==u;){if(u.key===l){if((l=o.type)===T){if(7===u.tag){n(i,u.sibling),(s=r(u,o.props.children)).return=i,i=s;break e}}else if(u.elementType===l||"object"===typeof l&&null!==l&&l.$$typeof===A&&ys(l)===u.type){n(i,u.sibling),(s=r(u,o.props)).ref=gs(i,u,o),s.return=i,i=s;break e}n(i,u);break}t(i,u),u=u.sibling}o.type===T?((s=Dl(o.props.children,i.mode,c,o.key)).return=i,i=s):((c=jl(o.type,o.key,o.props,null,i.mode,c)).ref=gs(i,s,o),c.return=i,i=c)}return a(i);case S:e:{for(u=o.key;null!==s;){if(s.key===u){if(4===s.tag&&s.stateNode.containerInfo===o.containerInfo&&s.stateNode.implementation===o.implementation){n(i,s.sibling),(s=r(s,o.children||[])).return=i,i=s;break e}n(i,s);break}t(i,s),s=s.sibling}(s=Fl(o,i.mode,c)).return=i,i=s}return a(i);case A:return e(i,s,(u=o._init)(o._payload),c)}if(te(o))return m(i,s,o,c);if(D(o))return g(i,s,o,c);vs(i,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==s&&6===s.tag?(n(i,s.sibling),(s=r(s,o)).return=i,i=s):(n(i,s),(s=Ll(o,i.mode,c)).return=i,i=s),a(i)):n(i,s)}}var ks=bs(!0),ws=bs(!1),Ss=Cr(null),Ts=null,Cs=null,xs=null;function Es(){xs=Cs=Ts=null}function Ps(e){var t=Ss.current;xr(Ss),e._currentValue=t}function Rs(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Os(e,t){Ts=e,xs=Cs=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(ba=!0),e.firstContext=null)}function _s(e){var t=e._currentValue;if(xs!==e)if(e={context:e,memoizedValue:t,next:null},null===Cs){if(null===Ts)throw Error(s(308));Cs=e,Ts.dependencies={lanes:0,firstContext:e}}else Cs=Cs.next=e;return t}var Ns=null;function As(e){null===Ns?Ns=[e]:Ns.push(e)}function Is(e,t,n,i){var r=t.interleaved;return null===r?(n.next=n,As(t)):(n.next=r.next,r.next=n),t.interleaved=n,js(e,i)}function js(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ds=!1;function Ms(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ls(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Us(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,0!==(2&Rc)){var r=i.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),i.pending=t,js(e,n)}return null===(r=i.interleaved)?(t.next=t,As(i)):(t.next=r.next,r.next=t),i.interleaved=t,js(e,n)}function Bs(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Vs(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?r=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?r=s=t:s=s.next=t}else r=s=t;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function qs(e,t,n,i){var r=e.updateQueue;Ds=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(null!==a){r.shared.pending=null;var c=a,l=c.next;c.next=null,null===o?s=l:o.next=l,o=c;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===a?u.firstBaseUpdate=l:a.next=l,u.lastBaseUpdate=c))}if(null!==s){var d=r.baseState;for(o=0,u=l=c=null,a=s;;){var h=a.lane,p=a.eventTime;if((i&h)===h){null!==u&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var f=e,m=a;switch(h=t,p=n,m.tag){case 1:if("function"===typeof(f=m.payload)){d=f.call(p,d,h);break e}d=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(h="function"===typeof(f=m.payload)?f.call(p,d,h):f)||void 0===h)break e;d=L({},d,h);break e;case 2:Ds=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(h=r.effects)?r.effects=[a]:h.push(a))}else p={eventTime:p,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(l=u=p,c=d):u=u.next=p,o|=h;if(null===(a=a.next)){if(null===(a=r.shared.pending))break;a=(h=a).next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}if(null===u&&(c=d),r.baseState=c,r.firstBaseUpdate=l,r.lastBaseUpdate=u,null!==(t=r.shared.interleaved)){r=t;do{o|=r.lane,r=r.next}while(r!==t)}else null===s&&(r.shared.lanes=0);Mc|=o,e.lanes=o,e.memoizedState=d}}function zs(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!==typeof r)throw Error(s(191,r));r.call(i)}}}var Hs={},Ws=Cr(Hs),Ks=Cr(Hs),$s=Cr(Hs);function Gs(e){if(e===Hs)throw Error(s(174));return e}function Qs(e,t){switch(Er($s,t),Er(Ks,e),Er(Ws,Hs),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ce(null,"");break;default:t=ce(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}xr(Ws),Er(Ws,t)}function Js(){xr(Ws),xr(Ks),xr($s)}function Ys(e){Gs($s.current);var t=Gs(Ws.current),n=ce(t,e.type);t!==n&&(Er(Ks,e),Er(Ws,n))}function Xs(e){Ks.current===e&&(xr(Ws),xr(Ks))}var Zs=Cr(0);function eo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var to=[];function no(){for(var e=0;e<to.length;e++)to[e]._workInProgressVersionPrimary=null;to.length=0}var io=k.ReactCurrentDispatcher,ro=k.ReactCurrentBatchConfig,so=0,oo=null,ao=null,co=null,lo=!1,uo=!1,ho=0,po=0;function fo(){throw Error(s(321))}function mo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ai(e[n],t[n]))return!1;return!0}function go(e,t,n,i,r,o){if(so=o,oo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,io.current=null===e||null===e.memoizedState?Zo:ea,e=n(i,r),uo){o=0;do{if(uo=!1,ho=0,25<=o)throw Error(s(301));o+=1,co=ao=null,t.updateQueue=null,io.current=ta,e=n(i,r)}while(uo)}if(io.current=Xo,t=null!==ao&&null!==ao.next,so=0,co=ao=oo=null,lo=!1,t)throw Error(s(300));return e}function vo(){var e=0!==ho;return ho=0,e}function yo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===co?oo.memoizedState=co=e:co=co.next=e,co}function bo(){if(null===ao){var e=oo.alternate;e=null!==e?e.memoizedState:null}else e=ao.next;var t=null===co?oo.memoizedState:co.next;if(null!==t)co=t,ao=e;else{if(null===e)throw Error(s(310));e={memoizedState:(ao=e).memoizedState,baseState:ao.baseState,baseQueue:ao.baseQueue,queue:ao.queue,next:null},null===co?oo.memoizedState=co=e:co=co.next=e}return co}function ko(e,t){return"function"===typeof t?t(e):t}function wo(e){var t=bo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var i=ao,r=i.baseQueue,o=n.pending;if(null!==o){if(null!==r){var a=r.next;r.next=o.next,o.next=a}i.baseQueue=r=o,n.pending=null}if(null!==r){o=r.next,i=i.baseState;var c=a=null,l=null,u=o;do{var d=u.lane;if((so&d)===d)null!==l&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:e(i,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===l?(c=l=h,a=i):l=l.next=h,oo.lanes|=d,Mc|=d}u=u.next}while(null!==u&&u!==o);null===l?a=i:l.next=c,ai(i,t.memoizedState)||(ba=!0),t.memoizedState=i,t.baseState=a,t.baseQueue=l,n.lastRenderedState=i}if(null!==(e=n.interleaved)){r=e;do{o=r.lane,oo.lanes|=o,Mc|=o,r=r.next}while(r!==e)}else null===r&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function So(e){var t=bo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,o=t.memoizedState;if(null!==r){n.pending=null;var a=r=r.next;do{o=e(o,a.action),a=a.next}while(a!==r);ai(o,t.memoizedState)||(ba=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,i]}function To(){}function Co(e,t){var n=oo,i=bo(),r=t(),o=!ai(i.memoizedState,r);if(o&&(i.memoizedState=r,ba=!0),i=i.queue,Mo(Po.bind(null,n,i,e),[e]),i.getSnapshot!==t||o||null!==co&&1&co.memoizedState.tag){if(n.flags|=2048,No(9,Eo.bind(null,n,i,r,t),void 0,null),null===Oc)throw Error(s(349));0!==(30&so)||xo(n,t,r)}return r}function xo(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Eo(e,t,n,i){t.value=n,t.getSnapshot=i,Ro(t)&&Oo(e)}function Po(e,t,n){return n(function(){Ro(t)&&Oo(e)})}function Ro(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ai(e,n)}catch(i){return!0}}function Oo(e){var t=js(e,1);null!==t&&nl(t,e,1,-1)}function _o(e){var t=yo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ko,lastRenderedState:e},t.queue=e,e=e.dispatch=Go.bind(null,oo,e),[t.memoizedState,e]}function No(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function Ao(){return bo().memoizedState}function Io(e,t,n,i){var r=yo();oo.flags|=e,r.memoizedState=No(1|t,n,void 0,void 0===i?null:i)}function jo(e,t,n,i){var r=bo();i=void 0===i?null:i;var s=void 0;if(null!==ao){var o=ao.memoizedState;if(s=o.destroy,null!==i&&mo(i,o.deps))return void(r.memoizedState=No(t,n,s,i))}oo.flags|=e,r.memoizedState=No(1|t,n,s,i)}function Do(e,t){return Io(8390656,8,e,t)}function Mo(e,t){return jo(2048,8,e,t)}function Lo(e,t){return jo(4,2,e,t)}function Fo(e,t){return jo(4,4,e,t)}function Uo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Bo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,jo(4,4,Uo.bind(null,t,e),n)}function Vo(){}function qo(e,t){var n=bo();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&mo(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function zo(e,t){var n=bo();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&mo(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function Ho(e,t,n){return 0===(21&so)?(e.baseState&&(e.baseState=!1,ba=!0),e.memoizedState=n):(ai(n,t)||(n=mt(),oo.lanes|=n,Mc|=n,e.baseState=!0),t)}function Wo(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var i=ro.transition;ro.transition={};try{e(!1),t()}finally{bt=n,ro.transition=i}}function Ko(){return bo().memoizedState}function $o(e,t,n){var i=tl(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},Qo(e))Jo(t,n);else if(null!==(n=Is(e,t,n,i))){nl(n,e,i,el()),Yo(n,t,i)}}function Go(e,t,n){var i=tl(e),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qo(e))Jo(t,r);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,ai(a,o)){var c=t.interleaved;return null===c?(r.next=r,As(t)):(r.next=c.next,c.next=r),void(t.interleaved=r)}}catch(l){}null!==(n=Is(e,t,r,i))&&(nl(n,e,i,r=el()),Yo(n,t,i))}}function Qo(e){var t=e.alternate;return e===oo||null!==t&&t===oo}function Jo(e,t){uo=lo=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Yo(e,t,n){if(0!==(4194240&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Xo={readContext:_s,useCallback:fo,useContext:fo,useEffect:fo,useImperativeHandle:fo,useInsertionEffect:fo,useLayoutEffect:fo,useMemo:fo,useReducer:fo,useRef:fo,useState:fo,useDebugValue:fo,useDeferredValue:fo,useTransition:fo,useMutableSource:fo,useSyncExternalStore:fo,useId:fo,unstable_isNewReconciler:!1},Zo={readContext:_s,useCallback:function(e,t){return yo().memoizedState=[e,void 0===t?null:t],e},useContext:_s,useEffect:Do,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Io(4194308,4,Uo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Io(4194308,4,e,t)},useInsertionEffect:function(e,t){return Io(4,2,e,t)},useMemo:function(e,t){var n=yo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=yo();return t=void 0!==n?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=$o.bind(null,oo,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},yo().memoizedState=e},useState:_o,useDebugValue:Vo,useDeferredValue:function(e){return yo().memoizedState=e},useTransition:function(){var e=_o(!1),t=e[0];return e=Wo.bind(null,e[1]),yo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=oo,r=yo();if(rs){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Oc)throw Error(s(349));0!==(30&so)||xo(i,t,n)}r.memoizedState=n;var o={value:n,getSnapshot:t};return r.queue=o,Do(Po.bind(null,i,o,e),[e]),i.flags|=2048,No(9,Eo.bind(null,i,o,n,t),void 0,null),n},useId:function(){var e=yo(),t=Oc.identifierPrefix;if(rs){var n=Yr;t=":"+t+"R"+(n=(Jr&~(1<<32-ot(Jr)-1)).toString(32)+n),0<(n=ho++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=po++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ea={readContext:_s,useCallback:qo,useContext:_s,useEffect:Mo,useImperativeHandle:Bo,useInsertionEffect:Lo,useLayoutEffect:Fo,useMemo:zo,useReducer:wo,useRef:Ao,useState:function(){return wo(ko)},useDebugValue:Vo,useDeferredValue:function(e){return Ho(bo(),ao.memoizedState,e)},useTransition:function(){return[wo(ko)[0],bo().memoizedState]},useMutableSource:To,useSyncExternalStore:Co,useId:Ko,unstable_isNewReconciler:!1},ta={readContext:_s,useCallback:qo,useContext:_s,useEffect:Mo,useImperativeHandle:Bo,useInsertionEffect:Lo,useLayoutEffect:Fo,useMemo:zo,useReducer:So,useRef:Ao,useState:function(){return So(ko)},useDebugValue:Vo,useDeferredValue:function(e){var t=bo();return null===ao?t.memoizedState=e:Ho(t,ao.memoizedState,e)},useTransition:function(){return[So(ko)[0],bo().memoizedState]},useMutableSource:To,useSyncExternalStore:Co,useId:Ko,unstable_isNewReconciler:!1};function na(e,t){if(e&&e.defaultProps){for(var n in t=L({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function ia(e,t,n,i){n=null===(n=n(i,t=e.memoizedState))||void 0===n?t:L({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ra={isMounted:function(e){return!!(e=e._reactInternals)&&qe(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=el(),r=tl(e),s=Fs(i,r);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Us(e,s,r))&&(nl(t,e,r,i),Bs(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=el(),r=tl(e),s=Fs(i,r);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Us(e,s,r))&&(nl(t,e,r,i),Bs(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=el(),i=tl(e),r=Fs(n,i);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=Us(e,r,i))&&(nl(t,e,i,n),Bs(t,e,i))}};function sa(e,t,n,i,r,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!ci(n,i)||!ci(r,s))}function oa(e,t,n){var i=!1,r=Pr,s=t.contextType;return"object"===typeof s&&null!==s?s=_s(s):(r=Ar(t)?_r:Rr.current,s=(i=null!==(i=t.contextTypes)&&void 0!==i)?Nr(e,r):Pr),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ra,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=s),t}function aa(e,t,n,i){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&ra.enqueueReplaceState(t,t.state,null)}function ca(e,t,n,i){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs={},Ms(e);var s=t.contextType;"object"===typeof s&&null!==s?r.context=_s(s):(s=Ar(t)?_r:Rr.current,r.context=Nr(e,s)),r.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(ia(e,t,s,n),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&ra.enqueueReplaceState(r,r.state,null),qs(e,n,r,i),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function la(e,t){try{var n="",i=t;do{n+=V(i),i=i.return}while(i);var r=n}catch(s){r="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:r,digest:null}}function ua(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function da(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var ha="function"===typeof WeakMap?WeakMap:Map;function pa(e,t,n){(n=Fs(-1,n)).tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){Hc||(Hc=!0,Wc=i),da(0,t)},n}function fa(e,t,n){(n=Fs(-1,n)).tag=3;var i=e.type.getDerivedStateFromError;if("function"===typeof i){var r=t.value;n.payload=function(){return i(r)},n.callback=function(){da(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){da(0,t),"function"!==typeof i&&(null===Kc?Kc=new Set([this]):Kc.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ma(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new ha;var r=new Set;i.set(t,r)}else void 0===(r=i.get(t))&&(r=new Set,i.set(t,r));r.has(n)||(r.add(n),e=xl.bind(null,e,t,n),t.then(e,e))}function ga(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function va(e,t,n,i,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Fs(-1,1)).tag=2,Us(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var ya=k.ReactCurrentOwner,ba=!1;function ka(e,t,n,i){t.child=null===e?ws(t,null,n,i):ks(t,e.child,n,i)}function wa(e,t,n,i,r){n=n.render;var s=t.ref;return Os(t,r),i=go(e,t,n,i,s,r),n=vo(),null===e||ba?(rs&&n&&es(t),t.flags|=1,ka(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Ha(e,t,r))}function Sa(e,t,n,i,r){if(null===e){var s=n.type;return"function"!==typeof s||Al(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=jl(n.type,null,i,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Ta(e,t,s,i,r))}if(s=e.child,0===(e.lanes&r)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:ci)(o,i)&&e.ref===t.ref)return Ha(e,t,r)}return t.flags|=1,(e=Il(s,i)).ref=t.ref,e.return=t,t.child=e}function Ta(e,t,n,i,r){if(null!==e){var s=e.memoizedProps;if(ci(s,i)&&e.ref===t.ref){if(ba=!1,t.pendingProps=i=s,0===(e.lanes&r))return t.lanes=e.lanes,Ha(e,t,r);0!==(131072&e.flags)&&(ba=!0)}}return Ea(e,t,n,i,r)}function Ca(e,t,n){var i=t.pendingProps,r=i.children,s=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Er(Ic,Ac),Ac|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Er(Ic,Ac),Ac|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==s?s.baseLanes:n,Er(Ic,Ac),Ac|=i}else null!==s?(i=s.baseLanes|n,t.memoizedState=null):i=n,Er(Ic,Ac),Ac|=i;return ka(e,t,r,n),t.child}function xa(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ea(e,t,n,i,r){var s=Ar(n)?_r:Rr.current;return s=Nr(t,s),Os(t,r),n=go(e,t,n,i,s,r),i=vo(),null===e||ba?(rs&&i&&es(t),t.flags|=1,ka(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Ha(e,t,r))}function Pa(e,t,n,i,r){if(Ar(n)){var s=!0;Mr(t)}else s=!1;if(Os(t,r),null===t.stateNode)za(e,t),oa(t,n,i),ca(t,n,i,r),i=!0;else if(null===e){var o=t.stateNode,a=t.memoizedProps;o.props=a;var c=o.context,l=n.contextType;"object"===typeof l&&null!==l?l=_s(l):l=Nr(t,l=Ar(n)?_r:Rr.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof o.getSnapshotBeforeUpdate;d||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==i||c!==l)&&aa(t,o,i,l),Ds=!1;var h=t.memoizedState;o.state=h,qs(t,i,o,r),c=t.memoizedState,a!==i||h!==c||Or.current||Ds?("function"===typeof u&&(ia(t,n,u,i),c=t.memoizedState),(a=Ds||sa(t,n,a,i,h,c,l))?(d||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=c),o.props=i,o.state=c,o.context=l,i=a):("function"===typeof o.componentDidMount&&(t.flags|=4194308),i=!1)}else{o=t.stateNode,Ls(e,t),a=t.memoizedProps,l=t.type===t.elementType?a:na(t.type,a),o.props=l,d=t.pendingProps,h=o.context,"object"===typeof(c=n.contextType)&&null!==c?c=_s(c):c=Nr(t,c=Ar(n)?_r:Rr.current);var p=n.getDerivedStateFromProps;(u="function"===typeof p||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==d||h!==c)&&aa(t,o,i,c),Ds=!1,h=t.memoizedState,o.state=h,qs(t,i,o,r);var f=t.memoizedState;a!==d||h!==f||Or.current||Ds?("function"===typeof p&&(ia(t,n,p,i),f=t.memoizedState),(l=Ds||sa(t,n,l,i,h,f,c)||!1)?(u||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(i,f,c),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(i,f,c)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=f),o.props=i,o.state=f,o.context=c,i=l):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),i=!1)}return Ra(e,t,n,i,s,r)}function Ra(e,t,n,i,r,s){xa(e,t);var o=0!==(128&t.flags);if(!i&&!o)return r&&Lr(t,n,!1),Ha(e,t,s);i=t.stateNode,ya.current=t;var a=o&&"function"!==typeof n.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&o?(t.child=ks(t,e.child,null,s),t.child=ks(t,null,a,s)):ka(e,t,a,s),t.memoizedState=i.state,r&&Lr(t,n,!0),t.child}function Oa(e){var t=e.stateNode;t.pendingContext?jr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&jr(0,t.context,!1),Qs(e,t.containerInfo)}function _a(e,t,n,i,r){return ps(),fs(r),t.flags|=256,ka(e,t,n,i),t.child}var Na,Aa,Ia,ja,Da={dehydrated:null,treeContext:null,retryLane:0};function Ma(e){return{baseLanes:e,cachePool:null,transitions:null}}function La(e,t,n){var i,r=t.pendingProps,o=Zs.current,a=!1,c=0!==(128&t.flags);if((i=c)||(i=(null===e||null!==e.memoizedState)&&0!==(2&o)),i?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Er(Zs,1&o),null===e)return ls(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(c=r.children,e=r.fallback,a?(r=t.mode,a=t.child,c={mode:"hidden",children:c},0===(1&r)&&null!==a?(a.childLanes=0,a.pendingProps=c):a=Ml(c,r,0,null),e=Dl(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Ma(n),t.memoizedState=Da,e):Fa(t,c));if(null!==(o=e.memoizedState)&&null!==(i=o.dehydrated))return function(e,t,n,i,r,o,a){if(n)return 256&t.flags?(t.flags&=-257,Ua(e,t,a,i=ua(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=i.fallback,r=t.mode,i=Ml({mode:"visible",children:i.children},r,0,null),(o=Dl(o,r,a,null)).flags|=2,i.return=t,o.return=t,i.sibling=o,t.child=i,0!==(1&t.mode)&&ks(t,e.child,null,a),t.child.memoizedState=Ma(a),t.memoizedState=Da,o);if(0===(1&t.mode))return Ua(e,t,a,null);if("$!"===r.data){if(i=r.nextSibling&&r.nextSibling.dataset)var c=i.dgst;return i=c,Ua(e,t,a,i=ua(o=Error(s(419)),i,void 0))}if(c=0!==(a&e.childLanes),ba||c){if(null!==(i=Oc)){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(i.suspendedLanes|a))?0:r)&&r!==o.retryLane&&(o.retryLane=r,js(e,r),nl(i,e,r,-1))}return ml(),Ua(e,t,a,i=ua(Error(s(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=Pl.bind(null,e),r._reactRetry=t,null):(e=o.treeContext,is=lr(r.nextSibling),ns=t,rs=!0,ss=null,null!==e&&($r[Gr++]=Jr,$r[Gr++]=Yr,$r[Gr++]=Qr,Jr=e.id,Yr=e.overflow,Qr=t),t=Fa(t,i.children),t.flags|=4096,t)}(e,t,c,r,i,o,n);if(a){a=r.fallback,c=t.mode,i=(o=e.child).sibling;var l={mode:"hidden",children:r.children};return 0===(1&c)&&t.child!==o?((r=t.child).childLanes=0,r.pendingProps=l,t.deletions=null):(r=Il(o,l)).subtreeFlags=14680064&o.subtreeFlags,null!==i?a=Il(i,a):(a=Dl(a,c,n,null)).flags|=2,a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,c=null===(c=e.child.memoizedState)?Ma(n):{baseLanes:c.baseLanes|n,cachePool:null,transitions:c.transitions},a.memoizedState=c,a.childLanes=e.childLanes&~n,t.memoizedState=Da,r}return e=(a=e.child).sibling,r=Il(a,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=n),r.return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Fa(e,t){return(t=Ml({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ua(e,t,n,i){return null!==i&&fs(i),ks(t,e.child,null,n),(e=Fa(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ba(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),Rs(e.return,t,n)}function Va(e,t,n,i,r){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function qa(e,t,n){var i=t.pendingProps,r=i.revealOrder,s=i.tail;if(ka(e,t,i.children,n),0!==(2&(i=Zs.current)))i=1&i|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ba(e,n,t);else if(19===e.tag)Ba(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(Er(Zs,i),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===eo(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),Va(t,!1,r,n,s);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===eo(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}Va(t,!0,n,null,s);break;case"together":Va(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function za(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ha(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Mc|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Il(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Il(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Wa(e,t){if(!rs)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Ka(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=14680064&r.subtreeFlags,i|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function $a(e,t,n){var i=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ka(t),null;case 1:case 17:return Ar(t.type)&&Ir(),Ka(t),null;case 3:return i=t.stateNode,Js(),xr(Or),xr(Rr),no(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(ds(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(ol(ss),ss=null))),Aa(e,t),Ka(t),null;case 5:Xs(t);var r=Gs($s.current);if(n=t.type,null!==e&&null!=t.stateNode)Ia(e,t,n,i,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(s(166));return Ka(t),null}if(e=Gs(Ws.current),ds(t)){i=t.stateNode,n=t.type;var o=t.memoizedProps;switch(i[hr]=t,i[pr]=o,e=0!==(1&t.mode),n){case"dialog":Ui("cancel",i),Ui("close",i);break;case"iframe":case"object":case"embed":Ui("load",i);break;case"video":case"audio":for(r=0;r<Di.length;r++)Ui(Di[r],i);break;case"source":Ui("error",i);break;case"img":case"image":case"link":Ui("error",i),Ui("load",i);break;case"details":Ui("toggle",i);break;case"input":J(i,o),Ui("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!o.multiple},Ui("invalid",i);break;case"textarea":re(i,o),Ui("invalid",i)}for(var c in ye(n,o),r=null,o)if(o.hasOwnProperty(c)){var l=o[c];"children"===c?"string"===typeof l?i.textContent!==l&&(!0!==o.suppressHydrationWarning&&Xi(i.textContent,l,e),r=["children",l]):"number"===typeof l&&i.textContent!==""+l&&(!0!==o.suppressHydrationWarning&&Xi(i.textContent,l,e),r=["children",""+l]):a.hasOwnProperty(c)&&null!=l&&"onScroll"===c&&Ui("scroll",i)}switch(n){case"input":K(i),Z(i,o,!0);break;case"textarea":K(i),oe(i);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(i.onclick=Zi)}i=r,t.updateQueue=i,null!==i&&(t.flags|=4)}else{c=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=c.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof i.is?e=c.createElement(n,{is:i.is}):(e=c.createElement(n),"select"===n&&(c=e,i.multiple?c.multiple=!0:i.size&&(c.size=i.size))):e=c.createElementNS(e,n),e[hr]=t,e[pr]=i,Na(e,t,!1,!1),t.stateNode=e;e:{switch(c=be(n,i),n){case"dialog":Ui("cancel",e),Ui("close",e),r=i;break;case"iframe":case"object":case"embed":Ui("load",e),r=i;break;case"video":case"audio":for(r=0;r<Di.length;r++)Ui(Di[r],e);r=i;break;case"source":Ui("error",e),r=i;break;case"img":case"image":case"link":Ui("error",e),Ui("load",e),r=i;break;case"details":Ui("toggle",e),r=i;break;case"input":J(e,i),r=Q(e,i),Ui("invalid",e);break;case"option":default:r=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},r=L({},i,{value:void 0}),Ui("invalid",e);break;case"textarea":re(e,i),r=ie(e,i),Ui("invalid",e)}for(o in ye(n,r),l=r)if(l.hasOwnProperty(o)){var u=l[o];"style"===o?ge(e,u):"dangerouslySetInnerHTML"===o?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===o?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(a.hasOwnProperty(o)?null!=u&&"onScroll"===o&&Ui("scroll",e):null!=u&&b(e,o,u,c))}switch(n){case"input":K(e),Z(e,i,!1);break;case"textarea":K(e),oe(e);break;case"option":null!=i.value&&e.setAttribute("value",""+H(i.value));break;case"select":e.multiple=!!i.multiple,null!=(o=i.value)?ne(e,!!i.multiple,o,!1):null!=i.defaultValue&&ne(e,!!i.multiple,i.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=Zi)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ka(t),null;case 6:if(e&&null!=t.stateNode)ja(e,t,e.memoizedProps,i);else{if("string"!==typeof i&&null===t.stateNode)throw Error(s(166));if(n=Gs($s.current),Gs(Ws.current),ds(t)){if(i=t.stateNode,n=t.memoizedProps,i[hr]=t,(o=i.nodeValue!==n)&&null!==(e=ns))switch(e.tag){case 3:Xi(i.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xi(i.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[hr]=t,t.stateNode=i}return Ka(t),null;case 13:if(xr(Zs),i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(rs&&null!==is&&0!==(1&t.mode)&&0===(128&t.flags))hs(),ps(),t.flags|=98560,o=!1;else if(o=ds(t),null!==i&&null!==i.dehydrated){if(null===e){if(!o)throw Error(s(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(s(317));o[hr]=t}else ps(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ka(t),o=!1}else null!==ss&&(ol(ss),ss=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((i=null!==i)!==(null!==e&&null!==e.memoizedState)&&i&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zs.current)?0===jc&&(jc=3):ml())),null!==t.updateQueue&&(t.flags|=4),Ka(t),null);case 4:return Js(),Aa(e,t),null===e&&qi(t.stateNode.containerInfo),Ka(t),null;case 10:return Ps(t.type._context),Ka(t),null;case 19:if(xr(Zs),null===(o=t.memoizedState))return Ka(t),null;if(i=0!==(128&t.flags),null===(c=o.rendering))if(i)Wa(o,!1);else{if(0!==jc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(c=eo(e))){for(t.flags|=128,Wa(o,!1),null!==(i=c.updateQueue)&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;null!==n;)e=i,(o=n).flags&=14680066,null===(c=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=c.childLanes,o.lanes=c.lanes,o.child=c.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=c.memoizedProps,o.memoizedState=c.memoizedState,o.updateQueue=c.updateQueue,o.type=c.type,e=c.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Er(Zs,1&Zs.current|2),t.child}e=e.sibling}null!==o.tail&&Ye()>qc&&(t.flags|=128,i=!0,Wa(o,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=eo(c))){if(t.flags|=128,i=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Wa(o,!0),null===o.tail&&"hidden"===o.tailMode&&!c.alternate&&!rs)return Ka(t),null}else 2*Ye()-o.renderingStartTime>qc&&1073741824!==n&&(t.flags|=128,i=!0,Wa(o,!1),t.lanes=4194304);o.isBackwards?(c.sibling=t.child,t.child=c):(null!==(n=o.last)?n.sibling=c:t.child=c,o.last=c)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Ye(),t.sibling=null,n=Zs.current,Er(Zs,i?1&n|2:1&n),t):(Ka(t),null);case 22:case 23:return dl(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&0!==(1&t.mode)?0!==(1073741824&Ac)&&(Ka(t),6&t.subtreeFlags&&(t.flags|=8192)):Ka(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Ga(e,t){switch(ts(t),t.tag){case 1:return Ar(t.type)&&Ir(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Js(),xr(Or),xr(Rr),no(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Xs(t),null;case 13:if(xr(Zs),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));ps()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return xr(Zs),null;case 4:return Js(),null;case 10:return Ps(t.type._context),null;case 22:case 23:return dl(),null;default:return null}}Na=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Aa=function(){},Ia=function(e,t,n,i){var r=e.memoizedProps;if(r!==i){e=t.stateNode,Gs(Ws.current);var s,o=null;switch(n){case"input":r=Q(e,r),i=Q(e,i),o=[];break;case"select":r=L({},r,{value:void 0}),i=L({},i,{value:void 0}),o=[];break;case"textarea":r=ie(e,r),i=ie(e,i),o=[];break;default:"function"!==typeof r.onClick&&"function"===typeof i.onClick&&(e.onclick=Zi)}for(u in ye(n,i),n=null,r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&null!=r[u])if("style"===u){var c=r[u];for(s in c)c.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in i){var l=i[u];if(c=null!=r?r[u]:void 0,i.hasOwnProperty(u)&&l!==c&&(null!=l||null!=c))if("style"===u)if(c){for(s in c)!c.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in l)l.hasOwnProperty(s)&&c[s]!==l[s]&&(n||(n={}),n[s]=l[s])}else n||(o||(o=[]),o.push(u,n)),n=l;else"dangerouslySetInnerHTML"===u?(l=l?l.__html:void 0,c=c?c.__html:void 0,null!=l&&c!==l&&(o=o||[]).push(u,l)):"children"===u?"string"!==typeof l&&"number"!==typeof l||(o=o||[]).push(u,""+l):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=l&&"onScroll"===u&&Ui("scroll",e),o||c===l||(o=[])):(o=o||[]).push(u,l))}n&&(o=o||[]).push("style",n);var u=o;(t.updateQueue=u)&&(t.flags|=4)}},ja=function(e,t,n,i){n!==i&&(t.flags|=4)};var Qa=!1,Ja=!1,Ya="function"===typeof WeakSet?WeakSet:Set,Xa=null;function Za(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(i){Cl(e,t,i)}else n.current=null}function ec(e,t,n){try{n()}catch(i){Cl(e,t,i)}}var tc=!1;function nc(e,t,n){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var r=i=i.next;do{if((r.tag&e)===e){var s=r.destroy;r.destroy=void 0,void 0!==s&&ec(t,n,s)}r=r.next}while(r!==i)}}function ic(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function rc(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function sc(e){var t=e.alternate;null!==t&&(e.alternate=null,sc(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hr],delete t[pr],delete t[mr],delete t[gr],delete t[vr])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function oc(e){return 5===e.tag||3===e.tag||4===e.tag}function ac(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||oc(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cc(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zi));else if(4!==i&&null!==(e=e.child))for(cc(e,t,n),e=e.sibling;null!==e;)cc(e,t,n),e=e.sibling}function lc(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&null!==(e=e.child))for(lc(e,t,n),e=e.sibling;null!==e;)lc(e,t,n),e=e.sibling}var uc=null,dc=!1;function hc(e,t,n){for(n=n.child;null!==n;)pc(e,t,n),n=n.sibling}function pc(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(rt,n)}catch(a){}switch(n.tag){case 5:Ja||Za(n,t);case 6:var i=uc,r=dc;uc=null,hc(e,t,n),dc=r,null!==(uc=i)&&(dc?(e=uc,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):uc.removeChild(n.stateNode));break;case 18:null!==uc&&(dc?(e=uc,n=n.stateNode,8===e.nodeType?cr(e.parentNode,n):1===e.nodeType&&cr(e,n),qt(e)):cr(uc,n.stateNode));break;case 4:i=uc,r=dc,uc=n.stateNode.containerInfo,dc=!0,hc(e,t,n),uc=i,dc=r;break;case 0:case 11:case 14:case 15:if(!Ja&&(null!==(i=n.updateQueue)&&null!==(i=i.lastEffect))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,void 0!==o&&(0!==(2&s)||0!==(4&s))&&ec(n,t,o),r=r.next}while(r!==i)}hc(e,t,n);break;case 1:if(!Ja&&(Za(n,t),"function"===typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){Cl(n,t,a)}hc(e,t,n);break;case 21:hc(e,t,n);break;case 22:1&n.mode?(Ja=(i=Ja)||null!==n.memoizedState,hc(e,t,n),Ja=i):hc(e,t,n);break;default:hc(e,t,n)}}function fc(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Ya),t.forEach(function(t){var i=Rl.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))})}}function mc(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i];try{var o=e,a=t,c=a;e:for(;null!==c;){switch(c.tag){case 5:uc=c.stateNode,dc=!1;break e;case 3:case 4:uc=c.stateNode.containerInfo,dc=!0;break e}c=c.return}if(null===uc)throw Error(s(160));pc(o,a,r),uc=null,dc=!1;var l=r.alternate;null!==l&&(l.return=null),r.return=null}catch(u){Cl(r,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gc(t,e),t=t.sibling}function gc(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(mc(t,e),vc(e),4&i){try{nc(3,e,e.return),ic(3,e)}catch(g){Cl(e,e.return,g)}try{nc(5,e,e.return)}catch(g){Cl(e,e.return,g)}}break;case 1:mc(t,e),vc(e),512&i&&null!==n&&Za(n,n.return);break;case 5:if(mc(t,e),vc(e),512&i&&null!==n&&Za(n,n.return),32&e.flags){var r=e.stateNode;try{he(r,"")}catch(g){Cl(e,e.return,g)}}if(4&i&&null!=(r=e.stateNode)){var o=e.memoizedProps,a=null!==n?n.memoizedProps:o,c=e.type,l=e.updateQueue;if(e.updateQueue=null,null!==l)try{"input"===c&&"radio"===o.type&&null!=o.name&&Y(r,o),be(c,a);var u=be(c,o);for(a=0;a<l.length;a+=2){var d=l[a],h=l[a+1];"style"===d?ge(r,h):"dangerouslySetInnerHTML"===d?de(r,h):"children"===d?he(r,h):b(r,d,h,u)}switch(c){case"input":X(r,o);break;case"textarea":se(r,o);break;case"select":var p=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!o.multiple;var f=o.value;null!=f?ne(r,!!o.multiple,f,!1):p!==!!o.multiple&&(null!=o.defaultValue?ne(r,!!o.multiple,o.defaultValue,!0):ne(r,!!o.multiple,o.multiple?[]:"",!1))}r[pr]=o}catch(g){Cl(e,e.return,g)}}break;case 6:if(mc(t,e),vc(e),4&i){if(null===e.stateNode)throw Error(s(162));r=e.stateNode,o=e.memoizedProps;try{r.nodeValue=o}catch(g){Cl(e,e.return,g)}}break;case 3:if(mc(t,e),vc(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{qt(t.containerInfo)}catch(g){Cl(e,e.return,g)}break;case 4:default:mc(t,e),vc(e);break;case 13:mc(t,e),vc(e),8192&(r=e.child).flags&&(o=null!==r.memoizedState,r.stateNode.isHidden=o,!o||null!==r.alternate&&null!==r.alternate.memoizedState||(Vc=Ye())),4&i&&fc(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Ja=(u=Ja)||d,mc(t,e),Ja=u):mc(t,e),vc(e),8192&i){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for(Xa=e,d=e.child;null!==d;){for(h=Xa=d;null!==Xa;){switch(f=(p=Xa).child,p.tag){case 0:case 11:case 14:case 15:nc(4,p,p.return);break;case 1:Za(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){i=p,n=p.return;try{t=i,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Cl(i,n,g)}}break;case 5:Za(p,p.return);break;case 22:if(null!==p.memoizedState){wc(h);continue}}null!==f?(f.return=p,Xa=f):wc(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{r=h.stateNode,u?"function"===typeof(o=r.style).setProperty?o.setProperty("display","none","important"):o.display="none":(c=h.stateNode,a=void 0!==(l=h.memoizedProps.style)&&null!==l&&l.hasOwnProperty("display")?l.display:null,c.style.display=me("display",a))}catch(g){Cl(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){Cl(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:mc(t,e),vc(e),4&i&&fc(e);case 21:}}function vc(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(oc(n)){var i=n;break e}n=n.return}throw Error(s(160))}switch(i.tag){case 5:var r=i.stateNode;32&i.flags&&(he(r,""),i.flags&=-33),lc(e,ac(e),r);break;case 3:case 4:var o=i.stateNode.containerInfo;cc(e,ac(e),o);break;default:throw Error(s(161))}}catch(a){Cl(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yc(e,t,n){Xa=e,bc(e,t,n)}function bc(e,t,n){for(var i=0!==(1&e.mode);null!==Xa;){var r=Xa,s=r.child;if(22===r.tag&&i){var o=null!==r.memoizedState||Qa;if(!o){var a=r.alternate,c=null!==a&&null!==a.memoizedState||Ja;a=Qa;var l=Ja;if(Qa=o,(Ja=c)&&!l)for(Xa=r;null!==Xa;)c=(o=Xa).child,22===o.tag&&null!==o.memoizedState?Sc(r):null!==c?(c.return=o,Xa=c):Sc(r);for(;null!==s;)Xa=s,bc(s,t,n),s=s.sibling;Xa=r,Qa=a,Ja=l}kc(e)}else 0!==(8772&r.subtreeFlags)&&null!==s?(s.return=r,Xa=s):kc(e)}}function kc(e){for(;null!==Xa;){var t=Xa;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ja||ic(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!Ja)if(null===n)i.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:na(t.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&zs(t,o,i);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}zs(t,a,n)}break;case 5:var c=t.stateNode;if(null===n&&4&t.flags){n=c;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&qt(h)}}}break;default:throw Error(s(163))}Ja||512&t.flags&&rc(t)}catch(p){Cl(t,t.return,p)}}if(t===e){Xa=null;break}if(null!==(n=t.sibling)){n.return=t.return,Xa=n;break}Xa=t.return}}function wc(e){for(;null!==Xa;){var t=Xa;if(t===e){Xa=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Xa=n;break}Xa=t.return}}function Sc(e){for(;null!==Xa;){var t=Xa;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ic(4,t)}catch(c){Cl(t,n,c)}break;case 1:var i=t.stateNode;if("function"===typeof i.componentDidMount){var r=t.return;try{i.componentDidMount()}catch(c){Cl(t,r,c)}}var s=t.return;try{rc(t)}catch(c){Cl(t,s,c)}break;case 5:var o=t.return;try{rc(t)}catch(c){Cl(t,o,c)}}}catch(c){Cl(t,t.return,c)}if(t===e){Xa=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Xa=a;break}Xa=t.return}}var Tc,Cc=Math.ceil,xc=k.ReactCurrentDispatcher,Ec=k.ReactCurrentOwner,Pc=k.ReactCurrentBatchConfig,Rc=0,Oc=null,_c=null,Nc=0,Ac=0,Ic=Cr(0),jc=0,Dc=null,Mc=0,Lc=0,Fc=0,Uc=null,Bc=null,Vc=0,qc=1/0,zc=null,Hc=!1,Wc=null,Kc=null,$c=!1,Gc=null,Qc=0,Jc=0,Yc=null,Xc=-1,Zc=0;function el(){return 0!==(6&Rc)?Ye():-1!==Xc?Xc:Xc=Ye()}function tl(e){return 0===(1&e.mode)?1:0!==(2&Rc)&&0!==Nc?Nc&-Nc:null!==ms.transition?(0===Zc&&(Zc=mt()),Zc):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Jt(e.type)}function nl(e,t,n,i){if(50<Jc)throw Jc=0,Yc=null,Error(s(185));vt(e,n,i),0!==(2&Rc)&&e===Oc||(e===Oc&&(0===(2&Rc)&&(Lc|=n),4===jc&&al(e,Nc)),il(e,i),1===n&&0===Rc&&0===(1&t.mode)&&(qc=Ye()+500,Ur&&qr()))}function il(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-ot(s),a=1<<o,c=r[o];-1===c?0!==(a&n)&&0===(a&i)||(r[o]=pt(a,t)):c<=t&&(e.expiredLanes|=a),s&=~a}}(e,t);var i=ht(e,e===Oc?Nc:0);if(0===i)null!==n&&Ge(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=n&&Ge(n),1===t)0===e.tag?function(e){Ur=!0,Vr(e)}(cl.bind(null,e)):Vr(cl.bind(null,e)),or(function(){0===(6&Rc)&&qr()}),n=null;else{switch(kt(i)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=it}n=Ol(n,rl.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function rl(e,t){if(Xc=-1,Zc=0,0!==(6&Rc))throw Error(s(327));var n=e.callbackNode;if(Sl()&&e.callbackNode!==n)return null;var i=ht(e,e===Oc?Nc:0);if(0===i)return null;if(0!==(30&i)||0!==(i&e.expiredLanes)||t)t=gl(e,i);else{t=i;var r=Rc;Rc|=2;var o=fl();for(Oc===e&&Nc===t||(zc=null,qc=Ye()+500,hl(e,t));;)try{yl();break}catch(c){pl(e,c)}Es(),xc.current=o,Rc=r,null!==_c?t=0:(Oc=null,Nc=0,t=jc)}if(0!==t){if(2===t&&(0!==(r=ft(e))&&(i=r,t=sl(e,r))),1===t)throw n=Dc,hl(e,0),al(e,i),il(e,Ye()),n;if(6===t)al(e,i);else{if(r=e.current.alternate,0===(30&i)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!ai(s(),r))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=gl(e,i))&&(0!==(o=ft(e))&&(i=o,t=sl(e,o))),1===t))throw n=Dc,hl(e,0),al(e,i),il(e,Ye()),n;switch(e.finishedWork=r,e.finishedLanes=i,t){case 0:case 1:throw Error(s(345));case 2:case 5:wl(e,Bc,zc);break;case 3:if(al(e,i),(130023424&i)===i&&10<(t=Vc+500-Ye())){if(0!==ht(e,0))break;if(((r=e.suspendedLanes)&i)!==i){el(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=ir(wl.bind(null,e,Bc,zc),t);break}wl(e,Bc,zc);break;case 4:if(al(e,i),(4194240&i)===i)break;for(t=e.eventTimes,r=-1;0<i;){var a=31-ot(i);o=1<<a,(a=t[a])>r&&(r=a),i&=~o}if(i=r,10<(i=(120>(i=Ye()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Cc(i/1960))-i)){e.timeoutHandle=ir(wl.bind(null,e,Bc,zc),i);break}wl(e,Bc,zc);break;default:throw Error(s(329))}}}return il(e,Ye()),e.callbackNode===n?rl.bind(null,e):null}function sl(e,t){var n=Uc;return e.current.memoizedState.isDehydrated&&(hl(e,t).flags|=256),2!==(e=gl(e,t))&&(t=Bc,Bc=n,null!==t&&ol(t)),e}function ol(e){null===Bc?Bc=e:Bc.push.apply(Bc,e)}function al(e,t){for(t&=~Fc,t&=~Lc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),i=1<<n;e[n]=-1,t&=~i}}function cl(e){if(0!==(6&Rc))throw Error(s(327));Sl();var t=ht(e,0);if(0===(1&t))return il(e,Ye()),null;var n=gl(e,t);if(0!==e.tag&&2===n){var i=ft(e);0!==i&&(t=i,n=sl(e,i))}if(1===n)throw n=Dc,hl(e,0),al(e,t),il(e,Ye()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wl(e,Bc,zc),il(e,Ye()),null}function ll(e,t){var n=Rc;Rc|=1;try{return e(t)}finally{0===(Rc=n)&&(qc=Ye()+500,Ur&&qr())}}function ul(e){null!==Gc&&0===Gc.tag&&0===(6&Rc)&&Sl();var t=Rc;Rc|=1;var n=Pc.transition,i=bt;try{if(Pc.transition=null,bt=1,e)return e()}finally{bt=i,Pc.transition=n,0===(6&(Rc=t))&&qr()}}function dl(){Ac=Ic.current,xr(Ic)}function hl(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,rr(n)),null!==_c)for(n=_c.return;null!==n;){var i=n;switch(ts(i),i.tag){case 1:null!==(i=i.type.childContextTypes)&&void 0!==i&&Ir();break;case 3:Js(),xr(Or),xr(Rr),no();break;case 5:Xs(i);break;case 4:Js();break;case 13:case 19:xr(Zs);break;case 10:Ps(i.type._context);break;case 22:case 23:dl()}n=n.return}if(Oc=e,_c=e=Il(e.current,null),Nc=Ac=t,jc=0,Dc=null,Fc=Lc=Mc=0,Bc=Uc=null,null!==Ns){for(t=0;t<Ns.length;t++)if(null!==(i=(n=Ns[t]).interleaved)){n.interleaved=null;var r=i.next,s=n.pending;if(null!==s){var o=s.next;s.next=r,i.next=o}n.pending=i}Ns=null}return e}function pl(e,t){for(;;){var n=_c;try{if(Es(),io.current=Xo,lo){for(var i=oo.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}lo=!1}if(so=0,co=ao=oo=null,uo=!1,ho=0,Ec.current=null,null===n||null===n.return){jc=1,Dc=t,_c=null;break}e:{var o=e,a=n.return,c=n,l=t;if(t=Nc,c.flags|=32768,null!==l&&"object"===typeof l&&"function"===typeof l.then){var u=l,d=c,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=ga(a);if(null!==f){f.flags&=-257,va(f,a,c,0,t),1&f.mode&&ma(o,u,t),l=u;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(l),t.updateQueue=g}else m.add(l);break e}if(0===(1&t)){ma(o,u,t),ml();break e}l=Error(s(426))}else if(rs&&1&c.mode){var v=ga(a);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),va(v,a,c,0,t),fs(la(l,c));break e}}o=l=la(l,c),4!==jc&&(jc=2),null===Uc?Uc=[o]:Uc.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Vs(o,pa(0,l,t));break e;case 1:c=l;var y=o.type,b=o.stateNode;if(0===(128&o.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Kc||!Kc.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t,Vs(o,fa(o,c,t));break e}}o=o.return}while(null!==o)}kl(n)}catch(k){t=k,_c===n&&null!==n&&(_c=n=n.return);continue}break}}function fl(){var e=xc.current;return xc.current=Xo,null===e?Xo:e}function ml(){0!==jc&&3!==jc&&2!==jc||(jc=4),null===Oc||0===(268435455&Mc)&&0===(268435455&Lc)||al(Oc,Nc)}function gl(e,t){var n=Rc;Rc|=2;var i=fl();for(Oc===e&&Nc===t||(zc=null,hl(e,t));;)try{vl();break}catch(r){pl(e,r)}if(Es(),Rc=n,xc.current=i,null!==_c)throw Error(s(261));return Oc=null,Nc=0,jc}function vl(){for(;null!==_c;)bl(_c)}function yl(){for(;null!==_c&&!Qe();)bl(_c)}function bl(e){var t=Tc(e.alternate,e,Ac);e.memoizedProps=e.pendingProps,null===t?kl(e):_c=t,Ec.current=null}function kl(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=$a(n,t,Ac)))return void(_c=n)}else{if(null!==(n=Ga(n,t)))return n.flags&=32767,void(_c=n);if(null===e)return jc=6,void(_c=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(_c=t);_c=t=e}while(null!==t);0===jc&&(jc=5)}function wl(e,t,n){var i=bt,r=Pc.transition;try{Pc.transition=null,bt=1,function(e,t,n,i){do{Sl()}while(null!==Gc);if(0!==(6&Rc))throw Error(s(327));n=e.finishedWork;var r=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-ot(n),s=1<<r;t[r]=0,i[r]=-1,e[r]=-1,n&=~s}}(e,o),e===Oc&&(_c=Oc=null,Nc=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||$c||($c=!0,Ol(tt,function(){return Sl(),null})),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Pc.transition,Pc.transition=null;var a=bt;bt=1;var c=Rc;Rc|=4,Ec.current=null,function(e,t){if(er=Ht,pi(e=hi())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var r=i.anchorOffset,o=i.focusNode;i=i.focusOffset;try{n.nodeType,o.nodeType}catch(w){n=null;break e}var a=0,c=-1,l=-1,u=0,d=0,h=e,p=null;t:for(;;){for(var f;h!==n||0!==r&&3!==h.nodeType||(c=a+r),h!==o||0!==i&&3!==h.nodeType||(l=a+i),3===h.nodeType&&(a+=h.nodeValue.length),null!==(f=h.firstChild);)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++u===r&&(c=a),p===o&&++d===i&&(l=a),null!==(f=h.nextSibling))break;p=(h=p).parentNode}h=f}n=-1===c||-1===l?null:{start:c,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(tr={focusedElem:e,selectionRange:n},Ht=!1,Xa=t;null!==Xa;)if(e=(t=Xa).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Xa=e;else for(;null!==Xa;){t=Xa;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:na(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var k=t.stateNode.containerInfo;1===k.nodeType?k.textContent="":9===k.nodeType&&k.documentElement&&k.removeChild(k.documentElement);break;default:throw Error(s(163))}}catch(w){Cl(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Xa=e;break}Xa=t.return}m=tc,tc=!1}(e,n),gc(n,e),fi(tr),Ht=!!er,tr=er=null,e.current=n,yc(n,e,r),Je(),Rc=c,bt=a,Pc.transition=o}else e.current=n;if($c&&($c=!1,Gc=e,Qc=r),o=e.pendingLanes,0===o&&(Kc=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),il(e,Ye()),null!==t)for(i=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(Hc)throw Hc=!1,e=Wc,Wc=null,e;0!==(1&Qc)&&0!==e.tag&&Sl(),o=e.pendingLanes,0!==(1&o)?e===Yc?Jc++:(Jc=0,Yc=e):Jc=0,qr()}(e,t,n,i)}finally{Pc.transition=r,bt=i}return null}function Sl(){if(null!==Gc){var e=kt(Qc),t=Pc.transition,n=bt;try{if(Pc.transition=null,bt=16>e?16:e,null===Gc)var i=!1;else{if(e=Gc,Gc=null,Qc=0,0!==(6&Rc))throw Error(s(331));var r=Rc;for(Rc|=4,Xa=e.current;null!==Xa;){var o=Xa,a=o.child;if(0!==(16&Xa.flags)){var c=o.deletions;if(null!==c){for(var l=0;l<c.length;l++){var u=c[l];for(Xa=u;null!==Xa;){var d=Xa;switch(d.tag){case 0:case 11:case 15:nc(8,d,o)}var h=d.child;if(null!==h)h.return=d,Xa=h;else for(;null!==Xa;){var p=(d=Xa).sibling,f=d.return;if(sc(d),d===u){Xa=null;break}if(null!==p){p.return=f,Xa=p;break}Xa=f}}}var m=o.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Xa=o}}if(0!==(2064&o.subtreeFlags)&&null!==a)a.return=o,Xa=a;else e:for(;null!==Xa;){if(0!==(2048&(o=Xa).flags))switch(o.tag){case 0:case 11:case 15:nc(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,Xa=y;break e}Xa=o.return}}var b=e.current;for(Xa=b;null!==Xa;){var k=(a=Xa).child;if(0!==(2064&a.subtreeFlags)&&null!==k)k.return=a,Xa=k;else e:for(a=b;null!==Xa;){if(0!==(2048&(c=Xa).flags))try{switch(c.tag){case 0:case 11:case 15:ic(9,c)}}catch(S){Cl(c,c.return,S)}if(c===a){Xa=null;break e}var w=c.sibling;if(null!==w){w.return=c.return,Xa=w;break e}Xa=c.return}}if(Rc=r,qr(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(rt,e)}catch(S){}i=!0}return i}finally{bt=n,Pc.transition=t}}return!1}function Tl(e,t,n){e=Us(e,t=pa(0,t=la(n,t),1),1),t=el(),null!==e&&(vt(e,1,t),il(e,t))}function Cl(e,t,n){if(3===e.tag)Tl(e,e,n);else for(;null!==t;){if(3===t.tag){Tl(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===Kc||!Kc.has(i))){t=Us(t,e=fa(t,e=la(n,e),1),1),e=el(),null!==t&&(vt(t,1,e),il(t,e));break}}t=t.return}}function xl(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),t=el(),e.pingedLanes|=e.suspendedLanes&n,Oc===e&&(Nc&n)===n&&(4===jc||3===jc&&(130023424&Nc)===Nc&&500>Ye()-Vc?hl(e,0):Fc|=n),il(e,t)}function El(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=el();null!==(e=js(e,t))&&(vt(e,t,n),il(e,n))}function Pl(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),El(e,n)}function Rl(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(s(314))}null!==i&&i.delete(t),El(e,n)}function Ol(e,t){return $e(e,t)}function _l(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nl(e,t,n,i){return new _l(e,t,n,i)}function Al(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Il(e,t){var n=e.alternate;return null===n?((n=Nl(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function jl(e,t,n,i,r,o){var a=2;if(i=e,"function"===typeof e)Al(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case T:return Dl(n.children,r,o,t);case C:a=8,r|=8;break;case x:return(e=Nl(12,n,t,2|r)).elementType=x,e.lanes=o,e;case O:return(e=Nl(13,n,t,r)).elementType=O,e.lanes=o,e;case _:return(e=Nl(19,n,t,r)).elementType=_,e.lanes=o,e;case I:return Ml(n,r,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case E:a=10;break e;case P:a=9;break e;case R:a=11;break e;case N:a=14;break e;case A:a=16,i=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Nl(a,n,t,r)).elementType=e,t.type=i,t.lanes=o,t}function Dl(e,t,n,i){return(e=Nl(7,e,i,t)).lanes=n,e}function Ml(e,t,n,i){return(e=Nl(22,e,i,t)).elementType=I,e.lanes=n,e.stateNode={isHidden:!1},e}function Ll(e,t,n){return(e=Nl(6,e,null,t)).lanes=n,e}function Fl(e,t,n){return(t=Nl(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Ul(e,t,n,i,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Bl(e,t,n,i,r,s,o,a,c){return e=new Ul(e,t,n,a,c),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Nl(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ms(s),e}function Vl(e){if(!e)return Pr;e:{if(qe(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ar(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Ar(n))return Dr(e,n,t)}return t}function ql(e,t,n,i,r,s,o,a,c){return(e=Bl(n,i,!0,e,0,s,0,a,c)).context=Vl(null),n=e.current,(s=Fs(i=el(),r=tl(n))).callback=void 0!==t&&null!==t?t:null,Us(n,s,r),e.current.lanes=r,vt(e,r,i),il(e,i),e}function zl(e,t,n,i){var r=t.current,s=el(),o=tl(r);return n=Vl(n),null===t.context?t.context=n:t.pendingContext=n,(t=Fs(s,o)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),null!==(e=Us(r,t,o))&&(nl(e,r,o,s),Bs(e,r,o)),o}function Hl(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Wl(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Kl(e,t){Wl(e,t),(e=e.alternate)&&Wl(e,t)}Tc=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Or.current)ba=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return ba=!1,function(e,t,n){switch(t.tag){case 3:Oa(t),ps();break;case 5:Ys(t);break;case 1:Ar(t.type)&&Mr(t);break;case 4:Qs(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,r=t.memoizedProps.value;Er(Ss,i._currentValue),i._currentValue=r;break;case 13:if(null!==(i=t.memoizedState))return null!==i.dehydrated?(Er(Zs,1&Zs.current),t.flags|=128,null):0!==(n&t.child.childLanes)?La(e,t,n):(Er(Zs,1&Zs.current),null!==(e=Ha(e,t,n))?e.sibling:null);Er(Zs,1&Zs.current);break;case 19:if(i=0!==(n&t.childLanes),0!==(128&e.flags)){if(i)return qa(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Er(Zs,Zs.current),i)break;return null;case 22:case 23:return t.lanes=0,Ca(e,t,n)}return Ha(e,t,n)}(e,t,n);ba=0!==(131072&e.flags)}else ba=!1,rs&&0!==(1048576&t.flags)&&Zr(t,Kr,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;za(e,t),e=t.pendingProps;var r=Nr(t,Rr.current);Os(t,n),r=go(null,t,i,e,r,n);var o=vo();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ar(i)?(o=!0,Mr(t)):o=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Ms(t),r.updater=ra,t.stateNode=r,r._reactInternals=t,ca(t,i,e,n),t=Ra(null,t,i,!0,o,n)):(t.tag=0,rs&&o&&es(t),ka(null,t,r,n),t=t.child),t;case 16:i=t.elementType;e:{switch(za(e,t),e=t.pendingProps,i=(r=i._init)(i._payload),t.type=i,r=t.tag=function(e){if("function"===typeof e)return Al(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===R)return 11;if(e===N)return 14}return 2}(i),e=na(i,e),r){case 0:t=Ea(null,t,i,e,n);break e;case 1:t=Pa(null,t,i,e,n);break e;case 11:t=wa(null,t,i,e,n);break e;case 14:t=Sa(null,t,i,na(i.type,e),n);break e}throw Error(s(306,i,""))}return t;case 0:return i=t.type,r=t.pendingProps,Ea(e,t,i,r=t.elementType===i?r:na(i,r),n);case 1:return i=t.type,r=t.pendingProps,Pa(e,t,i,r=t.elementType===i?r:na(i,r),n);case 3:e:{if(Oa(t),null===e)throw Error(s(387));i=t.pendingProps,r=(o=t.memoizedState).element,Ls(e,t),qs(t,i,null,n);var a=t.memoizedState;if(i=a.element,o.isDehydrated){if(o={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=_a(e,t,i,n,r=la(Error(s(423)),t));break e}if(i!==r){t=_a(e,t,i,n,r=la(Error(s(424)),t));break e}for(is=lr(t.stateNode.containerInfo.firstChild),ns=t,rs=!0,ss=null,n=ws(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ps(),i===r){t=Ha(e,t,n);break e}ka(e,t,i,n)}t=t.child}return t;case 5:return Ys(t),null===e&&ls(t),i=t.type,r=t.pendingProps,o=null!==e?e.memoizedProps:null,a=r.children,nr(i,r)?a=null:null!==o&&nr(i,o)&&(t.flags|=32),xa(e,t),ka(e,t,a,n),t.child;case 6:return null===e&&ls(t),null;case 13:return La(e,t,n);case 4:return Qs(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=ks(t,null,i,n):ka(e,t,i,n),t.child;case 11:return i=t.type,r=t.pendingProps,wa(e,t,i,r=t.elementType===i?r:na(i,r),n);case 7:return ka(e,t,t.pendingProps,n),t.child;case 8:case 12:return ka(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,r=t.pendingProps,o=t.memoizedProps,a=r.value,Er(Ss,i._currentValue),i._currentValue=a,null!==o)if(ai(o.value,a)){if(o.children===r.children&&!Or.current){t=Ha(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var c=o.dependencies;if(null!==c){a=o.child;for(var l=c.firstContext;null!==l;){if(l.context===i){if(1===o.tag){(l=Fs(-1,n&-n)).tag=2;var u=o.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),Rs(o.return,n,t),c.lanes|=n;break}l=l.next}}else if(10===o.tag)a=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(a=o.return))throw Error(s(341));a.lanes|=n,null!==(c=a.alternate)&&(c.lanes|=n),Rs(a,n,t),a=o.sibling}else a=o.child;if(null!==a)a.return=o;else for(a=o;null!==a;){if(a===t){a=null;break}if(null!==(o=a.sibling)){o.return=a.return,a=o;break}a=a.return}o=a}ka(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,i=t.pendingProps.children,Os(t,n),i=i(r=_s(r)),t.flags|=1,ka(e,t,i,n),t.child;case 14:return r=na(i=t.type,t.pendingProps),Sa(e,t,i,r=na(i.type,r),n);case 15:return Ta(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:na(i,r),za(e,t),t.tag=1,Ar(i)?(e=!0,Mr(t)):e=!1,Os(t,n),oa(t,i,r),ca(t,i,r,n),Ra(null,t,i,!0,e,n);case 19:return qa(e,t,n);case 22:return Ca(e,t,n)}throw Error(s(156,t.tag))};var $l="function"===typeof reportError?reportError:function(e){console.error(e)};function Gl(e){this._internalRoot=e}function Ql(e){this._internalRoot=e}function Jl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Yl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Xl(){}function Zl(e,t,n,i,r){var s=n._reactRootContainer;if(s){var o=s;if("function"===typeof r){var a=r;r=function(){var e=Hl(o);a.call(e)}}zl(t,o,e,r)}else o=function(e,t,n,i,r){if(r){if("function"===typeof i){var s=i;i=function(){var e=Hl(o);s.call(e)}}var o=ql(t,i,e,0,null,!1,0,"",Xl);return e._reactRootContainer=o,e[fr]=o.current,qi(8===e.nodeType?e.parentNode:e),ul(),o}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof i){var a=i;i=function(){var e=Hl(c);a.call(e)}}var c=Bl(e,0,!1,null,0,!1,0,"",Xl);return e._reactRootContainer=c,e[fr]=c.current,qi(8===e.nodeType?e.parentNode:e),ul(function(){zl(t,c,n,i)}),c}(n,t,e,r,i);return Hl(o)}Ql.prototype.render=Gl.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));zl(e,t,null,null)},Ql.prototype.unmount=Gl.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;ul(function(){zl(null,e,null,null)}),t[fr]=null}},Ql.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ct();e={blockedOn:null,target:e,priority:t};for(var n=0;n<It.length&&0!==t&&t<It[n].priority;n++);It.splice(n,0,e),0===n&&Lt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),il(t,Ye()),0===(6&Rc)&&(qc=Ye()+500,qr()))}break;case 13:ul(function(){var t=js(e,1);if(null!==t){var n=el();nl(t,e,1,n)}}),Kl(e,1)}},St=function(e){if(13===e.tag){var t=js(e,134217728);if(null!==t)nl(t,e,134217728,el());Kl(e,134217728)}},Tt=function(e){if(13===e.tag){var t=tl(e),n=js(e,t);if(null!==n)nl(n,e,t,el());Kl(e,t)}},Ct=function(){return bt},xt=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},Se=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var r=wr(i);if(!r)throw Error(s(90));$(i),X(i,r)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Re=ll,Oe=ul;var eu={usingClientEntryPoint:!1,Events:[br,kr,wr,Ee,Pe,ll]},tu={findFiberByHostInstance:yr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:k.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{rt=iu.inject(nu),st=iu}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Jl(t))throw Error(s(200));return function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:S,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Jl(e))throw Error(s(299));var n=!1,i="",r=$l;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=Bl(e,1,!1,null,0,n,0,i,r),e[fr]=t.current,qi(8===e.nodeType?e.parentNode:e),new Gl(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return ul(e)},t.hydrate=function(e,t,n){if(!Yl(t))throw Error(s(200));return Zl(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Jl(e))throw Error(s(405));var i=null!=n&&n.hydratedSources||null,r=!1,o="",a=$l;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=ql(t,null,e,1,null!=n?n:null,r,0,o,a),e[fr]=t.current,qi(e),i)for(e=0;e<i.length;e++)r=(r=(n=i[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new Ql(t)},t.render=function(e,t,n){if(!Yl(t))throw Error(s(200));return Zl(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Yl(e))throw Error(s(40));return!!e._reactRootContainer&&(ul(function(){Zl(null,null,e,!1,function(){e._reactRootContainer=null,e[fr]=null})}),!0)},t.unstable_batchedUpdates=ll,t.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!Yl(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return Zl(e,t,n,!1,i)},t.version="18.3.1-next-f1338f8080-20240426"},2786:(e,t,n)=>{"use strict";e.exports=C,C.filename=null,C.defaults={keepCase:!1};var i=n(1752),r=n(7149),s=n(2225),o=n(9229),a=n(4635),c=n(2924),l=n(1220),u=n(6366),d=n(360),h=n(6046),p=n(9876),f=n(9469),m=/^[1-9][0-9]*$/,g=/^-?[1-9][0-9]*$/,v=/^0[x][0-9a-fA-F]+$/,y=/^-?0[x][0-9a-fA-F]+$/,b=/^0[0-7]+$/,k=/^-?0[0-7]+$/,w=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,S=/^[a-zA-Z_][a-zA-Z_0-9]*$/,T=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/;function C(e,t,n){t instanceof r||(n=t,t=new r),n||(n=C.defaults);var x,E,P,R,O=n.preferTrailingComment||!1,_=i(e,n.alternateCommentMode||!1),N=_.next,A=_.push,I=_.peek,j=_.skip,D=_.cmnt,M=!0,L="proto2",F=t,U=[],B={},V=n.keepCase?function(e){return e}:f.camelCase;function q(e,t,n){var i=C.filename;return n||(C.filename=null),Error("illegal "+(t||"token")+" '"+e+"' ("+(i?i+", ":"")+"line "+_.line+")")}function z(){var e,t=[];do{if('"'!==(e=N())&&"'"!==e)throw q(e);t.push(N()),j(e),e=I()}while('"'===e||"'"===e);return t.join("")}function H(e){var t=N();switch(t){case"'":case'"':return A(t),z();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return function(e,t){var n=1;"-"===e.charAt(0)&&(n=-1,e=e.substring(1));switch(e){case"inf":case"INF":case"Inf":return n*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(m.test(e))return n*parseInt(e,10);if(v.test(e))return n*parseInt(e,16);if(b.test(e))return n*parseInt(e,8);if(w.test(e))return n*parseFloat(e);throw q(e,"number",t)}(t,!0)}catch(n){if(e&&T.test(t))return t;throw q(t,"value")}}function W(e,t){var n,i;do{if(!t||'"'!==(n=I())&&"'"!==n)try{e.push([i=K(N()),j("to",!0)?K(N()):i])}catch(o){if(!(t&&T.test(n)&&L>=2023))throw o;e.push(n)}else{var r=z();if(e.push(r),L>=2023)throw q(r,"id")}}while(j(",",!0));var s={options:void 0,setOption:function(e,t){void 0===this.options&&(this.options={}),this.options[e]=t}};X(s,function(e){if("option"!==e)throw q(e);ne(s,e),j(";")},function(){se(s)})}function K(e,t){switch(e){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!t&&"-"===e.charAt(0))throw q(e,"id");if(g.test(e))return parseInt(e,10);if(y.test(e))return parseInt(e,16);if(k.test(e))return parseInt(e,8);throw q(e,"id")}function $(){if(void 0!==x)throw q("package");if(x=N(),!T.test(x))throw q(x,"name");F=F.define(x),j(";")}function G(){var e,t=I();switch(t){case"weak":e=P||(P=[]),N();break;case"public":N();default:e=E||(E=[])}t=z(),j(";"),e.push(t)}function Q(){if(j("="),(L=z())<2023)throw q(L,"syntax");j(";")}function J(){j("="),L=z();if(!["2023"].includes(L))throw q(L,"edition");j(";")}function Y(e,t){switch(t){case"option":return ne(e,t),j(";"),!0;case"message":return Z(e,t),!0;case"enum":return te(e,t),!0;case"service":return function(e,t){if(!S.test(t=N()))throw q(t,"service name");var n=new u(t);X(n,function(e){if(!Y(n,e)){if("rpc"!==e)throw q(e);!function(e,t){var n=D(),i=t;if(!S.test(t=N()))throw q(t,"name");var r,s,o,a,c=t;j("("),j("stream",!0)&&(s=!0);if(!T.test(t=N()))throw q(t);r=t,j(")"),j("returns"),j("("),j("stream",!0)&&(a=!0);if(!T.test(t=N()))throw q(t);o=t,j(")");var l=new d(c,i,r,o,s,a);l.comment=n,X(l,function(e){if("option"!==e)throw q(e);ne(l,e),j(";")}),e.add(l)}(n,e)}}),e.add(n),e===F&&U.push(n)}(e,t),!0;case"extend":return function(e,t){if(!T.test(t=N()))throw q(t,"reference");var n=t;X(null,function(t){switch(t){case"required":case"repeated":ee(e,t,n);break;case"optional":ee(e,"proto3"===L?"proto3_optional":"optional",n);break;default:if("proto2"===L||!T.test(t))throw q(t);A(t),ee(e,"optional",n)}})}(e,t),!0}return!1}function X(e,t,n){var i=_.line;if(e&&("string"!==typeof e.comment&&(e.comment=D()),e.filename=C.filename),j("{",!0)){for(var r;"}"!==(r=N());)t(r);j(";",!0)}else n&&n(),j(";"),e&&("string"!==typeof e.comment||O)&&(e.comment=D(i)||e.comment)}function Z(e,t){if(!S.test(t=N()))throw q(t,"type name");var n=new s(t);X(n,function(e){if(!Y(n,e))switch(e){case"map":!function(e){j("<");var t=N();if(void 0===p.mapKey[t])throw q(t,"type");j(",");var n=N();if(!T.test(n))throw q(n,"type");j(">");var i=N();if(!S.test(i))throw q(i,"name");j("=");var r=new a(V(i),K(N()),t,n);X(r,function(e){if("option"!==e)throw q(e);ne(r,e),j(";")},function(){se(r)}),e.add(r)}(n);break;case"required":if("proto2"!==L)throw q(e);case"repeated":ee(n,e);break;case"optional":if("proto3"===L)ee(n,"proto3_optional");else{if("proto2"!==L)throw q(e);ee(n,"optional")}break;case"oneof":!function(e,t){if(!S.test(t=N()))throw q(t,"name");var n=new c(V(t));X(n,function(e){"option"===e?(ne(n,e),j(";")):(A(e),ee(n,"optional"))}),e.add(n)}(n,e);break;case"extensions":W(n.extensions||(n.extensions=[]));break;case"reserved":W(n.reserved||(n.reserved=[]),!0);break;default:if("proto2"===L||!T.test(e))throw q(e);A(e),ee(n,"optional")}}),e.add(n),e===F&&U.push(n)}function ee(e,t,n){var i=N();if("group"!==i){for(;i.endsWith(".")||I().startsWith(".");)i+=N();if(!T.test(i))throw q(i,"type");var r=N();if(!S.test(r))throw q(r,"name");r=V(r),j("=");var a=new o(r,K(N()),i,t,n);if(X(a,function(e){if("option"!==e)throw q(e);ne(a,e),j(";")},function(){se(a)}),"proto3_optional"===t){var l=new c("_"+r);a.setOption("proto3_optional",!0),l.add(a),e.add(l)}else e.add(a);e===F&&U.push(a)}else!function(e,t){if(L>=2023)throw q("group");var n=N();if(!S.test(n))throw q(n,"name");var i=f.lcFirst(n);n===i&&(n=f.ucFirst(n));j("=");var r=K(N()),a=new s(n);a.group=!0;var c=new o(i,r,n,t);c.filename=C.filename,X(a,function(e){switch(e){case"option":ne(a,e),j(";");break;case"required":case"repeated":ee(a,e);break;case"optional":ee(a,"proto3"===L?"proto3_optional":"optional");break;case"message":Z(a,e);break;case"enum":te(a,e);break;case"reserved":W(a.reserved||(a.reserved=[]),!0);break;default:throw q(e)}}),e.add(a).add(c)}(e,t)}function te(e,t){if(!S.test(t=N()))throw q(t,"name");var n=new l(t);X(n,function(e){switch(e){case"option":ne(n,e),j(";");break;case"reserved":W(n.reserved||(n.reserved=[]),!0),void 0===n.reserved&&(n.reserved=[]);break;default:!function(e,t){if(!S.test(t))throw q(t,"name");j("=");var n=K(N(),!0),i={options:void 0,getOption:function(e){return this.options[e]}};i.setOption=function(e,t){h.prototype.setOption.call(i,e,t)},i.setParsedOption=function(){},X(i,function(e){if("option"!==e)throw q(e);ne(i,e),j(";")},function(){se(i)}),e.add(t,n,i.comment,i.parsedOptions||i.options)}(n,e)}}),e.add(n),e===F&&U.push(n)}function ne(e,t){var n,i,r=!0;for("option"===t&&(t=N());"="!==t;){if("("===t){var s=N();j(")"),t="("+s+")"}if(r){if(r=!1,t.includes(".")&&!t.includes("(")){var o=t.split(".");n=o[0]+".",t=o[1];continue}n=t}else i=i?i+=t:t;t=N()}var a=ie(e,i?n.concat(i):n);i=i&&"."===i[0]?i.slice(1):i,function(e,t,n,i){e.setParsedOption&&e.setParsedOption(t,n,i)}(e,n=n&&"."===n[n.length-1]?n.slice(0,-1):n,a,i)}function ie(e,t){if(j("{",!0)){for(var n={};!j("}",!0);){if(!S.test(R=N()))throw q(R,"name");if(null===R)throw q(R,"end of input");var i,r=R;if(j(":",!0),"{"===I())i=ie(e,t+"."+R);else if("["===I()){var s;if(i=[],j("[",!0)){do{s=H(!0),i.push(s)}while(j(",",!0));j("]"),"undefined"!==typeof s&&re(e,t+"."+R,s)}}else i=H(!0),re(e,t+"."+R,i);var o=n[r];o&&(i=[].concat(o).concat(i)),n[r]=i,j(",",!0),j(";",!0)}return n}var a=H(!0);return re(e,t,a),a}function re(e,t,n){F===e&&/^features\./.test(t)?B[t]=n:e.setOption&&e.setOption(t,n)}function se(e){if(j("[",!0)){do{ne(e,"option")}while(j(",",!0));j("]")}return e}for(;null!==(R=N());)switch(R){case"package":if(!M)throw q(R);$();break;case"import":if(!M)throw q(R);G();break;case"syntax":if(!M)throw q(R);Q();break;case"edition":if(!M)throw q(R);J();break;case"option":ne(F,R),j(";",!0);break;default:if(Y(F,R)){M=!1;continue}throw q(R)}return U.forEach(e=>{e._edition=L,Object.keys(B).forEach(t=>{void 0===e.getOption(t)&&e.setOption(t,B[t],!0)})}),C.filename=null,{package:x,imports:E,weakImports:P,root:t}}},2907:(e,t,n)=>{"use strict";n.d(t,{QueryClient:()=>i.QueryClient,QueryClientProvider:()=>r.QueryClientProvider});var i=n(5819);n.o(i,"QueryClientProvider")&&n.d(t,{QueryClientProvider:function(){return i.QueryClientProvider}});var r=n(6524)},2924:(e,t,n)=>{"use strict";e.exports=o;var i=n(6046);((o.prototype=Object.create(i.prototype)).constructor=o).className="OneOf";var r=n(9229),s=n(9469);function o(e,t,n,r){if(Array.isArray(t)||(n=t,t=void 0),i.call(this,e,n),void 0!==t&&!Array.isArray(t))throw TypeError("fieldNames must be an Array");this.oneof=t||[],this.fieldsArray=[],this.comment=r}function a(e){if(e.parent)for(var t=0;t<e.fieldsArray.length;++t)e.fieldsArray[t].parent||e.parent.add(e.fieldsArray[t])}o.fromJSON=function(e,t){return new o(e,t.oneof,t.options,t.comment)},o.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return s.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:void 0])},o.prototype.add=function(e){if(!(e instanceof r))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,a(this),this},o.prototype.remove=function(e){if(!(e instanceof r))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),(t=this.oneof.indexOf(e.name))>-1&&this.oneof.splice(t,1),e.partOf=null,this},o.prototype.onAdd=function(e){i.prototype.onAdd.call(this,e);for(var t=0;t<this.oneof.length;++t){var n=e.get(this.oneof[t]);n&&!n.partOf&&(n.partOf=this,this.fieldsArray.push(n))}a(this)},o.prototype.onRemove=function(e){for(var t,n=0;n<this.fieldsArray.length;++n)(t=this.fieldsArray[n]).parent&&t.parent.remove(t);i.prototype.onRemove.call(this,e)},Object.defineProperty(o.prototype,"isProto3Optional",{get:function(){if(null==this.fieldsArray||1!==this.fieldsArray.length)return!1;var e=this.fieldsArray[0];return null!=e.options&&!0===e.options.proto3_optional}}),o.d=function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(t,n){s.decorateType(t.constructor).add(new o(n,e)),Object.defineProperty(t,n,{get:s.oneOfGetter(e),set:s.oneOfSetter(e)})}}},3338:(e,t,n)=>{"use strict";e.exports=c;var i,r=n(1509),s=r.LongBits,o=r.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var l="undefined"!==typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")},u=function(){return r.Buffer?function(e){return(c.create=function(e){return r.Buffer.isBuffer(e)?new i(e):l(e)})(e)}:l};function d(){var e=new s(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function h(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function p(){if(this.pos+8>this.len)throw a(this,8);return new s(h(this.buf,this.pos+=4),h(this.buf,this.pos+=4))}c.create=u(),c.prototype._slice=r.Array.prototype.subarray||r.Array.prototype.slice,c.prototype.uint32=function(){var e=4294967295;return function(){if(e=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return e;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return e}}(),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return h(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|h(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=r.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=r.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw a(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(t,n);if(t===n){var i=r.Buffer;return i?i.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,t,n)},c.prototype.string=function(){var e=this.bytes();return o.read(e,0,e.length)},c.prototype.skip=function(e){if("number"===typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!==(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){i=e,c.create=u(),i._configure();var t=r.Long?"toLong":"toNumber";r.merge(c.prototype,{int64:function(){return d.call(this)[t](!1)},uint64:function(){return d.call(this)[t](!0)},sint64:function(){return d.call(this).zzDecode()[t](!1)},fixed64:function(){return p.call(this)[t](!0)},sfixed64:function(){return p.call(this)[t](!1)}})}},3694:(e,t,n)=>{"use strict";e.exports=r;var i=n(1509);function r(e,t,n){if("function"!==typeof e)throw TypeError("rpcImpl must be a function");i.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(r.prototype=Object.create(i.EventEmitter.prototype)).constructor=r,r.prototype.rpcCall=function e(t,n,r,s,o){if(!s)throw TypeError("request must be specified");var a=this;if(!o)return i.asPromise(e,a,t,n,r,s);if(a.rpcImpl)try{return a.rpcImpl(t,n[a.requestDelimited?"encodeDelimited":"encode"](s).finish(),function(e,n){if(e)return a.emit("error",e,t),o(e);if(null!==n){if(!(n instanceof r))try{n=r[a.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return a.emit("error",e,t),o(e)}return a.emit("data",n,t),o(null,n)}a.end(!0)})}catch(c){return a.emit("error",c,t),void setTimeout(function(){o(c)},0)}else setTimeout(function(){o(Error("already ended"))},0)},r.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},3931:(e,t,n)=>{"use strict";e.exports=s;var i=n(5850);(s.prototype=Object.create(i.prototype)).constructor=s;var r=n(1509);function s(){i.call(this)}function o(e,t,n){e.length<40?r.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}s._configure=function(){s.alloc=r._Buffer_allocUnsafe,s.writeBytesBuffer=r.Buffer&&r.Buffer.prototype instanceof Uint8Array&&"set"===r.Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var i=0;i<e.length;)t[n++]=e[i++]}},s.prototype.bytes=function(e){r.isString(e)&&(e=r._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(s.writeBytesBuffer,t,e),this},s.prototype.string=function(e){var t=r.Buffer.byteLength(e);return this.uint32(t),t&&this._push(o,t,e),this},s._configure()},4198:(e,t,n)=>{"use strict";n.d(t,{E:()=>T});var i=n(8168),r=n(8870);function s(e,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s(e,t)}function o(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,s(e,t)}var a=n(1991),c=n(75),l=function(){function e(){this.listeners=[]}var t=e.prototype;return t.subscribe=function(e){var t=this,n=e||function(){};return this.listeners.push(n),this.onSubscribe(),function(){t.listeners=t.listeners.filter(function(e){return e!==n}),t.onUnsubscribe()}},t.hasListeners=function(){return this.listeners.length>0},t.onSubscribe=function(){},t.onUnsubscribe=function(){},e}(),u=new(function(e){function t(){var t;return(t=e.call(this)||this).setup=function(e){var t;if(!r.S$&&(null==(t=window)?void 0:t.addEventListener)){var n=function(){return e()};return window.addEventListener("visibilitychange",n,!1),window.addEventListener("focus",n,!1),function(){window.removeEventListener("visibilitychange",n),window.removeEventListener("focus",n)}}},t}o(t,e);var n=t.prototype;return n.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},n.onUnsubscribe=function(){var e;this.hasListeners()||(null==(e=this.cleanup)||e.call(this),this.cleanup=void 0)},n.setEventListener=function(e){var t,n=this;this.setup=e,null==(t=this.cleanup)||t.call(this),this.cleanup=e(function(e){"boolean"===typeof e?n.setFocused(e):n.onFocus()})},n.setFocused=function(e){this.focused=e,e&&this.onFocus()},n.onFocus=function(){this.listeners.forEach(function(e){e()})},n.isFocused=function(){return"boolean"===typeof this.focused?this.focused:"undefined"===typeof document||[void 0,"visible","prerender"].includes(document.visibilityState)},t}(l)),d=new(function(e){function t(){var t;return(t=e.call(this)||this).setup=function(e){var t;if(!r.S$&&(null==(t=window)?void 0:t.addEventListener)){var n=function(){return e()};return window.addEventListener("online",n,!1),window.addEventListener("offline",n,!1),function(){window.removeEventListener("online",n),window.removeEventListener("offline",n)}}},t}o(t,e);var n=t.prototype;return n.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},n.onUnsubscribe=function(){var e;this.hasListeners()||(null==(e=this.cleanup)||e.call(this),this.cleanup=void 0)},n.setEventListener=function(e){var t,n=this;this.setup=e,null==(t=this.cleanup)||t.call(this),this.cleanup=e(function(e){"boolean"===typeof e?n.setOnline(e):n.onOnline()})},n.setOnline=function(e){this.online=e,e&&this.onOnline()},n.onOnline=function(){this.listeners.forEach(function(e){e()})},n.isOnline=function(){return"boolean"===typeof this.online?this.online:"undefined"===typeof navigator||"undefined"===typeof navigator.onLine||navigator.onLine},t}(l));function h(e){return Math.min(1e3*Math.pow(2,e),3e4)}function p(e){return"function"===typeof(null==e?void 0:e.cancel)}var f=function(e){this.revert=null==e?void 0:e.revert,this.silent=null==e?void 0:e.silent};function m(e){return e instanceof f}var g=function(e){var t,n,i,s,o=this,a=!1;this.abort=e.abort,this.cancel=function(e){return null==t?void 0:t(e)},this.cancelRetry=function(){a=!0},this.continueRetry=function(){a=!1},this.continue=function(){return null==n?void 0:n()},this.failureCount=0,this.isPaused=!1,this.isResolved=!1,this.isTransportCancelable=!1,this.promise=new Promise(function(e,t){i=e,s=t});var c=function(t){o.isResolved||(o.isResolved=!0,null==e.onSuccess||e.onSuccess(t),null==n||n(),i(t))},l=function(t){o.isResolved||(o.isResolved=!0,null==e.onError||e.onError(t),null==n||n(),s(t))};!function i(){if(!o.isResolved){var s;try{s=e.fn()}catch(m){s=Promise.reject(m)}t=function(e){if(!o.isResolved&&(l(new f(e)),null==o.abort||o.abort(),p(s)))try{s.cancel()}catch(t){}},o.isTransportCancelable=p(s),Promise.resolve(s).then(c).catch(function(t){var s,c;if(!o.isResolved){var p=null!=(s=e.retry)?s:3,f=null!=(c=e.retryDelay)?c:h,m="function"===typeof f?f(o.failureCount,t):f,g=!0===p||"number"===typeof p&&o.failureCount<p||"function"===typeof p&&p(o.failureCount,t);!a&&g?(o.failureCount++,null==e.onFail||e.onFail(o.failureCount,t),(0,r.yy)(m).then(function(){if(!u.isFocused()||!d.isOnline())return new Promise(function(t){n=t,o.isPaused=!0,null==e.onPause||e.onPause()}).then(function(){n=void 0,o.isPaused=!1,null==e.onContinue||e.onContinue()})}).then(function(){a?l(t):i()})):l(t)}})}}()},v=function(){function e(e){this.abortSignalConsumed=!1,this.hadObservers=!1,this.defaultOptions=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.cache=e.cache,this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.initialState=e.state||this.getDefaultState(this.options),this.state=this.initialState,this.meta=e.meta,this.scheduleGc()}var t=e.prototype;return t.setOptions=function(e){var t;this.options=(0,i.A)({},this.defaultOptions,e),this.meta=null==e?void 0:e.meta,this.cacheTime=Math.max(this.cacheTime||0,null!=(t=this.options.cacheTime)?t:3e5)},t.setDefaultOptions=function(e){this.defaultOptions=e},t.scheduleGc=function(){var e=this;this.clearGcTimeout(),(0,r.gn)(this.cacheTime)&&(this.gcTimeout=setTimeout(function(){e.optionalRemove()},this.cacheTime))},t.clearGcTimeout=function(){this.gcTimeout&&(clearTimeout(this.gcTimeout),this.gcTimeout=void 0)},t.optionalRemove=function(){this.observers.length||(this.state.isFetching?this.hadObservers&&this.scheduleGc():this.cache.remove(this))},t.setData=function(e,t){var n,i,s=this.state.data,o=(0,r.Zw)(e,s);return(null==(n=(i=this.options).isDataEqual)?void 0:n.call(i,s,o))?o=s:!1!==this.options.structuralSharing&&(o=(0,r.BH)(s,o)),this.dispatch({data:o,type:"success",dataUpdatedAt:null==t?void 0:t.updatedAt}),o},t.setState=function(e,t){this.dispatch({type:"setState",state:e,setStateOptions:t})},t.cancel=function(e){var t,n=this.promise;return null==(t=this.retryer)||t.cancel(e),n?n.then(r.lQ).catch(r.lQ):Promise.resolve()},t.destroy=function(){this.clearGcTimeout(),this.cancel({silent:!0})},t.reset=function(){this.destroy(),this.setState(this.initialState)},t.isActive=function(){return this.observers.some(function(e){return!1!==e.options.enabled})},t.isFetching=function(){return this.state.isFetching},t.isStale=function(){return this.state.isInvalidated||!this.state.dataUpdatedAt||this.observers.some(function(e){return e.getCurrentResult().isStale})},t.isStaleByTime=function(e){return void 0===e&&(e=0),this.state.isInvalidated||!this.state.dataUpdatedAt||!(0,r.j3)(this.state.dataUpdatedAt,e)},t.onFocus=function(){var e,t=this.observers.find(function(e){return e.shouldFetchOnWindowFocus()});t&&t.refetch(),null==(e=this.retryer)||e.continue()},t.onOnline=function(){var e,t=this.observers.find(function(e){return e.shouldFetchOnReconnect()});t&&t.refetch(),null==(e=this.retryer)||e.continue()},t.addObserver=function(e){-1===this.observers.indexOf(e)&&(this.observers.push(e),this.hadObservers=!0,this.clearGcTimeout(),this.cache.notify({type:"observerAdded",query:this,observer:e}))},t.removeObserver=function(e){-1!==this.observers.indexOf(e)&&(this.observers=this.observers.filter(function(t){return t!==e}),this.observers.length||(this.retryer&&(this.retryer.isTransportCancelable||this.abortSignalConsumed?this.retryer.cancel({revert:!0}):this.retryer.cancelRetry()),this.cacheTime?this.scheduleGc():this.cache.remove(this)),this.cache.notify({type:"observerRemoved",query:this,observer:e}))},t.getObserversCount=function(){return this.observers.length},t.invalidate=function(){this.state.isInvalidated||this.dispatch({type:"invalidate"})},t.fetch=function(e,t){var n,i,s,o=this;if(this.state.isFetching)if(this.state.dataUpdatedAt&&(null==t?void 0:t.cancelRefetch))this.cancel({silent:!0});else if(this.promise){var a;return null==(a=this.retryer)||a.continueRetry(),this.promise}if(e&&this.setOptions(e),!this.options.queryFn){var l=this.observers.find(function(e){return e.options.queryFn});l&&this.setOptions(l.options)}var u=(0,r.HN)(this.queryKey),d=(0,r.jY)(),h={queryKey:u,pageParam:void 0,meta:this.meta};Object.defineProperty(h,"signal",{enumerable:!0,get:function(){if(d)return o.abortSignalConsumed=!0,d.signal}});var p,f,v={fetchOptions:t,options:this.options,queryKey:u,state:this.state,fetchFn:function(){return o.options.queryFn?(o.abortSignalConsumed=!1,o.options.queryFn(h)):Promise.reject("Missing queryFn")},meta:this.meta};(null==(n=this.options.behavior)?void 0:n.onFetch)&&(null==(p=this.options.behavior)||p.onFetch(v));(this.revertState=this.state,this.state.isFetching&&this.state.fetchMeta===(null==(i=v.fetchOptions)?void 0:i.meta))||this.dispatch({type:"fetch",meta:null==(f=v.fetchOptions)?void 0:f.meta});return this.retryer=new g({fn:v.fetchFn,abort:null==d||null==(s=d.abort)?void 0:s.bind(d),onSuccess:function(e){o.setData(e),null==o.cache.config.onSuccess||o.cache.config.onSuccess(e,o),0===o.cacheTime&&o.optionalRemove()},onError:function(e){m(e)&&e.silent||o.dispatch({type:"error",error:e}),m(e)||(null==o.cache.config.onError||o.cache.config.onError(e,o),(0,c.t)().error(e)),0===o.cacheTime&&o.optionalRemove()},onFail:function(){o.dispatch({type:"failed"})},onPause:function(){o.dispatch({type:"pause"})},onContinue:function(){o.dispatch({type:"continue"})},retry:v.options.retry,retryDelay:v.options.retryDelay}),this.promise=this.retryer.promise,this.promise},t.dispatch=function(e){var t=this;this.state=this.reducer(this.state,e),a.j.batch(function(){t.observers.forEach(function(t){t.onQueryUpdate(e)}),t.cache.notify({query:t,type:"queryUpdated",action:e})})},t.getDefaultState=function(e){var t="function"===typeof e.initialData?e.initialData():e.initialData,n="undefined"!==typeof e.initialData?"function"===typeof e.initialDataUpdatedAt?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0,i="undefined"!==typeof t;return{data:t,dataUpdateCount:0,dataUpdatedAt:i?null!=n?n:Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchMeta:null,isFetching:!1,isInvalidated:!1,isPaused:!1,status:i?"success":"idle"}},t.reducer=function(e,t){var n,r;switch(t.type){case"failed":return(0,i.A)({},e,{fetchFailureCount:e.fetchFailureCount+1});case"pause":return(0,i.A)({},e,{isPaused:!0});case"continue":return(0,i.A)({},e,{isPaused:!1});case"fetch":return(0,i.A)({},e,{fetchFailureCount:0,fetchMeta:null!=(n=t.meta)?n:null,isFetching:!0,isPaused:!1},!e.dataUpdatedAt&&{error:null,status:"loading"});case"success":return(0,i.A)({},e,{data:t.data,dataUpdateCount:e.dataUpdateCount+1,dataUpdatedAt:null!=(r=t.dataUpdatedAt)?r:Date.now(),error:null,fetchFailureCount:0,isFetching:!1,isInvalidated:!1,isPaused:!1,status:"success"});case"error":var s=t.error;return m(s)&&s.revert&&this.revertState?(0,i.A)({},this.revertState):(0,i.A)({},e,{error:s,errorUpdateCount:e.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:e.fetchFailureCount+1,isFetching:!1,isPaused:!1,status:"error"});case"invalidate":return(0,i.A)({},e,{isInvalidated:!0});case"setState":return(0,i.A)({},e,t.state);default:return e}},e}(),y=function(e){function t(t){var n;return(n=e.call(this)||this).config=t||{},n.queries=[],n.queriesMap={},n}o(t,e);var n=t.prototype;return n.build=function(e,t,n){var i,s=t.queryKey,o=null!=(i=t.queryHash)?i:(0,r.F$)(s,t),a=this.get(o);return a||(a=new v({cache:this,queryKey:s,queryHash:o,options:e.defaultQueryOptions(t),state:n,defaultOptions:e.getQueryDefaults(s),meta:t.meta}),this.add(a)),a},n.add=function(e){this.queriesMap[e.queryHash]||(this.queriesMap[e.queryHash]=e,this.queries.push(e),this.notify({type:"queryAdded",query:e}))},n.remove=function(e){var t=this.queriesMap[e.queryHash];t&&(e.destroy(),this.queries=this.queries.filter(function(t){return t!==e}),t===e&&delete this.queriesMap[e.queryHash],this.notify({type:"queryRemoved",query:e}))},n.clear=function(){var e=this;a.j.batch(function(){e.queries.forEach(function(t){e.remove(t)})})},n.get=function(e){return this.queriesMap[e]},n.getAll=function(){return this.queries},n.find=function(e,t){var n=(0,r.b_)(e,t)[0];return"undefined"===typeof n.exact&&(n.exact=!0),this.queries.find(function(e){return(0,r.MK)(n,e)})},n.findAll=function(e,t){var n=(0,r.b_)(e,t)[0];return Object.keys(n).length>0?this.queries.filter(function(e){return(0,r.MK)(n,e)}):this.queries},n.notify=function(e){var t=this;a.j.batch(function(){t.listeners.forEach(function(t){t(e)})})},n.onFocus=function(){var e=this;a.j.batch(function(){e.queries.forEach(function(e){e.onFocus()})})},n.onOnline=function(){var e=this;a.j.batch(function(){e.queries.forEach(function(e){e.onOnline()})})},t}(l),b=function(){function e(e){this.options=(0,i.A)({},e.defaultOptions,e.options),this.mutationId=e.mutationId,this.mutationCache=e.mutationCache,this.observers=[],this.state=e.state||{context:void 0,data:void 0,error:null,failureCount:0,isPaused:!1,status:"idle",variables:void 0},this.meta=e.meta}var t=e.prototype;return t.setState=function(e){this.dispatch({type:"setState",state:e})},t.addObserver=function(e){-1===this.observers.indexOf(e)&&this.observers.push(e)},t.removeObserver=function(e){this.observers=this.observers.filter(function(t){return t!==e})},t.cancel=function(){return this.retryer?(this.retryer.cancel(),this.retryer.promise.then(r.lQ).catch(r.lQ)):Promise.resolve()},t.continue=function(){return this.retryer?(this.retryer.continue(),this.retryer.promise):this.execute()},t.execute=function(){var e,t=this,n="loading"===this.state.status,i=Promise.resolve();return n||(this.dispatch({type:"loading",variables:this.options.variables}),i=i.then(function(){null==t.mutationCache.config.onMutate||t.mutationCache.config.onMutate(t.state.variables,t)}).then(function(){return null==t.options.onMutate?void 0:t.options.onMutate(t.state.variables)}).then(function(e){e!==t.state.context&&t.dispatch({type:"loading",context:e,variables:t.state.variables})})),i.then(function(){return t.executeMutation()}).then(function(n){e=n,null==t.mutationCache.config.onSuccess||t.mutationCache.config.onSuccess(e,t.state.variables,t.state.context,t)}).then(function(){return null==t.options.onSuccess?void 0:t.options.onSuccess(e,t.state.variables,t.state.context)}).then(function(){return null==t.options.onSettled?void 0:t.options.onSettled(e,null,t.state.variables,t.state.context)}).then(function(){return t.dispatch({type:"success",data:e}),e}).catch(function(e){return null==t.mutationCache.config.onError||t.mutationCache.config.onError(e,t.state.variables,t.state.context,t),(0,c.t)().error(e),Promise.resolve().then(function(){return null==t.options.onError?void 0:t.options.onError(e,t.state.variables,t.state.context)}).then(function(){return null==t.options.onSettled?void 0:t.options.onSettled(void 0,e,t.state.variables,t.state.context)}).then(function(){throw t.dispatch({type:"error",error:e}),e})})},t.executeMutation=function(){var e,t=this;return this.retryer=new g({fn:function(){return t.options.mutationFn?t.options.mutationFn(t.state.variables):Promise.reject("No mutationFn found")},onFail:function(){t.dispatch({type:"failed"})},onPause:function(){t.dispatch({type:"pause"})},onContinue:function(){t.dispatch({type:"continue"})},retry:null!=(e=this.options.retry)?e:0,retryDelay:this.options.retryDelay}),this.retryer.promise},t.dispatch=function(e){var t=this;this.state=function(e,t){switch(t.type){case"failed":return(0,i.A)({},e,{failureCount:e.failureCount+1});case"pause":return(0,i.A)({},e,{isPaused:!0});case"continue":return(0,i.A)({},e,{isPaused:!1});case"loading":return(0,i.A)({},e,{context:t.context,data:void 0,error:null,isPaused:!1,status:"loading",variables:t.variables});case"success":return(0,i.A)({},e,{data:t.data,error:null,status:"success",isPaused:!1});case"error":return(0,i.A)({},e,{data:void 0,error:t.error,failureCount:e.failureCount+1,isPaused:!1,status:"error"});case"setState":return(0,i.A)({},e,t.state);default:return e}}(this.state,e),a.j.batch(function(){t.observers.forEach(function(t){t.onMutationUpdate(e)}),t.mutationCache.notify(t)})},e}();var k=function(e){function t(t){var n;return(n=e.call(this)||this).config=t||{},n.mutations=[],n.mutationId=0,n}o(t,e);var n=t.prototype;return n.build=function(e,t,n){var i=new b({mutationCache:this,mutationId:++this.mutationId,options:e.defaultMutationOptions(t),state:n,defaultOptions:t.mutationKey?e.getMutationDefaults(t.mutationKey):void 0,meta:t.meta});return this.add(i),i},n.add=function(e){this.mutations.push(e),this.notify(e)},n.remove=function(e){this.mutations=this.mutations.filter(function(t){return t!==e}),e.cancel(),this.notify(e)},n.clear=function(){var e=this;a.j.batch(function(){e.mutations.forEach(function(t){e.remove(t)})})},n.getAll=function(){return this.mutations},n.find=function(e){return"undefined"===typeof e.exact&&(e.exact=!0),this.mutations.find(function(t){return(0,r.nJ)(e,t)})},n.findAll=function(e){return this.mutations.filter(function(t){return(0,r.nJ)(e,t)})},n.notify=function(e){var t=this;a.j.batch(function(){t.listeners.forEach(function(t){t(e)})})},n.onFocus=function(){this.resumePausedMutations()},n.onOnline=function(){this.resumePausedMutations()},n.resumePausedMutations=function(){var e=this.mutations.filter(function(e){return e.state.isPaused});return a.j.batch(function(){return e.reduce(function(e,t){return e.then(function(){return t.continue().catch(r.lQ)})},Promise.resolve())})},t}(l);function w(e,t){return null==e.getNextPageParam?void 0:e.getNextPageParam(t[t.length-1],t)}function S(e,t){return null==e.getPreviousPageParam?void 0:e.getPreviousPageParam(t[0],t)}var T=function(){function e(e){void 0===e&&(e={}),this.queryCache=e.queryCache||new y,this.mutationCache=e.mutationCache||new k,this.defaultOptions=e.defaultOptions||{},this.queryDefaults=[],this.mutationDefaults=[]}var t=e.prototype;return t.mount=function(){var e=this;this.unsubscribeFocus=u.subscribe(function(){u.isFocused()&&d.isOnline()&&(e.mutationCache.onFocus(),e.queryCache.onFocus())}),this.unsubscribeOnline=d.subscribe(function(){u.isFocused()&&d.isOnline()&&(e.mutationCache.onOnline(),e.queryCache.onOnline())})},t.unmount=function(){var e,t;null==(e=this.unsubscribeFocus)||e.call(this),null==(t=this.unsubscribeOnline)||t.call(this)},t.isFetching=function(e,t){var n=(0,r.b_)(e,t)[0];return n.fetching=!0,this.queryCache.findAll(n).length},t.isMutating=function(e){return this.mutationCache.findAll((0,i.A)({},e,{fetching:!0})).length},t.getQueryData=function(e,t){var n;return null==(n=this.queryCache.find(e,t))?void 0:n.state.data},t.getQueriesData=function(e){return this.getQueryCache().findAll(e).map(function(e){return[e.queryKey,e.state.data]})},t.setQueryData=function(e,t,n){var i=(0,r.vh)(e),s=this.defaultQueryOptions(i);return this.queryCache.build(this,s).setData(t,n)},t.setQueriesData=function(e,t,n){var i=this;return a.j.batch(function(){return i.getQueryCache().findAll(e).map(function(e){var r=e.queryKey;return[r,i.setQueryData(r,t,n)]})})},t.getQueryState=function(e,t){var n;return null==(n=this.queryCache.find(e,t))?void 0:n.state},t.removeQueries=function(e,t){var n=(0,r.b_)(e,t)[0],i=this.queryCache;a.j.batch(function(){i.findAll(n).forEach(function(e){i.remove(e)})})},t.resetQueries=function(e,t,n){var s=this,o=(0,r.b_)(e,t,n),c=o[0],l=o[1],u=this.queryCache,d=(0,i.A)({},c,{active:!0});return a.j.batch(function(){return u.findAll(c).forEach(function(e){e.reset()}),s.refetchQueries(d,l)})},t.cancelQueries=function(e,t,n){var i=this,s=(0,r.b_)(e,t,n),o=s[0],c=s[1],l=void 0===c?{}:c;"undefined"===typeof l.revert&&(l.revert=!0);var u=a.j.batch(function(){return i.queryCache.findAll(o).map(function(e){return e.cancel(l)})});return Promise.all(u).then(r.lQ).catch(r.lQ)},t.invalidateQueries=function(e,t,n){var s,o,c,l=this,u=(0,r.b_)(e,t,n),d=u[0],h=u[1],p=(0,i.A)({},d,{active:null==(s=null!=(o=d.refetchActive)?o:d.active)||s,inactive:null!=(c=d.refetchInactive)&&c});return a.j.batch(function(){return l.queryCache.findAll(d).forEach(function(e){e.invalidate()}),l.refetchQueries(p,h)})},t.refetchQueries=function(e,t,n){var s=this,o=(0,r.b_)(e,t,n),c=o[0],l=o[1],u=a.j.batch(function(){return s.queryCache.findAll(c).map(function(e){return e.fetch(void 0,(0,i.A)({},l,{meta:{refetchPage:null==c?void 0:c.refetchPage}}))})}),d=Promise.all(u).then(r.lQ);return(null==l?void 0:l.throwOnError)||(d=d.catch(r.lQ)),d},t.fetchQuery=function(e,t,n){var i=(0,r.vh)(e,t,n),s=this.defaultQueryOptions(i);"undefined"===typeof s.retry&&(s.retry=!1);var o=this.queryCache.build(this,s);return o.isStaleByTime(s.staleTime)?o.fetch(s):Promise.resolve(o.state.data)},t.prefetchQuery=function(e,t,n){return this.fetchQuery(e,t,n).then(r.lQ).catch(r.lQ)},t.fetchInfiniteQuery=function(e,t,n){var i=(0,r.vh)(e,t,n);return i.behavior={onFetch:function(e){e.fetchFn=function(){var t,n,i,s,o,a,c,l=null==(t=e.fetchOptions)||null==(n=t.meta)?void 0:n.refetchPage,u=null==(i=e.fetchOptions)||null==(s=i.meta)?void 0:s.fetchMore,d=null==u?void 0:u.pageParam,h="forward"===(null==u?void 0:u.direction),f="backward"===(null==u?void 0:u.direction),m=(null==(o=e.state.data)?void 0:o.pages)||[],g=(null==(a=e.state.data)?void 0:a.pageParams)||[],v=(0,r.jY)(),y=null==v?void 0:v.signal,b=g,k=!1,T=e.options.queryFn||function(){return Promise.reject("Missing queryFn")},C=function(e,t,n,i){return b=i?[t].concat(b):[].concat(b,[t]),i?[n].concat(e):[].concat(e,[n])},x=function(t,n,i,r){if(k)return Promise.reject("Cancelled");if("undefined"===typeof i&&!n&&t.length)return Promise.resolve(t);var s={queryKey:e.queryKey,signal:y,pageParam:i,meta:e.meta},o=T(s),a=Promise.resolve(o).then(function(e){return C(t,i,e,r)});return p(o)&&(a.cancel=o.cancel),a};if(m.length)if(h){var E="undefined"!==typeof d,P=E?d:w(e.options,m);c=x(m,E,P)}else if(f){var R="undefined"!==typeof d,O=R?d:S(e.options,m);c=x(m,R,O,!0)}else!function(){b=[];var t="undefined"===typeof e.options.getNextPageParam,n=!l||!m[0]||l(m[0],0,m);c=n?x([],t,g[0]):Promise.resolve(C([],g[0],m[0]));for(var i=function(n){c=c.then(function(i){if(!l||!m[n]||l(m[n],n,m)){var r=t?g[n]:w(e.options,i);return x(i,t,r)}return Promise.resolve(C(i,g[n],m[n]))})},r=1;r<m.length;r++)i(r)}();else c=x([]);var _=c.then(function(e){return{pages:e,pageParams:b}});return _.cancel=function(){k=!0,null==v||v.abort(),p(c)&&c.cancel()},_}}},this.fetchQuery(i)},t.prefetchInfiniteQuery=function(e,t,n){return this.fetchInfiniteQuery(e,t,n).then(r.lQ).catch(r.lQ)},t.cancelMutations=function(){var e=this,t=a.j.batch(function(){return e.mutationCache.getAll().map(function(e){return e.cancel()})});return Promise.all(t).then(r.lQ).catch(r.lQ)},t.resumePausedMutations=function(){return this.getMutationCache().resumePausedMutations()},t.executeMutation=function(e){return this.mutationCache.build(this,e).execute()},t.getQueryCache=function(){return this.queryCache},t.getMutationCache=function(){return this.mutationCache},t.getDefaultOptions=function(){return this.defaultOptions},t.setDefaultOptions=function(e){this.defaultOptions=e},t.setQueryDefaults=function(e,t){var n=this.queryDefaults.find(function(t){return(0,r.Od)(e)===(0,r.Od)(t.queryKey)});n?n.defaultOptions=t:this.queryDefaults.push({queryKey:e,defaultOptions:t})},t.getQueryDefaults=function(e){var t;return e?null==(t=this.queryDefaults.find(function(t){return(0,r.Cp)(e,t.queryKey)}))?void 0:t.defaultOptions:void 0},t.setMutationDefaults=function(e,t){var n=this.mutationDefaults.find(function(t){return(0,r.Od)(e)===(0,r.Od)(t.mutationKey)});n?n.defaultOptions=t:this.mutationDefaults.push({mutationKey:e,defaultOptions:t})},t.getMutationDefaults=function(e){var t;return e?null==(t=this.mutationDefaults.find(function(t){return(0,r.Cp)(e,t.mutationKey)}))?void 0:t.defaultOptions:void 0},t.defaultQueryOptions=function(e){if(null==e?void 0:e._defaulted)return e;var t=(0,i.A)({},this.defaultOptions.queries,this.getQueryDefaults(null==e?void 0:e.queryKey),e,{_defaulted:!0});return!t.queryHash&&t.queryKey&&(t.queryHash=(0,r.F$)(t.queryKey,t)),t},t.defaultQueryObserverOptions=function(e){return this.defaultQueryOptions(e)},t.defaultMutationOptions=function(e){return(null==e?void 0:e._defaulted)?e:(0,i.A)({},this.defaultOptions.mutations,this.getMutationDefaults(null==e?void 0:e.mutationKey),e,{_defaulted:!0})},t.clear=function(){this.queryCache.clear(),this.mutationCache.clear()},e}()},4202:(e,t)=>{"use strict";var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var k=b.prototype=new y;k.constructor=b,m(k,v.prototype),k.isPureReactComponent=!0;var w=Array.isArray,S=Object.prototype.hasOwnProperty,T={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function x(e,t,i){var r,s={},o=null,a=null;if(null!=t)for(r in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(o=""+t.key),t)S.call(t,r)&&!C.hasOwnProperty(r)&&(s[r]=t[r]);var c=arguments.length-2;if(1===c)s.children=i;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];s.children=l}if(e&&e.defaultProps)for(r in c=e.defaultProps)void 0===s[r]&&(s[r]=c[r]);return{$$typeof:n,type:e,key:o,ref:a,props:s,_owner:T.current}}function E(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var P=/\/+/g;function R(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function O(e,t,r,s,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var c=!1;if(null===e)c=!0;else switch(a){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case n:case i:c=!0}}if(c)return o=o(c=e),e=""===s?"."+R(c,0):s,w(o)?(r="",null!=e&&(r=e.replace(P,"$&/")+"/"),O(o,t,r,"",function(e){return e})):null!=o&&(E(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,r+(!o.key||c&&c.key===o.key?"":(""+o.key).replace(P,"$&/")+"/")+e)),t.push(o)),1;if(c=0,s=""===s?".":s+":",w(e))for(var l=0;l<e.length;l++){var u=s+R(a=e[l],l);c+=O(a,t,r,u,o)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),l=0;!(a=e.next()).done;)c+=O(a=a.value,t,r,u=s+R(a,l++),o);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function _(e,t,n){if(null==e)return e;var i=[],r=0;return O(e,i,"","",function(e){return t.call(n,e,r++)}),i}function N(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var A={current:null},I={transition:null},j={ReactCurrentDispatcher:A,ReactCurrentBatchConfig:I,ReactCurrentOwner:T};function D(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:_,forEach:function(e,t,n){_(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return _(e,function(){t++}),t},toArray:function(e){return _(e,function(e){return e})||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=r,t.Profiler=o,t.PureComponent=b,t.StrictMode=s,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=j,t.act=D,t.cloneElement=function(e,t,i){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=m({},e.props),s=e.key,o=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,a=T.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(l in t)S.call(t,l)&&!C.hasOwnProperty(l)&&(r[l]=void 0===t[l]&&void 0!==c?c[l]:t[l])}var l=arguments.length-2;if(1===l)r.children=i;else if(1<l){c=Array(l);for(var u=0;u<l;u++)c[u]=arguments[u+2];r.children=c}return{$$typeof:n,type:e.type,key:s,ref:o,props:r,_owner:a}},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=x,t.createFactory=function(e){var t=x.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:N}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=I.transition;I.transition={};try{e()}finally{I.transition=t}},t.unstable_act=D,t.useCallback=function(e,t){return A.current.useCallback(e,t)},t.useContext=function(e){return A.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return A.current.useDeferredValue(e)},t.useEffect=function(e,t){return A.current.useEffect(e,t)},t.useId=function(){return A.current.useId()},t.useImperativeHandle=function(e,t,n){return A.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return A.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return A.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return A.current.useMemo(e,t)},t.useReducer=function(e,t,n){return A.current.useReducer(e,t,n)},t.useRef=function(e){return A.current.useRef(e)},t.useState=function(e){return A.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return A.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return A.current.useTransition()},t.version="18.3.1"},4298:()=>{},4391:(e,t,n)=>{"use strict";var i=n(7950);t.createRoot=i.createRoot,t.hydrateRoot=i.hydrateRoot},4412:(e,t,n)=>{"use strict";e.exports=n(4573)},4573:(e,t,n)=>{"use strict";var i=e.exports=n(7916);i.build="full",i.tokenize=n(1752),i.parse=n(2786),i.common=n(908),i.Root._configure(i.Type,i.parse,i.common)},4635:(e,t,n)=>{"use strict";e.exports=o;var i=n(9229);((o.prototype=Object.create(i.prototype)).constructor=o).className="MapField";var r=n(9876),s=n(9469);function o(e,t,n,r,o,a){if(i.call(this,e,t,r,void 0,void 0,o,a),!s.isString(n))throw TypeError("keyType must be a string");this.keyType=n,this.resolvedKeyType=null,this.map=!0}o.fromJSON=function(e,t){return new o(e,t.id,t.keyType,t.type,t.options,t.comment)},o.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return s.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},o.prototype.resolve=function(){if(this.resolved)return this;if(void 0===r.mapKey[this.keyType])throw Error("invalid key type: "+this.keyType);return i.prototype.resolve.call(this)},o.d=function(e,t,n){return"function"===typeof n?n=s.decorateType(n).name:n&&"object"===typeof n&&(n=s.decorateEnum(n).name),function(i,r){s.decorateType(i.constructor).add(new o(r,e,t,n))}}},4762:e=>{"use strict";e.exports=function(e,t){var n=new Array(arguments.length-1),i=0,r=2,s=!0;for(;r<arguments.length;)n[i++]=arguments[r++];return new Promise(function(r,o){n[i]=function(e){if(s)if(s=!1,e)o(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];r.apply(null,t)}};try{e.apply(t||null,n)}catch(a){s&&(s=!1,o(a))}})}},4882:module=>{"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},5043:(e,t,n)=>{"use strict";e.exports=n(4202)},5534:(e,t)=>{"use strict";var n=t,i=n.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},r=n.normalize=function(e){var t=(e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),n=i(e),r="";n&&(r=t.shift()+"/");for(var s=0;s<t.length;)".."===t[s]?s>0&&".."!==t[s-1]?t.splice(--s,2):n?t.splice(s,1):++s:"."===t[s]?t.splice(s,1):++s;return r+t.join("/")};n.resolve=function(e,t,n){return n||(t=r(t)),i(t)?t:(n||(e=r(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?r(e+"/"+t):t)}},5819:(e,t,n)=>{"use strict";n.d(t,{QueryClient:()=>i.E});var i=n(4198),r=n(4298);n.o(r,"QueryClientProvider")&&n.d(t,{QueryClientProvider:function(){return r.QueryClientProvider}})},5850:(e,t,n)=>{"use strict";e.exports=d;var i,r=n(1509),s=r.LongBits,o=r.base64,a=r.utf8;function c(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function l(){}function u(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function d(){this.len=0,this.head=new c(l,0,0),this.tail=this.head,this.states=null}var h=function(){return r.Buffer?function(){return(d.create=function(){return new i})()}:function(){return new d}};function p(e,t,n){t[n]=255&e}function f(e,t){this.len=e,this.next=void 0,this.val=t}function m(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function g(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}d.create=h(),d.alloc=function(e){return new r.Array(e)},r.Array!==Array&&(d.alloc=r.pool(d.alloc,r.Array.prototype.subarray)),d.prototype._push=function(e,t,n){return this.tail=this.tail.next=new c(e,t,n),this.len+=t,this},f.prototype=Object.create(c.prototype),f.prototype.fn=function(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e},d.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new f((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},d.prototype.int32=function(e){return e<0?this._push(m,10,s.fromNumber(e)):this.uint32(e)},d.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},d.prototype.uint64=function(e){var t=s.from(e);return this._push(m,t.length(),t)},d.prototype.int64=d.prototype.uint64,d.prototype.sint64=function(e){var t=s.from(e).zzEncode();return this._push(m,t.length(),t)},d.prototype.bool=function(e){return this._push(p,1,e?1:0)},d.prototype.fixed32=function(e){return this._push(g,4,e>>>0)},d.prototype.sfixed32=d.prototype.fixed32,d.prototype.fixed64=function(e){var t=s.from(e);return this._push(g,4,t.lo)._push(g,4,t.hi)},d.prototype.sfixed64=d.prototype.fixed64,d.prototype.float=function(e){return this._push(r.float.writeFloatLE,4,e)},d.prototype.double=function(e){return this._push(r.float.writeDoubleLE,8,e)};var v=r.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var i=0;i<e.length;++i)t[n+i]=e[i]};d.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(p,1,0);if(r.isString(e)){var n=d.alloc(t=o.length(e));o.decode(e,n,0),e=n}return this.uint32(t)._push(v,t,e)},d.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(p,1,0)},d.prototype.fork=function(){return this.states=new u(this),this.head=this.tail=new c(l,0,0),this.len=0,this},d.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(l,0,0),this.len=0),this},d.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},d.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},d._configure=function(e){i=e,d.create=h(),i._configure()}},6046:(e,t,n)=>{"use strict";e.exports=l,l.className="ReflectionObject";const i=n(2924);var r,s=n(9469),o={enum_type:"OPEN",field_presence:"EXPLICIT",json_format:"ALLOW",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"PACKED",utf8_validation:"VERIFY"},a={enum_type:"CLOSED",field_presence:"EXPLICIT",json_format:"LEGACY_BEST_EFFORT",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"EXPANDED",utf8_validation:"NONE"},c={enum_type:"OPEN",field_presence:"IMPLICIT",json_format:"ALLOW",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"PACKED",utf8_validation:"VERIFY"};function l(e,t){if(!s.isString(e))throw TypeError("name must be a string");if(t&&!s.isObject(t))throw TypeError("options must be an object");this.options=t,this.parsedOptions=null,this.name=e,this._edition=null,this._defaultEdition="proto2",this._features={},this._featuresResolved=!1,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(l.prototype,{root:{get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}},fullName:{get:function(){for(var e=[this.name],t=this.parent;t;)e.unshift(t.name),t=t.parent;return e.join(".")}}}),l.prototype.toJSON=function(){throw Error()},l.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof r&&t._handleAdd(this)},l.prototype.onRemove=function(e){var t=e.root;t instanceof r&&t._handleRemove(this),this.parent=null,this.resolved=!1},l.prototype.resolve=function(){return this.resolved||this.root instanceof r&&(this.resolved=!0),this},l.prototype._resolveFeaturesRecursive=function(e){return this._resolveFeatures(this._edition||e)},l.prototype._resolveFeatures=function(e){if(!this._featuresResolved){var t={};if(!e)throw new Error("Unknown edition for "+this.fullName);var n=Object.assign(this.options?Object.assign({},this.options.features):{},this._inferLegacyProtoFeatures(e));if(this._edition){if("proto2"===e)t=Object.assign({},a);else if("proto3"===e)t=Object.assign({},c);else{if("2023"!==e)throw new Error("Unknown edition: "+e);t=Object.assign({},o)}return this._features=Object.assign(t,n||{}),void(this._featuresResolved=!0)}if(this.partOf instanceof i){var r=Object.assign({},this.partOf._features);this._features=Object.assign(r,n||{})}else if(this.declaringField);else{if(!this.parent)throw new Error("Unable to find a parent for "+this.fullName);var s=Object.assign({},this.parent._features);this._features=Object.assign(s,n||{})}this.extensionField&&(this.extensionField._features=this._features),this._featuresResolved=!0}},l.prototype._inferLegacyProtoFeatures=function(){return{}},l.prototype.getOption=function(e){if(this.options)return this.options[e]},l.prototype.setOption=function(e,t,n){return this.options||(this.options={}),/^features\./.test(e)?s.setProperty(this.options,e,t,n):n&&void 0!==this.options[e]||(this.getOption(e)!==t&&(this.resolved=!1),this.options[e]=t),this},l.prototype.setParsedOption=function(e,t,n){this.parsedOptions||(this.parsedOptions=[]);var i=this.parsedOptions;if(n){var r=i.find(function(t){return Object.prototype.hasOwnProperty.call(t,e)});if(r){var o=r[e];s.setProperty(o,n,t)}else(r={})[e]=s.setProperty({},n,t),i.push(r)}else{var a={};a[e]=t,i.push(a)}return this},l.prototype.setOptions=function(e,t){if(e)for(var n=Object.keys(e),i=0;i<n.length;++i)this.setOption(n[i],e[n[i]],t);return this},l.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e},l.prototype._editionToJSON=function(){if(this._edition&&"proto3"!==this._edition)return this._edition},l._configure=function(e){r=e}},6350:(e,t,n)=>{"use strict";e.exports=r;var i=n(1509);function r(e,t){this.lo=e>>>0,this.hi=t>>>0}var s=r.zero=new r(0,0);s.toNumber=function(){return 0},s.zzEncode=s.zzDecode=function(){return this},s.length=function(){return 1};var o=r.zeroHash="\0\0\0\0\0\0\0\0";r.fromNumber=function(e){if(0===e)return s;var t=e<0;t&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return t&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new r(n,i)},r.from=function(e){if("number"===typeof e)return r.fromNumber(e);if(i.isString(e)){if(!i.Long)return r.fromNumber(parseInt(e,10));e=i.Long.fromString(e)}return e.low||e.high?new r(e.low>>>0,e.high>>>0):s},r.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},r.prototype.toLong=function(e){return i.Long?new i.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;r.fromHash=function(e){return e===o?s:new r((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},r.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},r.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},r.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},r.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}},6366:(e,t,n)=>{"use strict";e.exports=a;var i=n(1374);((a.prototype=Object.create(i.prototype)).constructor=a).className="Service";var r=n(360),s=n(9469),o=n(8094);function a(e,t){i.call(this,e,t),this.methods={},this._methodsArray=null}function c(e){return e._methodsArray=null,e}a.fromJSON=function(e,t){var n=new a(e,t.options);if(t.methods)for(var i=Object.keys(t.methods),s=0;s<i.length;++s)n.add(r.fromJSON(i[s],t.methods[i[s]]));return t.nested&&n.addJSON(t.nested),t.edition&&(n._edition=t.edition),n.comment=t.comment,n._defaultEdition="proto3",n},a.prototype.toJSON=function(e){var t=i.prototype.toJSON.call(this,e),n=!!e&&Boolean(e.keepComments);return s.toObject(["edition",this._editionToJSON(),"options",t&&t.options||void 0,"methods",i.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||void 0,"comment",n?this.comment:void 0])},Object.defineProperty(a.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=s.toArray(this.methods))}}),a.prototype.get=function(e){return this.methods[e]||i.prototype.get.call(this,e)},a.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;i.prototype.resolve.call(this);for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return this},a.prototype._resolveFeaturesRecursive=function(e){return this._needsRecursiveFeatureResolution?(e=this._edition||e,i.prototype._resolveFeaturesRecursive.call(this,e),this.methodsArray.forEach(t=>{t._resolveFeaturesRecursive(e)}),this):this},a.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof r?(this.methods[e.name]=e,e.parent=this,c(this)):i.prototype.add.call(this,e)},a.prototype.remove=function(e){if(e instanceof r){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,c(this)}return i.prototype.remove.call(this,e)},a.prototype.create=function(e,t,n){for(var i,r=new o.Service(e,t,n),a=0;a<this.methodsArray.length;++a){var c=s.lcFirst((i=this._methodsArray[a]).resolve().name).replace(/[^$\w_]/g,"");r[c]=s.codegen(["r","c"],s.isReserved(c)?c+"_":c)("return this.rpcCall(m,q,s,r,c)")({m:i,q:i.resolvedRequestType.ctor,s:i.resolvedResponseType.ctor})}return r}},6524:(e,t,n)=>{"use strict";n.d(t,{QueryClientProvider:()=>d});var i=n(1991),r=n(7950).unstable_batchedUpdates;i.j.setBatchNotifyFunction(r);var s=n(75),o=console;(0,s.B)(o);var a=n(5043),c=a.createContext(void 0),l=a.createContext(!1);function u(e){return e&&"undefined"!==typeof window?(window.ReactQueryClientContext||(window.ReactQueryClientContext=c),window.ReactQueryClientContext):c}var d=function(e){var t=e.client,n=e.contextSharing,i=void 0!==n&&n,r=e.children;a.useEffect(function(){return t.mount(),function(){t.unmount()}},[t]);var s=u(i);return a.createElement(l.Provider,{value:i},a.createElement(s.Provider,{value:t},r))}},6762:(e,t)=>{"use strict";var n=t;n.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var i=new Array(64),r=new Array(123),s=0;s<64;)r[i[s]=s<26?s+65:s<52?s+71:s<62?s-4:s-59|43]=s++;n.encode=function(e,t,n){for(var r,s=null,o=[],a=0,c=0;t<n;){var l=e[t++];switch(c){case 0:o[a++]=i[l>>2],r=(3&l)<<4,c=1;break;case 1:o[a++]=i[r|l>>4],r=(15&l)<<2,c=2;break;case 2:o[a++]=i[r|l>>6],o[a++]=i[63&l],c=0}a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0)}return c&&(o[a++]=i[r],o[a++]=61,1===c&&(o[a++]=61)),s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};var o="invalid encoding";n.decode=function(e,t,n){for(var i,s=n,a=0,c=0;c<e.length;){var l=e.charCodeAt(c++);if(61===l&&a>1)break;if(void 0===(l=r[l]))throw Error(o);switch(a){case 0:i=l,a=1;break;case 1:t[n++]=i<<2|(48&l)>>4,i=l,a=2;break;case 2:t[n++]=(15&i)<<4|(60&l)>>2,i=l,a=3;break;case 3:t[n++]=(3&i)<<6|l,a=0}}if(1===a)throw Error(o);return n-s},n.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},6931:e=>{"use strict";e.exports=function(e,t,n){var i=n||8192,r=i>>>1,s=null,o=i;return function(n){if(n<1||n>r)return e(n);o+n>i&&(s=e(i),o=0);var a=t.call(s,o,o+=n);return 7&o&&(o=1+(7|o)),a}}},7149:(e,t,n)=>{"use strict";e.exports=d;var i=n(1374);((d.prototype=Object.create(i.prototype)).constructor=d).className="Root";var r,s,o,a=n(9229),c=n(1220),l=n(2924),u=n(9469);function d(e){i.call(this,"",e),this.deferred=[],this.files=[],this._edition="proto2",this._fullyQualifiedObjects={}}function h(){}d.fromJSON=function(e,t){return t||(t=new d),e.options&&t.setOptions(e.options),t.addJSON(e.nested).resolveAll()},d.prototype.resolvePath=u.path.resolve,d.prototype.fetch=u.fetch,d.prototype.load=function e(t,n,i){"function"===typeof n&&(i=n,n=void 0);var r=this;if(!i)return u.asPromise(e,r,t,n);var a=i===h;function c(e,t){if(i){if(a)throw e;t&&t.resolveAll();var n=i;i=null,n(e,t)}}function l(e){var t=e.lastIndexOf("google/protobuf/");if(t>-1){var n=e.substring(t);if(n in o)return n}return null}function d(e,t){try{if(u.isString(t)&&"{"===t.charAt(0)&&(t=JSON.parse(t)),u.isString(t)){s.filename=e;var i,o=s(t,r,n),d=0;if(o.imports)for(;d<o.imports.length;++d)(i=l(o.imports[d])||r.resolvePath(e,o.imports[d]))&&p(i);if(o.weakImports)for(d=0;d<o.weakImports.length;++d)(i=l(o.weakImports[d])||r.resolvePath(e,o.weakImports[d]))&&p(i,!0)}else r.setOptions(t.options).addJSON(t.nested)}catch(h){c(h)}a||f||c(null,r)}function p(e,t){if(e=l(e)||e,!(r.files.indexOf(e)>-1))if(r.files.push(e),e in o)a?d(e,o[e]):(++f,setTimeout(function(){--f,d(e,o[e])}));else if(a){var n;try{n=u.fs.readFileSync(e).toString("utf8")}catch(s){return void(t||c(s))}d(e,n)}else++f,r.fetch(e,function(n,s){--f,i&&(n?t?f||c(null,r):c(n):d(e,s))})}var f=0;u.isString(t)&&(t=[t]);for(var m,g=0;g<t.length;++g)(m=r.resolvePath("",t[g]))&&p(m);return a?(r.resolveAll(),r):(f||c(null,r),r)},d.prototype.loadSync=function(e,t){if(!u.isNode)throw Error("not supported");return this.load(e,t,h)},d.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(e){return"'extend "+e.extend+"' in "+e.parent.fullName}).join(", "));return i.prototype.resolveAll.call(this)};var p=/^[A-Z]/;function f(e,t){var n=t.parent.lookup(t.extend);if(n){var i=new a(t.fullName,t.id,t.type,t.rule,void 0,t.options);return n.get(i.name)||(i.declaringField=t,t.extensionField=i,n.add(i)),!0}return!1}d.prototype._handleAdd=function(e){if(e instanceof a)void 0===e.extend||e.extensionField||f(0,e)||this.deferred.push(e);else if(e instanceof c)p.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof l)){if(e instanceof r)for(var t=0;t<this.deferred.length;)f(0,this.deferred[t])?this.deferred.splice(t,1):++t;for(var n=0;n<e.nestedArray.length;++n)this._handleAdd(e._nestedArray[n]);p.test(e.name)&&(e.parent[e.name]=e)}(e instanceof r||e instanceof c||e instanceof a)&&(this._fullyQualifiedObjects[e.fullName]=e)},d.prototype._handleRemove=function(e){if(e instanceof a){if(void 0!==e.extend)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}else if(e instanceof c)p.test(e.name)&&delete e.parent[e.name];else if(e instanceof i){for(var n=0;n<e.nestedArray.length;++n)this._handleRemove(e._nestedArray[n]);p.test(e.name)&&delete e.parent[e.name]}delete this._fullyQualifiedObjects[e.fullName]},d._configure=function(e,t,n){r=e,s=t,o=n}},7234:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,r=e[i];if(!(0<s(r,t)))break e;e[i]=t,e[n]=r,n=i}}function i(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,r=e.length,o=r>>>1;i<o;){var a=2*(i+1)-1,c=e[a],l=a+1,u=e[l];if(0>s(c,n))l<r&&0>s(u,c)?(e[i]=u,e[l]=n,i=l):(e[i]=c,e[a]=n,i=a);else{if(!(l<r&&0>s(u,n)))break e;e[i]=u,e[l]=n,i=l}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,c=a.now();t.unstable_now=function(){return a.now()-c}}var l=[],u=[],d=1,h=null,p=3,f=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function k(e){for(var t=i(u);null!==t;){if(null===t.callback)r(u);else{if(!(t.startTime<=e))break;r(u),t.sortIndex=t.expirationTime,n(l,t)}t=i(u)}}function w(e){if(g=!1,k(e),!m)if(null!==i(l))m=!0,I(S);else{var t=i(u);null!==t&&j(w,t.startTime-e)}}function S(e,n){m=!1,g&&(g=!1,y(E),E=-1),f=!0;var s=p;try{for(k(n),h=i(l);null!==h&&(!(h.expirationTime>n)||e&&!O());){var o=h.callback;if("function"===typeof o){h.callback=null,p=h.priorityLevel;var a=o(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?h.callback=a:h===i(l)&&r(l),k(n)}else r(l);h=i(l)}if(null!==h)var c=!0;else{var d=i(u);null!==d&&j(w,d.startTime-n),c=!1}return c}finally{h=null,p=s,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var T,C=!1,x=null,E=-1,P=5,R=-1;function O(){return!(t.unstable_now()-R<P)}function _(){if(null!==x){var e=t.unstable_now();R=e;var n=!0;try{n=x(!0,e)}finally{n?T():(C=!1,x=null)}}else C=!1}if("function"===typeof b)T=function(){b(_)};else if("undefined"!==typeof MessageChannel){var N=new MessageChannel,A=N.port2;N.port1.onmessage=_,T=function(){A.postMessage(null)}}else T=function(){v(_,0)};function I(e){x=e,C||(C=!0,T())}function j(e,n){E=v(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,I(S))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return i(l)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,r,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:d++,callback:r,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,n(u,e),null===i(l)&&e===i(u)&&(g?(y(E),E=-1):g=!0,j(w,s-o))):(e.sortIndex=a,n(l,e),m||f||(m=!0,I(S))),e},t.unstable_shouldYield=O,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},7351:e=>{"use strict";function t(){this._listeners={}}e.exports=t,t.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},t.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===t?n.splice(i,1):++i;return this},t.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<t.length;)t[i].fn.apply(t[i++].ctx,n)}return this}},7573:(e,t,n)=>{"use strict";e.exports=function(e){for(var t,n=s.codegen(["m","w"],e.name+"$encode")("if(!w)")("w=Writer.create()"),a=e.fieldsArray.slice().sort(s.compareFieldsById),c=0;c<a.length;++c){var l=a[c].resolve(),u=e._fieldsArray.indexOf(l),d=l.resolvedType instanceof i?"int32":l.type,h=r.basic[d];t="m"+s.safeProp(l.name),l.map?(n("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",t,l.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",t)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(l.id<<3|2)>>>0,8|r.mapKey[l.keyType],l.keyType),void 0===h?n("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",u,t):n(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|h,d,t),n("}")("}")):l.repeated?(n("if(%s!=null&&%s.length){",t,t),l.packed&&void 0!==r.packed[d]?n("w.uint32(%i).fork()",(l.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",t)("w.%s(%s[i])",d,t)("w.ldelim()"):(n("for(var i=0;i<%s.length;++i)",t),void 0===h?o(n,l,u,t+"[i]"):n("w.uint32(%i).%s(%s[i])",(l.id<<3|h)>>>0,d,t)),n("}")):(l.optional&&n("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",t,l.name),void 0===h?o(n,l,u,t):n("w.uint32(%i).%s(%s)",(l.id<<3|h)>>>0,d,t))}return n("return w")};var i=n(1220),r=n(9876),s=n(9469);function o(e,t,n,i){return t.delimited?e("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",n,i,(t.id<<3|3)>>>0,(t.id<<3|4)>>>0):e("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",n,i,(t.id<<3|2)>>>0)}},7707:(e,t,n)=>{"use strict";e.exports=s;var i=n(3338);(s.prototype=Object.create(i.prototype)).constructor=s;var r=n(1509);function s(e){i.call(this,e)}s._configure=function(){r.Buffer&&(s.prototype._slice=r.Buffer.prototype.slice)},s.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},s._configure()},7886:(e,t,n)=>{"use strict";e.exports=r;var i=n(1509);function r(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)this[t[n]]=e[t[n]]}r.create=function(e){return this.$type.create(e)},r.encode=function(e,t){return this.$type.encode(e,t)},r.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)},r.decode=function(e){return this.$type.decode(e)},r.decodeDelimited=function(e){return this.$type.decodeDelimited(e)},r.verify=function(e){return this.$type.verify(e)},r.fromObject=function(e){return this.$type.fromObject(e)},r.toObject=function(e,t){return this.$type.toObject(e,t)},r.prototype.toJSON=function(){return this.$type.toObject(this,i.toJSONOptions)}},7916:(e,t,n)=>{"use strict";var i=e.exports=n(9191);i.build="light",i.load=function(e,t,n){return"function"===typeof t?(n=t,t=new i.Root):t||(t=new i.Root),t.load(e,n)},i.loadSync=function(e,t){return t||(t=new i.Root),t.loadSync(e)},i.encoder=n(7573),i.decoder=n(1985),i.verifier=n(9875),i.converter=n(1561),i.ReflectionObject=n(6046),i.Namespace=n(1374),i.Root=n(7149),i.Enum=n(1220),i.Type=n(2225),i.Field=n(9229),i.OneOf=n(2924),i.MapField=n(4635),i.Service=n(6366),i.Method=n(360),i.Message=n(7886),i.wrappers=n(9297),i.types=n(9876),i.util=n(9469),i.ReflectionObject._configure(i.Root),i.Namespace._configure(i.Type,i.Service,i.Enum),i.Root._configure(i.Type),i.Field._configure(i.Type)},7950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(2730)},8094:(e,t,n)=>{"use strict";t.Service=n(3694)},8168:(e,t,n)=>{"use strict";function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},i.apply(null,arguments)}n.d(t,{A:()=>i})},8626:(e,t)=>{"use strict";var n=t;n.length=function(e){for(var t=0,n=0,i=0;i<e.length;++i)(n=e.charCodeAt(i))<128?t+=1:n<2048?t+=2:55296===(64512&n)&&56320===(64512&e.charCodeAt(i+1))?(++i,t+=4):t+=3;return t},n.read=function(e,t,n){if(n-t<1)return"";for(var i,r=null,s=[],o=0;t<n;)(i=e[t++])<128?s[o++]=i:i>191&&i<224?s[o++]=(31&i)<<6|63&e[t++]:i>239&&i<365?(i=((7&i)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,s[o++]=55296+(i>>10),s[o++]=56320+(1023&i)):s[o++]=(15&i)<<12|(63&e[t++])<<6|63&e[t++],o>8191&&((r||(r=[])).push(String.fromCharCode.apply(String,s)),o=0);return r?(o&&r.push(String.fromCharCode.apply(String,s.slice(0,o))),r.join("")):String.fromCharCode.apply(String,s.slice(0,o))},n.write=function(e,t,n){for(var i,r,s=n,o=0;o<e.length;++o)(i=e.charCodeAt(o))<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&56320===(64512&(r=e.charCodeAt(o+1)))?(i=65536+((1023&i)<<10)+(1023&r),++o,t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128);return n-s}},8853:(e,t,n)=>{"use strict";e.exports=n(7234)},8870:(e,t,n)=>{"use strict";n.d(t,{BH:()=>y,Cp:()=>g,F$:()=>f,G6:()=>T,HN:()=>c,MK:()=>h,Od:()=>m,S$:()=>r,Zw:()=>o,b_:()=>d,gn:()=>a,j3:()=>l,jY:()=>C,lQ:()=>s,nJ:()=>p,vh:()=>u,yy:()=>S});var i=n(8168),r="undefined"===typeof window;function s(){}function o(e,t){return"function"===typeof e?e(t):e}function a(e){return"number"===typeof e&&e>=0&&e!==1/0}function c(e){return Array.isArray(e)?e:[e]}function l(e,t){return Math.max(e+(t||0)-Date.now(),0)}function u(e,t,n){return w(e)?"function"===typeof t?(0,i.A)({},n,{queryKey:e,queryFn:t}):(0,i.A)({},t,{queryKey:e}):e}function d(e,t,n){return w(e)?[(0,i.A)({},t,{queryKey:e}),n]:[e||{},t]}function h(e,t){var n=e.active,i=e.exact,r=e.fetching,s=e.inactive,o=e.predicate,a=e.queryKey,c=e.stale;if(w(a))if(i){if(t.queryHash!==f(a,t.options))return!1}else if(!g(t.queryKey,a))return!1;var l=function(e,t){return!0===e&&!0===t||null==e&&null==t?"all":!1===e&&!1===t?"none":(null!=e?e:!t)?"active":"inactive"}(n,s);if("none"===l)return!1;if("all"!==l){var u=t.isActive();if("active"===l&&!u)return!1;if("inactive"===l&&u)return!1}return("boolean"!==typeof c||t.isStale()===c)&&(("boolean"!==typeof r||t.isFetching()===r)&&!(o&&!o(t)))}function p(e,t){var n=e.exact,i=e.fetching,r=e.predicate,s=e.mutationKey;if(w(s)){if(!t.options.mutationKey)return!1;if(n){if(m(t.options.mutationKey)!==m(s))return!1}else if(!g(t.options.mutationKey,s))return!1}return("boolean"!==typeof i||"loading"===t.state.status===i)&&!(r&&!r(t))}function f(e,t){return((null==t?void 0:t.queryKeyHashFn)||m)(e)}function m(e){var t,n=c(e);return t=n,JSON.stringify(t,function(e,t){return b(t)?Object.keys(t).sort().reduce(function(e,n){return e[n]=t[n],e},{}):t})}function g(e,t){return v(c(e),c(t))}function v(e,t){return e===t||typeof e===typeof t&&(!(!e||!t||"object"!==typeof e||"object"!==typeof t)&&!Object.keys(t).some(function(n){return!v(e[n],t[n])}))}function y(e,t){if(e===t)return e;var n=Array.isArray(e)&&Array.isArray(t);if(n||b(e)&&b(t)){for(var i=n?e.length:Object.keys(e).length,r=n?t:Object.keys(t),s=r.length,o=n?[]:{},a=0,c=0;c<s;c++){var l=n?c:r[c];o[l]=y(e[l],t[l]),o[l]===e[l]&&a++}return i===s&&a===i?e:o}return t}function b(e){if(!k(e))return!1;var t=e.constructor;if("undefined"===typeof t)return!0;var n=t.prototype;return!!k(n)&&!!n.hasOwnProperty("isPrototypeOf")}function k(e){return"[object Object]"===Object.prototype.toString.call(e)}function w(e){return"string"===typeof e||Array.isArray(e)}function S(e){return new Promise(function(t){setTimeout(t,e)})}function T(e){Promise.resolve().then(e).catch(function(e){return setTimeout(function(){throw e})})}function C(){if("function"===typeof AbortController)return new AbortController}},9191:(e,t,n)=>{"use strict";var i=t;function r(){i.util._configure(),i.Writer._configure(i.BufferWriter),i.Reader._configure(i.BufferReader)}i.build="minimal",i.Writer=n(5850),i.BufferWriter=n(3931),i.Reader=n(3338),i.BufferReader=n(7707),i.util=n(1509),i.rpc=n(8094),i.roots=n(1368),i.configure=r,r()},9229:(e,t,n)=>{"use strict";e.exports=l;var i=n(6046);((l.prototype=Object.create(i.prototype)).constructor=l).className="Field";var r,s=n(1220),o=n(9876),a=n(9469),c=/^required|optional|repeated$/;function l(e,t,n,r,s,l,u){if(a.isObject(r)?(u=s,l=r,r=s=void 0):a.isObject(s)&&(u=l,l=s,s=void 0),i.call(this,e,l),!a.isInteger(t)||t<0)throw TypeError("id must be a non-negative integer");if(!a.isString(n))throw TypeError("type must be a string");if(void 0!==r&&!c.test(r=r.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(void 0!==s&&!a.isString(s))throw TypeError("extend must be a string");"proto3_optional"===r&&(r="optional"),this.rule=r&&"optional"!==r?r:void 0,this.type=n,this.id=t,this.extend=s||void 0,this.repeated="repeated"===r,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!a.Long&&void 0!==o.long[n],this.bytes="bytes"===n,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this.comment=u}l.fromJSON=function(e,t){var n=new l(e,t.id,t.type,t.rule,t.extend,t.options,t.comment);return t.edition&&(n._edition=t.edition),n._defaultEdition="proto3",n},Object.defineProperty(l.prototype,"required",{get:function(){return"LEGACY_REQUIRED"===this._features.field_presence}}),Object.defineProperty(l.prototype,"optional",{get:function(){return!this.required}}),Object.defineProperty(l.prototype,"delimited",{get:function(){return this.resolvedType instanceof r&&"DELIMITED"===this._features.message_encoding}}),Object.defineProperty(l.prototype,"packed",{get:function(){return"PACKED"===this._features.repeated_field_encoding}}),Object.defineProperty(l.prototype,"hasPresence",{get:function(){return!this.repeated&&!this.map&&(this.partOf||this.declaringField||this.extensionField||"IMPLICIT"!==this._features.field_presence)}}),l.prototype.setOption=function(e,t,n){return i.prototype.setOption.call(this,e,t,n)},l.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return a.toObject(["edition",this._editionToJSON(),"rule","optional"!==this.rule&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},l.prototype.resolve=function(){if(this.resolved)return this;if(void 0===(this.typeDefault=o.defaults[this.type])?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof r?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof s&&"string"===typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(void 0===this.options.packed||!this.resolvedType||this.resolvedType instanceof s||delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=a.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&"string"===typeof this.typeDefault){var e;a.base64.test(this.typeDefault)?a.base64.decode(this.typeDefault,e=a.newBuffer(a.base64.length(this.typeDefault)),0):a.utf8.write(this.typeDefault,e=a.newBuffer(a.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=a.emptyObject:this.repeated?this.defaultValue=a.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof r&&(this.parent.ctor.prototype[this.name]=this.defaultValue),i.prototype.resolve.call(this)},l.prototype._inferLegacyProtoFeatures=function(e){if("proto2"!==e&&"proto3"!==e)return{};var t={};if("required"===this.rule&&(t.field_presence="LEGACY_REQUIRED"),this.parent&&void 0===o.defaults[this.type]){var n=this.parent.get(this.type.split(".").pop());n&&n instanceof r&&n.group&&(t.message_encoding="DELIMITED")}return!0===this.getOption("packed")?t.repeated_field_encoding="PACKED":!1===this.getOption("packed")&&(t.repeated_field_encoding="EXPANDED"),t},l.prototype._resolveFeatures=function(e){return i.prototype._resolveFeatures.call(this,this._edition||e)},l.d=function(e,t,n,i){return"function"===typeof t?t=a.decorateType(t).name:t&&"object"===typeof t&&(t=a.decorateEnum(t).name),function(r,s){a.decorateType(r.constructor).add(new l(s,e,t,n,{default:i}))}},l._configure=function(e){r=e}},9297:(e,t,n)=>{"use strict";var i=t,r=n(7886);i[".google.protobuf.Any"]={fromObject:function(e){if(e&&e["@type"]){var t=e["@type"].substring(e["@type"].lastIndexOf("/")+1),n=this.lookup(t);if(n){var i="."===e["@type"].charAt(0)?e["@type"].slice(1):e["@type"];return-1===i.indexOf("/")&&(i="/"+i),this.create({type_url:i,value:n.encode(n.fromObject(e)).finish()})}}return this.fromObject(e)},toObject:function(e,t){var n="",i="";if(t&&t.json&&e.type_url&&e.value){i=e.type_url.substring(e.type_url.lastIndexOf("/")+1),n=e.type_url.substring(0,e.type_url.lastIndexOf("/")+1);var s=this.lookup(i);s&&(e=s.decode(e.value))}if(!(e instanceof this.ctor)&&e instanceof r){var o=e.$type.toObject(e,t);return""===n&&(n="type.googleapis.com/"),i=n+("."===e.$type.fullName[0]?e.$type.fullName.slice(1):e.$type.fullName),o["@type"]=i,o}return this.toObject(e,t)}}},9469:(e,t,n)=>{"use strict";var i,r,s=e.exports=n(1509),o=n(1368);s.codegen=n(1318),s.fetch=n(643),s.path=n(5534),s.fs=s.inquire("fs"),s.toArray=function(e){if(e){for(var t=Object.keys(e),n=new Array(t.length),i=0;i<t.length;)n[i]=e[t[i++]];return n}return[]},s.toObject=function(e){for(var t={},n=0;n<e.length;){var i=e[n++],r=e[n++];void 0!==r&&(t[i]=r)}return t};var a=/\\/g,c=/"/g;s.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)},s.safeProp=function(e){return!/^[$\w_]+$/.test(e)||s.isReserved(e)?'["'+e.replace(a,"\\\\").replace(c,'\\"')+'"]':"."+e},s.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var l=/_([a-z])/g;s.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(l,function(e,t){return t.toUpperCase()})},s.compareFieldsById=function(e,t){return e.id-t.id},s.decorateType=function(e,t){if(e.$type)return t&&e.$type.name!==t&&(s.decorateRoot.remove(e.$type),e.$type.name=t,s.decorateRoot.add(e.$type)),e.$type;i||(i=n(2225));var r=new i(t||e.name);return s.decorateRoot.add(r),r.ctor=e,Object.defineProperty(e,"$type",{value:r,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:r,enumerable:!1}),r};var u=0;s.decorateEnum=function(e){if(e.$type)return e.$type;r||(r=n(1220));var t=new r("Enum"+u++,e);return s.decorateRoot.add(t),Object.defineProperty(e,"$type",{value:t,enumerable:!1}),t},s.setProperty=function(e,t,n,i){if("object"!==typeof e)throw TypeError("dst must be an object");if(!t)throw TypeError("path must be specified");return function e(t,n,r){var s=n.shift();if("__proto__"===s||"prototype"===s)return t;if(n.length>0)t[s]=e(t[s]||{},n,r);else{var o=t[s];if(o&&i)return t;o&&(r=[].concat(o).concat(r)),t[s]=r}return t}(e,t=t.split("."),n)},Object.defineProperty(s,"decorateRoot",{get:function(){return o.decorated||(o.decorated=new(n(7149)))}})},9875:(e,t,n)=>{"use strict";e.exports=function(e){var t=r.codegen(["m"],e.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),n=e.oneofsArray,i={};n.length&&t("var p={}");for(var c=0;c<e.fieldsArray.length;++c){var l=e._fieldsArray[c].resolve(),u="m"+r.safeProp(l.name);if(l.optional&&t("if(%s!=null&&m.hasOwnProperty(%j)){",u,l.name),l.map)t("if(!util.isObject(%s))",u)("return%j",s(l,"object"))("var k=Object.keys(%s)",u)("for(var i=0;i<k.length;++i){"),a(t,l,"k[i]"),o(t,l,c,u+"[k[i]]")("}");else if(l.repeated)t("if(!Array.isArray(%s))",u)("return%j",s(l,"array"))("for(var i=0;i<%s.length;++i){",u),o(t,l,c,u+"[i]")("}");else{if(l.partOf){var d=r.safeProp(l.partOf.name);1===i[l.partOf.name]&&t("if(p%s===1)",d)("return%j",l.partOf.name+": multiple values"),i[l.partOf.name]=1,t("p%s=1",d)}o(t,l,c,u)}l.optional&&t("}")}return t("return null")};var i=n(1220),r=n(9469);function s(e,t){return e.name+": "+t+(e.repeated&&"array"!==t?"[]":e.map&&"object"!==t?"{k:"+e.keyType+"}":"")+" expected"}function o(e,t,n,r){if(t.resolvedType)if(t.resolvedType instanceof i){e("switch(%s){",r)("default:")("return%j",s(t,"enum value"));for(var o=Object.keys(t.resolvedType.values),a=0;a<o.length;++a)e("case %i:",t.resolvedType.values[o[a]]);e("break")("}")}else e("{")("var e=types[%i].verify(%s);",n,r)("if(e)")("return%j+e",t.name+".")("}");else switch(t.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.isInteger(%s))",r)("return%j",s(t,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",r,r,r,r)("return%j",s(t,"integer|Long"));break;case"float":case"double":e('if(typeof %s!=="number")',r)("return%j",s(t,"number"));break;case"bool":e('if(typeof %s!=="boolean")',r)("return%j",s(t,"boolean"));break;case"string":e("if(!util.isString(%s))",r)("return%j",s(t,"string"));break;case"bytes":e('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',r,r,r)("return%j",s(t,"buffer"))}return e}function a(e,t,n){switch(t.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.key32Re.test(%s))",n)("return%j",s(t,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.key64Re.test(%s))",n)("return%j",s(t,"integer|Long key"));break;case"bool":e("if(!util.key2Re.test(%s))",n)("return%j",s(t,"boolean key"))}return e}},9876:(e,t,n)=>{"use strict";var i=t,r=n(9469),s=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function o(e,t){var n=0,i={};for(t|=0;n<e.length;)i[s[n+t]]=e[n++];return i}i.basic=o([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),i.defaults=o([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",r.emptyArray,null]),i.long=o([0,0,0,1,1],7),i.mapKey=o([0,0,0,5,5,0,0,0,1,1,0,2],2),i.packed=o([1,5,0,0,0,5,5,0,0,0,1,1,0])}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;__webpack_require__.t=function(n,i){if(1&i&&(n=this(n)),8&i)return n;if("object"===typeof n&&n){if(4&i&&n.__esModule)return n;if(16&i&&"function"===typeof n.then)return n}var r=Object.create(null);__webpack_require__.r(r);var s={};e=e||[null,t({}),t([]),t(t)];for(var o=2&i&&n;("object"==typeof o||"function"==typeof o)&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach(e=>s[e]=()=>n[e]);return s.default=()=>n,__webpack_require__.d(r,s),r}})(),__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};(()=>{"use strict";var e={};__webpack_require__.r(e),__webpack_require__.d(e,{hasBrowserEnv:()=>zl,hasStandardBrowserEnv:()=>Wl,hasStandardBrowserWebWorkerEnv:()=>Kl,navigator:()=>Hl,origin:()=>$l});var t=__webpack_require__(5043),n=__webpack_require__.t(t,2),i=__webpack_require__(4391);let r={data:""},s=e=>"object"==typeof window?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||r,o=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,a=/\/\*[^]*?\*\/|  +/g,c=/\n+/g,l=(e,t)=>{let n="",i="",r="";for(let s in e){let o=e[s];"@"==s[0]?"i"==s[1]?n=s+" "+o+";":i+="f"==s[1]?l(o,s):s+"{"+l(o,"k"==s[1]?"":t)+"}":"object"==typeof o?i+=l(o,t?t.replace(/([^,])+/g,e=>s.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,t=>/&/.test(t)?t.replace(/&/g,e):e?e+" "+t:t)):s):null!=o&&(s=/^--/.test(s)?s:s.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=l.p?l.p(s,o):s+":"+o+";")}return n+(t&&r?t+"{"+r+"}":r)+i},u={},d=e=>{if("object"==typeof e){let t="";for(let n in e)t+=n+d(e[n]);return t}return e},h=(e,t,n,i,r)=>{let s=d(e),h=u[s]||(u[s]=(e=>{let t=0,n=11;for(;t<e.length;)n=101*n+e.charCodeAt(t++)>>>0;return"go"+n})(s));if(!u[h]){let t=s!==e?e:(e=>{let t,n,i=[{}];for(;t=o.exec(e.replace(a,""));)t[4]?i.shift():t[3]?(n=t[3].replace(c," ").trim(),i.unshift(i[0][n]=i[0][n]||{})):i[0][t[1]]=t[2].replace(c," ").trim();return i[0]})(e);u[h]=l(r?{["@keyframes "+h]:t}:t,n?"":"."+h)}let p=n&&u.g?u.g:null;return n&&(u.g=u[h]),((e,t,n,i)=>{i?t.data=t.data.replace(i,e):-1===t.data.indexOf(e)&&(t.data=n?e+t.data:t.data+e)})(u[h],t,i,p),h};function p(e){let t=this||{},n=e.call?e(t.p):e;return h(n.unshift?n.raw?((e,t,n)=>e.reduce((e,i,r)=>{let s=t[r];if(s&&s.call){let e=s(n),t=e&&e.props&&e.props.className||/^go/.test(e)&&e;s=t?"."+t:e&&"object"==typeof e?e.props?"":l(e,""):!1===e?"":e}return e+i+(null==s?"":s)},""))(n,[].slice.call(arguments,1),t.p):n.reduce((e,n)=>Object.assign(e,n&&n.call?n(t.p):n),{}):n,s(t.target),t.g,t.o,t.k)}p.bind({g:1});let f,m,g,v=p.bind({k:1});function y(e,t){let n=this||{};return function(){let i=arguments;function r(s,o){let a=Object.assign({},s),c=a.className||r.className;n.p=Object.assign({theme:m&&m()},a),n.o=/ *go\d+/.test(c),a.className=p.apply(n,i)+(c?" "+c:""),t&&(a.ref=o);let l=e;return e[0]&&(l=a.as||e,delete a.as),g&&l[0]&&g(a),f(l,a)}return t?t(r):r}}var b=(e,t)=>(e=>"function"==typeof e)(e)?e(t):e,k=(()=>{let e=0;return()=>(++e).toString()})(),w=(()=>{let e;return()=>{if(void 0===e&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),S=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,20)};case 1:return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case 2:let{toast:n}=t;return S(e,{type:e.toasts.find(e=>e.id===n.id)?1:0,toast:n});case 3:let{toastId:i}=t;return{...e,toasts:e.toasts.map(e=>e.id===i||void 0===i?{...e,dismissed:!0,visible:!1}:e)};case 4:return void 0===t.toastId?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let r=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(e=>({...e,pauseDuration:e.pauseDuration+r}))}}},T=[],C={toasts:[],pausedAt:void 0},x=e=>{C=S(C,e),T.forEach(e=>{e(C)})},E={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},P=e=>(t,n)=>{let i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"blank",n=arguments.length>2?arguments[2]:void 0;return{createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...n,id:(null==n?void 0:n.id)||k()}}(t,e,n);return x({type:2,toast:i}),i.id},R=(e,t)=>P("blank")(e,t);R.error=P("error"),R.success=P("success"),R.loading=P("loading"),R.custom=P("custom"),R.dismiss=e=>{x({type:3,toastId:e})},R.remove=e=>x({type:4,toastId:e}),R.promise=(e,t,n)=>{let i=R.loading(t.loading,{...n,...null==n?void 0:n.loading});return"function"==typeof e&&(e=e()),e.then(e=>{let r=t.success?b(t.success,e):void 0;return r?R.success(r,{id:i,...n,...null==n?void 0:n.success}):R.dismiss(i),e}).catch(e=>{let r=t.error?b(t.error,e):void 0;r?R.error(r,{id:i,...n,...null==n?void 0:n.error}):R.dismiss(i)}),e};var O=(e,t)=>{x({type:1,toast:{id:e,height:t}})},_=()=>{x({type:5,time:Date.now()})},N=new Map,A=e=>{let{toasts:n,pausedAt:i}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[n,i]=(0,t.useState)(C),r=(0,t.useRef)(C);(0,t.useEffect)(()=>(r.current!==C&&i(C),T.push(i),()=>{let e=T.indexOf(i);e>-1&&T.splice(e,1)}),[]);let s=n.toasts.map(t=>{var n,i,r;return{...e,...e[t.type],...t,removeDelay:t.removeDelay||(null==(n=e[t.type])?void 0:n.removeDelay)||(null==e?void 0:e.removeDelay),duration:t.duration||(null==(i=e[t.type])?void 0:i.duration)||(null==e?void 0:e.duration)||E[t.type],style:{...e.style,...null==(r=e[t.type])?void 0:r.style,...t.style}}});return{...n,toasts:s}}(e);(0,t.useEffect)(()=>{if(i)return;let e=Date.now(),t=n.map(t=>{if(t.duration===1/0)return;let n=(t.duration||0)+t.pauseDuration-(e-t.createdAt);if(!(n<0))return setTimeout(()=>R.dismiss(t.id),n);t.visible&&R.dismiss(t.id)});return()=>{t.forEach(e=>e&&clearTimeout(e))}},[n,i]);let r=(0,t.useCallback)(()=>{i&&x({type:6,time:Date.now()})},[i]),s=(0,t.useCallback)((e,t)=>{let{reverseOrder:i=!1,gutter:r=8,defaultPosition:s}=t||{},o=n.filter(t=>(t.position||s)===(e.position||s)&&t.height),a=o.findIndex(t=>t.id===e.id),c=o.filter((e,t)=>t<a&&e.visible).length;return o.filter(e=>e.visible).slice(...i?[c+1]:[0,c]).reduce((e,t)=>e+(t.height||0)+r,0)},[n]);return(0,t.useEffect)(()=>{n.forEach(e=>{if(e.dismissed)!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;if(N.has(e))return;let n=setTimeout(()=>{N.delete(e),x({type:4,toastId:e})},t);N.set(e,n)}(e.id,e.removeDelay);else{let t=N.get(e.id);t&&(clearTimeout(t),N.delete(e.id))}})},[n]),{toasts:n,handlers:{updateHeight:O,startPause:_,endPause:r,calculateOffset:s}}},I=v`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,j=v`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,D=v`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,M=y("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${I} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${j} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${D} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,L=v`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,F=y("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${L} 1s linear infinite;
`,U=v`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,B=v`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,V=y("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${U} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${B} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,q=y("div")`
  position: absolute;
`,z=y("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,H=v`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,W=y("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${H} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,K=e=>{let{toast:n}=e,{icon:i,type:r,iconTheme:s}=n;return void 0!==i?"string"==typeof i?t.createElement(W,null,i):i:"blank"===r?null:t.createElement(z,null,t.createElement(F,{...s}),"loading"!==r&&t.createElement(q,null,"error"===r?t.createElement(M,{...s}):t.createElement(V,{...s})))},$=e=>`\n0% {transform: translate3d(0,${-200*e}%,0) scale(.6); opacity:.5;}\n100% {transform: translate3d(0,0,0) scale(1); opacity:1;}\n`,G=e=>`\n0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}\n100% {transform: translate3d(0,${-150*e}%,-1px) scale(.6); opacity:0;}\n`,Q=y("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,J=y("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Y=t.memo(e=>{let{toast:n,position:i,style:r,children:s}=e,o=n.height?((e,t)=>{let n=e.includes("top")?1:-1,[i,r]=w()?["0%{opacity:0;} 100%{opacity:1;}","0%{opacity:1;} 100%{opacity:0;}"]:[$(n),G(n)];return{animation:t?`${v(i)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${v(r)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}})(n.position||i||"top-center",n.visible):{opacity:0},a=t.createElement(K,{toast:n}),c=t.createElement(J,{...n.ariaProps},b(n.message,n));return t.createElement(Q,{className:n.className,style:{...o,...r,...n.style}},"function"==typeof s?s({icon:a,message:c}):t.createElement(t.Fragment,null,a,c))});!function(e,t,n,i){l.p=t,f=e,m=n,g=i}(t.createElement);var X,Z=e=>{let{id:n,className:i,style:r,onHeightUpdate:s,children:o}=e,a=t.useCallback(e=>{if(e){let t=()=>{let t=e.getBoundingClientRect().height;s(n,t)};t(),new MutationObserver(t).observe(e,{subtree:!0,childList:!0,characterData:!0})}},[n,s]);return t.createElement("div",{ref:a,className:i,style:r},o)},ee=p`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,te=e=>{let{reverseOrder:n,position:i="top-center",toastOptions:r,gutter:s,children:o,containerStyle:a,containerClassName:c}=e,{toasts:l,handlers:u}=A(r);return t.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:16,left:16,right:16,bottom:16,pointerEvents:"none",...a},className:c,onMouseEnter:u.startPause,onMouseLeave:u.endPause},l.map(e=>{let r=e.position||i,a=((e,t)=>{let n=e.includes("top"),i=n?{top:0}:{bottom:0},r=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:w()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(n?1:-1)}px)`,...i,...r}})(r,u.calculateOffset(e,{reverseOrder:n,gutter:s,defaultPosition:i}));return t.createElement(Z,{id:e.id,key:e.id,onHeightUpdate:u.updateHeight,className:e.visible?ee:"",style:a},"custom"===e.type?b(e.message,e):o?o(e):t.createElement(Y,{toast:e,position:r}))}))},ne=R,ie=__webpack_require__(2907),re=__webpack_require__(7950),se=__webpack_require__.t(re,2);function oe(){return oe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},oe.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(X||(X={}));const ae="popstate";function ce(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function le(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(r){}}}function ue(e,t){return{usr:e.state,key:e.key,idx:t}}function de(e,t,n,i){return void 0===n&&(n=null),oe({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?pe(t):t,{state:n,key:t&&t.key||i||Math.random().toString(36).substr(2,8)})}function he(e){let{pathname:t="/",search:n="",hash:i=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),i&&"#"!==i&&(t+="#"===i.charAt(0)?i:"#"+i),t}function pe(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let i=e.indexOf("?");i>=0&&(t.search=e.substr(i),e=e.substr(0,i)),e&&(t.pathname=e)}return t}function fe(e,t,n,i){void 0===i&&(i={});let{window:r=document.defaultView,v5Compat:s=!1}=i,o=r.history,a=X.Pop,c=null,l=u();function u(){return(o.state||{idx:null}).idx}function d(){a=X.Pop;let e=u(),t=null==e?null:e-l;l=e,c&&c({action:a,location:p.location,delta:t})}function h(e){let t="null"!==r.location.origin?r.location.origin:r.location.href,n="string"===typeof e?e:he(e);return n=n.replace(/ $/,"%20"),ce(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==l&&(l=0,o.replaceState(oe({},o.state,{idx:l}),""));let p={get action(){return a},get location(){return e(r,o)},listen(e){if(c)throw new Error("A history only accepts one active listener");return r.addEventListener(ae,d),c=e,()=>{r.removeEventListener(ae,d),c=null}},createHref:e=>t(r,e),createURL:h,encodeLocation(e){let t=h(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){a=X.Push;let i=de(p.location,e,t);n&&n(i,e),l=u()+1;let d=ue(i,l),h=p.createHref(i);try{o.pushState(d,"",h)}catch(f){if(f instanceof DOMException&&"DataCloneError"===f.name)throw f;r.location.assign(h)}s&&c&&c({action:a,location:p.location,delta:1})},replace:function(e,t){a=X.Replace;let i=de(p.location,e,t);n&&n(i,e),l=u();let r=ue(i,l),d=p.createHref(i);o.replaceState(r,"",d),s&&c&&c({action:a,location:p.location,delta:0})},go:e=>o.go(e)};return p}var me;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(me||(me={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function ge(e,t,n){return void 0===n&&(n="/"),ve(e,t,n,!1)}function ve(e,t,n,i){let r=Ne(("string"===typeof t?pe(t):t).pathname||"/",n);if(null==r)return null;let s=ye(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(s);let o=null;for(let a=0;null==o&&a<s.length;++a){let e=_e(r);o=Re(s[a],e,i)}return o}function ye(e,t,n,i){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===i&&(i="");let r=(e,r,s)=>{let o={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:r,route:e};o.relativePath.startsWith("/")&&(ce(o.relativePath.startsWith(i),'Absolute route path "'+o.relativePath+'" nested under path "'+i+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(i.length));let a=Me([i,o.relativePath]),c=n.concat(o);e.children&&e.children.length>0&&(ce(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+a+'".'),ye(e.children,t,c,a)),(null!=e.path||e.index)&&t.push({path:a,score:Pe(a,e.index),routesMeta:c})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let i of be(e.path))r(e,t,i);else r(e,t)}),t}function be(e){let t=e.split("/");if(0===t.length)return[];let[n,...i]=t,r=n.endsWith("?"),s=n.replace(/\?$/,"");if(0===i.length)return r?[s,""]:[s];let o=be(i.join("/")),a=[];return a.push(...o.map(e=>""===e?s:[s,e].join("/"))),r&&a.push(...o),a.map(t=>e.startsWith("/")&&""===t?"/":t)}const ke=/^:[\w-]+$/,we=3,Se=2,Te=1,Ce=10,xe=-2,Ee=e=>"*"===e;function Pe(e,t){let n=e.split("/"),i=n.length;return n.some(Ee)&&(i+=xe),t&&(i+=Se),n.filter(e=>!Ee(e)).reduce((e,t)=>e+(ke.test(t)?we:""===t?Te:Ce),i)}function Re(e,t,n){void 0===n&&(n=!1);let{routesMeta:i}=e,r={},s="/",o=[];for(let a=0;a<i.length;++a){let e=i[a],c=a===i.length-1,l="/"===s?t:t.slice(s.length)||"/",u=Oe({path:e.relativePath,caseSensitive:e.caseSensitive,end:c},l),d=e.route;if(!u&&c&&n&&!i[i.length-1].route.index&&(u=Oe({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},l)),!u)return null;Object.assign(r,u.params),o.push({params:r,pathname:Me([s,u.pathname]),pathnameBase:Le(Me([s,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(s=Me([s,u.pathnameBase]))}return o}function Oe(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,i]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);le("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let i=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(i.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)"));e.endsWith("*")?(i.push({paramName:"*"}),r+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":""!==e&&"/"!==e&&(r+="(?:(?=\\/|$))");let s=new RegExp(r,t?void 0:"i");return[s,i]}(e.path,e.caseSensitive,e.end),r=t.match(n);if(!r)return null;let s=r[0],o=s.replace(/(.)\/+$/,"$1"),a=r.slice(1),c=i.reduce((e,t,n)=>{let{paramName:i,isOptional:r}=t;if("*"===i){let e=a[n]||"";o=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const c=a[n];return e[i]=r&&!c?void 0:(c||"").replace(/%2F/g,"/"),e},{});return{params:c,pathname:s,pathnameBase:o,pattern:e}}function _e(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return le(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function Ne(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,i=e.charAt(n);return i&&"/"!==i?null:e.slice(n)||"/"}function Ae(e,t,n,i){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(i)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function Ie(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function je(e,t){let n=Ie(e);return t?n.map((e,t)=>t===n.length-1?e.pathname:e.pathnameBase):n.map(e=>e.pathnameBase)}function De(e,t,n,i){let r;void 0===i&&(i=!1),"string"===typeof e?r=pe(e):(r=oe({},e),ce(!r.pathname||!r.pathname.includes("?"),Ae("?","pathname","search",r)),ce(!r.pathname||!r.pathname.includes("#"),Ae("#","pathname","hash",r)),ce(!r.search||!r.search.includes("#"),Ae("#","search","hash",r)));let s,o=""===e||""===r.pathname,a=o?"/":r.pathname;if(null==a)s=n;else{let e=t.length-1;if(!i&&a.startsWith("..")){let t=a.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}s=e>=0?t[e]:"/"}let c=function(e,t){void 0===t&&(t="/");let{pathname:n,search:i="",hash:r=""}="string"===typeof e?pe(e):e,s=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:s,search:Fe(i),hash:Ue(r)}}(r,s),l=a&&"/"!==a&&a.endsWith("/"),u=(o||"."===a)&&n.endsWith("/");return c.pathname.endsWith("/")||!l&&!u||(c.pathname+="/"),c}const Me=e=>e.join("/").replace(/\/\/+/g,"/"),Le=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Fe=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",Ue=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function Be(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const Ve=["post","put","patch","delete"],qe=(new Set(Ve),["get",...Ve]);new Set(qe),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function ze(){return ze=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},ze.apply(this,arguments)}const He=t.createContext(null);const We=t.createContext(null);const Ke=t.createContext(null);const $e=t.createContext(null);const Ge=t.createContext({outlet:null,matches:[],isDataRoute:!1});const Qe=t.createContext(null);function Je(){return null!=t.useContext($e)}function Ye(){return Je()||ce(!1),t.useContext($e).location}function Xe(e){t.useContext(Ke).static||t.useLayoutEffect(e)}function Ze(){let{isDataRoute:e}=t.useContext(Ge);return e?function(){let{router:e}=lt(at.UseNavigateStable),n=dt(ct.UseNavigateStable),i=t.useRef(!1);Xe(()=>{i.current=!0});let r=t.useCallback(function(t,r){void 0===r&&(r={}),i.current&&("number"===typeof t?e.navigate(t):e.navigate(t,ze({fromRouteId:n},r)))},[e,n]);return r}():function(){Je()||ce(!1);let e=t.useContext(He),{basename:n,future:i,navigator:r}=t.useContext(Ke),{matches:s}=t.useContext(Ge),{pathname:o}=Ye(),a=JSON.stringify(je(s,i.v7_relativeSplatPath)),c=t.useRef(!1);Xe(()=>{c.current=!0});let l=t.useCallback(function(t,i){if(void 0===i&&(i={}),!c.current)return;if("number"===typeof t)return void r.go(t);let s=De(t,JSON.parse(a),o,"path"===i.relative);null==e&&"/"!==n&&(s.pathname="/"===s.pathname?n:Me([n,s.pathname])),(i.replace?r.replace:r.push)(s,i.state,i)},[n,r,a,o,e]);return l}()}function et(e,n){let{relative:i}=void 0===n?{}:n,{future:r}=t.useContext(Ke),{matches:s}=t.useContext(Ge),{pathname:o}=Ye(),a=JSON.stringify(je(s,r.v7_relativeSplatPath));return t.useMemo(()=>De(e,JSON.parse(a),o,"path"===i),[e,a,o,i])}function tt(e,n,i,r){Je()||ce(!1);let{navigator:s}=t.useContext(Ke),{matches:o}=t.useContext(Ge),a=o[o.length-1],c=a?a.params:{},l=(a&&a.pathname,a?a.pathnameBase:"/");a&&a.route;let u,d=Ye();if(n){var h;let e="string"===typeof n?pe(n):n;"/"===l||(null==(h=e.pathname)?void 0:h.startsWith(l))||ce(!1),u=e}else u=d;let p=u.pathname||"/",f=p;if("/"!==l){let e=l.replace(/^\//,"").split("/");f="/"+p.replace(/^\//,"").split("/").slice(e.length).join("/")}let m=ge(e,{pathname:f});let g=ot(m&&m.map(e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:Me([l,s.encodeLocation?s.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?l:Me([l,s.encodeLocation?s.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),o,i,r);return n&&g?t.createElement($e.Provider,{value:{location:ze({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:X.Pop}},g):g}function nt(){let e=function(){var e;let n=t.useContext(Qe),i=ut(ct.UseRouteError),r=dt(ct.UseRouteError);if(void 0!==n)return n;return null==(e=i.errors)?void 0:e[r]}(),n=Be(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),i=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r};return t.createElement(t.Fragment,null,t.createElement("h2",null,"Unexpected Application Error!"),t.createElement("h3",{style:{fontStyle:"italic"}},n),i?t.createElement("pre",{style:s},i):null,null)}const it=t.createElement(nt,null);class rt extends t.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?t.createElement(Ge.Provider,{value:this.props.routeContext},t.createElement(Qe.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function st(e){let{routeContext:n,match:i,children:r}=e,s=t.useContext(He);return s&&s.static&&s.staticContext&&(i.route.errorElement||i.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=i.route.id),t.createElement(Ge.Provider,{value:n},r)}function ot(e,n,i,r){var s;if(void 0===n&&(n=[]),void 0===i&&(i=null),void 0===r&&(r=null),null==e){var o;if(!i)return null;if(i.errors)e=i.matches;else{if(!(null!=(o=r)&&o.v7_partialHydration&&0===n.length&&!i.initialized&&i.matches.length>0))return null;e=i.matches}}let a=e,c=null==(s=i)?void 0:s.errors;if(null!=c){let e=a.findIndex(e=>e.route.id&&void 0!==(null==c?void 0:c[e.route.id]));e>=0||ce(!1),a=a.slice(0,Math.min(a.length,e+1))}let l=!1,u=-1;if(i&&r&&r.v7_partialHydration)for(let t=0;t<a.length;t++){let e=a[t];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(u=t),e.route.id){let{loaderData:t,errors:n}=i,r=e.route.loader&&void 0===t[e.route.id]&&(!n||void 0===n[e.route.id]);if(e.route.lazy||r){l=!0,a=u>=0?a.slice(0,u+1):[a[0]];break}}}return a.reduceRight((e,r,s)=>{let o,d=!1,h=null,p=null;var f;i&&(o=c&&r.route.id?c[r.route.id]:void 0,h=r.route.errorElement||it,l&&(u<0&&0===s?(f="route-fallback",!1||ht[f]||(ht[f]=!0),d=!0,p=null):u===s&&(d=!0,p=r.route.hydrateFallbackElement||null)));let m=n.concat(a.slice(0,s+1)),g=()=>{let n;return n=o?h:d?p:r.route.Component?t.createElement(r.route.Component,null):r.route.element?r.route.element:e,t.createElement(st,{match:r,routeContext:{outlet:e,matches:m,isDataRoute:null!=i},children:n})};return i&&(r.route.ErrorBoundary||r.route.errorElement||0===s)?t.createElement(rt,{location:i.location,revalidation:i.revalidation,component:h,error:o,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):g()},null)}var at=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(at||{}),ct=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(ct||{});function lt(e){let n=t.useContext(He);return n||ce(!1),n}function ut(e){let n=t.useContext(We);return n||ce(!1),n}function dt(e){let n=function(){let e=t.useContext(Ge);return e||ce(!1),e}(),i=n.matches[n.matches.length-1];return i.route.id||ce(!1),i.route.id}const ht={};function pt(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}n.startTransition;function ft(e){let{to:n,replace:i,state:r,relative:s}=e;Je()||ce(!1);let{future:o,static:a}=t.useContext(Ke),{matches:c}=t.useContext(Ge),{pathname:l}=Ye(),u=Ze(),d=De(n,je(c,o.v7_relativeSplatPath),l,"path"===s),h=JSON.stringify(d);return t.useEffect(()=>u(JSON.parse(h),{replace:i,state:r,relative:s}),[u,h,s,i,r]),null}function mt(e){ce(!1)}function gt(e){let{basename:n="/",children:i=null,location:r,navigationType:s=X.Pop,navigator:o,static:a=!1,future:c}=e;Je()&&ce(!1);let l=n.replace(/^\/*/,"/"),u=t.useMemo(()=>({basename:l,navigator:o,static:a,future:ze({v7_relativeSplatPath:!1},c)}),[l,c,o,a]);"string"===typeof r&&(r=pe(r));let{pathname:d="/",search:h="",hash:p="",state:f=null,key:m="default"}=r,g=t.useMemo(()=>{let e=Ne(d,l);return null==e?null:{location:{pathname:e,search:h,hash:p,state:f,key:m},navigationType:s}},[l,d,h,p,f,m,s]);return null==g?null:t.createElement(Ke.Provider,{value:u},t.createElement($e.Provider,{children:i,value:g}))}function vt(e){let{children:t,location:n}=e;return tt(yt(t),n)}new Promise(()=>{});t.Component;function yt(e,n){void 0===n&&(n=[]);let i=[];return t.Children.forEach(e,(e,r)=>{if(!t.isValidElement(e))return;let s=[...n,r];if(e.type===t.Fragment)return void i.push.apply(i,yt(e.props.children,s));e.type!==mt&&ce(!1),e.props.index&&e.props.children&&ce(!1);let o={id:e.props.id||s.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(o.children=yt(e.props.children,s)),i.push(o)}),i}function bt(){return bt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},bt.apply(this,arguments)}function kt(e,t){if(null==e)return{};var n,i,r={},s=Object.keys(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const wt=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(r){}new Map;const St=n.startTransition;se.flushSync,n.useId;function Tt(e){let{basename:n,children:i,future:r,window:s}=e,o=t.useRef();null==o.current&&(o.current=function(e){return void 0===e&&(e={}),fe(function(e,t){let{pathname:n,search:i,hash:r}=e.location;return de("",{pathname:n,search:i,hash:r},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:he(t)},null,e)}({window:s,v5Compat:!0}));let a=o.current,[c,l]=t.useState({action:a.action,location:a.location}),{v7_startTransition:u}=r||{},d=t.useCallback(e=>{u&&St?St(()=>l(e)):l(e)},[l,u]);return t.useLayoutEffect(()=>a.listen(d),[a,d]),t.useEffect(()=>pt(r),[r]),t.createElement(gt,{basename:n,children:i,location:c.location,navigationType:c.action,navigator:a,future:r})}const Ct="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,xt=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Et=t.forwardRef(function(e,n){let i,{onClick:s,relative:o,reloadDocument:a,replace:c,state:l,target:u,to:d,preventScrollReset:h,viewTransition:p}=e,f=kt(e,wt),{basename:m}=t.useContext(Ke),g=!1;if("string"===typeof d&&xt.test(d)&&(i=d,Ct))try{let e=new URL(window.location.href),t=d.startsWith("//")?new URL(e.protocol+d):new URL(d),n=Ne(t.pathname,m);t.origin===e.origin&&null!=n?d=n+t.search+t.hash:g=!0}catch(r){}let v=function(e,n){let{relative:i}=void 0===n?{}:n;Je()||ce(!1);let{basename:r,navigator:s}=t.useContext(Ke),{hash:o,pathname:a,search:c}=et(e,{relative:i}),l=a;return"/"!==r&&(l="/"===a?r:Me([r,a])),s.createHref({pathname:l,search:c,hash:o})}(d,{relative:o}),y=function(e,n){let{target:i,replace:r,state:s,preventScrollReset:o,relative:a,viewTransition:c}=void 0===n?{}:n,l=Ze(),u=Ye(),d=et(e,{relative:a});return t.useCallback(t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,i)){t.preventDefault();let n=void 0!==r?r:he(u)===he(d);l(e,{replace:n,state:s,preventScrollReset:o,relative:a,viewTransition:c})}},[u,l,d,r,s,i,e,o,a,c])}(d,{replace:c,state:l,target:u,preventScrollReset:h,relative:o,viewTransition:p});return t.createElement("a",bt({},f,{href:i||v,onClick:g||a?s:function(e){s&&s(e),e.defaultPrevented||y(e)},ref:n,target:u}))});var Pt,Rt;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Pt||(Pt={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Rt||(Rt={}));const Ot=(0,t.createContext)({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),_t=(0,t.createContext)({}),Nt=(0,t.createContext)(null),At="undefined"!==typeof document,It=At?t.useLayoutEffect:t.useEffect,jt=(0,t.createContext)({strict:!1}),Dt=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),Mt="data-"+Dt("framerAppearId");function Lt(e){return e&&"object"===typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}function Ft(e){return"string"===typeof e||Array.isArray(e)}function Ut(e){return null!==e&&"object"===typeof e&&"function"===typeof e.start}const Bt=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Vt=["initial",...Bt];function qt(e){return Ut(e.animate)||Vt.some(t=>Ft(e[t]))}function zt(e){return Boolean(qt(e)||e.variants)}function Ht(e){const{initial:n,animate:i}=function(e,t){if(qt(e)){const{initial:t,animate:n}=e;return{initial:!1===t||Ft(t)?t:void 0,animate:Ft(n)?n:void 0}}return!1!==e.inherit?t:{}}(e,(0,t.useContext)(_t));return(0,t.useMemo)(()=>({initial:n,animate:i}),[Wt(n),Wt(i)])}function Wt(e){return Array.isArray(e)?e.join(" "):e}const Kt={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},$t={};for(const fT in Kt)$t[fT]={isEnabled:e=>Kt[fT].some(t=>!!e[t])};const Gt=(0,t.createContext)({}),Qt=(0,t.createContext)({}),Jt=Symbol.for("motionComponentSymbol");function Yt(e){let{preloadedFeatures:n,createVisualElement:i,useRender:r,useVisualState:s,Component:o}=e;n&&function(e){for(const t in e)$t[t]={...$t[t],...e[t]}}(n);const a=(0,t.forwardRef)(function(e,a){let c;const l={...(0,t.useContext)(Ot),...e,layoutId:Xt(e)},{isStatic:u}=l,d=Ht(e),h=s(e,u);if(!u&&At){d.visualElement=function(e,n,i,r){const{visualElement:s}=(0,t.useContext)(_t),o=(0,t.useContext)(jt),a=(0,t.useContext)(Nt),c=(0,t.useContext)(Ot).reducedMotion,l=(0,t.useRef)();r=r||o.renderer,!l.current&&r&&(l.current=r(e,{visualState:n,parent:s,props:i,presenceContext:a,blockInitialAnimation:!!a&&!1===a.initial,reducedMotionConfig:c}));const u=l.current;(0,t.useInsertionEffect)(()=>{u&&u.update(i,a)});const d=(0,t.useRef)(Boolean(i[Mt]&&!window.HandoffComplete));return It(()=>{u&&(u.render(),d.current&&u.animationState&&u.animationState.animateChanges())}),(0,t.useEffect)(()=>{u&&(u.updateFeatures(),!d.current&&u.animationState&&u.animationState.animateChanges(),d.current&&(d.current=!1,window.HandoffComplete=!0))}),u}(o,h,l,i);const e=(0,t.useContext)(Qt),r=(0,t.useContext)(jt).strict;d.visualElement&&(c=d.visualElement.loadFeatures(l,r,n,e))}return t.createElement(_t.Provider,{value:d},c&&d.visualElement?t.createElement(c,{visualElement:d.visualElement,...l}):null,r(o,e,function(e,n,i){return(0,t.useCallback)(t=>{t&&e.mount&&e.mount(t),n&&(t?n.mount(t):n.unmount()),i&&("function"===typeof i?i(t):Lt(i)&&(i.current=t))},[n])}(h,d.visualElement,a),h,u,d.visualElement))});return a[Jt]=o,a}function Xt(e){let{layoutId:n}=e;const i=(0,t.useContext)(Gt).id;return i&&void 0!==n?i+"-"+n:n}function Zt(e){function t(t){return Yt(e(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}if("undefined"===typeof Proxy)return t;const n=new Map;return new Proxy(t,{get:(e,i)=>(n.has(i)||n.set(i,t(i)),n.get(i))})}const en=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function tn(e){return"string"===typeof e&&!e.includes("-")&&!!(en.indexOf(e)>-1||/[A-Z]/.test(e))}const nn={};const rn=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],sn=new Set(rn);function on(e,t){let{layout:n,layoutId:i}=t;return sn.has(e)||e.startsWith("origin")||(n||void 0!==i)&&(!!nn[e]||"opacity"===e)}const an=e=>Boolean(e&&e.getVelocity),cn={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},ln=rn.length;const un=e=>t=>"string"===typeof t&&t.startsWith(e),dn=un("--"),hn=un("var(--"),pn=(e,t)=>t&&"number"===typeof e?t.transform(e):e,fn=(e,t,n)=>Math.min(Math.max(n,e),t),mn={test:e=>"number"===typeof e,parse:parseFloat,transform:e=>e},gn={...mn,transform:e=>fn(0,1,e)},vn={...mn,default:1},yn=e=>Math.round(1e5*e)/1e5,bn=/(-)?([\d]*\.?[\d])+/g,kn=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,wn=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function Sn(e){return"string"===typeof e}const Tn=e=>({test:t=>Sn(t)&&t.endsWith(e)&&1===t.split(" ").length,parse:parseFloat,transform:t=>`${t}${e}`}),Cn=Tn("deg"),xn=Tn("%"),En=Tn("px"),Pn=Tn("vh"),Rn=Tn("vw"),On={...xn,parse:e=>xn.parse(e)/100,transform:e=>xn.transform(100*e)},_n={...mn,transform:Math.round},Nn={borderWidth:En,borderTopWidth:En,borderRightWidth:En,borderBottomWidth:En,borderLeftWidth:En,borderRadius:En,radius:En,borderTopLeftRadius:En,borderTopRightRadius:En,borderBottomRightRadius:En,borderBottomLeftRadius:En,width:En,maxWidth:En,height:En,maxHeight:En,size:En,top:En,right:En,bottom:En,left:En,padding:En,paddingTop:En,paddingRight:En,paddingBottom:En,paddingLeft:En,margin:En,marginTop:En,marginRight:En,marginBottom:En,marginLeft:En,rotate:Cn,rotateX:Cn,rotateY:Cn,rotateZ:Cn,scale:vn,scaleX:vn,scaleY:vn,scaleZ:vn,skew:Cn,skewX:Cn,skewY:Cn,distance:En,translateX:En,translateY:En,translateZ:En,x:En,y:En,z:En,perspective:En,transformPerspective:En,opacity:gn,originX:On,originY:On,originZ:En,zIndex:_n,fillOpacity:gn,strokeOpacity:gn,numOctaves:_n};function An(e,t,n,i){const{style:r,vars:s,transform:o,transformOrigin:a}=e;let c=!1,l=!1,u=!0;for(const d in t){const e=t[d];if(dn(d)){s[d]=e;continue}const n=Nn[d],i=pn(e,n);if(sn.has(d)){if(c=!0,o[d]=i,!u)continue;e!==(n.default||0)&&(u=!1)}else d.startsWith("origin")?(l=!0,a[d]=i):r[d]=i}if(t.transform||(c||i?r.transform=function(e,t,n,i){let{enableHardwareAcceleration:r=!0,allowTransformNone:s=!0}=t,o="";for(let a=0;a<ln;a++){const t=rn[a];void 0!==e[t]&&(o+=`${cn[t]||t}(${e[t]}) `)}return r&&!e.z&&(o+="translateZ(0)"),o=o.trim(),i?o=i(e,n?"":o):s&&n&&(o="none"),o}(e.transform,n,u,i):r.transform&&(r.transform="none")),l){const{originX:e="50%",originY:t="50%",originZ:n=0}=a;r.transformOrigin=`${e} ${t} ${n}`}}const In=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function jn(e,t,n){for(const i in t)an(t[i])||on(i,n)||(e[i]=t[i])}function Dn(e,n,i){const r={};return jn(r,e.style||{},e),Object.assign(r,function(e,n,i){let{transformTemplate:r}=e;return(0,t.useMemo)(()=>{const e={style:{},transform:{},transformOrigin:{},vars:{}};return An(e,n,{enableHardwareAcceleration:!i},r),Object.assign({},e.vars,e.style)},[n])}(e,n,i)),e.transformValues?e.transformValues(r):r}function Mn(e,t,n){const i={},r=Dn(e,t,n);return e.drag&&!1!==e.dragListener&&(i.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=!0===e.drag?"none":"pan-"+("x"===e.drag?"y":"x")),void 0===e.tabIndex&&(e.onTap||e.onTapStart||e.whileTap)&&(i.tabIndex=0),i.style=r,i}const Ln=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Fn(e){return e.startsWith("while")||e.startsWith("drag")&&"draggable"!==e||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||Ln.has(e)}let Un=e=>!Fn(e);try{(Bn=require("@emotion/is-prop-valid").default)&&(Un=e=>e.startsWith("on")?!Fn(e):Bn(e))}catch(pT){}var Bn;function Vn(e,t,n){return"string"===typeof e?e:En.transform(t+n*e)}const qn={offset:"stroke-dashoffset",array:"stroke-dasharray"},zn={offset:"strokeDashoffset",array:"strokeDasharray"};function Hn(e,t,n,i,r){let{attrX:s,attrY:o,attrScale:a,originX:c,originY:l,pathLength:u,pathSpacing:d=1,pathOffset:h=0,...p}=t;if(An(e,p,n,r),i)return void(e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox));e.attrs=e.style,e.style={};const{attrs:f,style:m,dimensions:g}=e;f.transform&&(g&&(m.transform=f.transform),delete f.transform),g&&(void 0!==c||void 0!==l||m.transform)&&(m.transformOrigin=function(e,t,n){return`${Vn(t,e.x,e.width)} ${Vn(n,e.y,e.height)}`}(g,void 0!==c?c:.5,void 0!==l?l:.5)),void 0!==s&&(f.x=s),void 0!==o&&(f.y=o),void 0!==a&&(f.scale=a),void 0!==u&&function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];e.pathLength=1;const s=r?qn:zn;e[s.offset]=En.transform(-i);const o=En.transform(t),a=En.transform(n);e[s.array]=`${o} ${a}`}(f,u,d,h,!1)}const Wn=()=>({style:{},transform:{},transformOrigin:{},vars:{},attrs:{}}),Kn=e=>"string"===typeof e&&"svg"===e.toLowerCase();function $n(e,n,i,r){const s=(0,t.useMemo)(()=>{const t={style:{},transform:{},transformOrigin:{},vars:{},attrs:{}};return Hn(t,n,{enableHardwareAcceleration:!1},Kn(r),e.transformTemplate),{...t.attrs,style:{...t.style}}},[n]);if(e.style){const t={};jn(t,e.style,e),s.style={...t,...s.style}}return s}function Gn(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(n,i,r,s,o)=>{let{latestValues:a}=s;const c=(tn(n)?$n:Mn)(i,a,o,n),l=function(e,t,n){const i={};for(const r in e)"values"===r&&"object"===typeof e.values||(Un(r)||!0===n&&Fn(r)||!t&&!Fn(r)||e.draggable&&r.startsWith("onDrag"))&&(i[r]=e[r]);return i}(i,"string"===typeof n,e),u={...l,...c,ref:r},{children:d}=i,h=(0,t.useMemo)(()=>an(d)?d.get():d,[d]);return(0,t.createElement)(n,{...u,children:h})}}function Qn(e,t,n,i){let{style:r,vars:s}=t;Object.assign(e.style,r,i&&i.getProjectionStyles(n));for(const o in s)e.style.setProperty(o,s[o])}const Jn=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Yn(e,t,n,i){Qn(e,t,void 0,i);for(const r in t.attrs)e.setAttribute(Jn.has(r)?r:Dt(r),t.attrs[r])}function Xn(e,t){const{style:n}=e,i={};for(const r in n)(an(n[r])||t.style&&an(t.style[r])||on(r,e))&&(i[r]=n[r]);return i}function Zn(e,t){const n=Xn(e,t);for(const i in e)if(an(e[i])||an(t[i])){n[-1!==rn.indexOf(i)?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i]=e[i]}return n}function ei(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return"function"===typeof t&&(t=t(void 0!==n?n:e.custom,i,r)),"string"===typeof t&&(t=e.variants&&e.variants[t]),"function"===typeof t&&(t=t(void 0!==n?n:e.custom,i,r)),t}function ti(e){const n=(0,t.useRef)(null);return null===n.current&&(n.current=e()),n.current}const ni=e=>Array.isArray(e),ii=e=>ni(e)?e[e.length-1]||0:e;function ri(e){const t=an(e)?e.get():e;return(e=>Boolean(e&&"object"===typeof e&&e.mix&&e.toValue))(t)?t.toValue():t}const si=e=>(n,i)=>{const r=(0,t.useContext)(_t),s=(0,t.useContext)(Nt),o=()=>function(e,t,n,i){let{scrapeMotionValuesFromProps:r,createRenderState:s,onMount:o}=e;const a={latestValues:oi(t,n,i,r),renderState:s()};return o&&(a.mount=e=>o(t,e,a)),a}(e,n,r,s);return i?o():ti(o)};function oi(e,t,n,i){const r={},s=i(e,{});for(const h in s)r[h]=ri(s[h]);let{initial:o,animate:a}=e;const c=qt(e),l=zt(e);t&&l&&!c&&!1!==e.inherit&&(void 0===o&&(o=t.initial),void 0===a&&(a=t.animate));let u=!!n&&!1===n.initial;u=u||!1===o;const d=u?a:o;if(d&&"boolean"!==typeof d&&!Ut(d)){(Array.isArray(d)?d:[d]).forEach(t=>{const n=ei(e,t);if(!n)return;const{transitionEnd:i,transition:s,...o}=n;for(const e in o){let t=o[e];if(Array.isArray(t)){t=t[u?t.length-1:0]}null!==t&&(r[e]=t)}for(const e in i)r[e]=i[e]})}return r}const ai=e=>e;class ci{constructor(){this.order=[],this.scheduled=new Set}add(e){if(!this.scheduled.has(e))return this.scheduled.add(e),this.order.push(e),!0}remove(e){const t=this.order.indexOf(e);-1!==t&&(this.order.splice(t,1),this.scheduled.delete(e))}clear(){this.order.length=0,this.scheduled.clear()}}const li=["prepare","read","update","preRender","render","postRender"];const{schedule:ui,cancel:di,state:hi,steps:pi}=function(e,t){let n=!1,i=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=li.reduce((e,t)=>(e[t]=function(e){let t=new ci,n=new ci,i=0,r=!1,s=!1;const o=new WeakSet,a={schedule:function(e){const s=arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&r,a=s?t:n;return arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&o.add(e),a.add(e)&&s&&r&&(i=t.order.length),e},cancel:e=>{n.remove(e),o.delete(e)},process:c=>{if(r)s=!0;else{if(r=!0,[t,n]=[n,t],n.clear(),i=t.order.length,i)for(let n=0;n<i;n++){const i=t.order[n];i(c),o.has(i)&&(a.schedule(i),e())}r=!1,s&&(s=!1,a.process(c))}}};return a}(()=>n=!0),e),{}),o=e=>s[e].process(r),a=()=>{const s=performance.now();n=!1,r.delta=i?1e3/60:Math.max(Math.min(s-r.timestamp,40),1),r.timestamp=s,r.isProcessing=!0,li.forEach(o),r.isProcessing=!1,n&&t&&(i=!1,e(a))},c=li.reduce((t,o)=>{const c=s[o];return t[o]=function(t){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n||(n=!0,i=!0,r.isProcessing||e(a)),c.schedule(t,s,o)},t},{});return{schedule:c,cancel:e=>li.forEach(t=>s[t].cancel(e)),state:r,steps:s}}("undefined"!==typeof requestAnimationFrame?requestAnimationFrame:ai,!0),fi={useVisualState:si({scrapeMotionValuesFromProps:Zn,createRenderState:Wn,onMount:(e,t,n)=>{let{renderState:i,latestValues:s}=n;ui.read(()=>{try{i.dimensions="function"===typeof t.getBBox?t.getBBox():t.getBoundingClientRect()}catch(r){i.dimensions={x:0,y:0,width:0,height:0}}}),ui.render(()=>{Hn(i,s,{enableHardwareAcceleration:!1},Kn(t.tagName),e.transformTemplate),Yn(t,i)})}})},mi={useVisualState:si({scrapeMotionValuesFromProps:Xn,createRenderState:In})};function gi(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{passive:!0};return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n)}const vi=e=>"mouse"===e.pointerType?"number"!==typeof e.button||e.button<=0:!1!==e.isPrimary;function yi(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"page";return{point:{x:e[t+"X"],y:e[t+"Y"]}}}function bi(e,t,n,i){return gi(e,t,(e=>t=>vi(t)&&e(t,yi(t)))(n),i)}const ki=(e,t)=>n=>t(e(n)),wi=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(ki)};function Si(e){let t=null;return()=>{const n=()=>{t=null};return null===t&&(t=e,n)}}const Ti=Si("dragHorizontal"),Ci=Si("dragVertical");function xi(e){let t=!1;if("y"===e)t=Ci();else if("x"===e)t=Ti();else{const e=Ti(),n=Ci();e&&n?t=()=>{e(),n()}:(e&&e(),n&&n())}return t}function Ei(){const e=xi(!0);return!e||(e(),!1)}class Pi{constructor(e){this.isMounted=!1,this.node=e}update(){}}function Ri(e,t){const n="pointer"+(t?"enter":"leave"),i="onHover"+(t?"Start":"End");return bi(e.current,n,(n,r)=>{if("touch"===n.pointerType||Ei())return;const s=e.getProps();e.animationState&&s.whileHover&&e.animationState.setActive("whileHover",t),s[i]&&ui.update(()=>s[i](n,r))},{passive:!e.getProps()[i]})}const Oi=(e,t)=>!!t&&(e===t||Oi(e,t.parentElement));function _i(e,t){if(!t)return;const n=new PointerEvent("pointer"+e);t(n,yi(n))}const Ni=new WeakMap,Ai=new WeakMap,Ii=e=>{const t=Ni.get(e.target);t&&t(e)},ji=e=>{e.forEach(Ii)};function Di(e,t,n){const i=function(e){let{root:t,...n}=e;const i=t||document;Ai.has(i)||Ai.set(i,{});const r=Ai.get(i),s=JSON.stringify(n);return r[s]||(r[s]=new IntersectionObserver(ji,{root:t,...n})),r[s]}(t);return Ni.set(e,n),i.observe(e),()=>{Ni.delete(e),i.unobserve(e)}}const Mi={some:0,all:1};const Li={inView:{Feature:class extends Pi{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:n,amount:i="some",once:r}=e,s={root:t?t.current:void 0,rootMargin:n,threshold:"number"===typeof i?i:Mi[i]};return Di(this.node.current,s,e=>{const{isIntersecting:t}=e;if(this.isInView===t)return;if(this.isInView=t,r&&!t&&this.hasEnteredView)return;t&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",t);const{onViewportEnter:n,onViewportLeave:i}=this.node.getProps(),s=t?n:i;s&&s(e)})}mount(){this.startObserver()}update(){if("undefined"===typeof IntersectionObserver)return;const{props:e,prevProps:t}=this.node,n=["amount","margin","root"].some(function(e){let{viewport:t={}}=e,{viewport:n={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=>t[e]!==n[e]}(e,t));n&&this.startObserver()}unmount(){}}},tap:{Feature:class extends Pi{constructor(){super(...arguments),this.removeStartListeners=ai,this.removeEndListeners=ai,this.removeAccessibleListeners=ai,this.startPointerPress=(e,t)=>{if(this.isPressing)return;this.removeEndListeners();const n=this.node.getProps(),i=bi(window,"pointerup",(e,t)=>{if(!this.checkPressEnd())return;const{onTap:n,onTapCancel:i,globalTapTarget:r}=this.node.getProps();ui.update(()=>{r||Oi(this.node.current,e.target)?n&&n(e,t):i&&i(e,t)})},{passive:!(n.onTap||n.onPointerUp)}),r=bi(window,"pointercancel",(e,t)=>this.cancelPress(e,t),{passive:!(n.onTapCancel||n.onPointerCancel)});this.removeEndListeners=wi(i,r),this.startPress(e,t)},this.startAccessiblePress=()=>{const e=gi(this.node.current,"keydown",e=>{if("Enter"!==e.key||this.isPressing)return;this.removeEndListeners(),this.removeEndListeners=gi(this.node.current,"keyup",e=>{"Enter"===e.key&&this.checkPressEnd()&&_i("up",(e,t)=>{const{onTap:n}=this.node.getProps();n&&ui.update(()=>n(e,t))})}),_i("down",(e,t)=>{this.startPress(e,t)})}),t=gi(this.node.current,"blur",()=>{this.isPressing&&_i("cancel",(e,t)=>this.cancelPress(e,t))});this.removeAccessibleListeners=wi(e,t)}}startPress(e,t){this.isPressing=!0;const{onTapStart:n,whileTap:i}=this.node.getProps();i&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),n&&ui.update(()=>n(e,t))}checkPressEnd(){this.removeEndListeners(),this.isPressing=!1;return this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!Ei()}cancelPress(e,t){if(!this.checkPressEnd())return;const{onTapCancel:n}=this.node.getProps();n&&ui.update(()=>n(e,t))}mount(){const e=this.node.getProps(),t=bi(e.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),n=gi(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=wi(t,n)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}},focus:{Feature:class extends Pi{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch(r){e=!0}e&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=wi(gi(this.node.current,"focus",()=>this.onFocus()),gi(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}},hover:{Feature:class extends Pi{mount(){this.unmount=wi(Ri(this.node,!0),Ri(this.node,!1))}unmount(){}}}};function Fi(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}function Ui(e,t,n){const i=e.getProps();return ei(i,t,void 0!==n?n:i.custom,function(e){const t={};return e.values.forEach((e,n)=>t[n]=e.get()),t}(e),function(e){const t={};return e.values.forEach((e,n)=>t[n]=e.getVelocity()),t}(e))}let Bi=ai,Vi=ai;const qi=e=>1e3*e,zi=e=>e/1e3,Hi=!1,Wi=e=>Array.isArray(e)&&"number"===typeof e[0];function Ki(e){return Boolean(!e||"string"===typeof e&&Gi[e]||Wi(e)||Array.isArray(e)&&e.every(Ki))}const $i=e=>{let[t,n,i,r]=e;return`cubic-bezier(${t}, ${n}, ${i}, ${r})`},Gi={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:$i([0,.65,.55,1]),circOut:$i([.55,0,1,.45]),backIn:$i([.31,.01,.66,-.59]),backOut:$i([.33,1.53,.69,.99])};function Qi(e){if(e)return Wi(e)?$i(e):Array.isArray(e)?e.map(Qi):Gi[e]}const Ji=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e;function Yi(e,t,n,i){if(e===t&&n===i)return ai;const r=t=>function(e,t,n,i,r){let s,o,a=0;do{o=t+(n-t)/2,s=Ji(o,i,r)-e,s>0?n=o:t=o}while(Math.abs(s)>1e-7&&++a<12);return o}(t,0,1,e,n);return e=>0===e||1===e?e:Ji(r(e),t,i)}const Xi=Yi(.42,0,1,1),Zi=Yi(0,0,.58,1),er=Yi(.42,0,.58,1),tr=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,nr=e=>t=>1-e(1-t),ir=e=>1-Math.sin(Math.acos(e)),rr=nr(ir),sr=tr(ir),or=Yi(.33,1.53,.69,.99),ar=nr(or),cr=tr(ar),lr={linear:ai,easeIn:Xi,easeInOut:er,easeOut:Zi,circIn:ir,circInOut:sr,circOut:rr,backIn:ar,backInOut:cr,backOut:or,anticipate:e=>(e*=2)<1?.5*ar(e):.5*(2-Math.pow(2,-10*(e-1)))},ur=e=>{if(Array.isArray(e)){Vi(4===e.length,"Cubic bezier arrays must contain four numerical values.");const[t,n,i,r]=e;return Yi(t,n,i,r)}return"string"===typeof e?(Vi(void 0!==lr[e],`Invalid easing type '${e}'`),lr[e]):e},dr=(e,t)=>n=>Boolean(Sn(n)&&wn.test(n)&&n.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(n,t)),hr=(e,t,n)=>i=>{if(!Sn(i))return i;const[r,s,o,a]=i.match(bn);return{[e]:parseFloat(r),[t]:parseFloat(s),[n]:parseFloat(o),alpha:void 0!==a?parseFloat(a):1}},pr={...mn,transform:e=>Math.round((e=>fn(0,255,e))(e))},fr={test:dr("rgb","red"),parse:hr("red","green","blue"),transform:e=>{let{red:t,green:n,blue:i,alpha:r=1}=e;return"rgba("+pr.transform(t)+", "+pr.transform(n)+", "+pr.transform(i)+", "+yn(gn.transform(r))+")"}};const mr={test:dr("#"),parse:function(e){let t="",n="",i="",r="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),i=e.substring(5,7),r=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),i=e.substring(3,4),r=e.substring(4,5),t+=t,n+=n,i+=i,r+=r),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}},transform:fr.transform},gr={test:dr("hsl","hue"),parse:hr("hue","saturation","lightness"),transform:e=>{let{hue:t,saturation:n,lightness:i,alpha:r=1}=e;return"hsla("+Math.round(t)+", "+xn.transform(yn(n))+", "+xn.transform(yn(i))+", "+yn(gn.transform(r))+")"}},vr={test:e=>fr.test(e)||mr.test(e)||gr.test(e),parse:e=>fr.test(e)?fr.parse(e):gr.test(e)?gr.parse(e):mr.parse(e),transform:e=>Sn(e)?e:e.hasOwnProperty("red")?fr.transform(e):gr.transform(e)},yr=(e,t,n)=>-n*e+n*t+e;function br(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}const kr=(e,t,n)=>{const i=e*e;return Math.sqrt(Math.max(0,n*(t*t-i)+i))},wr=[mr,fr,gr];function Sr(e){const t=(e=>wr.find(t=>t.test(e)))(e);Vi(Boolean(t),`'${e}' is not an animatable color. Use the equivalent color code instead.`);let n=t.parse(e);return t===gr&&(n=function(e){let{hue:t,saturation:n,lightness:i,alpha:r}=e;t/=360,n/=100,i/=100;let s=0,o=0,a=0;if(n){const e=i<.5?i*(1+n):i+n-i*n,r=2*i-e;s=br(r,e,t+1/3),o=br(r,e,t),a=br(r,e,t-1/3)}else s=o=a=i;return{red:Math.round(255*s),green:Math.round(255*o),blue:Math.round(255*a),alpha:r}}(n)),n}const Tr=(e,t)=>{const n=Sr(e),i=Sr(t),r={...n};return e=>(r.red=kr(n.red,i.red,e),r.green=kr(n.green,i.green,e),r.blue=kr(n.blue,i.blue,e),r.alpha=yr(n.alpha,i.alpha,e),fr.transform(r))};const Cr={regex:/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,countKey:"Vars",token:"${v}",parse:ai},xr={regex:kn,countKey:"Colors",token:"${c}",parse:vr.parse},Er={regex:bn,countKey:"Numbers",token:"${n}",parse:mn.parse};function Pr(e,t){let{regex:n,countKey:i,token:r,parse:s}=t;const o=e.tokenised.match(n);o&&(e["num"+i]=o.length,e.tokenised=e.tokenised.replace(n,r),e.values.push(...o.map(s)))}function Rr(e){const t=e.toString(),n={value:t,tokenised:t,values:[],numVars:0,numColors:0,numNumbers:0};return n.value.includes("var(--")&&Pr(n,Cr),Pr(n,xr),Pr(n,Er),n}function Or(e){return Rr(e).values}function _r(e){const{values:t,numColors:n,numVars:i,tokenised:r}=Rr(e),s=t.length;return e=>{let t=r;for(let r=0;r<s;r++)t=r<i?t.replace(Cr.token,e[r]):r<i+n?t.replace(xr.token,vr.transform(e[r])):t.replace(Er.token,yn(e[r]));return t}}const Nr=e=>"number"===typeof e?0:e;const Ar={test:function(e){var t,n;return isNaN(e)&&Sn(e)&&((null===(t=e.match(bn))||void 0===t?void 0:t.length)||0)+((null===(n=e.match(kn))||void 0===n?void 0:n.length)||0)>0},parse:Or,createTransformer:_r,getAnimatableNone:function(e){const t=Or(e);return _r(e)(t.map(Nr))}},Ir=(e,t)=>n=>`${n>0?t:e}`;function jr(e,t){return"number"===typeof e?n=>yr(e,t,n):vr.test(e)?Tr(e,t):e.startsWith("var(")?Ir(e,t):Lr(e,t)}const Dr=(e,t)=>{const n=[...e],i=n.length,r=e.map((e,n)=>jr(e,t[n]));return e=>{for(let t=0;t<i;t++)n[t]=r[t](e);return n}},Mr=(e,t)=>{const n={...e,...t},i={};for(const r in n)void 0!==e[r]&&void 0!==t[r]&&(i[r]=jr(e[r],t[r]));return e=>{for(const t in i)n[t]=i[t](e);return n}},Lr=(e,t)=>{const n=Ar.createTransformer(t),i=Rr(e),r=Rr(t);return i.numVars===r.numVars&&i.numColors===r.numColors&&i.numNumbers>=r.numNumbers?wi(Dr(i.values,r.values),n):(Bi(!0,`Complex values '${e}' and '${t}' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition.`),Ir(e,t))},Fr=(e,t,n)=>{const i=t-e;return 0===i?1:(n-e)/i},Ur=(e,t)=>n=>yr(e,t,n);function Br(e,t,n){const i=[],r=n||function(e){return"number"===typeof e?Ur:"string"===typeof e?vr.test(e)?Tr:Lr:Array.isArray(e)?Dr:"object"===typeof e?Mr:Ur}(e[0]),s=e.length-1;for(let o=0;o<s;o++){let n=r(e[o],e[o+1]);if(t){const e=Array.isArray(t)?t[o]||ai:t;n=wi(e,n)}i.push(n)}return i}function Vr(e,t){let{clamp:n=!0,ease:i,mixer:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=e.length;if(Vi(s===t.length,"Both input and output ranges must be the same length"),1===s)return()=>t[0];e[0]>e[s-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=Br(t,i,r),a=o.length,c=t=>{let n=0;if(a>1)for(;n<e.length-2&&!(t<e[n+1]);n++);const i=Fr(e[n],e[n+1],t);return o[n](i)};return n?t=>c(fn(e[0],e[s-1],t)):c}function qr(e){const t=[0];return function(e,t){const n=e[e.length-1];for(let i=1;i<=t;i++){const r=Fr(0,t,i);e.push(yr(n,1,r))}}(t,e.length-1),t}function zr(e){let{duration:t=300,keyframes:n,times:i,ease:r="easeInOut"}=e;const s=(e=>Array.isArray(e)&&"number"!==typeof e[0])(r)?r.map(ur):ur(r),o={done:!1,value:n[0]},a=function(e,t){return e.map(e=>e*t)}(i&&i.length===n.length?i:qr(n),t),c=Vr(a,n,{ease:Array.isArray(s)?s:(l=n,u=s,l.map(()=>u||er).splice(0,l.length-1))});var l,u;return{calculatedDuration:t,next:e=>(o.value=c(e),o.done=e>=t,o)}}function Hr(e,t){return t?e*(1e3/t):0}function Wr(e,t,n){const i=Math.max(t-5,0);return Hr(n-e(i),t-i)}const Kr=.001;function $r(e){let t,n,{duration:i=800,bounce:r=.25,velocity:s=0,mass:o=1}=e;Bi(i<=qi(10),"Spring duration must be 10 seconds or less");let a=1-r;a=fn(.05,1,a),i=fn(.01,10,zi(i)),a<1?(t=e=>{const t=e*a,n=t*i,r=t-s,o=Qr(e,a),c=Math.exp(-n);return Kr-r/o*c},n=e=>{const n=e*a*i,r=n*s+s,o=Math.pow(a,2)*Math.pow(e,2)*i,c=Math.exp(-n),l=Qr(Math.pow(e,2),a);return(-t(e)+Kr>0?-1:1)*((r-o)*c)/l}):(t=e=>Math.exp(-e*i)*((e-s)*i+1)-.001,n=e=>Math.exp(-e*i)*(i*i*(s-e)));const c=function(e,t,n){let i=n;for(let r=1;r<Gr;r++)i-=e(i)/t(i);return i}(t,n,5/i);if(i=qi(i),isNaN(c))return{stiffness:100,damping:10,duration:i};{const e=Math.pow(c,2)*o;return{stiffness:e,damping:2*a*Math.sqrt(o*e),duration:i}}}const Gr=12;function Qr(e,t){return e*Math.sqrt(1-t*t)}const Jr=["duration","bounce"],Yr=["stiffness","damping","mass"];function Xr(e,t){return t.some(t=>void 0!==e[t])}function Zr(e){let{keyframes:t,restDelta:n,restSpeed:i,...r}=e;const s=t[0],o=t[t.length-1],a={done:!1,value:s},{stiffness:c,damping:l,mass:u,duration:d,velocity:h,isResolvedFromDuration:p}=function(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!Xr(e,Yr)&&Xr(e,Jr)){const n=$r(e);t={...t,...n,mass:1},t.isResolvedFromDuration=!0}return t}({...r,velocity:-zi(r.velocity||0)}),f=h||0,m=l/(2*Math.sqrt(c*u)),g=o-s,v=zi(Math.sqrt(c/u)),y=Math.abs(g)<5;let b;if(i||(i=y?.01:2),n||(n=y?.005:.5),m<1){const e=Qr(v,m);b=t=>{const n=Math.exp(-m*v*t);return o-n*((f+m*v*g)/e*Math.sin(e*t)+g*Math.cos(e*t))}}else if(1===m)b=e=>o-Math.exp(-v*e)*(g+(f+v*g)*e);else{const e=v*Math.sqrt(m*m-1);b=t=>{const n=Math.exp(-m*v*t),i=Math.min(e*t,300);return o-n*((f+m*v*g)*Math.sinh(i)+e*g*Math.cosh(i))/e}}return{calculatedDuration:p&&d||null,next:e=>{const t=b(e);if(p)a.done=e>=d;else{let r=f;0!==e&&(r=m<1?Wr(b,e,t):0);const s=Math.abs(r)<=i,c=Math.abs(o-t)<=n;a.done=s&&c}return a.value=a.done?o:t,a}}}function es(e){let{keyframes:t,velocity:n=0,power:i=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:o=500,modifyTarget:a,min:c,max:l,restDelta:u=.5,restSpeed:d}=e;const h=t[0],p={done:!1,value:h},f=e=>void 0===c?l:void 0===l||Math.abs(c-e)<Math.abs(l-e)?c:l;let m=i*n;const g=h+m,v=void 0===a?g:a(g);v!==g&&(m=v-h);const y=e=>-m*Math.exp(-e/r),b=e=>v+y(e),k=e=>{const t=y(e),n=b(e);p.done=Math.abs(t)<=u,p.value=p.done?v:n};let w,S;const T=e=>{(e=>void 0!==c&&e<c||void 0!==l&&e>l)(p.value)&&(w=e,S=Zr({keyframes:[p.value,f(p.value)],velocity:Wr(b,e,p.value),damping:s,stiffness:o,restDelta:u,restSpeed:d}))};return T(0),{calculatedDuration:null,next:e=>{let t=!1;return S||void 0!==w||(t=!0,k(e),T(e)),void 0!==w&&e>w?S.next(e-w):(!t&&k(e),p)}}}const ts=e=>{const t=t=>{let{timestamp:n}=t;return e(n)};return{start:()=>ui.update(t,!0),stop:()=>di(t),now:()=>hi.isProcessing?hi.timestamp:performance.now()}};function ns(e){let t=0;let n=e.next(t);for(;!n.done&&t<2e4;)t+=50,n=e.next(t);return t>=2e4?1/0:t}const is={decay:es,inertia:es,tween:zr,keyframes:zr,spring:Zr};function rs(e){let t,n,{autoplay:i=!0,delay:r=0,driver:s=ts,keyframes:o,type:a="keyframes",repeat:c=0,repeatDelay:l=0,repeatType:u="loop",onPlay:d,onStop:h,onComplete:p,onUpdate:f,...m}=e,g=1,v=!1;const y=()=>{n=new Promise(e=>{t=e})};let b;y();const k=is[a]||zr;let w;k!==zr&&"number"!==typeof o[0]&&(w=Vr([0,100],o,{clamp:!1}),o=[0,100]);const S=k({...m,keyframes:o});let T;"mirror"===u&&(T=k({...m,keyframes:[...o].reverse(),velocity:-(m.velocity||0)}));let C="idle",x=null,E=null,P=null;null===S.calculatedDuration&&c&&(S.calculatedDuration=ns(S));const{calculatedDuration:R}=S;let O=1/0,_=1/0;null!==R&&(O=R+l,_=O*(c+1)-l);let N=0;const A=e=>{if(null===E)return;g>0&&(E=Math.min(E,e)),g<0&&(E=Math.min(e-_/g,E)),N=null!==x?x:Math.round(e-E)*g;const t=N-r*(g>=0?1:-1),n=g>=0?t<0:t>_;N=Math.max(t,0),"finished"===C&&null===x&&(N=_);let i=N,s=S;if(c){const e=Math.min(N,_)/O;let t=Math.floor(e),n=e%1;!n&&e>=1&&(n=1),1===n&&t--,t=Math.min(t,c+1);Boolean(t%2)&&("reverse"===u?(n=1-n,l&&(n-=l/O)):"mirror"===u&&(s=T)),i=fn(0,1,n)*O}const a=n?{done:!1,value:o[0]}:s.next(i);w&&(a.value=w(a.value));let{done:d}=a;n||null===R||(d=g>=0?N>=_:N<=0);const h=null===x&&("finished"===C||"running"===C&&d);return f&&f(a.value),h&&D(),a},I=()=>{b&&b.stop(),b=void 0},j=()=>{C="idle",I(),t(),y(),E=P=null},D=()=>{C="finished",p&&p(),I(),t()},M=()=>{if(v)return;b||(b=s(A));const e=b.now();d&&d(),null!==x?E=e-x:E&&"finished"!==C||(E=e),"finished"===C&&y(),P=E,x=null,C="running",b.start()};i&&M();const L={then:(e,t)=>n.then(e,t),get time(){return zi(N)},set time(e){e=qi(e),N=e,null===x&&b&&0!==g?E=b.now()-e/g:x=e},get duration(){const e=null===S.calculatedDuration?ns(S):S.calculatedDuration;return zi(e)},get speed(){return g},set speed(e){e!==g&&b&&(g=e,L.time=zi(N))},get state(){return C},play:M,pause:()=>{C="paused",x=N},stop:()=>{v=!0,"idle"!==C&&(C="idle",h&&h(),j())},cancel:()=>{null!==P&&A(P),j()},complete:()=>{C="finished"},sample:e=>(E=0,A(e))};return L}const ss=function(e){let t;return()=>(void 0===t&&(t=e()),t)}(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),os=new Set(["opacity","clipPath","filter","transform","backgroundColor"]);function as(e,t,n){let{onUpdate:i,onComplete:r,...s}=n;if(!(ss()&&os.has(t)&&!s.repeatDelay&&"mirror"!==s.repeatType&&0!==s.damping&&"inertia"!==s.type))return!1;let o,a,c=!1,l=!1;const u=()=>{a=new Promise(e=>{o=e})};u();let{keyframes:d,duration:h=300,ease:p,times:f}=s;if(((e,t)=>"spring"===t.type||"backgroundColor"===e||!Ki(t.ease))(t,s)){const e=rs({...s,repeat:0,delay:0});let t={done:!1,value:d[0]};const n=[];let i=0;for(;!t.done&&i<2e4;)t=e.sample(i),n.push(t.value),i+=10;f=void 0,d=n,h=i-10,p="linear"}const m=function(e,t,n){let{delay:i=0,duration:r,repeat:s=0,repeatType:o="loop",ease:a,times:c}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const l={[t]:n};c&&(l.offset=c);const u=Qi(a);return Array.isArray(u)&&(l.easing=u),e.animate(l,{delay:i,duration:r,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:s+1,direction:"reverse"===o?"alternate":"normal"})}(e.owner.current,t,d,{...s,duration:h,ease:p,times:f}),g=()=>{l=!1,m.cancel()},v=()=>{l=!0,ui.update(g),o(),u()};m.onfinish=()=>{l||(e.set(function(e,t){let{repeat:n,repeatType:i="loop"}=t;return e[n&&"loop"!==i&&n%2===1?0:e.length-1]}(d,s)),r&&r(),v())};return{then:(e,t)=>a.then(e,t),attachTimeline:e=>(m.timeline=e,m.onfinish=null,ai),get time(){return zi(m.currentTime||0)},set time(e){m.currentTime=qi(e)},get speed(){return m.playbackRate},set speed(e){m.playbackRate=e},get duration(){return zi(h)},play:()=>{c||(m.play(),di(g))},pause:()=>m.pause(),stop:()=>{if(c=!0,"idle"===m.playState)return;const{currentTime:t}=m;if(t){const n=rs({...s,autoplay:!1});e.setWithVelocity(n.sample(t-10).value,n.sample(t).value,10)}v()},complete:()=>{l||m.finish()},cancel:v}}const cs={type:"spring",stiffness:500,damping:25,restSpeed:10},ls={type:"keyframes",duration:.8},us={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},ds=(e,t)=>{let{keyframes:n}=t;return n.length>2?ls:sn.has(e)?e.startsWith("scale")?{type:"spring",stiffness:550,damping:0===n[1]?2*Math.sqrt(550):30,restSpeed:10}:cs:us},hs=(e,t)=>"zIndex"!==e&&(!("number"!==typeof t&&!Array.isArray(t))||!("string"!==typeof t||!Ar.test(t)&&"0"!==t||t.startsWith("url("))),ps=new Set(["brightness","contrast","saturate","opacity"]);function fs(e){const[t,n]=e.slice(0,-1).split("(");if("drop-shadow"===t)return e;const[i]=n.match(bn)||[];if(!i)return e;const r=n.replace(i,"");let s=ps.has(t)?1:0;return i!==n&&(s*=100),t+"("+s+r+")"}const ms=/([a-z-]*)\(.*?\)/g,gs={...Ar,getAnimatableNone:e=>{const t=e.match(ms);return t?t.map(fs).join(" "):e}},vs={...Nn,color:vr,backgroundColor:vr,outlineColor:vr,fill:vr,stroke:vr,borderColor:vr,borderTopColor:vr,borderRightColor:vr,borderBottomColor:vr,borderLeftColor:vr,filter:gs,WebkitFilter:gs},ys=e=>vs[e];function bs(e,t){let n=ys(e);return n!==gs&&(n=Ar),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const ks=e=>/^0[^.\s]+$/.test(e);function ws(e){return"number"===typeof e?0===e:null!==e?"none"===e||"0"===e||ks(e):void 0}function Ss(e,t){return e[t]||e.default||e}const Ts=!1,Cs=function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return r=>{const s=Ss(i,e)||{},o=s.delay||i.delay||0;let{elapsed:a=0}=i;a-=qi(o);const c=function(e,t,n,i){const r=hs(t,n);let s;s=Array.isArray(n)?[...n]:[null,n];const o=void 0!==i.from?i.from:e.get();let a;const c=[];for(let l=0;l<s.length;l++)null===s[l]&&(s[l]=0===l?o:s[l-1]),ws(s[l])&&c.push(l),"string"===typeof s[l]&&"none"!==s[l]&&"0"!==s[l]&&(a=s[l]);if(r&&c.length&&a)for(let l=0;l<c.length;l++)s[c[l]]=bs(t,a);return s}(t,e,n,s),l=c[0],u=c[c.length-1],d=hs(e,l),h=hs(e,u);Bi(d===h,`You are trying to animate ${e} from "${l}" to "${u}". ${l} is not an animatable value - to enable this animation set ${l} to a value animatable to ${u} via the \`style\` property.`);let p={keyframes:c,velocity:t.getVelocity(),ease:"easeOut",...s,delay:-a,onUpdate:e=>{t.set(e),s.onUpdate&&s.onUpdate(e)},onComplete:()=>{r(),s.onComplete&&s.onComplete()}};if(function(e){let{when:t,delay:n,delayChildren:i,staggerChildren:r,staggerDirection:s,repeat:o,repeatType:a,repeatDelay:c,from:l,elapsed:u,...d}=e;return!!Object.keys(d).length}(s)||(p={...p,...ds(e,p)}),p.duration&&(p.duration=qi(p.duration)),p.repeatDelay&&(p.repeatDelay=qi(p.repeatDelay)),!d||!h||Hi||!1===s.type||Ts)return function(e){let{keyframes:t,delay:n,onUpdate:i,onComplete:r}=e;const s=()=>(i&&i(t[t.length-1]),r&&r(),{time:0,speed:1,duration:0,play:ai,pause:ai,stop:ai,then:e=>(e(),Promise.resolve()),cancel:ai,complete:ai});return n?rs({keyframes:[0,1],duration:0,delay:n,onComplete:s}):s()}(Hi?{...p,delay:0}:p);if(!i.isHandoff&&t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate){const n=as(t,e,p);if(n)return n}return rs(p)}};function xs(e){return Boolean(an(e)&&e.add)}const Es=e=>/^\-?\d*\.?\d+$/.test(e);function Ps(e,t){-1===e.indexOf(t)&&e.push(t)}function Rs(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}class Os{constructor(){this.subscriptions=[]}add(e){return Ps(this.subscriptions,e),()=>Rs(this.subscriptions,e)}notify(e,t,n){const i=this.subscriptions.length;if(i)if(1===i)this.subscriptions[0](e,t,n);else for(let r=0;r<i;r++){const i=this.subscriptions[r];i&&i(e,t,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const _s={current:void 0};class Ns{constructor(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var i;this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=function(e){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t.prev=t.current,t.current=e;const{delta:i,timestamp:r}=hi;t.lastUpdated!==r&&(t.timeDelta=i,t.lastUpdated=r,ui.postRender(t.scheduleVelocityCheck)),t.prev!==t.current&&t.events.change&&t.events.change.notify(t.current),t.events.velocityChange&&t.events.velocityChange.notify(t.getVelocity()),n&&t.events.renderRequest&&t.events.renderRequest.notify(t.current)},this.scheduleVelocityCheck=()=>ui.postRender(this.velocityCheck),this.velocityCheck=e=>{let{timestamp:t}=e;t!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=e,this.canTrackVelocity=(i=this.current,!isNaN(parseFloat(i))),this.owner=n.owner}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new Os);const n=this.events[e].add(t);return"change"===e?()=>{n(),ui.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t&&this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e,t)}setWithVelocity(e,t,n){this.set(t),this.prev=e,this.timeDelta=n}jump(e){this.updateAndNotify(e),this.prev=e,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return _s.current&&_s.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?Hr(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function As(e,t){return new Ns(e,t)}const Is=e=>t=>t.test(e),js=[mn,En,xn,Cn,Rn,Pn,{test:e=>"auto"===e,parse:e=>e}],Ds=e=>js.find(Is(e)),Ms=[...js,vr,Ar],Ls=e=>Ms.find(Is(e));function Fs(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,As(n))}function Us(e,t){const n=Ui(e,t);let{transitionEnd:i={},transition:r={},...s}=n?e.makeTargetAnimatable(n,!1):{};s={...s,...i};for(const o in s){Fs(e,o,ii(s[o]))}}function Bs(e,t){if(!t)return;return(t[e]||t.default||t).from}function Vs(e,t){let{protectedKeys:n,needsAnimating:i}=e;const r=n.hasOwnProperty(t)&&!0!==i[t];return i[t]=!1,r}function qs(e,t){const n=e.get();if(!Array.isArray(t))return n!==t;for(let i=0;i<t.length;i++)if(t[i]!==n)return!0}function zs(e,t){let{delay:n=0,transitionOverride:i,type:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{transition:s=e.getDefaultTransition(),transitionEnd:o,...a}=e.makeTargetAnimatable(t);const c=e.getValue("willChange");i&&(s=i);const l=[],u=r&&e.animationState&&e.animationState.getState()[r];for(const d in a){const t=e.getValue(d),i=a[d];if(!t||void 0===i||u&&Vs(u,d))continue;const r={delay:n,elapsed:0,...Ss(s||{},d)};if(window.HandoffAppearAnimations){const n=e.getProps()[Mt];if(n){const e=window.HandoffAppearAnimations(n,d,t,ui);null!==e&&(r.elapsed=e,r.isHandoff=!0)}}let o=!r.isHandoff&&!qs(t,i);if("spring"===r.type&&(t.getVelocity()||r.velocity)&&(o=!1),t.animation&&(o=!1),o)continue;t.start(Cs(d,t,i,e.shouldReduceMotion&&sn.has(d)?{type:!1}:r));const h=t.animation;xs(c)&&(c.add(d),h.then(()=>c.remove(d))),l.push(h)}return o&&Promise.all(l).then(()=>{o&&Us(e,o)}),l}function Hs(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=Ui(e,t,n.custom);let{transition:r=e.getDefaultTransition()||{}}=i||{};n.transitionOverride&&(r=n.transitionOverride);const s=i?()=>Promise.all(zs(e,i,n)):()=>Promise.resolve(),o=e.variantChildren&&e.variantChildren.size?function(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const{delayChildren:s=0,staggerChildren:o,staggerDirection:a}=r;return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5?arguments[5]:void 0;const o=[],a=(e.variantChildren.size-1)*i,c=1===r?function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)*i}:function(){return a-(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)*i};return Array.from(e.variantChildren).sort(Ws).forEach((e,i)=>{e.notify("AnimationStart",t),o.push(Hs(e,t,{...s,delay:n+c(i)}).then(()=>e.notify("AnimationComplete",t)))}),Promise.all(o)}(e,t,s+i,o,a,n)}:()=>Promise.resolve(),{when:a}=r;if(a){const[e,t]="beforeChildren"===a?[s,o]:[o,s];return e().then(()=>t())}return Promise.all([s(),o(n.delay)])}function Ws(e,t){return e.sortNodePosition(t)}const Ks=[...Bt].reverse(),$s=Bt.length;function Gs(e){return t=>Promise.all(t.map(t=>{let{animation:n,options:i}=t;return function(e,t){let n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e.notify("AnimationStart",t),Array.isArray(t)){const r=t.map(t=>Hs(e,t,i));n=Promise.all(r)}else if("string"===typeof t)n=Hs(e,t,i);else{const r="function"===typeof t?Ui(e,t,i.custom):t;n=Promise.all(zs(e,r,i))}return n.then(()=>e.notify("AnimationComplete",t))}(e,n,i)}))}function Qs(e){let t=Gs(e);const n={animate:Ys(!0),whileInView:Ys(),whileHover:Ys(),whileTap:Ys(),whileDrag:Ys(),whileFocus:Ys(),exit:Ys()};let i=!0;const r=(t,n)=>{const i=Ui(e,n);if(i){const{transition:e,transitionEnd:n,...r}=i;t={...t,...r,...n}}return t};function s(s,o){const a=e.getProps(),c=e.getVariantContext(!0)||{},l=[],u=new Set;let d={},h=1/0;for(let t=0;t<$s;t++){const p=Ks[t],f=n[p],m=void 0!==a[p]?a[p]:c[p],g=Ft(m),v=p===o?f.isActive:null;!1===v&&(h=t);let y=m===c[p]&&m!==a[p]&&g;if(y&&i&&e.manuallyAnimateOnMount&&(y=!1),f.protectedKeys={...d},!f.isActive&&null===v||!m&&!f.prevProp||Ut(m)||"boolean"===typeof m)continue;let b=Js(f.prevProp,m)||p===o&&f.isActive&&!y&&g||t>h&&g,k=!1;const w=Array.isArray(m)?m:[m];let S=w.reduce(r,{});!1===v&&(S={});const{prevResolvedValues:T={}}=f,C={...T,...S},x=e=>{b=!0,u.has(e)&&(k=!0,u.delete(e)),f.needsAnimating[e]=!0};for(const e in C){const t=S[e],n=T[e];if(d.hasOwnProperty(e))continue;let i=!1;i=ni(t)&&ni(n)?!Fi(t,n):t!==n,i?void 0!==t?x(e):u.add(e):void 0!==t&&u.has(e)?x(e):f.protectedKeys[e]=!0}f.prevProp=m,f.prevResolvedValues=S,f.isActive&&(d={...d,...S}),i&&e.blockInitialAnimation&&(b=!1),!b||y&&!k||l.push(...w.map(e=>({animation:e,options:{type:p,...s}})))}if(u.size){const t={};u.forEach(n=>{const i=e.getBaseTarget(n);void 0!==i&&(t[n]=i)}),l.push({animation:t})}let p=Boolean(l.length);return!i||!1!==a.initial&&a.initial!==a.animate||e.manuallyAnimateOnMount||(p=!1),i=!1,p?t(l):Promise.resolve()}return{animateChanges:s,setActive:function(t,i,r){var o;if(n[t].isActive===i)return Promise.resolve();null===(o=e.variantChildren)||void 0===o||o.forEach(e=>{var n;return null===(n=e.animationState)||void 0===n?void 0:n.setActive(t,i)}),n[t].isActive=i;const a=s(r,t);for(const e in n)n[e].protectedKeys={};return a},setAnimateFunction:function(n){t=n(e)},getState:()=>n}}function Js(e,t){return"string"===typeof t?t!==e:!!Array.isArray(t)&&!Fi(t,e)}function Ys(){return{isActive:arguments.length>0&&void 0!==arguments[0]&&arguments[0],protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}let Xs=0;const Zs={animation:{Feature:class extends Pi{constructor(e){super(e),e.animationState||(e.animationState=Qs(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();this.unmount(),Ut(e)&&(this.unmount=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){}}},exit:{Feature:class extends Pi{constructor(){super(...arguments),this.id=Xs++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t,custom:n}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;const r=this.node.animationState.setActive("exit",!e,{custom:null!==n&&void 0!==n?n:this.node.getProps().custom});t&&!e&&r.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}}},eo=(e,t)=>Math.abs(e-t);class to{constructor(e,t){let{transformPagePoint:n,contextWindow:i,dragSnapToOrigin:r=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!this.lastMoveEvent||!this.lastMoveEventInfo)return;const e=ro(this.lastMoveEventInfo,this.history),t=null!==this.startEvent,n=function(e,t){const n=eo(e.x,t.x),i=eo(e.y,t.y);return Math.sqrt(n**2+i**2)}(e.offset,{x:0,y:0})>=3;if(!t&&!n)return;const{point:i}=e,{timestamp:r}=hi;this.history.push({...i,timestamp:r});const{onStart:s,onMove:o}=this.handlers;t||(s&&s(this.lastMoveEvent,e),this.startEvent=this.lastMoveEvent),o&&o(this.lastMoveEvent,e)},this.handlePointerMove=(e,t)=>{this.lastMoveEvent=e,this.lastMoveEventInfo=no(t,this.transformPagePoint),ui.update(this.updatePoint,!0)},this.handlePointerUp=(e,t)=>{this.end();const{onEnd:n,onSessionEnd:i,resumeAnimation:r}=this.handlers;if(this.dragSnapToOrigin&&r&&r(),!this.lastMoveEvent||!this.lastMoveEventInfo)return;const s=ro("pointercancel"===e.type?this.lastMoveEventInfo:no(t,this.transformPagePoint),this.history);this.startEvent&&n&&n(e,s),i&&i(e,s)},!vi(e))return;this.dragSnapToOrigin=r,this.handlers=t,this.transformPagePoint=n,this.contextWindow=i||window;const s=no(yi(e),this.transformPagePoint),{point:o}=s,{timestamp:a}=hi;this.history=[{...o,timestamp:a}];const{onSessionStart:c}=t;c&&c(e,ro(s,this.history)),this.removeListeners=wi(bi(this.contextWindow,"pointermove",this.handlePointerMove),bi(this.contextWindow,"pointerup",this.handlePointerUp),bi(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),di(this.updatePoint)}}function no(e,t){return t?{point:t(e.point)}:e}function io(e,t){return{x:e.x-t.x,y:e.y-t.y}}function ro(e,t){let{point:n}=e;return{point:n,delta:io(n,oo(t)),offset:io(n,so(t)),velocity:ao(t,.1)}}function so(e){return e[0]}function oo(e){return e[e.length-1]}function ao(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,i=null;const r=oo(e);for(;n>=0&&(i=e[n],!(r.timestamp-i.timestamp>qi(t)));)n--;if(!i)return{x:0,y:0};const s=zi(r.timestamp-i.timestamp);if(0===s)return{x:0,y:0};const o={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function co(e){return e.max-e.min}function lo(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01;return Math.abs(e-t)<=n}function uo(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;e.origin=i,e.originPoint=yr(t.min,t.max,e.origin),e.scale=co(n)/co(t),(lo(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=yr(n.min,n.max,e.origin)-e.originPoint,(lo(e.translate)||isNaN(e.translate))&&(e.translate=0)}function ho(e,t,n,i){uo(e.x,t.x,n.x,i?i.originX:void 0),uo(e.y,t.y,n.y,i?i.originY:void 0)}function po(e,t,n){e.min=n.min+t.min,e.max=e.min+co(t)}function fo(e,t,n){e.min=t.min-n.min,e.max=e.min+co(t)}function mo(e,t,n){fo(e.x,t.x,n.x),fo(e.y,t.y,n.y)}function go(e,t,n){return{min:void 0!==t?e.min+t:void 0,max:void 0!==n?e.max+n-(e.max-e.min):void 0}}function vo(e,t){let n=t.min-e.min,i=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,i]=[i,n]),{min:n,max:i}}const yo=.35;function bo(e,t,n){return{min:ko(e,t),max:ko(e,n)}}function ko(e,t){return"number"===typeof e?e:e[t]||0}const wo=()=>({x:{min:0,max:0},y:{min:0,max:0}});function So(e){return[e("x"),e("y")]}function To(e){let{top:t,left:n,right:i,bottom:r}=e;return{x:{min:n,max:i},y:{min:t,max:r}}}function Co(e){return void 0===e||1===e}function xo(e){let{scale:t,scaleX:n,scaleY:i}=e;return!Co(t)||!Co(n)||!Co(i)}function Eo(e){return xo(e)||Po(e)||e.z||e.rotate||e.rotateX||e.rotateY}function Po(e){return Ro(e.x)||Ro(e.y)}function Ro(e){return e&&"0%"!==e}function Oo(e,t,n){return n+t*(e-n)}function _o(e,t,n,i,r){return void 0!==r&&(e=Oo(e,r,i)),Oo(e,n,i)+t}function No(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;e.min=_o(e.min,t,n,i,r),e.max=_o(e.max,t,n,i,r)}function Ao(e,t){let{x:n,y:i}=t;No(e.x,n.translate,n.scale,n.originPoint),No(e.y,i.translate,i.scale,i.originPoint)}function Io(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function jo(e,t){e.min=e.min+t,e.max=e.max+t}function Do(e,t,n){let[i,r,s]=n;const o=void 0!==t[s]?t[s]:.5,a=yr(e.min,e.max,o);No(e,t[i],t[r],a,t.scale)}const Mo=["x","scaleX","originX"],Lo=["y","scaleY","originY"];function Fo(e,t){Do(e.x,t,Mo),Do(e.y,t,Lo)}function Uo(e,t){return To(function(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),i=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:i.y,right:i.x}}(e.getBoundingClientRect(),t))}const Bo=e=>{let{current:t}=e;return t?t.ownerDocument.defaultView:null},Vo=new WeakMap;class qo{constructor(e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic={x:{min:0,max:0},y:{min:0,max:0}},this.visualElement=e}start(e){let{snapToCursor:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{presenceContext:n}=this.visualElement;if(n&&!1===n.isPresent)return;const{dragSnapToOrigin:i}=this.getProps();this.panSession=new to(e,{onSessionStart:e=>{const{dragSnapToOrigin:n}=this.getProps();n?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(yi(e,"page").point)},onStart:(e,t)=>{const{drag:n,dragPropagation:i,onDragStart:r}=this.getProps();if(n&&!i&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=xi(n),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),So(e=>{let t=this.getAxisMotionValue(e).get()||0;if(xn.test(t)){const{projection:n}=this.visualElement;if(n&&n.layout){const i=n.layout.layoutBox[e];if(i){t=co(i)*(parseFloat(t)/100)}}}this.originPoint[e]=t}),r&&ui.update(()=>r(e,t),!1,!0);const{animationState:s}=this.visualElement;s&&s.setActive("whileDrag",!0)},onMove:(e,t)=>{const{dragPropagation:n,dragDirectionLock:i,onDirectionLock:r,onDrag:s}=this.getProps();if(!n&&!this.openGlobalLock)return;const{offset:o}=t;if(i&&null===this.currentDirection)return this.currentDirection=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=null;Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x");return n}(o),void(null!==this.currentDirection&&r&&r(this.currentDirection));this.updateAxis("x",t.point,o),this.updateAxis("y",t.point,o),this.visualElement.render(),s&&s(e,t)},onSessionEnd:(e,t)=>this.stop(e,t),resumeAnimation:()=>So(e=>{var t;return"paused"===this.getAnimationState(e)&&(null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.play())})},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:i,contextWindow:Bo(this.visualElement)})}stop(e,t){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:i}=t;this.startAnimation(i);const{onDragEnd:r}=this.getProps();r&&ui.update(()=>r(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,n){const{drag:i}=this.getProps();if(!n||!zo(e,i,this.currentDirection))return;const r=this.getAxisMotionValue(e);let s=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(s=function(e,t,n){let{min:i,max:r}=t;return void 0!==i&&e<i?e=n?yr(i,e,n.min):Math.max(e,i):void 0!==r&&e>r&&(e=n?yr(r,e,n.max):Math.min(e,r)),e}(s,this.constraints[e],this.elastic[e])),r.set(s)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:n}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):null===(e=this.visualElement.projection)||void 0===e?void 0:e.layout,r=this.constraints;t&&Lt(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):this.constraints=!(!t||!i)&&function(e,t){let{top:n,left:i,bottom:r,right:s}=t;return{x:go(e.x,i,s),y:go(e.y,n,r)}}(i.layoutBox,t),this.elastic=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yo;return!1===e?e=0:!0===e&&(e=yo),{x:bo(e,"left","right"),y:bo(e,"top","bottom")}}(n),r!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&So(e=>{this.getAxisMotionValue(e)&&(this.constraints[e]=function(e,t){const n={};return void 0!==t.min&&(n.min=t.min-e.min),void 0!==t.max&&(n.max=t.max-e.min),n}(i.layoutBox[e],this.constraints[e]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Lt(e))return!1;const n=e.current;Vi(null!==n,"If `dragConstraints` is set as a React ref, that ref must be passed to another component's `ref` prop.");const{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const r=function(e,t,n){const i=Uo(e,n),{scroll:r}=t;return r&&(jo(i.x,r.offset.x),jo(i.y,r.offset.y)),i}(n,i.root,this.visualElement.getTransformPagePoint());let s=function(e,t){return{x:vo(e.x,t.x),y:vo(e.y,t.y)}}(i.layout.layoutBox,r);if(t){const e=t(function(e){let{x:t,y:n}=e;return{top:n.min,right:t.max,bottom:n.max,left:t.min}}(s));this.hasMutatedConstraints=!!e,e&&(s=To(e))}return s}startAnimation(e){const{drag:t,dragMomentum:n,dragElastic:i,dragTransition:r,dragSnapToOrigin:s,onDragTransitionEnd:o}=this.getProps(),a=this.constraints||{},c=So(o=>{if(!zo(o,t,this.currentDirection))return;let c=a&&a[o]||{};s&&(c={min:0,max:0});const l=i?200:1e6,u=i?40:1e7,d={type:"inertia",velocity:n?e[o]:0,bounceStiffness:l,bounceDamping:u,timeConstant:750,restDelta:1,restSpeed:10,...r,...c};return this.startAxisValueAnimation(o,d)});return Promise.all(c).then(o)}startAxisValueAnimation(e,t){const n=this.getAxisMotionValue(e);return n.start(Cs(e,n,0,t))}stopAnimation(){So(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){So(e=>{var t;return null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.pause()})}getAnimationState(e){var t;return null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.state}getAxisMotionValue(e){const t="_drag"+e.toUpperCase(),n=this.visualElement.getProps(),i=n[t];return i||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){So(t=>{const{drag:n}=this.getProps();if(!zo(t,n,this.currentDirection))return;const{projection:i}=this.visualElement,r=this.getAxisMotionValue(t);if(i&&i.layout){const{min:n,max:s}=i.layout.layoutBox[t];r.set(e[t]-yr(n,s,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:n}=this.visualElement;if(!Lt(t)||!n||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};So(e=>{const t=this.getAxisMotionValue(e);if(t){const n=t.get();i[e]=function(e,t){let n=.5;const i=co(e),r=co(t);return r>i?n=Fr(t.min,t.max-i,e.min):i>r&&(n=Fr(e.min,e.max-r,t.min)),fn(0,1,n)}({min:n,max:n},this.constraints[e])}});const{transformTemplate:r}=this.visualElement.getProps();this.visualElement.current.style.transform=r?r({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),So(t=>{if(!zo(t,e,null))return;const n=this.getAxisMotionValue(t),{min:r,max:s}=this.constraints[t];n.set(yr(r,s,i[t]))})}addListeners(){if(!this.visualElement.current)return;Vo.set(this.visualElement,this);const e=bi(this.visualElement.current,"pointerdown",e=>{const{drag:t,dragListener:n=!0}=this.getProps();t&&n&&this.start(e)}),t=()=>{const{dragConstraints:e}=this.getProps();Lt(e)&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,i=n.addEventListener("measure",t);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),t();const r=gi(window,"resize",()=>this.scalePositionWithinConstraints()),s=n.addEventListener("didUpdate",e=>{let{delta:t,hasLayoutChanged:n}=e;this.isDragging&&n&&(So(e=>{const n=this.getAxisMotionValue(e);n&&(this.originPoint[e]+=t[e].translate,n.set(n.get()+t[e].translate))}),this.visualElement.render())});return()=>{r(),e(),i(),s&&s()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:n=!1,dragPropagation:i=!1,dragConstraints:r=!1,dragElastic:s=yo,dragMomentum:o=!0}=e;return{...e,drag:t,dragDirectionLock:n,dragPropagation:i,dragConstraints:r,dragElastic:s,dragMomentum:o}}}function zo(e,t,n){return(!0===t||t===e)&&(null===n||n===e)}const Ho=e=>(t,n)=>{e&&ui.update(()=>e(t,n))};const Wo={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Ko(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const $o={correct:(e,t)=>{if(!t.target)return e;if("string"===typeof e){if(!En.test(e))return e;e=parseFloat(e)}return`${Ko(e,t.target.x)}% ${Ko(e,t.target.y)}%`}},Go={correct:(e,t)=>{let{treeScale:n,projectionDelta:i}=t;const r=e,s=Ar.parse(e);if(s.length>5)return r;const o=Ar.createTransformer(e),a="number"!==typeof s[0]?1:0,c=i.x.scale*n.x,l=i.y.scale*n.y;s[0+a]/=c,s[1+a]/=l;const u=yr(c,l,.5);return"number"===typeof s[2+a]&&(s[2+a]/=u),"number"===typeof s[3+a]&&(s[3+a]/=u),o(s)}};class Qo extends t.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n,layoutId:i}=this.props,{projection:r}=e;var s;s=Yo,Object.assign(nn,s),r&&(t.group&&t.group.add(r),n&&n.register&&i&&n.register(r),r.root.didUpdate(),r.addEventListener("animationComplete",()=>{this.safeToRemove()}),r.setOptions({...r.options,onExitComplete:()=>this.safeToRemove()})),Wo.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:n,drag:i,isPresent:r}=this.props,s=n.projection;return s?(s.isPresent=r,i||e.layoutDependency!==t||void 0===t?s.willUpdate():this.safeToRemove(),e.isPresent!==r&&(r?s.promote():s.relegate()||ui.postRender(()=>{const e=s.getStack();e&&e.members.length||this.safeToRemove()})),null):null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),queueMicrotask(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),n&&n.deregister&&n.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function Jo(e){const[n,i]=function(){const e=(0,t.useContext)(Nt);if(null===e)return[!0,null];const{isPresent:n,onExitComplete:i,register:r}=e,s=(0,t.useId)();return(0,t.useEffect)(()=>r(s),[]),!n&&i?[!1,()=>i&&i(s)]:[!0]}(),r=(0,t.useContext)(Gt);return t.createElement(Qo,{...e,layoutGroup:r,switchLayoutGroup:(0,t.useContext)(Qt),isPresent:n,safeToRemove:i})}const Yo={borderRadius:{...$o,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:$o,borderTopRightRadius:$o,borderBottomLeftRadius:$o,borderBottomRightRadius:$o,boxShadow:Go},Xo=["TopLeft","TopRight","BottomLeft","BottomRight"],Zo=Xo.length,ea=e=>"string"===typeof e?parseFloat(e):e,ta=e=>"number"===typeof e||En.test(e);function na(e,t){return void 0!==e[t]?e[t]:e.borderRadius}const ia=sa(0,.5,rr),ra=sa(.5,.95,ai);function sa(e,t,n){return i=>i<e?0:i>t?1:n(Fr(e,t,i))}function oa(e,t){e.min=t.min,e.max=t.max}function aa(e,t){oa(e.x,t.x),oa(e.y,t.y)}function ca(e,t,n,i,r){return e=Oo(e-=t,1/n,i),void 0!==r&&(e=Oo(e,1/r,i)),e}function la(e,t,n,i,r){let[s,o,a]=n;!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:e;xn.test(t)&&(t=parseFloat(t),t=yr(o.min,o.max,t/100)-o.min);if("number"!==typeof t)return;let a=yr(s.min,s.max,i);e===s&&(a-=t),e.min=ca(e.min,t,n,a,r),e.max=ca(e.max,t,n,a,r)}(e,t[s],t[o],t[a],t.scale,i,r)}const ua=["x","scaleX","originX"],da=["y","scaleY","originY"];function ha(e,t,n,i){la(e.x,t,ua,n?n.x:void 0,i?i.x:void 0),la(e.y,t,da,n?n.y:void 0,i?i.y:void 0)}function pa(e){return 0===e.translate&&1===e.scale}function fa(e){return pa(e.x)&&pa(e.y)}function ma(e,t){return Math.round(e.x.min)===Math.round(t.x.min)&&Math.round(e.x.max)===Math.round(t.x.max)&&Math.round(e.y.min)===Math.round(t.y.min)&&Math.round(e.y.max)===Math.round(t.y.max)}function ga(e){return co(e.x)/co(e.y)}class va{constructor(){this.members=[]}add(e){Ps(this.members,e),e.scheduleRender()}remove(e){if(Rs(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const e=this.members[this.members.length-1];e&&this.promote(e)}}relegate(e){const t=this.members.findIndex(t=>e===t);if(0===t)return!1;let n;for(let i=t;i>=0;i--){const e=this.members[i];if(!1!==e.isPresent){n=e;break}}return!!n&&(this.promote(n),!0)}promote(e,t){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,t&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;!1===i&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:n}=e;t.onExitComplete&&t.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function ya(e,t,n){let i="";const r=e.x.translate/t.x,s=e.y.translate/t.y;if((r||s)&&(i=`translate3d(${r}px, ${s}px, 0) `),1===t.x&&1===t.y||(i+=`scale(${1/t.x}, ${1/t.y}) `),n){const{rotate:e,rotateX:t,rotateY:r}=n;e&&(i+=`rotate(${e}deg) `),t&&(i+=`rotateX(${t}deg) `),r&&(i+=`rotateY(${r}deg) `)}const o=e.x.scale*t.x,a=e.y.scale*t.y;return 1===o&&1===a||(i+=`scale(${o}, ${a})`),i||"none"}const ba=(e,t)=>e.depth-t.depth;class ka{constructor(){this.children=[],this.isDirty=!1}add(e){Ps(this.children,e),this.isDirty=!0}remove(e){Rs(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(ba),this.isDirty=!1,this.children.forEach(e)}}const wa=["","X","Y","Z"],Sa={visibility:"hidden"};let Ta=0;const Ca={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function xa(e){let{attachResizeListener:t,defaultParent:n,measureScroll:i,checkIsScrollRoot:r,resetTransform:s}=e;return class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===n||void 0===n?void 0:n();this.id=Ta++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Ca.totalNodes=Ca.resolvedTargetDeltas=Ca.recalculatedProjection=0,this.nodes.forEach(Ra),this.nodes.forEach(Da),this.nodes.forEach(Ma),this.nodes.forEach(Oa),function(e){window.MotionDebug&&window.MotionDebug.record(e)}(Ca)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=e,this.root=t?t.root||t:this,this.path=t?[...t.path,t]:[],this.parent=t,this.depth=t?t.depth+1:0;for(let n=0;n<this.path.length;n++)this.path[n].shouldResetTransform=!0;this.root===this&&(this.nodes=new ka)}addEventListener(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new Os),this.eventHandlers.get(e).add(t)}notifyListeners(e){const t=this.eventHandlers.get(e);for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];t&&t.notify(...i)}hasListeners(e){return this.eventHandlers.has(e)}mount(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.root.hasTreeAnimated;if(this.instance)return;var i;this.isSVG=(i=e)instanceof SVGElement&&"svg"!==i.tagName,this.instance=e;const{layoutId:r,layout:s,visualElement:o}=this.options;if(o&&!o.current&&o.mount(e),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),n&&(s||r)&&(this.isLayoutDirty=!0),t){let n;const i=()=>this.root.updateBlockedByResize=!1;t(e,()=>{this.root.updateBlockedByResize=!0,n&&n(),n=function(e,t){const n=performance.now(),i=r=>{let{timestamp:s}=r;const o=s-n;o>=t&&(di(i),e(o-t))};return ui.read(i,!0),()=>di(i)}(i,250),Wo.hasAnimatedSinceResize&&(Wo.hasAnimatedSinceResize=!1,this.nodes.forEach(ja))})}r&&this.root.registerSharedNode(r,this),!1!==this.options.animate&&o&&(r||s)&&this.addEventListener("didUpdate",e=>{let{delta:t,hasLayoutChanged:n,hasRelativeTargetChanged:i,layout:r}=e;if(this.isTreeAnimationBlocked())return this.target=void 0,void(this.relativeTarget=void 0);const s=this.options.transition||o.getDefaultTransition()||qa,{onLayoutAnimationStart:a,onLayoutAnimationComplete:c}=o.getProps(),l=!this.targetLayout||!ma(this.targetLayout,r)||i,u=!n&&i;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||u||n&&(l||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(t,u);const e={...Ss(s,"layout"),onPlay:a,onComplete:c};(o.shouldReduceMotion||this.options.layoutRoot)&&(e.delay=0,e.type=!1),this.startAnimation(e)}else n||ja(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=r})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const e=this.getStack();e&&e.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,di(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(La),this.animationId++)}getTransformTemplate(){const{visualElement:e}=this.options;return e&&e.getProps().transformTemplate}willUpdate(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked())return void(this.options.onExitComplete&&this.options.onExitComplete());if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let r=0;r<this.path.length;r++){const e=this.path[r];e.shouldResetTransform=!0,e.updateScroll("snapshot"),e.options.layoutRoot&&e.willUpdate(!1)}const{layoutId:t,layout:n}=this.options;if(void 0===t&&!n)return;const i=this.getTransformTemplate();this.prevTransformTemplateValue=i?i(this.latestValues,""):void 0,this.updateSnapshot(),e&&this.notifyListeners("willUpdate")}update(){this.updateScheduled=!1;if(this.isUpdateBlocked())return this.unblockUpdate(),this.clearAllSnapshots(),void this.nodes.forEach(Na);this.isUpdating||this.nodes.forEach(Aa),this.isUpdating=!1,this.nodes.forEach(Ia),this.nodes.forEach(Ea),this.nodes.forEach(Pa),this.clearAllSnapshots();const e=performance.now();hi.delta=fn(0,1e3/60,e-hi.timestamp),hi.timestamp=e,hi.isProcessing=!0,pi.update.process(hi),pi.preRender.process(hi),pi.render.process(hi),hi.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(_a),this.sharedNodes.forEach(Fa)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,ui.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){ui.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){!this.snapshot&&this.instance&&(this.snapshot=this.measure())}updateLayout(){if(!this.instance)return;if(this.updateScroll(),(!this.options.alwaysMeasureLayout||!this.isLead())&&!this.isLayoutDirty)return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let n=0;n<this.path.length;n++){this.path[n].updateScroll()}const e=this.layout;this.layout=this.measure(!1),this.layoutCorrected={x:{min:0,max:0},y:{min:0,max:0}},this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:t}=this.options;t&&t.notify("LayoutMeasure",this.layout.layoutBox,e?e.layoutBox:void 0)}updateScroll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"measure",t=Boolean(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===e&&(t=!1),t&&(this.scroll={animationId:this.root.animationId,phase:e,isRoot:r(this.instance),offset:i(this.instance)})}resetTransform(){if(!s)return;const e=this.isLayoutDirty||this.shouldResetTransform,t=this.projectionDelta&&!fa(this.projectionDelta),n=this.getTransformTemplate(),i=n?n(this.latestValues,""):void 0,r=i!==this.prevTransformTemplateValue;e&&(t||Eo(this.latestValues)||r)&&(s(this.instance,i),this.shouldResetTransform=!1,this.scheduleRender())}measure(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=this.measurePageBox();let n=this.removeElementScroll(t);var i;return e&&(n=this.removeTransform(n)),Wa((i=n).x),Wa(i.y),{animationId:this.root.animationId,measuredBox:t,layoutBox:n,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:e}=this.options;if(!e)return{x:{min:0,max:0},y:{min:0,max:0}};const t=e.measureViewportBox(),{scroll:n}=this.root;return n&&(jo(t.x,n.offset.x),jo(t.y,n.offset.y)),t}removeElementScroll(e){const t={x:{min:0,max:0},y:{min:0,max:0}};aa(t,e);for(let n=0;n<this.path.length;n++){const i=this.path[n],{scroll:r,options:s}=i;if(i!==this.root&&r&&s.layoutScroll){if(r.isRoot){aa(t,e);const{scroll:n}=this.root;n&&(jo(t.x,-n.offset.x),jo(t.y,-n.offset.y))}jo(t.x,r.offset.x),jo(t.y,r.offset.y)}}return t}applyTransform(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n={x:{min:0,max:0},y:{min:0,max:0}};aa(n,e);for(let i=0;i<this.path.length;i++){const e=this.path[i];!t&&e.options.layoutScroll&&e.scroll&&e!==e.root&&Fo(n,{x:-e.scroll.offset.x,y:-e.scroll.offset.y}),Eo(e.latestValues)&&Fo(n,e.latestValues)}return Eo(this.latestValues)&&Fo(n,this.latestValues),n}removeTransform(e){const t={x:{min:0,max:0},y:{min:0,max:0}};aa(t,e);for(let n=0;n<this.path.length;n++){const e=this.path[n];if(!e.instance)continue;if(!Eo(e.latestValues))continue;xo(e.latestValues)&&e.updateSnapshot();const i=wo();aa(i,e.measurePageBox()),ha(t,e.latestValues,e.snapshot?e.snapshot.layoutBox:void 0,i)}return Eo(this.latestValues)&&ha(t,this.latestValues),t}setTargetDelta(e){this.targetDelta=e,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(e){this.options={...this.options,...e,crossfade:void 0===e.crossfade||e.crossfade}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==hi.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t;const n=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=n.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=n.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=n.isSharedProjectionDirty);const i=Boolean(this.resumingFrom)||this!==n;if(!(e||i&&this.isSharedProjectionDirty||this.isProjectionDirty||(null===(t=this.parent)||void 0===t?void 0:t.isProjectionDirty)||this.attemptToResolveRelativeTarget))return;const{layout:r,layoutId:s}=this.options;if(this.layout&&(r||s)){if(this.resolvedRelativeTargetAt=hi.timestamp,!this.targetDelta&&!this.relativeTarget){const e=this.getClosestProjectingParent();e&&e.layout&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget={x:{min:0,max:0},y:{min:0,max:0}},this.relativeTargetOrigin={x:{min:0,max:0},y:{min:0,max:0}},mo(this.relativeTargetOrigin,this.layout.layoutBox,e.layout.layoutBox),aa(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(this.relativeTarget||this.targetDelta){var o,a,c;if(this.target||(this.target={x:{min:0,max:0},y:{min:0,max:0}},this.targetWithTransforms={x:{min:0,max:0},y:{min:0,max:0}}),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),o=this.target,a=this.relativeTarget,c=this.relativeParent.target,po(o.x,a.x,c.x),po(o.y,a.y,c.y)):this.targetDelta?(Boolean(this.resumingFrom)?this.target=this.applyTransform(this.layout.layoutBox):aa(this.target,this.layout.layoutBox),Ao(this.target,this.targetDelta)):aa(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const e=this.getClosestProjectingParent();e&&Boolean(e.resumingFrom)===Boolean(this.resumingFrom)&&!e.options.layoutScroll&&e.target&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget={x:{min:0,max:0},y:{min:0,max:0}},this.relativeTargetOrigin={x:{min:0,max:0},y:{min:0,max:0}},mo(this.relativeTargetOrigin,this.target,e.target),aa(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Ca.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(this.parent&&!xo(this.parent.latestValues)&&!Po(this.parent.latestValues))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return Boolean((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var e;const t=this.getLead(),n=Boolean(this.resumingFrom)||this!==t;let i=!0;if((this.isProjectionDirty||(null===(e=this.parent)||void 0===e?void 0:e.isProjectionDirty))&&(i=!1),n&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(i=!1),this.resolvedRelativeTargetAt===hi.timestamp&&(i=!1),i)return;const{layout:r,layoutId:s}=this.options;if(this.isTreeAnimating=Boolean(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!r&&!s)return;aa(this.layoutCorrected,this.layout.layoutBox);const o=this.treeScale.x,a=this.treeScale.y;!function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=n.length;if(!r)return;let s,o;t.x=t.y=1;for(let a=0;a<r;a++){s=n[a],o=s.projectionDelta;const r=s.instance;r&&r.style&&"contents"===r.style.display||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Fo(e,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(t.x*=o.x.scale,t.y*=o.y.scale,Ao(e,o)),i&&Eo(s.latestValues)&&Fo(e,s.latestValues))}t.x=Io(t.x),t.y=Io(t.y)}(this.layoutCorrected,this.treeScale,this.path,n),!t.layout||t.target||1===this.treeScale.x&&1===this.treeScale.y||(t.target=t.layout.layoutBox);const{target:c}=t;if(!c)return void(this.projectionTransform&&(this.projectionDelta={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}},this.projectionTransform="none",this.scheduleRender()));this.projectionDelta||(this.projectionDelta={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}},this.projectionDeltaWithTransform={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}});const l=this.projectionTransform;ho(this.projectionDelta,this.layoutCorrected,c,this.latestValues),this.projectionTransform=ya(this.projectionDelta,this.treeScale),this.projectionTransform===l&&this.treeScale.x===o&&this.treeScale.y===a||(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",c)),Ca.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.options.scheduleRender&&this.options.scheduleRender(),e){const e=this.getStack();e&&e.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.snapshot,i=n?n.latestValues:{},r={...this.latestValues},s={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!t;const o={x:{min:0,max:0},y:{min:0,max:0}},a=(n?n.source:void 0)!==(this.layout?this.layout.source:void 0),c=this.getStack(),l=!c||c.members.length<=1,u=Boolean(a&&!l&&!0===this.options.crossfade&&!this.path.some(Va));let d;this.animationProgress=0,this.mixTargetDelta=t=>{const n=t/1e3;Ua(s.x,e.x,n),Ua(s.y,e.y,n),this.setTargetDelta(s),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(mo(o,this.layout.layoutBox,this.relativeParent.layout.layoutBox),function(e,t,n,i){Ba(e.x,t.x,n.x,i),Ba(e.y,t.y,n.y,i)}(this.relativeTarget,this.relativeTargetOrigin,o,n),d&&function(e,t){return e.x.min===t.x.min&&e.x.max===t.x.max&&e.y.min===t.y.min&&e.y.max===t.y.max}(this.relativeTarget,d)&&(this.isProjectionDirty=!1),d||(d={x:{min:0,max:0},y:{min:0,max:0}}),aa(d,this.relativeTarget)),a&&(this.animationValues=r,function(e,t,n,i,r,s){r?(e.opacity=yr(0,void 0!==n.opacity?n.opacity:1,ia(i)),e.opacityExit=yr(void 0!==t.opacity?t.opacity:1,0,ra(i))):s&&(e.opacity=yr(void 0!==t.opacity?t.opacity:1,void 0!==n.opacity?n.opacity:1,i));for(let o=0;o<Zo;o++){const r=`border${Xo[o]}Radius`;let s=na(t,r),a=na(n,r);void 0===s&&void 0===a||(s||(s=0),a||(a=0),0===s||0===a||ta(s)===ta(a)?(e[r]=Math.max(yr(ea(s),ea(a),i),0),(xn.test(a)||xn.test(s))&&(e[r]+="%")):e[r]=a)}(t.rotate||n.rotate)&&(e.rotate=yr(t.rotate||0,n.rotate||0,i))}(r,i,this.latestValues,n,u,l)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=n},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(e){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(di(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ui.update(()=>{Wo.hasAnimatedSinceResize=!0,this.currentAnimation=function(e,t,n){const i=an(e)?e:As(e);return i.start(Cs("",i,t,n)),i.animation}(0,1e3,{...e,onUpdate:t=>{this.mixTargetDelta(t),e.onUpdate&&e.onUpdate(t)},onComplete:()=>{e.onComplete&&e.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const e=this.getStack();e&&e.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(1e3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const e=this.getLead();let{targetWithTransforms:t,target:n,layout:i,latestValues:r}=e;if(t&&n&&i){if(this!==e&&this.layout&&i&&Ka(this.options.animationType,this.layout.layoutBox,i.layoutBox)){n=this.target||{x:{min:0,max:0},y:{min:0,max:0}};const t=co(this.layout.layoutBox.x);n.x.min=e.target.x.min,n.x.max=n.x.min+t;const i=co(this.layout.layoutBox.y);n.y.min=e.target.y.min,n.y.max=n.y.min+i}aa(t,n),Fo(t,r),ho(this.projectionDeltaWithTransform,this.layoutCorrected,t,r)}}registerSharedNode(e,t){this.sharedNodes.has(e)||this.sharedNodes.set(e,new va);this.sharedNodes.get(e).add(t);const n=t.options.initialPromotionConfig;t.promote({transition:n?n.transition:void 0,preserveFollowOpacity:n&&n.shouldPreserveFollowOpacity?n.shouldPreserveFollowOpacity(t):void 0})}isLead(){const e=this.getStack();return!e||e.lead===this}getLead(){var e;const{layoutId:t}=this.options;return t&&(null===(e=this.getStack())||void 0===e?void 0:e.lead)||this}getPrevLead(){var e;const{layoutId:t}=this.options;return t?null===(e=this.getStack())||void 0===e?void 0:e.prevLead:void 0}getStack(){const{layoutId:e}=this.options;if(e)return this.root.sharedNodes.get(e)}promote(){let{needsReset:e,transition:t,preserveFollowOpacity:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const i=this.getStack();i&&i.promote(this,n),e&&(this.projectionDelta=void 0,this.needsReset=!0),t&&this.setOptions({transition:t})}relegate(){const e=this.getStack();return!!e&&e.relegate(this)}resetRotation(){const{visualElement:e}=this.options;if(!e)return;let t=!1;const{latestValues:n}=e;if((n.rotate||n.rotateX||n.rotateY||n.rotateZ)&&(t=!0),!t)return;const i={};for(let r=0;r<wa.length;r++){const t="rotate"+wa[r];n[t]&&(i[t]=n[t],e.setStaticValue(t,0))}e.render();for(const r in i)e.setStaticValue(r,i[r]);e.scheduleRender()}getProjectionStyles(e){var t,n;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Sa;const i={visibility:""},r=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,i.opacity="",i.pointerEvents=ri(null===e||void 0===e?void 0:e.pointerEvents)||"",i.transform=r?r(this.latestValues,""):"none",i;const s=this.getLead();if(!this.projectionDelta||!this.layout||!s.target){const t={};return this.options.layoutId&&(t.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,t.pointerEvents=ri(null===e||void 0===e?void 0:e.pointerEvents)||""),this.hasProjected&&!Eo(this.latestValues)&&(t.transform=r?r({},""):"none",this.hasProjected=!1),t}const o=s.animationValues||s.latestValues;this.applyTransformsToTarget(),i.transform=ya(this.projectionDeltaWithTransform,this.treeScale,o),r&&(i.transform=r(o,i.transform));const{x:a,y:c}=this.projectionDelta;i.transformOrigin=`${100*a.origin}% ${100*c.origin}% 0`,s.animationValues?i.opacity=s===this?null!==(n=null!==(t=o.opacity)&&void 0!==t?t:this.latestValues.opacity)&&void 0!==n?n:1:this.preserveOpacity?this.latestValues.opacity:o.opacityExit:i.opacity=s===this?void 0!==o.opacity?o.opacity:"":void 0!==o.opacityExit?o.opacityExit:0;for(const l in nn){if(void 0===o[l])continue;const{correct:e,applyTo:t}=nn[l],n="none"===i.transform?o[l]:e(o[l],s);if(t){const e=t.length;for(let r=0;r<e;r++)i[t[r]]=n}else i[l]=n}return this.options.layoutId&&(i.pointerEvents=s===this?ri(null===e||void 0===e?void 0:e.pointerEvents)||"":"none"),i}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(e=>{var t;return null===(t=e.currentAnimation)||void 0===t?void 0:t.stop()}),this.root.nodes.forEach(Na),this.root.sharedNodes.clear()}}}function Ea(e){e.updateLayout()}function Pa(e){var t;const n=(null===(t=e.resumeFrom)||void 0===t?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&n&&e.hasListeners("didUpdate")){const{layoutBox:t,measuredBox:i}=e.layout,{animationType:r}=e.options,s=n.source!==e.layout.source;"size"===r?So(e=>{const i=s?n.measuredBox[e]:n.layoutBox[e],r=co(i);i.min=t[e].min,i.max=i.min+r}):Ka(r,n.layoutBox,t)&&So(i=>{const r=s?n.measuredBox[i]:n.layoutBox[i],o=co(t[i]);r.max=r.min+o,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[i].max=e.relativeTarget[i].min+o)});const o={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};ho(o,t,n.layoutBox);const a={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};s?ho(a,e.applyTransform(i,!0),n.measuredBox):ho(a,t,n.layoutBox);const c=!fa(o);let l=!1;if(!e.resumeFrom){const i=e.getClosestProjectingParent();if(i&&!i.resumeFrom){const{snapshot:r,layout:s}=i;if(r&&s){const o={x:{min:0,max:0},y:{min:0,max:0}};mo(o,n.layoutBox,r.layoutBox);const a={x:{min:0,max:0},y:{min:0,max:0}};mo(a,t,s.layoutBox),ma(o,a)||(l=!0),i.options.layoutRoot&&(e.relativeTarget=a,e.relativeTargetOrigin=o,e.relativeParent=i)}}}e.notifyListeners("didUpdate",{layout:t,snapshot:n,delta:a,layoutDelta:o,hasLayoutChanged:c,hasRelativeTargetChanged:l})}else if(e.isLead()){const{onExitComplete:t}=e.options;t&&t()}e.options.transition=void 0}function Ra(e){Ca.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=Boolean(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function Oa(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function _a(e){e.clearSnapshot()}function Na(e){e.clearMeasurements()}function Aa(e){e.isLayoutDirty=!1}function Ia(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function ja(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Da(e){e.resolveTargetDelta()}function Ma(e){e.calcProjection()}function La(e){e.resetRotation()}function Fa(e){e.removeLeadSnapshot()}function Ua(e,t,n){e.translate=yr(t.translate,0,n),e.scale=yr(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function Ba(e,t,n,i){e.min=yr(t.min,n.min,i),e.max=yr(t.max,n.max,i)}function Va(e){return e.animationValues&&void 0!==e.animationValues.opacityExit}const qa={duration:.45,ease:[.4,0,.1,1]},za=e=>"undefined"!==typeof navigator&&navigator.userAgent.toLowerCase().includes(e),Ha=za("applewebkit/")&&!za("chrome/")?Math.round:ai;function Wa(e){e.min=Ha(e.min),e.max=Ha(e.max)}function Ka(e,t,n){return"position"===e||"preserve-aspect"===e&&!lo(ga(t),ga(n),.2)}const $a=xa({attachResizeListener:(e,t)=>gi(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Ga={current:void 0},Qa=xa({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!Ga.current){const e=new $a({});e.mount(window),e.setOptions({layoutScroll:!0}),Ga.current=e}return Ga.current},resetTransform:(e,t)=>{e.style.transform=void 0!==t?t:"none"},checkIsScrollRoot:e=>Boolean("fixed"===window.getComputedStyle(e).position)}),Ja={pan:{Feature:class extends Pi{constructor(){super(...arguments),this.removePointerDownListener=ai}onPointerDown(e){this.session=new to(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Bo(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:n,onPanEnd:i}=this.node.getProps();return{onSessionStart:Ho(e),onStart:Ho(t),onMove:n,onEnd:(e,t)=>{delete this.session,i&&ui.update(()=>i(e,t))}}}mount(){this.removePointerDownListener=bi(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}},drag:{Feature:class extends Pi{constructor(e){super(e),this.removeGroupControls=ai,this.removeListeners=ai,this.controls=new qo(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ai}unmount(){this.removeGroupControls(),this.removeListeners()}},ProjectionNode:Qa,MeasureLayout:Jo}},Ya=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function Xa(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;Vi(n<=4,`Max CSS variable fallback depth detected in property "${e}". This may indicate a circular fallback dependency.`);const[i,r]=function(e){const t=Ya.exec(e);if(!t)return[,];const[,n,i]=t;return[n,i]}(e);if(!i)return;const s=window.getComputedStyle(t).getPropertyValue(i);if(s){const e=s.trim();return Es(e)?parseFloat(e):e}return hn(r)?Xa(r,t,n+1):r}const Za=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),ec=e=>Za.has(e),tc=e=>e===mn||e===En,nc=(e,t)=>parseFloat(e.split(", ")[t]),ic=(e,t)=>(n,i)=>{let{transform:r}=i;if("none"===r||!r)return 0;const s=r.match(/^matrix3d\((.+)\)$/);if(s)return nc(s[1],t);{const t=r.match(/^matrix\((.+)\)$/);return t?nc(t[1],e):0}},rc=new Set(["x","y","z"]),sc=rn.filter(e=>!rc.has(e));const oc={width:(e,t)=>{let{x:n}=e,{paddingLeft:i="0",paddingRight:r="0"}=t;return n.max-n.min-parseFloat(i)-parseFloat(r)},height:(e,t)=>{let{y:n}=e,{paddingTop:i="0",paddingBottom:r="0"}=t;return n.max-n.min-parseFloat(i)-parseFloat(r)},top:(e,t)=>{let{top:n}=t;return parseFloat(n)},left:(e,t)=>{let{left:n}=t;return parseFloat(n)},bottom:(e,t)=>{let{y:n}=e,{top:i}=t;return parseFloat(i)+(n.max-n.min)},right:(e,t)=>{let{x:n}=e,{left:i}=t;return parseFloat(i)+(n.max-n.min)},x:ic(4,13),y:ic(5,14)};oc.translateX=oc.x,oc.translateY=oc.y;const ac=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};t={...t},i={...i};const r=Object.keys(t).filter(ec);let s=[],o=!1;const a=[];if(r.forEach(r=>{const c=e.getValue(r);if(!e.hasValue(r))return;let l=n[r],u=Ds(l);const d=t[r];let h;if(ni(d)){const e=d.length,t=null===d[0]?1:0;l=d[t],u=Ds(l);for(let n=t;n<e&&null!==d[n];n++)h?Vi(Ds(d[n])===h,"All keyframes must be of the same type"):(h=Ds(d[n]),Vi(h===u||tc(u)&&tc(h),"Keyframes must be of the same dimension as the current value"))}else h=Ds(d);if(u!==h)if(tc(u)&&tc(h)){const e=c.get();"string"===typeof e&&c.set(parseFloat(e)),"string"===typeof d?t[r]=parseFloat(d):Array.isArray(d)&&h===En&&(t[r]=d.map(parseFloat))}else(null===u||void 0===u?void 0:u.transform)&&(null===h||void 0===h?void 0:h.transform)&&(0===l||0===d)?0===l?c.set(h.transform(l)):t[r]=u.transform(d):(o||(s=function(e){const t=[];return sc.forEach(n=>{const i=e.getValue(n);void 0!==i&&(t.push([n,i.get()]),i.set(n.startsWith("scale")?1:0))}),t.length&&e.render(),t}(e),o=!0),a.push(r),i[r]=void 0!==i[r]?i[r]:t[r],c.jump(d))}),a.length){const n=a.indexOf("height")>=0?window.pageYOffset:null,r=((e,t,n)=>{const i=t.measureViewportBox(),r=t.current,s=getComputedStyle(r),{display:o}=s,a={};"none"===o&&t.setStaticValue("display",e.display||"block"),n.forEach(e=>{a[e]=oc[e](i,s)}),t.render();const c=t.measureViewportBox();return n.forEach(n=>{const i=t.getValue(n);i&&i.jump(a[n]),e[n]=oc[n](c,s)}),e})(t,e,a);return s.length&&s.forEach(t=>{let[n,i]=t;e.getValue(n).set(i)}),e.render(),At&&null!==n&&window.scrollTo({top:n}),{target:r,transitionEnd:i}}return{target:t,transitionEnd:i}};function cc(e,t,n,i){return(e=>Object.keys(e).some(ec))(t)?ac(e,t,n,i):{target:t,transitionEnd:i}}const lc=(e,t,n,i)=>{const r=function(e,t,n){let{...i}=t;const r=e.current;if(!(r instanceof Element))return{target:i,transitionEnd:n};n&&(n={...n}),e.values.forEach(e=>{const t=e.get();if(!hn(t))return;const n=Xa(t,r);n&&e.set(n)});for(const s in i){const e=i[s];if(!hn(e))continue;const t=Xa(e,r);t&&(i[s]=t,n||(n={}),void 0===n[s]&&(n[s]=e))}return{target:i,transitionEnd:n}}(e,t,i);return cc(e,t=r.target,n,i=r.transitionEnd)},uc={current:null},dc={current:!1};const hc=new WeakMap,pc=Object.keys($t),fc=pc.length,mc=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],gc=Vt.length;class vc{constructor(e){let{parent:t,props:n,presenceContext:i,reducedMotionConfig:r,visualState:s}=e,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>ui.render(this.render,!1,!0);const{latestValues:a,renderState:c}=s;this.latestValues=a,this.baseTarget={...a},this.initialValues=n.initial?{...a}:{},this.renderState=c,this.parent=t,this.props=n,this.presenceContext=i,this.depth=t?t.depth+1:0,this.reducedMotionConfig=r,this.options=o,this.isControllingVariants=qt(n),this.isVariantNode=zt(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=Boolean(t&&t.current);const{willChange:l,...u}=this.scrapeMotionValuesFromProps(n,{});for(const d in u){const e=u[d];void 0!==a[d]&&an(e)&&(e.set(a[d],!1),xs(l)&&l.add(d))}}scrapeMotionValuesFromProps(e,t){return{}}mount(e){this.current=e,hc.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((e,t)=>this.bindToMotionValue(t,e)),dc.current||function(){if(dc.current=!0,At)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>uc.current=e.matches;e.addListener(t),t()}else uc.current=!1}(),this.shouldReduceMotion="never"!==this.reducedMotionConfig&&("always"===this.reducedMotionConfig||uc.current),this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){hc.delete(this.current),this.projection&&this.projection.unmount(),di(this.notifyUpdate),di(this.render),this.valueSubscriptions.forEach(e=>e()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features)this.features[e].unmount();this.current=null}bindToMotionValue(e,t){const n=sn.has(e),i=t.on("change",t=>{this.latestValues[e]=t,this.props.onUpdate&&ui.update(this.notifyUpdate,!1,!0),n&&this.projection&&(this.projection.isTransformDirty=!0)}),r=t.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(e,()=>{i(),r()})}sortNodePosition(e){return this.current&&this.sortInstanceNodePosition&&this.type===e.type?this.sortInstanceNodePosition(this.current,e.current):0}loadFeatures(e,t,n,i){let r,s,{children:o,...a}=e;for(let c=0;c<fc;c++){const e=pc[c],{isEnabled:t,Feature:n,ProjectionNode:i,MeasureLayout:o}=$t[e];i&&(r=i),t(a)&&(!this.features[e]&&n&&(this.features[e]=new n(this)),o&&(s=o))}if(("html"===this.type||"svg"===this.type)&&!this.projection&&r){this.projection=new r(this.latestValues,this.parent&&this.parent.projection);const{layoutId:e,layout:t,drag:n,dragConstraints:s,layoutScroll:o,layoutRoot:c}=a;this.projection.setOptions({layoutId:e,layout:t,alwaysMeasureLayout:Boolean(n)||s&&Lt(s),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:"string"===typeof t?t:"both",initialPromotionConfig:i,layoutScroll:o,layoutRoot:c})}return s}updateFeatures(){for(const e in this.features){const t=this.features[e];t.isMounted?t.update():(t.mount(),t.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):{x:{min:0,max:0},y:{min:0,max:0}}}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}makeTargetAnimatable(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.makeTargetAnimatableFromInstance(e,this.props,t)}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let n=0;n<mc.length;n++){const t=mc[n];this.propEventSubscriptions[t]&&(this.propEventSubscriptions[t](),delete this.propEventSubscriptions[t]);const i=e["on"+t];i&&(this.propEventSubscriptions[t]=this.on(t,i))}this.prevMotionValues=function(e,t,n){const{willChange:i}=t;for(const r in t){const s=t[r],o=n[r];if(an(s))e.addValue(r,s),xs(i)&&i.add(r);else if(an(o))e.addValue(r,As(s,{owner:e})),xs(i)&&i.remove(r);else if(o!==s)if(e.hasValue(r)){const t=e.getValue(r);!t.hasAnimated&&t.set(s)}else{const t=e.getStaticValue(r);e.addValue(r,As(void 0!==t?t:s,{owner:e}))}}for(const r in n)void 0===t[r]&&e.removeValue(r);return t}(this,this.scrapeMotionValuesFromProps(e,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const e=this.parent&&this.parent.getVariantContext()||{};return void 0!==this.props.initial&&(e.initial=this.props.initial),e}const e={};for(let t=0;t<gc;t++){const n=Vt[t],i=this.props[n];(Ft(i)||!1===i)&&(e[n]=i)}return e}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){t!==this.values.get(e)&&(this.removeValue(e),this.bindToMotionValue(e,t)),this.values.set(e,t),this.latestValues[e]=t.get()}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return void 0===n&&void 0!==t&&(n=As(t,{owner:this}),this.addValue(e,n)),n}readValue(e){var t;return void 0===this.latestValues[e]&&this.current?null!==(t=this.getBaseTargetFromProps(this.props,e))&&void 0!==t?t:this.readValueFromInstance(this.current,e,this.options):this.latestValues[e]}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:n}=this.props,i="string"===typeof n||"object"===typeof n?null===(t=ei(this.props,n))||void 0===t?void 0:t[e]:void 0;if(n&&void 0!==i)return i;const r=this.getBaseTargetFromProps(this.props,e);return void 0===r||an(r)?void 0!==this.initialValues[e]&&void 0===i?void 0:this.baseTarget[e]:r}on(e,t){return this.events[e]||(this.events[e]=new Os),this.events[e].add(t)}notify(e){if(this.events[e]){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.events[e].notify(...n)}}}class yc extends vc{sortInstanceNodePosition(e,t){return 2&e.compareDocumentPosition(t)?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,t){let{vars:n,style:i}=t;delete n[e],delete i[e]}makeTargetAnimatableFromInstance(e,t,n){let{transition:i,transitionEnd:r,...s}=e,{transformValues:o}=t,a=function(e,t,n){const i={};for(const r in e){const e=Bs(r,t);if(void 0!==e)i[r]=e;else{const e=n.getValue(r);e&&(i[r]=e.get())}}return i}(s,i||{},this);if(o&&(r&&(r=o(r)),s&&(s=o(s)),a&&(a=o(a))),n){!function(e,t,n){var i,r;const s=Object.keys(t).filter(t=>!e.hasValue(t)),o=s.length;if(o)for(let a=0;a<o;a++){const o=s[a],c=t[o];let l=null;Array.isArray(c)&&(l=c[0]),null===l&&(l=null!==(r=null!==(i=n[o])&&void 0!==i?i:e.readValue(o))&&void 0!==r?r:t[o]),void 0!==l&&null!==l&&("string"===typeof l&&(Es(l)||ks(l))?l=parseFloat(l):!Ls(l)&&Ar.test(c)&&(l=bs(o,c)),e.addValue(o,As(l,{owner:e})),void 0===n[o]&&(n[o]=l),null!==l&&e.setBaseTarget(o,l))}}(this,s,a);const e=lc(this,s,a,r);r=e.transitionEnd,s=e.target}return{transition:i,transitionEnd:r,...s}}}class bc extends yc{constructor(){super(...arguments),this.type="html"}readValueFromInstance(e,t){if(sn.has(t)){const e=ys(t);return e&&e.default||0}{const i=(n=e,window.getComputedStyle(n)),r=(dn(t)?i.getPropertyValue(t):i[t])||0;return"string"===typeof r?r.trim():r}var n}measureInstanceViewportBox(e,t){let{transformPagePoint:n}=t;return Uo(e,n)}build(e,t,n,i){An(e,t,n,i.transformTemplate)}scrapeMotionValuesFromProps(e,t){return Xn(e,t)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;an(e)&&(this.childSubscription=e.on("change",e=>{this.current&&(this.current.textContent=`${e}`)}))}renderInstance(e,t,n,i){Qn(e,t,n,i)}}class kc extends yc{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(sn.has(t)){const e=ys(t);return e&&e.default||0}return t=Jn.has(t)?t:Dt(t),e.getAttribute(t)}measureInstanceViewportBox(){return{x:{min:0,max:0},y:{min:0,max:0}}}scrapeMotionValuesFromProps(e,t){return Zn(e,t)}build(e,t,n,i){Hn(e,t,n,this.isSVGTag,i.transformTemplate)}renderInstance(e,t,n,i){Yn(e,t,0,i)}mount(e){this.isSVGTag=Kn(e.tagName),super.mount(e)}}const wc=(e,t)=>tn(e)?new kc(t,{enableHardwareAcceleration:!1}):new bc(t,{enableHardwareAcceleration:!0}),Sc={...Zs,...Li,...Ja,...{layout:{ProjectionNode:Qa,MeasureLayout:Jo}}},Tc=Zt((e,t)=>function(e,t,n,i){let{forwardMotionProps:r=!1}=t;return{...tn(e)?fi:mi,preloadedFeatures:n,useRender:Gn(r),createVisualElement:i,Component:e}}(e,t,Sc,wc));var Cc={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const xc=(e,n)=>{const i=(0,t.forwardRef)((i,r)=>{let{color:s="currentColor",size:o=24,strokeWidth:a=2,absoluteStrokeWidth:c,className:l="",children:u,...d}=i;return(0,t.createElement)("svg",{ref:r,...Cc,width:o,height:o,stroke:s,strokeWidth:c?24*Number(a)/Number(o):a,className:["lucide",`lucide-${h=e,h.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim()}`,l].join(" "),...d},[...n.map(e=>{let[n,i]=e;return(0,t.createElement)(n,i)}),...Array.isArray(u)?u:[u]]);var h});return i.displayName=`${e}`,i},Ec=xc("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),Pc=xc("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),Rc=xc("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Oc=xc("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),_c=xc("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),Nc=xc("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),Ac=xc("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]),Ic=xc("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),jc=xc("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),Dc=xc("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),Mc=xc("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Lc=xc("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);function Fc(e,t){return function(){return e.apply(t,arguments)}}const{toString:Uc}=Object.prototype,{getPrototypeOf:Bc}=Object,{iterator:Vc,toStringTag:qc}=Symbol,zc=(Hc=Object.create(null),e=>{const t=Uc.call(e);return Hc[t]||(Hc[t]=t.slice(8,-1).toLowerCase())});var Hc;const Wc=e=>(e=e.toLowerCase(),t=>zc(t)===e),Kc=e=>t=>typeof t===e,{isArray:$c}=Array,Gc=Kc("undefined");function Qc(e){return null!==e&&!Gc(e)&&null!==e.constructor&&!Gc(e.constructor)&&Xc(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Jc=Wc("ArrayBuffer");const Yc=Kc("string"),Xc=Kc("function"),Zc=Kc("number"),el=e=>null!==e&&"object"===typeof e,tl=e=>{if("object"!==zc(e))return!1;const t=Bc(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(qc in e)&&!(Vc in e)},nl=Wc("Date"),il=Wc("File"),rl=Wc("Blob"),sl=Wc("FileList"),ol=Wc("URLSearchParams"),[al,cl,ll,ul]=["ReadableStream","Request","Response","Headers"].map(Wc);function dl(e,t){let n,i,{allOwnKeys:r=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),$c(e))for(n=0,i=e.length;n<i;n++)t.call(null,e[n],n,e);else{if(Qc(e))return;const i=r?Object.getOwnPropertyNames(e):Object.keys(e),s=i.length;let o;for(n=0;n<s;n++)o=i[n],t.call(null,e[o],o,e)}}function hl(e,t){if(Qc(e))return null;t=t.toLowerCase();const n=Object.keys(e);let i,r=n.length;for(;r-- >0;)if(i=n[r],t===i.toLowerCase())return i;return null}const pl="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,fl=e=>!Gc(e)&&e!==pl;const ml=(gl="undefined"!==typeof Uint8Array&&Bc(Uint8Array),e=>gl&&e instanceof gl);var gl;const vl=Wc("HTMLFormElement"),yl=(e=>{let{hasOwnProperty:t}=e;return(e,n)=>t.call(e,n)})(Object.prototype),bl=Wc("RegExp"),kl=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),i={};dl(n,(n,r)=>{let s;!1!==(s=t(n,r,e))&&(i[r]=s||n)}),Object.defineProperties(e,i)};const wl=Wc("AsyncFunction"),Sl=((e,t)=>{return e?setImmediate:t?(n=`axios@${Math.random()}`,i=[],pl.addEventListener("message",e=>{let{source:t,data:r}=e;t===pl&&r===n&&i.length&&i.shift()()},!1),e=>{i.push(e),pl.postMessage(n,"*")}):e=>setTimeout(e);var n,i})("function"===typeof setImmediate,Xc(pl.postMessage)),Tl="undefined"!==typeof queueMicrotask?queueMicrotask.bind(pl):"undefined"!==typeof process&&process.nextTick||Sl,Cl={isArray:$c,isArrayBuffer:Jc,isBuffer:Qc,isFormData:e=>{let t;return e&&("function"===typeof FormData&&e instanceof FormData||Xc(e.append)&&("formdata"===(t=zc(e))||"object"===t&&Xc(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&Jc(e.buffer),t},isString:Yc,isNumber:Zc,isBoolean:e=>!0===e||!1===e,isObject:el,isPlainObject:tl,isEmptyObject:e=>{if(!el(e)||Qc(e))return!1;try{return 0===Object.keys(e).length&&Object.getPrototypeOf(e)===Object.prototype}catch(r){return!1}},isReadableStream:al,isRequest:cl,isResponse:ll,isHeaders:ul,isUndefined:Gc,isDate:nl,isFile:il,isBlob:rl,isRegExp:bl,isFunction:Xc,isStream:e=>el(e)&&Xc(e.pipe),isURLSearchParams:ol,isTypedArray:ml,isFileList:sl,forEach:dl,merge:function e(){const{caseless:t}=fl(this)&&this||{},n={},i=(i,r)=>{const s=t&&hl(n,r)||r;tl(n[s])&&tl(i)?n[s]=e(n[s],i):tl(i)?n[s]=e({},i):$c(i)?n[s]=i.slice():n[s]=i};for(let r=0,s=arguments.length;r<s;r++)arguments[r]&&dl(arguments[r],i);return n},extend:function(e,t,n){let{allOwnKeys:i}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return dl(t,(t,i)=>{n&&Xc(t)?e[i]=Fc(t,n):e[i]=t},{allOwnKeys:i}),e},trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,i)=>{let r,s,o;const a={};if(t=t||{},null==e)return t;do{for(r=Object.getOwnPropertyNames(e),s=r.length;s-- >0;)o=r[s],i&&!i(o,e,t)||a[o]||(t[o]=e[o],a[o]=!0);e=!1!==n&&Bc(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:zc,kindOfTest:Wc,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const i=e.indexOf(t,n);return-1!==i&&i===n},toArray:e=>{if(!e)return null;if($c(e))return e;let t=e.length;if(!Zc(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[Vc]).call(e);let i;for(;(i=n.next())&&!i.done;){const n=i.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const i=[];for(;null!==(n=e.exec(t));)i.push(n);return i},isHTMLForm:vl,hasOwnProperty:yl,hasOwnProp:yl,reduceDescriptors:kl,freezeMethods:e=>{kl(e,(t,n)=>{if(Xc(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const i=e[n];Xc(i)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))})},toObjectSet:(e,t)=>{const n={},i=e=>{e.forEach(e=>{n[e]=!0})};return $c(e)?i(e):i(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,t,n){return t.toUpperCase()+n}),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:hl,global:pl,isContextDefined:fl,isSpecCompliantForm:function(e){return!!(e&&Xc(e.append)&&"FormData"===e[qc]&&e[Vc])},toJSONObject:e=>{const t=new Array(10),n=(e,i)=>{if(el(e)){if(t.indexOf(e)>=0)return;if(Qc(e))return e;if(!("toJSON"in e)){t[i]=e;const r=$c(e)?[]:{};return dl(e,(e,t)=>{const s=n(e,i+1);!Gc(s)&&(r[t]=s)}),t[i]=void 0,r}}return e};return n(e,0)},isAsyncFn:wl,isThenable:e=>e&&(el(e)||Xc(e))&&Xc(e.then)&&Xc(e.catch),setImmediate:Sl,asap:Tl,isIterable:e=>null!=e&&Xc(e[Vc])};function xl(e,t,n,i,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),i&&(this.request=i),r&&(this.response=r,this.status=r.status?r.status:null)}Cl.inherits(xl,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Cl.toJSONObject(this.config),code:this.code,status:this.status}}});const El=xl.prototype,Pl={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Pl[e]={value:e}}),Object.defineProperties(xl,Pl),Object.defineProperty(El,"isAxiosError",{value:!0}),xl.from=(e,t,n,i,r,s)=>{const o=Object.create(El);return Cl.toFlatObject(e,o,function(e){return e!==Error.prototype},e=>"isAxiosError"!==e),xl.call(o,e.message,t,n,i,r),o.cause=e,o.name=e.name,s&&Object.assign(o,s),o};const Rl=xl;function Ol(e){return Cl.isPlainObject(e)||Cl.isArray(e)}function _l(e){return Cl.endsWith(e,"[]")?e.slice(0,-2):e}function Nl(e,t,n){return e?e.concat(t).map(function(e,t){return e=_l(e),!n&&t?"["+e+"]":e}).join(n?".":""):t}const Al=Cl.toFlatObject(Cl,{},null,function(e){return/^is[A-Z]/.test(e)});const Il=function(e,t,n){if(!Cl.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const i=(n=Cl.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(e,t){return!Cl.isUndefined(t[e])})).metaTokens,r=n.visitor||l,s=n.dots,o=n.indexes,a=(n.Blob||"undefined"!==typeof Blob&&Blob)&&Cl.isSpecCompliantForm(t);if(!Cl.isFunction(r))throw new TypeError("visitor must be a function");function c(e){if(null===e)return"";if(Cl.isDate(e))return e.toISOString();if(Cl.isBoolean(e))return e.toString();if(!a&&Cl.isBlob(e))throw new Rl("Blob is not supported. Use a Buffer instead.");return Cl.isArrayBuffer(e)||Cl.isTypedArray(e)?a&&"function"===typeof Blob?new Blob([e]):Buffer.from(e):e}function l(e,n,r){let a=e;if(e&&!r&&"object"===typeof e)if(Cl.endsWith(n,"{}"))n=i?n:n.slice(0,-2),e=JSON.stringify(e);else if(Cl.isArray(e)&&function(e){return Cl.isArray(e)&&!e.some(Ol)}(e)||(Cl.isFileList(e)||Cl.endsWith(n,"[]"))&&(a=Cl.toArray(e)))return n=_l(n),a.forEach(function(e,i){!Cl.isUndefined(e)&&null!==e&&t.append(!0===o?Nl([n],i,s):null===o?n:n+"[]",c(e))}),!1;return!!Ol(e)||(t.append(Nl(r,n,s),c(e)),!1)}const u=[],d=Object.assign(Al,{defaultVisitor:l,convertValue:c,isVisitable:Ol});if(!Cl.isObject(e))throw new TypeError("data must be an object");return function e(n,i){if(!Cl.isUndefined(n)){if(-1!==u.indexOf(n))throw Error("Circular reference detected in "+i.join("."));u.push(n),Cl.forEach(n,function(n,s){!0===(!(Cl.isUndefined(n)||null===n)&&r.call(t,n,Cl.isString(s)?s.trim():s,i,d))&&e(n,i?i.concat(s):[s])}),u.pop()}}(e),t};function jl(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(e){return t[e]})}function Dl(e,t){this._pairs=[],e&&Il(e,this,t)}const Ml=Dl.prototype;Ml.append=function(e,t){this._pairs.push([e,t])},Ml.toString=function(e){const t=e?function(t){return e.call(this,t,jl)}:jl;return this._pairs.map(function(e){return t(e[0])+"="+t(e[1])},"").join("&")};const Ll=Dl;function Fl(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Ul(e,t,n){if(!t)return e;const i=n&&n.encode||Fl;Cl.isFunction(n)&&(n={serialize:n});const r=n&&n.serialize;let s;if(s=r?r(t,n):Cl.isURLSearchParams(t)?t.toString():new Ll(t,n).toString(i),s){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+s}return e}const Bl=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Cl.forEach(this.handlers,function(t){null!==t&&e(t)})}},Vl={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ql={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:Ll,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},zl="undefined"!==typeof window&&"undefined"!==typeof document,Hl="object"===typeof navigator&&navigator||void 0,Wl=zl&&(!Hl||["ReactNative","NativeScript","NS"].indexOf(Hl.product)<0),Kl="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,$l=zl&&window.location.href||"http://localhost",Gl={...e,...ql};const Ql=function(e){function t(e,n,i,r){let s=e[r++];if("__proto__"===s)return!0;const o=Number.isFinite(+s),a=r>=e.length;if(s=!s&&Cl.isArray(i)?i.length:s,a)return Cl.hasOwnProp(i,s)?i[s]=[i[s],n]:i[s]=n,!o;i[s]&&Cl.isObject(i[s])||(i[s]=[]);return t(e,n,i[s],r)&&Cl.isArray(i[s])&&(i[s]=function(e){const t={},n=Object.keys(e);let i;const r=n.length;let s;for(i=0;i<r;i++)s=n[i],t[s]=e[s];return t}(i[s])),!o}if(Cl.isFormData(e)&&Cl.isFunction(e.entries)){const n={};return Cl.forEachEntry(e,(e,i)=>{t(function(e){return Cl.matchAll(/\w+|\[(\w*)]/g,e).map(e=>"[]"===e[0]?"":e[1]||e[0])}(e),i,n,0)}),n}return null};const Jl={transitional:Vl,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",i=n.indexOf("application/json")>-1,s=Cl.isObject(e);s&&Cl.isHTMLForm(e)&&(e=new FormData(e));if(Cl.isFormData(e))return i?JSON.stringify(Ql(e)):e;if(Cl.isArrayBuffer(e)||Cl.isBuffer(e)||Cl.isStream(e)||Cl.isFile(e)||Cl.isBlob(e)||Cl.isReadableStream(e))return e;if(Cl.isArrayBufferView(e))return e.buffer;if(Cl.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return Il(e,new Gl.classes.URLSearchParams,{visitor:function(e,t,n,i){return Gl.isNode&&Cl.isBuffer(e)?(this.append(t,e.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}(e,this.formSerializer).toString();if((o=Cl.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return Il(o?{"files[]":e}:e,t&&new t,this.formSerializer)}}return s||i?(t.setContentType("application/json",!1),function(e,t,n){if(Cl.isString(e))try{return(t||JSON.parse)(e),Cl.trim(e)}catch(r){if("SyntaxError"!==r.name)throw r}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||Jl.transitional,n=t&&t.forcedJSONParsing,i="json"===this.responseType;if(Cl.isResponse(e)||Cl.isReadableStream(e))return e;if(e&&Cl.isString(e)&&(n&&!this.responseType||i)){const n=!(t&&t.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(r){if(n){if("SyntaxError"===r.name)throw Rl.from(r,Rl.ERR_BAD_RESPONSE,this,null,this.response);throw r}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Gl.classes.FormData,Blob:Gl.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Cl.forEach(["delete","get","head","post","put","patch"],e=>{Jl.headers[e]={}});const Yl=Jl,Xl=Cl.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Zl=Symbol("internals");function eu(e){return e&&String(e).trim().toLowerCase()}function tu(e){return!1===e||null==e?e:Cl.isArray(e)?e.map(tu):String(e)}function nu(e,t,n,i,r){return Cl.isFunction(i)?i.call(this,t,n):(r&&(t=n),Cl.isString(t)?Cl.isString(i)?-1!==t.indexOf(i):Cl.isRegExp(i)?i.test(t):void 0:void 0)}class iu{constructor(e){e&&this.set(e)}set(e,t,n){const i=this;function r(e,t,n){const r=eu(t);if(!r)throw new Error("header name must be a non-empty string");const s=Cl.findKey(i,r);(!s||void 0===i[s]||!0===n||void 0===n&&!1!==i[s])&&(i[s||t]=tu(e))}const s=(e,t)=>Cl.forEach(e,(e,n)=>r(e,n,t));if(Cl.isPlainObject(e)||e instanceof this.constructor)s(e,t);else if(Cl.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))s((e=>{const t={};let n,i,r;return e&&e.split("\n").forEach(function(e){r=e.indexOf(":"),n=e.substring(0,r).trim().toLowerCase(),i=e.substring(r+1).trim(),!n||t[n]&&Xl[n]||("set-cookie"===n?t[n]?t[n].push(i):t[n]=[i]:t[n]=t[n]?t[n]+", "+i:i)}),t})(e),t);else if(Cl.isObject(e)&&Cl.isIterable(e)){let n,i,r={};for(const t of e){if(!Cl.isArray(t))throw TypeError("Object iterator must return a key-value pair");r[i=t[0]]=(n=r[i])?Cl.isArray(n)?[...n,t[1]]:[n,t[1]]:t[1]}s(r,t)}else null!=e&&r(t,e,n);return this}get(e,t){if(e=eu(e)){const n=Cl.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=n.exec(e);)t[i[1]]=i[2];return t}(e);if(Cl.isFunction(t))return t.call(this,e,n);if(Cl.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=eu(e)){const n=Cl.findKey(this,e);return!(!n||void 0===this[n]||t&&!nu(0,this[n],n,t))}return!1}delete(e,t){const n=this;let i=!1;function r(e){if(e=eu(e)){const r=Cl.findKey(n,e);!r||t&&!nu(0,n[r],r,t)||(delete n[r],i=!0)}}return Cl.isArray(e)?e.forEach(r):r(e),i}clear(e){const t=Object.keys(this);let n=t.length,i=!1;for(;n--;){const r=t[n];e&&!nu(0,this[r],r,e,!0)||(delete this[r],i=!0)}return i}normalize(e){const t=this,n={};return Cl.forEach(this,(i,r)=>{const s=Cl.findKey(n,r);if(s)return t[s]=tu(i),void delete t[r];const o=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,n)=>t.toUpperCase()+n)}(r):String(r).trim();o!==r&&delete t[r],t[o]=tu(i),n[o]=!0}),this}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.constructor.concat(this,...t)}toJSON(e){const t=Object.create(null);return Cl.forEach(this,(n,i)=>{null!=n&&!1!==n&&(t[i]=e&&Cl.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(e=>{let[t,n]=e;return t+": "+n}).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e){const t=new this(e);for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return i.forEach(e=>t.set(e)),t}static accessor(e){const t=(this[Zl]=this[Zl]={accessors:{}}).accessors,n=this.prototype;function i(e){const i=eu(e);t[i]||(!function(e,t){const n=Cl.toCamelCase(" "+t);["get","set","has"].forEach(i=>{Object.defineProperty(e,i+n,{value:function(e,n,r){return this[i].call(this,t,e,n,r)},configurable:!0})})}(n,e),t[i]=!0)}return Cl.isArray(e)?e.forEach(i):i(e),this}}iu.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Cl.reduceDescriptors(iu.prototype,(e,t)=>{let{value:n}=e,i=t[0].toUpperCase()+t.slice(1);return{get:()=>n,set(e){this[i]=e}}}),Cl.freezeMethods(iu);const ru=iu;function su(e,t){const n=this||Yl,i=t||n,r=ru.from(i.headers);let s=i.data;return Cl.forEach(e,function(e){s=e.call(n,s,r.normalize(),t?t.status:void 0)}),r.normalize(),s}function ou(e){return!(!e||!e.__CANCEL__)}function au(e,t,n){Rl.call(this,null==e?"canceled":e,Rl.ERR_CANCELED,t,n),this.name="CanceledError"}Cl.inherits(au,Rl,{__CANCEL__:!0});const cu=au;function lu(e,t,n){const i=n.config.validateStatus;n.status&&i&&!i(n.status)?t(new Rl("Request failed with status code "+n.status,[Rl.ERR_BAD_REQUEST,Rl.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}const uu=function(e,t){e=e||10;const n=new Array(e),i=new Array(e);let r,s=0,o=0;return t=void 0!==t?t:1e3,function(a){const c=Date.now(),l=i[o];r||(r=c),n[s]=a,i[s]=c;let u=o,d=0;for(;u!==s;)d+=n[u++],u%=e;if(s=(s+1)%e,s===o&&(o=(o+1)%e),c-r<t)return;const h=l&&c-l;return h?Math.round(1e3*d/h):void 0}};const du=function(e,t){let n,i,r=0,s=1e3/t;const o=function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();r=s,n=null,i&&(clearTimeout(i),i=null),e(...t)};return[function(){const e=Date.now(),t=e-r;for(var a=arguments.length,c=new Array(a),l=0;l<a;l++)c[l]=arguments[l];t>=s?o(c,e):(n=c,i||(i=setTimeout(()=>{i=null,o(n)},s-t)))},()=>n&&o(n)]},hu=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,i=0;const r=uu(50,250);return du(n=>{const s=n.loaded,o=n.lengthComputable?n.total:void 0,a=s-i,c=r(a);i=s;e({loaded:s,total:o,progress:o?s/o:void 0,bytes:a,rate:c||void 0,estimated:c&&o&&s<=o?(o-s)/c:void 0,event:n,lengthComputable:null!=o,[t?"download":"upload"]:!0})},n)},pu=(e,t)=>{const n=null!=e;return[i=>t[0]({lengthComputable:n,total:e,loaded:i}),t[1]]},fu=e=>function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return Cl.asap(()=>e(...n))},mu=Gl.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,Gl.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(Gl.origin),Gl.navigator&&/(msie|trident)/i.test(Gl.navigator.userAgent)):()=>!0,gu=Gl.hasStandardBrowserEnv?{write(e,t,n,i,r,s){const o=[e+"="+encodeURIComponent(t)];Cl.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),Cl.isString(i)&&o.push("path="+i),Cl.isString(r)&&o.push("domain="+r),!0===s&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function vu(e,t,n){let i=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t);return e&&(i||0==n)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const yu=e=>e instanceof ru?{...e}:e;function bu(e,t){t=t||{};const n={};function i(e,t,n,i){return Cl.isPlainObject(e)&&Cl.isPlainObject(t)?Cl.merge.call({caseless:i},e,t):Cl.isPlainObject(t)?Cl.merge({},t):Cl.isArray(t)?t.slice():t}function r(e,t,n,r){return Cl.isUndefined(t)?Cl.isUndefined(e)?void 0:i(void 0,e,0,r):i(e,t,0,r)}function s(e,t){if(!Cl.isUndefined(t))return i(void 0,t)}function o(e,t){return Cl.isUndefined(t)?Cl.isUndefined(e)?void 0:i(void 0,e):i(void 0,t)}function a(n,r,s){return s in t?i(n,r):s in e?i(void 0,n):void 0}const c={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(e,t,n)=>r(yu(e),yu(t),0,!0)};return Cl.forEach(Object.keys({...e,...t}),function(i){const s=c[i]||r,o=s(e[i],t[i],i);Cl.isUndefined(o)&&s!==a||(n[i]=o)}),n}const ku=e=>{const t=bu({},e);let n,{data:i,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:o,headers:a,auth:c}=t;if(t.headers=a=ru.from(a),t.url=Ul(vu(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),c&&a.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):""))),Cl.isFormData(i))if(Gl.hasStandardBrowserEnv||Gl.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if(!1!==(n=a.getContentType())){const[e,...t]=n?n.split(";").map(e=>e.trim()).filter(Boolean):[];a.setContentType([e||"multipart/form-data",...t].join("; "))}if(Gl.hasStandardBrowserEnv&&(r&&Cl.isFunction(r)&&(r=r(t)),r||!1!==r&&mu(t.url))){const e=s&&o&&gu.read(o);e&&a.set(s,e)}return t},wu="undefined"!==typeof XMLHttpRequest&&function(e){return new Promise(function(t,n){const i=ku(e);let r=i.data;const s=ru.from(i.headers).normalize();let o,a,c,l,u,{responseType:d,onUploadProgress:h,onDownloadProgress:p}=i;function f(){l&&l(),u&&u(),i.cancelToken&&i.cancelToken.unsubscribe(o),i.signal&&i.signal.removeEventListener("abort",o)}let m=new XMLHttpRequest;function g(){if(!m)return;const i=ru.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders());lu(function(e){t(e),f()},function(e){n(e),f()},{data:d&&"text"!==d&&"json"!==d?m.response:m.responseText,status:m.status,statusText:m.statusText,headers:i,config:e,request:m}),m=null}m.open(i.method.toUpperCase(),i.url,!0),m.timeout=i.timeout,"onloadend"in m?m.onloadend=g:m.onreadystatechange=function(){m&&4===m.readyState&&(0!==m.status||m.responseURL&&0===m.responseURL.indexOf("file:"))&&setTimeout(g)},m.onabort=function(){m&&(n(new Rl("Request aborted",Rl.ECONNABORTED,e,m)),m=null)},m.onerror=function(){n(new Rl("Network Error",Rl.ERR_NETWORK,e,m)),m=null},m.ontimeout=function(){let t=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const r=i.transitional||Vl;i.timeoutErrorMessage&&(t=i.timeoutErrorMessage),n(new Rl(t,r.clarifyTimeoutError?Rl.ETIMEDOUT:Rl.ECONNABORTED,e,m)),m=null},void 0===r&&s.setContentType(null),"setRequestHeader"in m&&Cl.forEach(s.toJSON(),function(e,t){m.setRequestHeader(t,e)}),Cl.isUndefined(i.withCredentials)||(m.withCredentials=!!i.withCredentials),d&&"json"!==d&&(m.responseType=i.responseType),p&&([c,u]=hu(p,!0),m.addEventListener("progress",c)),h&&m.upload&&([a,l]=hu(h),m.upload.addEventListener("progress",a),m.upload.addEventListener("loadend",l)),(i.cancelToken||i.signal)&&(o=t=>{m&&(n(!t||t.type?new cu(null,e,m):t),m.abort(),m=null)},i.cancelToken&&i.cancelToken.subscribe(o),i.signal&&(i.signal.aborted?o():i.signal.addEventListener("abort",o)));const v=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(i.url);v&&-1===Gl.protocols.indexOf(v)?n(new Rl("Unsupported protocol "+v+":",Rl.ERR_BAD_REQUEST,e)):m.send(r||null)})},Su=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let n,i=new AbortController;const r=function(e){if(!n){n=!0,o();const t=e instanceof Error?e:this.reason;i.abort(t instanceof Rl?t:new cu(t instanceof Error?t.message:t))}};let s=t&&setTimeout(()=>{s=null,r(new Rl(`timeout ${t} of ms exceeded`,Rl.ETIMEDOUT))},t);const o=()=>{e&&(s&&clearTimeout(s),s=null,e.forEach(e=>{e.unsubscribe?e.unsubscribe(r):e.removeEventListener("abort",r)}),e=null)};e.forEach(e=>e.addEventListener("abort",r));const{signal:a}=i;return a.unsubscribe=()=>Cl.asap(o),a}},Tu=function*(e,t){let n=e.byteLength;if(!t||n<t)return void(yield e);let i,r=0;for(;r<n;)i=r+t,yield e.slice(r,i),r=i},Cu=async function*(e){if(e[Symbol.asyncIterator])return void(yield*e);const t=e.getReader();try{for(;;){const{done:e,value:n}=await t.read();if(e)break;yield n}}finally{await t.cancel()}},xu=(e,t,n,i)=>{const r=async function*(e,t){for await(const n of Cu(e))yield*Tu(n,t)}(e,t);let s,o=0,a=e=>{s||(s=!0,i&&i(e))};return new ReadableStream({async pull(e){try{const{done:t,value:i}=await r.next();if(t)return a(),void e.close();let s=i.byteLength;if(n){let e=o+=s;n(e)}e.enqueue(new Uint8Array(i))}catch(t){throw a(t),t}},cancel:e=>(a(e),r.return())},{highWaterMark:2})},Eu="function"===typeof fetch&&"function"===typeof Request&&"function"===typeof Response,Pu=Eu&&"function"===typeof ReadableStream,Ru=Eu&&("function"===typeof TextEncoder?(Ou=new TextEncoder,e=>Ou.encode(e)):async e=>new Uint8Array(await new Response(e).arrayBuffer()));var Ou;const _u=function(e){try{for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return!!e(...n)}catch(r){return!1}},Nu=Pu&&_u(()=>{let e=!1;const t=new Request(Gl.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),Au=Pu&&_u(()=>Cl.isReadableStream(new Response("").body)),Iu={stream:Au&&(e=>e.body)};var ju;Eu&&(ju=new Response,["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Iu[e]&&(Iu[e]=Cl.isFunction(ju[e])?t=>t[e]():(t,n)=>{throw new Rl(`Response type '${e}' is not supported`,Rl.ERR_NOT_SUPPORT,n)})}));const Du=async(e,t)=>{const n=Cl.toFiniteNumber(e.getContentLength());return null==n?(async e=>{if(null==e)return 0;if(Cl.isBlob(e))return e.size;if(Cl.isSpecCompliantForm(e)){const t=new Request(Gl.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return Cl.isArrayBufferView(e)||Cl.isArrayBuffer(e)?e.byteLength:(Cl.isURLSearchParams(e)&&(e+=""),Cl.isString(e)?(await Ru(e)).byteLength:void 0)})(t):n},Mu=Eu&&(async e=>{let{url:t,method:n,data:i,signal:r,cancelToken:s,timeout:o,onDownloadProgress:a,onUploadProgress:c,responseType:l,headers:u,withCredentials:d="same-origin",fetchOptions:h}=ku(e);l=l?(l+"").toLowerCase():"text";let p,f=Su([r,s&&s.toAbortSignal()],o);const m=f&&f.unsubscribe&&(()=>{f.unsubscribe()});let g;try{if(c&&Nu&&"get"!==n&&"head"!==n&&0!==(g=await Du(u,i))){let e,n=new Request(t,{method:"POST",body:i,duplex:"half"});if(Cl.isFormData(i)&&(e=n.headers.get("content-type"))&&u.setContentType(e),n.body){const[e,t]=pu(g,hu(fu(c)));i=xu(n.body,65536,e,t)}}Cl.isString(d)||(d=d?"include":"omit");const r="credentials"in Request.prototype;p=new Request(t,{...h,signal:f,method:n.toUpperCase(),headers:u.normalize().toJSON(),body:i,duplex:"half",credentials:r?d:void 0});let s=await fetch(p,h);const o=Au&&("stream"===l||"response"===l);if(Au&&(a||o&&m)){const e={};["status","statusText","headers"].forEach(t=>{e[t]=s[t]});const t=Cl.toFiniteNumber(s.headers.get("content-length")),[n,i]=a&&pu(t,hu(fu(a),!0))||[];s=new Response(xu(s.body,65536,n,()=>{i&&i(),m&&m()}),e)}l=l||"text";let v=await Iu[Cl.findKey(Iu,l)||"text"](s,e);return!o&&m&&m(),await new Promise((t,n)=>{lu(t,n,{data:v,headers:ru.from(s.headers),status:s.status,statusText:s.statusText,config:e,request:p})})}catch(v){if(m&&m(),v&&"TypeError"===v.name&&/Load failed|fetch/i.test(v.message))throw Object.assign(new Rl("Network Error",Rl.ERR_NETWORK,e,p),{cause:v.cause||v});throw Rl.from(v,v&&v.code,e,p)}}),Lu={http:null,xhr:wu,fetch:Mu};Cl.forEach(Lu,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(r){}Object.defineProperty(e,"adapterName",{value:t})}});const Fu=e=>`- ${e}`,Uu=e=>Cl.isFunction(e)||null===e||!1===e,Bu=e=>{e=Cl.isArray(e)?e:[e];const{length:t}=e;let n,i;const r={};for(let s=0;s<t;s++){let t;if(n=e[s],i=n,!Uu(n)&&(i=Lu[(t=String(n)).toLowerCase()],void 0===i))throw new Rl(`Unknown adapter '${t}'`);if(i)break;r[t||"#"+s]=i}if(!i){const e=Object.entries(r).map(e=>{let[t,n]=e;return`adapter ${t} `+(!1===n?"is not supported by the environment":"is not available in the build")});let n=t?e.length>1?"since :\n"+e.map(Fu).join("\n"):" "+Fu(e[0]):"as no adapter specified";throw new Rl("There is no suitable adapter to dispatch the request "+n,"ERR_NOT_SUPPORT")}return i};function Vu(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new cu(null,e)}function qu(e){Vu(e),e.headers=ru.from(e.headers),e.data=su.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return Bu(e.adapter||Yl.adapter)(e).then(function(t){return Vu(e),t.data=su.call(e,e.transformResponse,t),t.headers=ru.from(t.headers),t},function(t){return ou(t)||(Vu(e),t&&t.response&&(t.response.data=su.call(e,e.transformResponse,t.response),t.response.headers=ru.from(t.response.headers))),Promise.reject(t)})}const zu="1.11.0",Hu={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Hu[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const Wu={};Hu.transitional=function(e,t,n){function i(e,t){return"[Axios v"+zu+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,r,s)=>{if(!1===e)throw new Rl(i(r," has been removed"+(t?" in "+t:"")),Rl.ERR_DEPRECATED);return t&&!Wu[r]&&(Wu[r]=!0,console.warn(i(r," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,r,s)}},Hu.spelling=function(e){return(t,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};const Ku={assertOptions:function(e,t,n){if("object"!==typeof e)throw new Rl("options must be an object",Rl.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let r=i.length;for(;r-- >0;){const s=i[r],o=t[s];if(o){const t=e[s],n=void 0===t||o(t,s,e);if(!0!==n)throw new Rl("option "+s+" must be "+n,Rl.ERR_BAD_OPTION_VALUE);continue}if(!0!==n)throw new Rl("Unknown option "+s,Rl.ERR_BAD_OPTION)}},validators:Hu},$u=Ku.validators;class Gu{constructor(e){this.defaults=e||{},this.interceptors={request:new Bl,response:new Bl}}async request(e,t){try{return await this._request(e,t)}catch(n){if(n instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{n.stack?t&&!String(n.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(n.stack+="\n"+t):n.stack=t}catch(r){}}throw n}}_request(e,t){"string"===typeof e?(t=t||{}).url=e:t=e||{},t=bu(this.defaults,t);const{transitional:n,paramsSerializer:i,headers:r}=t;void 0!==n&&Ku.assertOptions(n,{silentJSONParsing:$u.transitional($u.boolean),forcedJSONParsing:$u.transitional($u.boolean),clarifyTimeoutError:$u.transitional($u.boolean)},!1),null!=i&&(Cl.isFunction(i)?t.paramsSerializer={serialize:i}:Ku.assertOptions(i,{encode:$u.function,serialize:$u.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Ku.assertOptions(t,{baseUrl:$u.spelling("baseURL"),withXsrfToken:$u.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let s=r&&Cl.merge(r.common,r[t.method]);r&&Cl.forEach(["delete","get","head","post","put","patch","common"],e=>{delete r[e]}),t.headers=ru.concat(s,r);const o=[];let a=!0;this.interceptors.request.forEach(function(e){"function"===typeof e.runWhen&&!1===e.runWhen(t)||(a=a&&e.synchronous,o.unshift(e.fulfilled,e.rejected))});const c=[];let l;this.interceptors.response.forEach(function(e){c.push(e.fulfilled,e.rejected)});let u,d=0;if(!a){const e=[qu.bind(this),void 0];for(e.unshift(...o),e.push(...c),u=e.length,l=Promise.resolve(t);d<u;)l=l.then(e[d++],e[d++]);return l}u=o.length;let h=t;for(d=0;d<u;){const e=o[d++],t=o[d++];try{h=e(h)}catch(p){t.call(this,p);break}}try{l=qu.call(this,h)}catch(p){return Promise.reject(p)}for(d=0,u=c.length;d<u;)l=l.then(c[d++],c[d++]);return l}getUri(e){return Ul(vu((e=bu(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}}Cl.forEach(["delete","get","head","options"],function(e){Gu.prototype[e]=function(t,n){return this.request(bu(n||{},{method:e,url:t,data:(n||{}).data}))}}),Cl.forEach(["post","put","patch"],function(e){function t(t){return function(n,i,r){return this.request(bu(r||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:i}))}}Gu.prototype[e]=t(),Gu.prototype[e+"Form"]=t(!0)});const Qu=Gu;class Ju{constructor(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(e){t=e});const n=this;this.promise.then(e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null}),this.promise.then=e=>{let t;const i=new Promise(e=>{n.subscribe(e),t=e}).then(e);return i.cancel=function(){n.unsubscribe(t)},i},e(function(e,i,r){n.reason||(n.reason=new cu(e,i,r),t(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;const t=new Ju(function(t){e=t});return{token:t,cancel:e}}}const Yu=Ju;const Xu={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Xu).forEach(e=>{let[t,n]=e;Xu[n]=t});const Zu=Xu;const ed=function e(t){const n=new Qu(t),i=Fc(Qu.prototype.request,n);return Cl.extend(i,Qu.prototype,n,{allOwnKeys:!0}),Cl.extend(i,n,null,{allOwnKeys:!0}),i.create=function(n){return e(bu(t,n))},i}(Yl);ed.Axios=Qu,ed.CanceledError=cu,ed.CancelToken=Yu,ed.isCancel=ou,ed.VERSION=zu,ed.toFormData=Il,ed.AxiosError=Rl,ed.Cancel=ed.CanceledError,ed.all=function(e){return Promise.all(e)},ed.spread=function(e){return function(t){return e.apply(null,t)}},ed.isAxiosError=function(e){return Cl.isObject(e)&&!0===e.isAxiosError},ed.mergeConfig=bu,ed.AxiosHeaders=ru,ed.formToJSON=e=>Ql(Cl.isHTMLForm(e)?new FormData(e):e),ed.getAdapter=Bu,ed.HttpStatusCode=Zu,ed.default=ed;const td={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_HEYGEN_AVATAR_ID:"Graham_ProfessionalLook2_public"}.REACT_APP_API_URL||"http://localhost:5001",nd=ed.create({baseURL:td,headers:{"Content-Type":"application/json"}});nd.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e)),nd.interceptors.response.use(e=>e,e=>{var t;return 401===(null===(t=e.response)||void 0===t?void 0:t.status)&&(localStorage.removeItem("token"),window.location.href="/login"),Promise.reject(e)});const id=e=>(console.log("\ud83d\udce1 Sending registration request:",{...e,password:"[HIDDEN]"}),nd.post("/api/auth/register",e)),rd=e=>nd.post("/api/auth/login",e),sd=()=>nd.get("/api/user/profile"),od=e=>nd.put("/api/user/profile",e),ad=e=>nd.post("/api/session/start",{subject:e}),cd=(e,t)=>nd.post("/api/session/message",{message:e,sessionId:t}),ld=()=>nd.get("/api/session/active"),ud=e=>nd.put("/api/session/end",{sessionId:e}),dd=()=>nd.delete("/api/session/clear-active"),hd=(e,t,n)=>nd.post("/api/video/start-stream",{sessionId:e,tutorName:t,userMessage:n}),pd=(e,t)=>nd.post("/api/video/talking-response",{sessionId:e,message:t}),fd=e=>nd.delete(`/api/video/stop-stream/${e}`),md=()=>nd.post("/api/heygen/streaming-token");var gd=__webpack_require__(579);const vd=(0,t.createContext)(void 0),yd=()=>{const e=(0,t.useContext)(vd);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e};function bd(e){let{children:n}=e;const[i,r]=(0,t.useState)(null),[s,o]=(0,t.useState)(localStorage.getItem("token")),[a,c]=(0,t.useState)(!0);(0,t.useEffect)(()=>{(async()=>{const e=localStorage.getItem("token");if(e)try{const t=await sd();r(t.data.user),o(e)}catch(t){console.error("Failed to get user profile:",t),localStorage.removeItem("token"),o(null)}c(!1)})()},[]);const l={user:i,token:s,login:async(e,t)=>{try{c(!0);const n=await rd({email:e,password:t}),{token:i,user:s}=n.data;localStorage.setItem("token",i),o(i),r(s),ne.success("Login successful!")}catch(s){var n,i;const e=(null===(n=s.response)||void 0===n||null===(i=n.data)||void 0===i?void 0:i.error)||"Login failed";throw ne.error(e),s}finally{c(!1)}},register:async e=>{try{c(!0),console.log("\ud83d\udd10 Attempting registration with data:",{...e,password:"[HIDDEN]"});const t=await id(e);console.log("\u2705 Registration response:",t.data);const{token:n,user:i}=t.data;localStorage.setItem("token",n),o(n),r(i),ne.success("Registration successful!")}catch(l){var t,n,i,s,a;console.error("\u274c Registration error:",l),console.error("\u274c Error response:",null===(t=l.response)||void 0===t?void 0:t.data);let e="Registration failed";if(null!==(n=l.response)&&void 0!==n&&null!==(i=n.data)&&void 0!==i&&i.errors&&Array.isArray(l.response.data.errors)){const t=l.response.data.errors[0];e=t.msg||t.message||"Validation error"}else if(null!==(s=l.response)&&void 0!==s&&null!==(a=s.data)&&void 0!==a&&a.error){const t=l.response.data.error;e="User already exists"===t?"An account with this email already exists. Please try logging in instead.":t}throw ne.error(e),l}finally{c(!1)}},logout:()=>{localStorage.removeItem("token"),o(null),r(null),ne.success("Logged out successfully")},loading:a,updateProfile:async e=>{try{const t=await od(e);r(t.data.user),ne.success("Profile updated successfully")}catch(i){var t,n;const e=(null===(t=i.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.error)||"Failed to update profile";throw ne.error(e),i}}};return(0,gd.jsx)(vd.Provider,{value:l,children:n})}function kd(){const{user:e,logout:n}=yd(),i=Ze(),[r,s]=(0,t.useState)(!1),o=async e=>{try{s(!0);const t=(await ad(e)).data.session.id;i(`/video-call/${t}`)}catch(r){var t,n;const e=(null===(t=r.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.error)||"Failed to start session";ne.error(e)}finally{s(!1)}};return(0,gd.jsxs)("div",{className:"min-h-screen bg-secondary-50",children:[(0,gd.jsx)("header",{className:"bg-white shadow-sm border-b border-secondary-200",children:(0,gd.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,gd.jsxs)("div",{className:"flex justify-between items-center py-4",children:[(0,gd.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,gd.jsx)("div",{className:"h-10 w-10 bg-gradient-to-r from-primary-600 to-accent-600 rounded-lg flex items-center justify-center",children:(0,gd.jsx)(Ec,{className:"h-6 w-6 text-white"})}),(0,gd.jsx)("h1",{className:"text-2xl font-bold text-gradient",children:"AI Tutor"})]}),(0,gd.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,gd.jsxs)("div",{className:"flex items-center space-x-2 text-secondary-600",children:[(0,gd.jsx)(Pc,{className:"h-4 w-4"}),(0,gd.jsx)("span",{className:"text-sm font-medium",children:(null===e||void 0===e?void 0:e.language)||"English"})]}),(0,gd.jsxs)("div",{className:"relative group",children:[(0,gd.jsxs)("button",{className:"flex items-center space-x-2 text-secondary-700 hover:text-secondary-900 transition-colors",children:[(0,gd.jsx)("div",{className:"h-8 w-8 bg-gradient-to-r from-primary-500 to-accent-500 rounded-full flex items-center justify-center",children:(0,gd.jsx)(Rc,{className:"h-4 w-4 text-white"})}),(0,gd.jsx)("span",{className:"font-medium",children:null===e||void 0===e?void 0:e.name})]}),(0,gd.jsx)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-secondary-200 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-10",children:(0,gd.jsxs)("div",{className:"py-2",children:[(0,gd.jsxs)("button",{onClick:()=>i("/profile"),className:"w-full px-4 py-2 text-left text-sm text-secondary-700 hover:bg-secondary-50 flex items-center space-x-2",children:[(0,gd.jsx)(Oc,{className:"h-4 w-4"}),(0,gd.jsx)("span",{children:"Settings"})]}),(0,gd.jsxs)("button",{onClick:async()=>{try{await dd(),ne.success("Active sessions cleared successfully")}catch(n){var e,t;const i=(null===(e=n.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.error)||"Failed to clear sessions";ne.error(i)}},className:"w-full px-4 py-2 text-left text-sm text-orange-600 hover:bg-orange-50 flex items-center space-x-2",children:[(0,gd.jsx)(Oc,{className:"h-4 w-4"}),(0,gd.jsx)("span",{children:"Clear Sessions"})]}),(0,gd.jsxs)("button",{onClick:()=>{n(),i("/login")},className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center space-x-2",children:[(0,gd.jsx)(_c,{className:"h-4 w-4"}),(0,gd.jsx)("span",{children:"Logout"})]})]})})]})]})]})})}),(0,gd.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,gd.jsxs)(Tc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center mb-12",children:[(0,gd.jsxs)("h2",{className:"text-4xl font-bold text-secondary-900 mb-4",children:["Welcome back, ",null===e||void 0===e?void 0:e.name,"! \ud83d\udc4b"]}),(0,gd.jsxs)("p",{className:"text-lg text-secondary-600 max-w-2xl mx-auto",children:["Ready to continue your learning journey with ",null===e||void 0===e?void 0:e.aiTutorName,"? Start a new session or pick up where you left off."]})]}),(0,gd.jsxs)(Tc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"mb-12",children:[(0,gd.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,gd.jsx)("h3",{className:"text-2xl font-bold text-secondary-900",children:"Quick Start"}),(0,gd.jsxs)("div",{className:"flex items-center space-x-2 text-accent-600",children:[(0,gd.jsx)(Nc,{className:"h-5 w-5"}),(0,gd.jsx)("span",{className:"text-sm font-medium",children:"AI-Powered Learning"})]})]}),(0,gd.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[{name:"Mathematics",icon:"\ud83d\udd22",color:"from-blue-500 to-blue-600"},{name:"Science",icon:"\ud83d\udd2c",color:"from-green-500 to-green-600"},{name:"History",icon:"\ud83d\udcda",color:"from-yellow-500 to-yellow-600"},{name:"Literature",icon:"\ud83d\udcd6",color:"from-purple-500 to-purple-600"},{name:"Programming",icon:"\ud83d\udcbb",color:"from-indigo-500 to-indigo-600"},{name:"Language",icon:"\ud83c\udf0d",color:"from-pink-500 to-pink-600"}].map((t,n)=>(0,gd.jsx)(Tc.button,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1+.1*n},onClick:()=>o(t.name),disabled:r,className:"group relative bg-white rounded-xl shadow-sm border border-secondary-200 p-6 hover:shadow-lg hover:border-primary-300 transition-all duration-200 text-left",children:(0,gd.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,gd.jsx)("div",{className:`h-12 w-12 bg-gradient-to-r ${t.color} rounded-lg flex items-center justify-center text-2xl`,children:t.icon}),(0,gd.jsxs)("div",{className:"flex-1",children:[(0,gd.jsx)("h4",{className:"font-semibold text-secondary-900 group-hover:text-primary-600 transition-colors",children:t.name}),(0,gd.jsxs)("p",{className:"text-sm text-secondary-600",children:["Start learning with ",null===e||void 0===e?void 0:e.aiTutorName]})]}),(0,gd.jsx)(Ac,{className:"h-5 w-5 text-secondary-400 group-hover:text-primary-500 transition-colors"})]})},t.name))})]}),(0,gd.jsxs)(Tc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"mb-12",children:[(0,gd.jsx)("h3",{className:"text-2xl font-bold text-secondary-900 mb-6",children:"Your AI Tutor Features"}),(0,gd.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,gd.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-secondary-200 p-6",children:[(0,gd.jsx)("div",{className:"h-12 w-12 bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg flex items-center justify-center mb-4",children:(0,gd.jsx)(Ac,{className:"h-6 w-6 text-white"})}),(0,gd.jsx)("h4",{className:"font-semibold text-secondary-900 mb-2",children:"Video Avatar"}),(0,gd.jsx)("p",{className:"text-sm text-secondary-600",children:"See your AI Tutor in real-time with lifelike video interaction"})]}),(0,gd.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-secondary-200 p-6",children:[(0,gd.jsx)("div",{className:"h-12 w-12 bg-gradient-to-r from-green-500 to-green-600 rounded-lg flex items-center justify-center mb-4",children:(0,gd.jsx)(Ic,{className:"h-6 w-6 text-white"})}),(0,gd.jsx)("h4",{className:"font-semibold text-secondary-900 mb-2",children:"Voice Interaction"}),(0,gd.jsx)("p",{className:"text-sm text-secondary-600",children:"Talk naturally with your AI Tutor using voice commands"})]}),(0,gd.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-secondary-200 p-6",children:[(0,gd.jsx)("div",{className:"h-12 w-12 bg-gradient-to-r from-purple-500 to-purple-600 rounded-lg flex items-center justify-center mb-4",children:(0,gd.jsx)(jc,{className:"h-6 w-6 text-white"})}),(0,gd.jsx)("h4",{className:"font-semibold text-secondary-900 mb-2",children:"Document Upload"}),(0,gd.jsx)("p",{className:"text-sm text-secondary-600",children:"Upload PDFs and slides for personalized explanations"})]}),(0,gd.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-secondary-200 p-6",children:[(0,gd.jsx)("div",{className:"h-12 w-12 bg-gradient-to-r from-accent-500 to-accent-600 rounded-lg flex items-center justify-center mb-4",children:(0,gd.jsx)(Dc,{className:"h-6 w-6 text-white"})}),(0,gd.jsx)("h4",{className:"font-semibold text-secondary-900 mb-2",children:"Real-time Chat"}),(0,gd.jsx)("p",{className:"text-sm text-secondary-600",children:"Interactive conversations with instant responses"})]})]})]}),(0,gd.jsxs)(Tc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:[(0,gd.jsx)("h3",{className:"text-2xl font-bold text-secondary-900 mb-6",children:"Recent Activity"}),(0,gd.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-secondary-200 p-6",children:[(0,gd.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,gd.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,gd.jsx)(Mc,{className:"h-5 w-5 text-secondary-400"}),(0,gd.jsx)("span",{className:"font-medium text-secondary-900",children:"No recent sessions"})]}),(0,gd.jsxs)("button",{onClick:()=>o("General Learning"),disabled:r,className:"btn-primary flex items-center space-x-2",children:[(0,gd.jsx)(Lc,{className:"h-4 w-4"}),(0,gd.jsx)("span",{children:"Start New Session"})]})]}),(0,gd.jsxs)("p",{className:"text-secondary-600",children:["Start your first session with ",null===e||void 0===e?void 0:e.aiTutorName," to begin your learning journey!"]})]})]})]})]})}const wd=xc("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),Sd=xc("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),Td=xc("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),Cd=xc("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var xd=e=>"checkbox"===e.type,Ed=e=>e instanceof Date,Pd=e=>null==e;const Rd=e=>"object"===typeof e;var Od=e=>!Pd(e)&&!Array.isArray(e)&&Rd(e)&&!Ed(e),_d=e=>Od(e)&&e.target?xd(e.target)?e.target.checked:e.target.value:e,Nd=(e,t)=>e.has((e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e)(t)),Ad="undefined"!==typeof window&&"undefined"!==typeof window.HTMLElement&&"undefined"!==typeof document;function Id(e){let t;const n=Array.isArray(e),i="undefined"!==typeof FileList&&e instanceof FileList;if(e instanceof Date)t=new Date(e);else{if(Ad&&(e instanceof Blob||i)||!n&&!Od(e))return e;if(t=n?[]:Object.create(Object.getPrototypeOf(e)),n||(e=>{const t=e.constructor&&e.constructor.prototype;return Od(t)&&t.hasOwnProperty("isPrototypeOf")})(e))for(const n in e)e.hasOwnProperty(n)&&(t[n]=Id(e[n]));else t=e}return t}var jd=e=>/^\w*$/.test(e),Dd=e=>void 0===e,Md=e=>Array.isArray(e)?e.filter(Boolean):[],Ld=e=>Md(e.replace(/["|']|\]/g,"").split(/\.|\[/)),Fd=(e,t,n)=>{if(!t||!Od(e))return n;const i=(jd(t)?[t]:Ld(t)).reduce((e,t)=>Pd(e)?e:e[t],e);return Dd(i)||i===e?Dd(e[t])?n:e[t]:i},Ud=e=>"boolean"===typeof e,Bd=(e,t,n)=>{let i=-1;const r=jd(t)?[t]:Ld(t),s=r.length,o=s-1;for(;++i<s;){const t=r[i];let s=n;if(i!==o){const n=e[t];s=Od(n)||Array.isArray(n)?n:isNaN(+r[i+1])?{}:[]}if("__proto__"===t||"constructor"===t||"prototype"===t)return;e[t]=s,e=e[t]}};const Vd="blur",qd="focusout",zd="onBlur",Hd="onChange",Wd="onSubmit",Kd="onTouched",$d="all",Gd="max",Qd="min",Jd="maxLength",Yd="minLength",Xd="pattern",Zd="required",eh="validate",th=t.createContext(null);th.displayName="HookFormContext";var nh=function(e,t,n){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const r={defaultValues:t._defaultValues};for(const s in e)Object.defineProperty(r,s,{get:()=>{const r=s;return t._proxyFormState[r]!==$d&&(t._proxyFormState[r]=!i||$d),n&&(n[r]=!0),e[r]}});return r};const ih="undefined"!==typeof window?t.useLayoutEffect:t.useEffect;var rh=e=>"string"===typeof e,sh=(e,t,n,i,r)=>rh(e)?(i&&t.watch.add(e),Fd(n,e,r)):Array.isArray(e)?e.map(e=>(i&&t.watch.add(e),Fd(n,e))):(i&&(t.watchAll=!0),n),oh=e=>Pd(e)||!Rd(e);function ah(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new WeakSet;if(oh(e)||oh(t))return e===t;if(Ed(e)&&Ed(t))return e.getTime()===t.getTime();const i=Object.keys(e),r=Object.keys(t);if(i.length!==r.length)return!1;if(n.has(e)||n.has(t))return!0;n.add(e),n.add(t);for(const s of i){const i=e[s];if(!r.includes(s))return!1;if("ref"!==s){const e=t[s];if(Ed(i)&&Ed(e)||Od(i)&&Od(e)||Array.isArray(i)&&Array.isArray(e)?!ah(i,e,n):i!==e)return!1}}return!0}var ch=(e,t,n,i,r)=>t?{...n[e],types:{...n[e]&&n[e].types?n[e].types:{},[i]:r||!0}}:{},lh=e=>Array.isArray(e)?e:[e],uh=()=>{let e=[];return{get observers(){return e},next:t=>{for(const n of e)n.next&&n.next(t)},subscribe:t=>(e.push(t),{unsubscribe:()=>{e=e.filter(e=>e!==t)}}),unsubscribe:()=>{e=[]}}},dh=e=>Od(e)&&!Object.keys(e).length,hh=e=>"file"===e.type,ph=e=>"function"===typeof e,fh=e=>{if(!Ad)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},mh=e=>"select-multiple"===e.type,gh=e=>"radio"===e.type,vh=e=>fh(e)&&e.isConnected;function yh(e,t){const n=Array.isArray(t)?t:jd(t)?[t]:Ld(t),i=1===n.length?e:function(e,t){const n=t.slice(0,-1).length;let i=0;for(;i<n;)e=Dd(e)?i++:e[t[i++]];return e}(e,n),r=n.length-1,s=n[r];return i&&delete i[s],0!==r&&(Od(i)&&dh(i)||Array.isArray(i)&&function(e){for(const t in e)if(e.hasOwnProperty(t)&&!Dd(e[t]))return!1;return!0}(i))&&yh(e,n.slice(0,-1)),e}var bh=e=>{for(const t in e)if(ph(e[t]))return!0;return!1};function kh(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Array.isArray(e);if(Od(e)||n)for(const i in e)Array.isArray(e[i])||Od(e[i])&&!bh(e[i])?(t[i]=Array.isArray(e[i])?[]:{},kh(e[i],t[i])):Pd(e[i])||(t[i]=!0);return t}function wh(e,t,n){const i=Array.isArray(e);if(Od(e)||i)for(const r in e)Array.isArray(e[r])||Od(e[r])&&!bh(e[r])?Dd(t)||oh(n[r])?n[r]=Array.isArray(e[r])?kh(e[r],[]):{...kh(e[r])}:wh(e[r],Pd(t)?{}:t[r],n[r]):n[r]=!ah(e[r],t[r]);return n}var Sh=(e,t)=>wh(e,t,kh(t));const Th={value:!1,isValid:!1},Ch={value:!0,isValid:!0};var xh=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(e=>e&&e.checked&&!e.disabled).map(e=>e.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!Dd(e[0].attributes.value)?Dd(e[0].value)||""===e[0].value?Ch:{value:e[0].value,isValid:!0}:Ch:Th}return Th},Eh=(e,t)=>{let{valueAsNumber:n,valueAsDate:i,setValueAs:r}=t;return Dd(e)?e:n?""===e?NaN:e?+e:e:i&&rh(e)?new Date(e):r?r(e):e};const Ph={isValid:!1,value:null};var Rh=e=>Array.isArray(e)?e.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,Ph):Ph;function Oh(e){const t=e.ref;return hh(t)?t.files:gh(t)?Rh(e.refs).value:mh(t)?[...t.selectedOptions].map(e=>{let{value:t}=e;return t}):xd(t)?xh(e.refs).value:Eh(Dd(t.value)?e.ref.value:t.value,e)}var _h=e=>e instanceof RegExp,Nh=e=>Dd(e)?e:_h(e)?e.source:Od(e)?_h(e.value)?e.value.source:e.value:e,Ah=e=>({isOnSubmit:!e||e===Wd,isOnBlur:e===zd,isOnChange:e===Hd,isOnAll:e===$d,isOnTouch:e===Kd});const Ih="AsyncFunction";var jh=e=>!!e&&!!e.validate&&!!(ph(e.validate)&&e.validate.constructor.name===Ih||Od(e.validate)&&Object.values(e.validate).find(e=>e.constructor.name===Ih)),Dh=(e,t,n)=>!n&&(t.watchAll||t.watch.has(e)||[...t.watch].some(t=>e.startsWith(t)&&/^\.\w+/.test(e.slice(t.length))));const Mh=(e,t,n,i)=>{for(const r of n||Object.keys(e)){const n=Fd(e,r);if(n){const{_f:e,...s}=n;if(e){if(e.refs&&e.refs[0]&&t(e.refs[0],r)&&!i)return!0;if(e.ref&&t(e.ref,e.name)&&!i)return!0;if(Mh(s,t))break}else if(Od(s)&&Mh(s,t))break}}};function Lh(e,t,n){const i=Fd(e,n);if(i||jd(n))return{error:i,name:n};const r=n.split(".");for(;r.length;){const i=r.join("."),s=Fd(t,i),o=Fd(e,i);if(s&&!Array.isArray(s)&&n!==i)return{name:n};if(o&&o.type)return{name:i,error:o};if(o&&o.root&&o.root.type)return{name:`${i}.root`,error:o.root};r.pop()}return{name:n}}var Fh=(e,t,n)=>{const i=lh(Fd(e,n));return Bd(i,"root",t[n]),Bd(e,n,i),e},Uh=e=>rh(e);function Bh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"validate";if(Uh(e)||Array.isArray(e)&&e.every(Uh)||Ud(e)&&!e)return{type:n,message:Uh(e)?e:"",ref:t}}var Vh=e=>Od(e)&&!_h(e)?e:{value:e,message:""},qh=async(e,t,n,i,r,s)=>{const{ref:o,refs:a,required:c,maxLength:l,minLength:u,min:d,max:h,pattern:p,validate:f,name:m,valueAsNumber:g,mount:v}=e._f,y=Fd(n,m);if(!v||t.has(m))return{};const b=a?a[0]:o,k=e=>{r&&b.reportValidity&&(b.setCustomValidity(Ud(e)?"":e||""),b.reportValidity())},w={},S=gh(o),T=xd(o),C=S||T,x=(g||hh(o))&&Dd(o.value)&&Dd(y)||fh(o)&&""===o.value||""===y||Array.isArray(y)&&!y.length,E=ch.bind(null,m,i,w),P=function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Jd,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Yd;const s=e?t:n;w[m]={type:e?i:r,message:s,ref:o,...E(e?i:r,s)}};if(s?!Array.isArray(y)||!y.length:c&&(!C&&(x||Pd(y))||Ud(y)&&!y||T&&!xh(a).isValid||S&&!Rh(a).isValid)){const{value:e,message:t}=Uh(c)?{value:!!c,message:c}:Vh(c);if(e&&(w[m]={type:Zd,message:t,ref:b,...E(Zd,t)},!i))return k(t),w}if(!x&&(!Pd(d)||!Pd(h))){let e,t;const n=Vh(h),r=Vh(d);if(Pd(y)||isNaN(y)){const i=o.valueAsDate||new Date(y),s=e=>new Date((new Date).toDateString()+" "+e),a="time"==o.type,c="week"==o.type;rh(n.value)&&y&&(e=a?s(y)>s(n.value):c?y>n.value:i>new Date(n.value)),rh(r.value)&&y&&(t=a?s(y)<s(r.value):c?y<r.value:i<new Date(r.value))}else{const i=o.valueAsNumber||(y?+y:y);Pd(n.value)||(e=i>n.value),Pd(r.value)||(t=i<r.value)}if((e||t)&&(P(!!e,n.message,r.message,Gd,Qd),!i))return k(w[m].message),w}if((l||u)&&!x&&(rh(y)||s&&Array.isArray(y))){const e=Vh(l),t=Vh(u),n=!Pd(e.value)&&y.length>+e.value,r=!Pd(t.value)&&y.length<+t.value;if((n||r)&&(P(n,e.message,t.message),!i))return k(w[m].message),w}if(p&&!x&&rh(y)){const{value:e,message:t}=Vh(p);if(_h(e)&&!y.match(e)&&(w[m]={type:Xd,message:t,ref:o,...E(Xd,t)},!i))return k(t),w}if(f)if(ph(f)){const e=Bh(await f(y,n),b);if(e&&(w[m]={...e,...E(eh,e.message)},!i))return k(e.message),w}else if(Od(f)){let e={};for(const t in f){if(!dh(e)&&!i)break;const r=Bh(await f[t](y,n),b,t);r&&(e={...r,...E(t,r.message)},k(r.message),i&&(w[m]=e))}if(!dh(e)&&(w[m]={ref:b,...e},!i))return w}return k(!0),w};const zh={mode:Wd,reValidateMode:Hd,shouldFocusError:!0};function Hh(){let e,t={...zh,...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}},n={submitCount:0,isDirty:!1,isReady:!1,isLoading:ph(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},i={},r=(Od(t.defaultValues)||Od(t.values))&&Id(t.defaultValues||t.values)||{},s=t.shouldUnregister?{}:Id(r),o={action:!1,mount:!1,watch:!1},a={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},c=0;const l={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let u={...l};const d={array:uh(),state:uh()},h=t.criteriaMode===$d,p=async e=>{if(!t.disabled&&(l.isValid||u.isValid||e)){const e=t.resolver?dh((await y()).errors):await b(i,!0);e!==n.isValid&&d.state.next({isValid:e})}},f=(e,i)=>{!t.disabled&&(l.isValidating||l.validatingFields||u.isValidating||u.validatingFields)&&((e||Array.from(a.mount)).forEach(e=>{e&&(i?Bd(n.validatingFields,e,i):yh(n.validatingFields,e))}),d.state.next({validatingFields:n.validatingFields,isValidating:!dh(n.validatingFields)}))},m=(e,t,n,a)=>{const c=Fd(i,e);if(c){const i=Fd(s,e,Dd(n)?Fd(r,e):n);Dd(i)||a&&a.defaultChecked||t?Bd(s,e,t?i:Oh(c._f)):S(e,i),o.mount&&p()}},g=(e,i,s,o,a)=>{let c=!1,h=!1;const p={name:e};if(!t.disabled){if(!s||o){(l.isDirty||u.isDirty)&&(h=n.isDirty,n.isDirty=p.isDirty=k(),c=h!==p.isDirty);const t=ah(Fd(r,e),i);h=!!Fd(n.dirtyFields,e),t?yh(n.dirtyFields,e):Bd(n.dirtyFields,e,!0),p.dirtyFields=n.dirtyFields,c=c||(l.dirtyFields||u.dirtyFields)&&h!==!t}if(s){const t=Fd(n.touchedFields,e);t||(Bd(n.touchedFields,e,s),p.touchedFields=n.touchedFields,c=c||(l.touchedFields||u.touchedFields)&&t!==s)}c&&a&&d.state.next(p)}return c?p:{}},v=(i,r,s,o)=>{const a=Fd(n.errors,i),h=(l.isValid||u.isValid)&&Ud(r)&&n.isValid!==r;var p;if(t.delayError&&s?(p=()=>((e,t)=>{Bd(n.errors,e,t),d.state.next({errors:n.errors})})(i,s),e=e=>{clearTimeout(c),c=setTimeout(p,e)},e(t.delayError)):(clearTimeout(c),e=null,s?Bd(n.errors,i,s):yh(n.errors,i)),(s?!ah(a,s):a)||!dh(o)||h){const e={...o,...h&&Ud(r)?{isValid:r}:{},errors:n.errors,name:i};n={...n,...e},d.state.next(e)}},y=async e=>{f(e,!0);const n=await t.resolver(s,t.context,((e,t,n,i)=>{const r={};for(const s of e){const e=Fd(t,s);e&&Bd(r,s,e._f)}return{criteriaMode:n,names:[...e],fields:r,shouldUseNativeValidation:i}})(e||a.mount,i,t.criteriaMode,t.shouldUseNativeValidation));return f(e),n},b=async function(e,i){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{valid:!0};for(const o in e){const c=e[o];if(c){const{_f:e,...u}=c;if(e){const u=a.array.has(e.name),d=c._f&&jh(c._f);d&&l.validatingFields&&f([o],!0);const p=await qh(c,a.disabled,s,h,t.shouldUseNativeValidation&&!i,u);if(d&&l.validatingFields&&f([o]),p[e.name]&&(r.valid=!1,i))break;!i&&(Fd(p,e.name)?u?Fh(n.errors,p,e.name):Bd(n.errors,e.name,p[e.name]):yh(n.errors,e.name))}!dh(u)&&await b(u,i,r)}}return r.valid},k=(e,n)=>!t.disabled&&(e&&n&&Bd(s,e,n),!ah(R(),r)),w=(e,t,n)=>sh(e,a,{...o.mount?s:Dd(t)?r:rh(e)?{[e]:t}:t},n,t),S=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=Fd(i,e);let o=t;if(r){const n=r._f;n&&(!n.disabled&&Bd(s,e,Eh(t,n)),o=fh(n.ref)&&Pd(t)?"":t,mh(n.ref)?[...n.ref.options].forEach(e=>e.selected=o.includes(e.value)):n.refs?xd(n.ref)?n.refs.forEach(e=>{e.defaultChecked&&e.disabled||(Array.isArray(o)?e.checked=!!o.find(t=>t===e.value):e.checked=o===e.value||!!o)}):n.refs.forEach(e=>e.checked=e.value===o):hh(n.ref)?n.ref.value="":(n.ref.value=o,n.ref.type||d.state.next({name:e,values:Id(s)})))}(n.shouldDirty||n.shouldTouch)&&g(e,o,n.shouldTouch,n.shouldDirty,!0),n.shouldValidate&&P(e)},T=(e,t,n)=>{for(const r in t){if(!t.hasOwnProperty(r))return;const s=t[r],o=e+"."+r,c=Fd(i,o);(a.array.has(e)||Od(s)||c&&!c._f)&&!Ed(s)?T(o,s,n):S(o,s,n)}},C=function(e,t){let c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const h=Fd(i,e),p=a.array.has(e),f=Id(t);Bd(s,e,f),p?(d.array.next({name:e,values:Id(s)}),(l.isDirty||l.dirtyFields||u.isDirty||u.dirtyFields)&&c.shouldDirty&&d.state.next({name:e,dirtyFields:Sh(r,s),isDirty:k(e,f)})):!h||h._f||Pd(f)?S(e,f,c):T(e,f,c),Dh(e,a)&&d.state.next({...n,name:e}),d.state.next({name:o.mount?e:void 0,values:Id(s)})},x=async r=>{o.mount=!0;const c=r.target;let m=c.name,k=!0;const w=Fd(i,m),S=e=>{k=Number.isNaN(e)||Ed(e)&&isNaN(e.getTime())||ah(e,Fd(s,m,e))},T=Ah(t.mode),C=Ah(t.reValidateMode);if(w){let o,x;const E=c.type?Oh(w._f):_d(r),R=r.type===Vd||r.type===qd,O=!(e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate))(w._f)&&!t.resolver&&!Fd(n.errors,m)&&!w._f.deps||((e,t,n,i,r)=>!r.isOnAll&&(!n&&r.isOnTouch?!(t||e):(n?i.isOnBlur:r.isOnBlur)?!e:!(n?i.isOnChange:r.isOnChange)||e))(R,Fd(n.touchedFields,m),n.isSubmitted,C,T),_=Dh(m,a,R);Bd(s,m,E),R?c&&c.readOnly||(w._f.onBlur&&w._f.onBlur(r),e&&e(0)):w._f.onChange&&w._f.onChange(r);const N=g(m,E,R),A=!dh(N)||_;if(!R&&d.state.next({name:m,type:r.type,values:Id(s)}),O)return(l.isValid||u.isValid)&&("onBlur"===t.mode?R&&p():R||p()),A&&d.state.next({name:m,..._?{}:N});if(!R&&_&&d.state.next({...n}),t.resolver){const{errors:e}=await y([m]);if(S(E),k){const t=Lh(n.errors,i,m),r=Lh(e,i,t.name||m);o=r.error,m=r.name,x=dh(e)}}else f([m],!0),o=(await qh(w,a.disabled,s,h,t.shouldUseNativeValidation))[m],f([m]),S(E),k&&(o?x=!1:(l.isValid||u.isValid)&&(x=await b(i,!0)));k&&(w._f.deps&&P(w._f.deps),v(m,x,o,N))}},E=(e,t)=>{if(Fd(n.errors,t)&&e.focus)return e.focus(),1},P=async function(e){let r,s,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const c=lh(e);if(t.resolver){const t=await(async e=>{const{errors:t}=await y(e);if(e)for(const i of e){const e=Fd(t,i);e?Bd(n.errors,i,e):yh(n.errors,i)}else n.errors=t;return t})(Dd(e)?e:c);r=dh(t),s=e?!c.some(e=>Fd(t,e)):r}else e?(s=(await Promise.all(c.map(async e=>{const t=Fd(i,e);return await b(t&&t._f?{[e]:t}:t)}))).every(Boolean),(s||n.isValid)&&p()):s=r=await b(i);return d.state.next({...!rh(e)||(l.isValid||u.isValid)&&r!==n.isValid?{}:{name:e},...t.resolver||!e?{isValid:r}:{},errors:n.errors}),o.shouldFocus&&!s&&Mh(i,E,e?c:a.mount),s},R=e=>{const t={...o.mount?s:r};return Dd(e)?t:rh(e)?Fd(t,e):e.map(e=>Fd(t,e))},O=(e,t)=>({invalid:!!Fd((t||n).errors,e),isDirty:!!Fd((t||n).dirtyFields,e),error:Fd((t||n).errors,e),isValidating:!!Fd(n.validatingFields,e),isTouched:!!Fd((t||n).touchedFields,e)}),_=(e,t,r)=>{const s=(Fd(i,e,{_f:{}})._f||{}).ref,o=Fd(n.errors,e)||{},{ref:a,message:c,type:l,...u}=o;Bd(n.errors,e,{...u,...t,ref:s}),d.state.next({name:e,errors:n.errors,isValid:!1}),r&&r.shouldFocus&&s&&s.focus&&s.focus()},N=e=>d.state.subscribe({next:t=>{var i,o,a;i=e.name,o=t.name,a=e.exact,i&&o&&i!==o&&!lh(i).some(e=>e&&(a?e===o:e.startsWith(o)||o.startsWith(e)))||!((e,t,n,i)=>{n(e);const{name:r,...s}=e;return dh(s)||Object.keys(s).length>=Object.keys(t).length||Object.keys(s).find(e=>t[e]===(!i||$d))})(t,e.formState||l,U,e.reRenderRoot)||e.callback({values:{...s},...n,...t,defaultValues:r})}}).unsubscribe,A=function(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(const c of e?lh(e):a.mount)a.mount.delete(c),a.array.delete(c),o.keepValue||(yh(i,c),yh(s,c)),!o.keepError&&yh(n.errors,c),!o.keepDirty&&yh(n.dirtyFields,c),!o.keepTouched&&yh(n.touchedFields,c),!o.keepIsValidating&&yh(n.validatingFields,c),!t.shouldUnregister&&!o.keepDefaultValue&&yh(r,c);d.state.next({values:Id(s)}),d.state.next({...n,...o.keepDirty?{isDirty:k()}:{}}),!o.keepIsValid&&p()},I=e=>{let{disabled:t,name:n}=e;(Ud(t)&&o.mount||t||a.disabled.has(n))&&(t?a.disabled.add(n):a.disabled.delete(n))},j=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=Fd(i,e);const c=Ud(n.disabled)||Ud(t.disabled);return Bd(i,e,{...s||{},_f:{...s&&s._f?s._f:{ref:{name:e}},name:e,mount:!0,...n}}),a.mount.add(e),s?I({disabled:Ud(n.disabled)?n.disabled:t.disabled,name:e}):m(e,!0,n.value),{...c?{disabled:n.disabled||t.disabled}:{},...t.progressive?{required:!!n.required,min:Nh(n.min),max:Nh(n.max),minLength:Nh(n.minLength),maxLength:Nh(n.maxLength),pattern:Nh(n.pattern)}:{},name:e,onChange:x,onBlur:x,ref:c=>{if(c){j(e,n),s=Fd(i,e);const t=Dd(c.value)&&c.querySelectorAll&&c.querySelectorAll("input,select,textarea")[0]||c,o=(e=>gh(e)||xd(e))(t),a=s._f.refs||[];if(o?a.find(e=>e===t):t===s._f.ref)return;Bd(i,e,{_f:{...s._f,...o?{refs:[...a.filter(vh),t,...Array.isArray(Fd(r,e))?[{}]:[]],ref:{type:t.type,name:e}}:{ref:t}}}),m(e,!1,void 0,t)}else s=Fd(i,e,{}),s._f&&(s._f.mount=!1),(t.shouldUnregister||n.shouldUnregister)&&(!Nd(a.array,e)||!o.action)&&a.unMount.add(e)}}},D=()=>t.shouldFocusError&&Mh(i,E,a.mount),M=(e,r)=>async o=>{let c;o&&(o.preventDefault&&o.preventDefault(),o.persist&&o.persist());let l=Id(s);if(d.state.next({isSubmitting:!0}),t.resolver){const{errors:e,values:t}=await y();n.errors=e,l=Id(t)}else await b(i);if(a.disabled.size)for(const e of a.disabled)yh(l,e);if(yh(n.errors,"root"),dh(n.errors)){d.state.next({errors:{}});try{await e(l,o)}catch(u){c=u}}else r&&await r({...n.errors},o),D(),setTimeout(D);if(d.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:dh(n.errors)&&!c,submitCount:n.submitCount+1,errors:n.errors}),c)throw c},L=function(e){let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const u=e?Id(e):r,h=Id(u),p=dh(e),f=p?r:h;if(c.keepDefaultValues||(r=u),!c.keepValues){if(c.keepDirtyValues){const e=new Set([...a.mount,...Object.keys(Sh(r,s))]);for(const t of Array.from(e))Fd(n.dirtyFields,t)?Bd(f,t,Fd(s,t)):C(t,Fd(f,t))}else{if(Ad&&Dd(e))for(const e of a.mount){const t=Fd(i,e);if(t&&t._f){const e=Array.isArray(t._f.refs)?t._f.refs[0]:t._f.ref;if(fh(e)){const t=e.closest("form");if(t){t.reset();break}}}}if(c.keepFieldsRef)for(const e of a.mount)C(e,Fd(f,e));else i={}}s=t.shouldUnregister?c.keepDefaultValues?Id(r):{}:Id(f),d.array.next({values:{...f}}),d.state.next({values:{...f}})}a={mount:c.keepDirtyValues?a.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!l.isValid||!!c.keepIsValid||!!c.keepDirtyValues,o.watch=!!t.shouldUnregister,d.state.next({submitCount:c.keepSubmitCount?n.submitCount:0,isDirty:!p&&(c.keepDirty?n.isDirty:!(!c.keepDefaultValues||ah(e,r))),isSubmitted:!!c.keepIsSubmitted&&n.isSubmitted,dirtyFields:p?{}:c.keepDirtyValues?c.keepDefaultValues&&s?Sh(r,s):n.dirtyFields:c.keepDefaultValues&&e?Sh(r,e):c.keepDirty?n.dirtyFields:{},touchedFields:c.keepTouched?n.touchedFields:{},errors:c.keepErrors?n.errors:{},isSubmitSuccessful:!!c.keepIsSubmitSuccessful&&n.isSubmitSuccessful,isSubmitting:!1,defaultValues:r})},F=(e,t)=>L(ph(e)?e(s):e,t),U=e=>{n={...n,...e}},B={control:{register:j,unregister:A,getFieldState:O,handleSubmit:M,setError:_,_subscribe:N,_runSchema:y,_focusError:D,_getWatch:w,_getDirty:k,_setValid:p,_setFieldArray:function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],c=arguments.length>2?arguments[2]:void 0,h=arguments.length>3?arguments[3]:void 0,p=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],f=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if(h&&c&&!t.disabled){if(o.action=!0,f&&Array.isArray(Fd(i,e))){const t=c(Fd(i,e),h.argA,h.argB);p&&Bd(i,e,t)}if(f&&Array.isArray(Fd(n.errors,e))){const t=c(Fd(n.errors,e),h.argA,h.argB);p&&Bd(n.errors,e,t),((e,t)=>{!Md(Fd(e,t)).length&&yh(e,t)})(n.errors,e)}if((l.touchedFields||u.touchedFields)&&f&&Array.isArray(Fd(n.touchedFields,e))){const t=c(Fd(n.touchedFields,e),h.argA,h.argB);p&&Bd(n.touchedFields,e,t)}(l.dirtyFields||u.dirtyFields)&&(n.dirtyFields=Sh(r,s)),d.state.next({name:e,isDirty:k(e,a),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else Bd(s,e,a)},_setDisabledField:I,_setErrors:e=>{n.errors=e,d.state.next({errors:n.errors,isValid:!1})},_getFieldArray:e=>Md(Fd(o.mount?s:r,e,t.shouldUnregister?Fd(r,e,[]):[])),_reset:L,_resetDefaultValues:()=>ph(t.defaultValues)&&t.defaultValues().then(e=>{F(e,t.resetOptions),d.state.next({isLoading:!1})}),_removeUnmounted:()=>{for(const e of a.unMount){const t=Fd(i,e);t&&(t._f.refs?t._f.refs.every(e=>!vh(e)):!vh(t._f.ref))&&A(e)}a.unMount=new Set},_disableForm:e=>{Ud(e)&&(d.state.next({disabled:e}),Mh(i,(t,n)=>{const r=Fd(i,n);r&&(t.disabled=r._f.disabled||e,Array.isArray(r._f.refs)&&r._f.refs.forEach(t=>{t.disabled=r._f.disabled||e}))},0,!1))},_subjects:d,_proxyFormState:l,get _fields(){return i},get _formValues(){return s},get _state(){return o},set _state(e){o=e},get _defaultValues(){return r},get _names(){return a},set _names(e){a=e},get _formState(){return n},get _options(){return t},set _options(e){t={...t,...e}}},subscribe:e=>(o.mount=!0,u={...u,...e.formState},N({...e,formState:u})),trigger:P,register:j,handleSubmit:M,watch:(e,t)=>ph(e)?d.state.subscribe({next:n=>"values"in n&&e(w(void 0,t),n)}):w(e,t,!0),setValue:C,getValues:R,reset:F,resetField:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Fd(i,e)&&(Dd(t.defaultValue)?C(e,Id(Fd(r,e))):(C(e,t.defaultValue),Bd(r,e,Id(t.defaultValue))),t.keepTouched||yh(n.touchedFields,e),t.keepDirty||(yh(n.dirtyFields,e),n.isDirty=t.defaultValue?k(e,Id(Fd(r,e))):k()),t.keepError||(yh(n.errors,e),l.isValid&&p()),d.state.next({...n}))},clearErrors:e=>{e&&lh(e).forEach(e=>yh(n.errors,e)),d.state.next({errors:e?n.errors:{}})},unregister:A,setError:_,setFocus:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Fd(i,e),r=n&&n._f;if(r){const e=r.refs?r.refs[0]:r.ref;e.focus&&(e.focus(),t.shouldSelect&&ph(e.select)&&e.select())}},getFieldState:O};return{...B,formControl:B}}function Wh(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=t.useRef(void 0),i=t.useRef(void 0),[r,s]=t.useState({isDirty:!1,isValidating:!1,isLoading:ph(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,isReady:!1,defaultValues:ph(e.defaultValues)?void 0:e.defaultValues});if(!n.current)if(e.formControl)n.current={...e.formControl,formState:r},e.defaultValues&&!ph(e.defaultValues)&&e.formControl.reset(e.defaultValues,e.resetOptions);else{const{formControl:t,...i}=Hh(e);n.current={...i,formState:r}}const o=n.current.control;return o._options=e,ih(()=>{const e=o._subscribe({formState:o._proxyFormState,callback:()=>s({...o._formState}),reRenderRoot:!0});return s(e=>({...e,isReady:!0})),o._formState.isReady=!0,e},[o]),t.useEffect(()=>o._disableForm(e.disabled),[o,e.disabled]),t.useEffect(()=>{e.mode&&(o._options.mode=e.mode),e.reValidateMode&&(o._options.reValidateMode=e.reValidateMode)},[o,e.mode,e.reValidateMode]),t.useEffect(()=>{e.errors&&(o._setErrors(e.errors),o._focusError())},[o,e.errors]),t.useEffect(()=>{e.shouldUnregister&&o._subjects.state.next({values:o._getWatch()})},[o,e.shouldUnregister]),t.useEffect(()=>{if(o._proxyFormState.isDirty){const e=o._getDirty();e!==r.isDirty&&o._subjects.state.next({isDirty:e})}},[o,r.isDirty]),t.useEffect(()=>{e.values&&!ah(e.values,i.current)?(o._reset(e.values,{keepFieldsRef:!0,...o._options.resetOptions}),i.current=e.values,s(e=>({...e}))):o._resetDefaultValues()},[o,e.values]),t.useEffect(()=>{o._state.mount||(o._setValid(),o._state.mount=!0),o._state.watch&&(o._state.watch=!1,o._subjects.state.next({...o._formState})),o._removeUnmounted()}),n.current.formState=nh(r,o),n.current}function Kh(){const[e,n]=(0,t.useState)(!1),{login:i,loading:r}=yd(),s=Ze(),{register:o,handleSubmit:a,formState:{errors:c}}=Wh();return(0,gd.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary-50 to-accent-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,gd.jsxs)(Tc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"max-w-md w-full space-y-8",children:[(0,gd.jsxs)("div",{className:"text-center",children:[(0,gd.jsx)(Tc.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},className:"mx-auto h-16 w-16 bg-gradient-to-r from-primary-600 to-accent-600 rounded-full flex items-center justify-center",children:(0,gd.jsx)(Ec,{className:"h-8 w-8 text-white"})}),(0,gd.jsx)(Tc.h2,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"mt-6 text-3xl font-bold text-secondary-900",children:"Welcome Back"}),(0,gd.jsx)(Tc.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},className:"mt-2 text-sm text-secondary-600",children:"Sign in to continue your learning journey with AI Tutor"})]}),(0,gd.jsxs)(Tc.form,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},className:"mt-8 space-y-6",onSubmit:a(async e=>{try{await i(e.email,e.password),s("/dashboard")}catch(t){}}),children:[(0,gd.jsxs)("div",{className:"space-y-4",children:[(0,gd.jsxs)("div",{children:[(0,gd.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-secondary-700",children:"Email Address"}),(0,gd.jsxs)("div",{className:"mt-1 relative",children:[(0,gd.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,gd.jsx)(wd,{className:"h-5 w-5 text-secondary-400"})}),(0,gd.jsx)("input",{...o("email",{required:"Email is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Invalid email address"}}),type:"email",className:"input-field pl-10",placeholder:"Enter your email"})]}),c.email&&(0,gd.jsx)("p",{className:"mt-1 text-sm text-red-600",children:c.email.message})]}),(0,gd.jsxs)("div",{children:[(0,gd.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-secondary-700",children:"Password"}),(0,gd.jsxs)("div",{className:"mt-1 relative",children:[(0,gd.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,gd.jsx)(Sd,{className:"h-5 w-5 text-secondary-400"})}),(0,gd.jsx)("input",{...o("password",{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"}}),type:e?"text":"password",className:"input-field pl-10 pr-10",placeholder:"Enter your password"}),(0,gd.jsx)("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>n(!e),children:e?(0,gd.jsx)(Td,{className:"h-5 w-5 text-secondary-400"}):(0,gd.jsx)(Cd,{className:"h-5 w-5 text-secondary-400"})})]}),c.password&&(0,gd.jsx)("p",{className:"mt-1 text-sm text-red-600",children:c.password.message})]})]}),(0,gd.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gd.jsxs)("div",{className:"flex items-center",children:[(0,gd.jsx)("input",{id:"remember-me",name:"remember-me",type:"checkbox",className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-secondary-300 rounded"}),(0,gd.jsx)("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-secondary-900",children:"Remember me"})]}),(0,gd.jsx)("div",{className:"text-sm",children:(0,gd.jsx)("a",{href:"#",className:"font-medium text-primary-600 hover:text-primary-500",children:"Forgot your password?"})})]}),(0,gd.jsx)("div",{children:(0,gd.jsx)("button",{type:"submit",disabled:r,className:"btn-primary w-full flex justify-center py-3 text-lg",children:r?(0,gd.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-white"}):"Sign In"})}),(0,gd.jsx)("div",{className:"text-center",children:(0,gd.jsxs)("p",{className:"text-sm text-secondary-600",children:["Don't have an account?"," ",(0,gd.jsx)(Et,{to:"/register",className:"font-medium text-primary-600 hover:text-primary-500",children:"Sign up here"})]})})]})]})})}const $h=xc("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),Gh=xc("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),Qh=xc("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]),Jh=xc("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),Yh=xc("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]),Xh=xc("Languages",[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]]),Zh=[{code:"en",name:"English"},{code:"es",name:"Spanish"},{code:"fr",name:"French"},{code:"de",name:"German"},{code:"it",name:"Italian"},{code:"pt",name:"Portuguese"},{code:"ru",name:"Russian"},{code:"ja",name:"Japanese"},{code:"ko",name:"Korean"},{code:"zh",name:"Chinese"}];function ep(){const{user:e,updateProfile:n,loading:i}=yd(),r=Ze(),[s,o]=(0,t.useState)(!1),{register:a,handleSubmit:c,formState:{errors:l},reset:u}=Wh({defaultValues:{name:(null===e||void 0===e?void 0:e.name)||"",language:(null===e||void 0===e?void 0:e.language)||"en",aiTutorName:(null===e||void 0===e?void 0:e.aiTutorName)||""}});return(0,gd.jsxs)("div",{className:"min-h-screen bg-secondary-50",children:[(0,gd.jsx)("header",{className:"bg-white shadow-sm border-b border-secondary-200",children:(0,gd.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,gd.jsxs)("div",{className:"flex items-center py-4",children:[(0,gd.jsx)("button",{onClick:()=>r("/dashboard"),className:"mr-4 p-2 text-secondary-600 hover:text-secondary-900 hover:bg-secondary-100 rounded-lg transition-colors",children:(0,gd.jsx)($h,{className:"h-5 w-5"})}),(0,gd.jsx)("h1",{className:"text-2xl font-bold text-secondary-900",children:"Profile Settings"})]})})}),(0,gd.jsx)("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,gd.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,gd.jsx)(Tc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"lg:col-span-2",children:(0,gd.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-secondary-200 p-6",children:[(0,gd.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,gd.jsx)("h2",{className:"text-xl font-semibold text-secondary-900",children:"Personal Information"}),!s&&(0,gd.jsxs)("button",{onClick:()=>o(!0),className:"btn-primary flex items-center space-x-2",children:[(0,gd.jsx)(Rc,{className:"h-4 w-4"}),(0,gd.jsx)("span",{children:"Edit Profile"})]})]}),(0,gd.jsxs)("form",{onSubmit:c(async e=>{try{await n(e),o(!1),ne.success("Profile updated successfully!")}catch(t){}}),className:"space-y-6",children:[(0,gd.jsxs)("div",{children:[(0,gd.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-secondary-700 mb-2",children:"Full Name"}),(0,gd.jsxs)("div",{className:"relative",children:[(0,gd.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,gd.jsx)(Rc,{className:"h-5 w-5 text-secondary-400"})}),(0,gd.jsx)("input",{...a("name",{required:"Name is required",minLength:{value:2,message:"Name must be at least 2 characters"}}),type:"text",disabled:!s,className:"input-field pl-10 "+(s?"":"bg-secondary-50 cursor-not-allowed"),placeholder:"Enter your full name"})]}),l.name&&(0,gd.jsx)("p",{className:"mt-1 text-sm text-red-600",children:l.name.message})]}),(0,gd.jsxs)("div",{children:[(0,gd.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-secondary-700 mb-2",children:"Email Address"}),(0,gd.jsxs)("div",{className:"relative",children:[(0,gd.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,gd.jsx)(wd,{className:"h-5 w-5 text-secondary-400"})}),(0,gd.jsx)("input",{type:"email",value:(null===e||void 0===e?void 0:e.email)||"",disabled:!0,className:"input-field pl-10 bg-secondary-50 cursor-not-allowed",placeholder:"Your email address"})]}),(0,gd.jsx)("p",{className:"mt-1 text-sm text-secondary-500",children:"Email cannot be changed"})]}),(0,gd.jsxs)("div",{children:[(0,gd.jsx)("label",{htmlFor:"language",className:"block text-sm font-medium text-secondary-700 mb-2",children:"Preferred Language"}),(0,gd.jsxs)("div",{className:"relative",children:[(0,gd.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,gd.jsx)(Pc,{className:"h-5 w-5 text-secondary-400"})}),(0,gd.jsx)("select",{...a("language",{required:"Language is required"}),disabled:!s,className:"input-field pl-10 "+(s?"":"bg-secondary-50 cursor-not-allowed"),children:Zh.map(e=>(0,gd.jsx)("option",{value:e.code,children:e.name},e.code))})]}),l.language&&(0,gd.jsx)("p",{className:"mt-1 text-sm text-red-600",children:l.language.message})]}),(0,gd.jsxs)("div",{children:[(0,gd.jsx)("label",{htmlFor:"aiTutorName",className:"block text-sm font-medium text-secondary-700 mb-2",children:"AI Tutor Name"}),(0,gd.jsxs)("div",{className:"relative",children:[(0,gd.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,gd.jsx)(Ec,{className:"h-5 w-5 text-secondary-400"})}),(0,gd.jsx)("input",{...a("aiTutorName",{required:"AI Tutor name is required",minLength:{value:2,message:"Name must be at least 2 characters"}}),type:"text",disabled:!s,className:"input-field pl-10 "+(s?"":"bg-secondary-50 cursor-not-allowed"),placeholder:"What would you like to call your AI Tutor?"})]}),l.aiTutorName&&(0,gd.jsx)("p",{className:"mt-1 text-sm text-red-600",children:l.aiTutorName.message})]}),s&&(0,gd.jsxs)("div",{className:"flex space-x-4 pt-4",children:[(0,gd.jsx)("button",{type:"button",onClick:()=>{u(),o(!1)},className:"btn-secondary flex-1 flex justify-center items-center py-2",children:"Cancel"}),(0,gd.jsx)("button",{type:"submit",disabled:i,className:"btn-primary flex-1 flex justify-center items-center py-2",children:i?(0,gd.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):(0,gd.jsxs)(gd.Fragment,{children:[(0,gd.jsx)(Gh,{className:"h-4 w-4 mr-2"}),"Save Changes"]})})]})]})]})}),(0,gd.jsxs)(Tc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"space-y-6",children:[(0,gd.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-secondary-200 p-6",children:[(0,gd.jsx)("h3",{className:"text-lg font-semibold text-secondary-900 mb-4",children:"Account Information"}),(0,gd.jsxs)("div",{className:"space-y-3",children:[(0,gd.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gd.jsx)("span",{className:"text-sm text-secondary-600",children:"Member since"}),(0,gd.jsx)("span",{className:"text-sm font-medium text-secondary-900",children:(new Date).toLocaleDateString()})]}),(0,gd.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gd.jsx)("span",{className:"text-sm text-secondary-600",children:"Account type"}),(0,gd.jsx)("span",{className:"text-sm font-medium text-primary-600",children:"Free"})]}),(0,gd.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gd.jsx)("span",{className:"text-sm text-secondary-600",children:"Status"}),(0,gd.jsx)("span",{className:"text-sm font-medium text-green-600",children:"Active"})]})]})]}),(0,gd.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-secondary-200 p-6",children:[(0,gd.jsx)("h3",{className:"text-lg font-semibold text-secondary-900 mb-4",children:"Quick Actions"}),(0,gd.jsxs)("div",{className:"space-y-3",children:[(0,gd.jsxs)("button",{className:"w-full flex items-center space-x-3 p-3 text-left text-secondary-700 hover:bg-secondary-50 rounded-lg transition-colors",children:[(0,gd.jsx)(Qh,{className:"h-5 w-5 text-secondary-400"}),(0,gd.jsx)("span",{className:"text-sm font-medium",children:"Privacy Settings"})]}),(0,gd.jsxs)("button",{className:"w-full flex items-center space-x-3 p-3 text-left text-secondary-700 hover:bg-secondary-50 rounded-lg transition-colors",children:[(0,gd.jsx)(Jh,{className:"h-5 w-5 text-secondary-400"}),(0,gd.jsx)("span",{className:"text-sm font-medium",children:"Notifications"})]}),(0,gd.jsxs)("button",{className:"w-full flex items-center space-x-3 p-3 text-left text-secondary-700 hover:bg-secondary-50 rounded-lg transition-colors",children:[(0,gd.jsx)(Yh,{className:"h-5 w-5 text-secondary-400"}),(0,gd.jsx)("span",{className:"text-sm font-medium",children:"Appearance"})]}),(0,gd.jsxs)("button",{className:"w-full flex items-center space-x-3 p-3 text-left text-secondary-700 hover:bg-secondary-50 rounded-lg transition-colors",children:[(0,gd.jsx)(Xh,{className:"h-5 w-5 text-secondary-400"}),(0,gd.jsx)("span",{className:"text-sm font-medium",children:"Language Settings"})]})]})]}),(0,gd.jsxs)("div",{className:"bg-gradient-to-r from-primary-50 to-accent-50 rounded-xl border border-primary-200 p-6",children:[(0,gd.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,gd.jsx)("div",{className:"h-10 w-10 bg-gradient-to-r from-primary-600 to-accent-600 rounded-lg flex items-center justify-center",children:(0,gd.jsx)(Ec,{className:"h-5 w-5 text-white"})}),(0,gd.jsxs)("div",{children:[(0,gd.jsx)("h3",{className:"font-semibold text-secondary-900",children:null===e||void 0===e?void 0:e.aiTutorName}),(0,gd.jsx)("p",{className:"text-sm text-secondary-600",children:"Your AI Tutor"})]})]}),(0,gd.jsxs)("div",{className:"space-y-2 text-sm text-secondary-700",children:[(0,gd.jsx)("p",{children:"\u2022 Voice interaction enabled"}),(0,gd.jsx)("p",{children:"\u2022 Video avatar available"}),(0,gd.jsx)("p",{children:"\u2022 Multi-language support"}),(0,gd.jsx)("p",{children:"\u2022 Document analysis"})]})]})]})]})})]})}function tp(){const e=(0,t.useRef)(!1);return It(()=>(e.current=!0,()=>{e.current=!1}),[]),e}class np extends t.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const e=this.props.sizeRef.current;e.height=t.offsetHeight||0,e.width=t.offsetWidth||0,e.top=t.offsetTop,e.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function ip(e){let{children:n,isPresent:i}=e;const r=(0,t.useId)(),s=(0,t.useRef)(null),o=(0,t.useRef)({width:0,height:0,top:0,left:0});return(0,t.useInsertionEffect)(()=>{const{width:e,height:t,top:n,left:a}=o.current;if(i||!s.current||!e||!t)return;s.current.dataset.motionPopId=r;const c=document.createElement("style");return document.head.appendChild(c),c.sheet&&c.sheet.insertRule(`\n          [data-motion-pop-id="${r}"] {\n            position: absolute !important;\n            width: ${e}px !important;\n            height: ${t}px !important;\n            top: ${n}px !important;\n            left: ${a}px !important;\n          }\n        `),()=>{document.head.removeChild(c)}},[i]),t.createElement(np,{isPresent:i,childRef:s,sizeRef:o},t.cloneElement(n,{ref:s}))}const rp=e=>{let{children:n,initial:i,isPresent:r,onExitComplete:s,custom:o,presenceAffectsLayout:a,mode:c}=e;const l=ti(sp),u=(0,t.useId)(),d=(0,t.useMemo)(()=>({id:u,initial:i,isPresent:r,custom:o,onExitComplete:e=>{l.set(e,!0);for(const t of l.values())if(!t)return;s&&s()},register:e=>(l.set(e,!1),()=>l.delete(e))}),a?void 0:[r]);return(0,t.useMemo)(()=>{l.forEach((e,t)=>l.set(t,!1))},[r]),t.useEffect(()=>{!r&&!l.size&&s&&s()},[r]),"popLayout"===c&&(n=t.createElement(ip,{isPresent:r},n)),t.createElement(Nt.Provider,{value:d},n)};function sp(){return new Map}const op=e=>e.key||"";const ap=e=>{let{children:n,custom:i,initial:r=!0,onExitComplete:s,exitBeforeEnter:o,presenceAffectsLayout:a=!0,mode:c="sync"}=e;Vi(!o,"Replace exitBeforeEnter with mode='wait'");const l=(0,t.useContext)(Gt).forceRender||function(){const e=tp(),[n,i]=(0,t.useState)(0),r=(0,t.useCallback)(()=>{e.current&&i(n+1)},[n]);return[(0,t.useCallback)(()=>ui.postRender(r),[r]),n]}()[0],u=tp(),d=function(e){const n=[];return t.Children.forEach(e,e=>{(0,t.isValidElement)(e)&&n.push(e)}),n}(n);let h=d;const p=(0,t.useRef)(new Map).current,f=(0,t.useRef)(h),m=(0,t.useRef)(new Map).current,g=(0,t.useRef)(!0);var v;if(It(()=>{g.current=!1,function(e,t){e.forEach(e=>{const n=op(e);t.set(n,e)})}(d,m),f.current=h}),v=()=>{g.current=!0,m.clear(),p.clear()},(0,t.useEffect)(()=>()=>v(),[]),g.current)return t.createElement(t.Fragment,null,h.map(e=>t.createElement(rp,{key:op(e),isPresent:!0,initial:!!r&&void 0,presenceAffectsLayout:a,mode:c},e)));h=[...h];const y=f.current.map(op),b=d.map(op),k=y.length;for(let t=0;t<k;t++){const e=y[t];-1!==b.indexOf(e)||p.has(e)||p.set(e,void 0)}return"wait"===c&&p.size&&(h=[]),p.forEach((e,n)=>{if(-1!==b.indexOf(n))return;const r=m.get(n);if(!r)return;const o=y.indexOf(n);let g=e;if(!g){const e=()=>{p.delete(n);const e=Array.from(m.keys()).filter(e=>!b.includes(e));if(e.forEach(e=>m.delete(e)),f.current=d.filter(t=>{const i=op(t);return i===n||e.includes(i)}),!p.size){if(!1===u.current)return;l(),s&&s()}};g=t.createElement(rp,{key:op(r),isPresent:!1,onExitComplete:e,custom:i,presenceAffectsLayout:a,mode:c},r),p.set(n,g)}h.splice(o,0,g)}),h=h.map(e=>{const n=e.key;return p.has(n)?e:t.createElement(rp,{key:op(e),isPresent:!0,presenceAffectsLayout:a,mode:c},e)}),t.createElement(t.Fragment,null,p.size?h:h.map(e=>(0,t.cloneElement)(e)))},cp=xc("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),lp=[{code:"en",name:"English"},{code:"es",name:"Spanish"},{code:"fr",name:"French"},{code:"de",name:"German"},{code:"it",name:"Italian"},{code:"pt",name:"Portuguese"},{code:"ru",name:"Russian"},{code:"ja",name:"Japanese"},{code:"ko",name:"Korean"},{code:"zh",name:"Chinese"}];function up(){const[e,n]=(0,t.useState)(1),[i,r]=(0,t.useState)(!1),[s,o]=(0,t.useState)(!1),{register:a,loading:c}=yd(),l=Ze(),{register:u,handleSubmit:d,watch:h,formState:{errors:p}}=Wh(),f=h("password"),m=()=>{n(e=>Math.min(e+1,4))},g=()=>{n(e=>Math.max(e-1,1))};return(0,gd.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-primary-50 to-accent-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,gd.jsxs)(Tc.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"max-w-md w-full space-y-8",children:[(0,gd.jsxs)("div",{className:"text-center",children:[(0,gd.jsx)(Tc.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},className:"mx-auto h-16 w-16 bg-gradient-to-r from-primary-600 to-accent-600 rounded-full flex items-center justify-center",children:(0,gd.jsx)(Ec,{className:"h-8 w-8 text-white"})}),(0,gd.jsx)(Tc.h2,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"mt-6 text-3xl font-bold text-secondary-900",children:"Join AI Tutor"}),(0,gd.jsx)(Tc.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},className:"mt-2 text-sm text-secondary-600",children:"Create your account and start your learning journey"})]}),(0,gd.jsx)("div",{className:"w-full bg-secondary-200 rounded-full h-2",children:(0,gd.jsx)(Tc.div,{className:"bg-gradient-to-r from-primary-600 to-accent-600 h-2 rounded-full",initial:{width:0},animate:{width:e/4*100+"%"},transition:{duration:.3}})}),(0,gd.jsx)(Tc.form,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},className:"mt-8 space-y-6",onSubmit:d(async t=>{try{if(console.log("\ud83d\udcdd Form data submitted:",{...t,password:"[HIDDEN]",confirmPassword:"[HIDDEN]"}),console.log("\ud83d\udcdd Form errors:",p),console.log("\ud83d\udcdd Form is valid:",0===Object.keys(p).length),console.log("\ud83d\udcdd Current step:",e),4!==e)return void console.error("\u274c User must complete all steps before submitting");if(Object.keys(p).length>0)return void console.error("\u274c Form has validation errors:",p);await a({name:t.name,email:t.email,password:t.password,language:t.language,aiTutorName:t.aiTutorName}),l("/dashboard")}catch(n){console.error("\u274c Form submission error:",n)}}),children:(0,gd.jsxs)(ap,{mode:"wait",children:[1===e&&(0,gd.jsxs)(Tc.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[(0,gd.jsxs)("div",{children:[(0,gd.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-secondary-700",children:"Full Name"}),(0,gd.jsxs)("div",{className:"mt-1 relative",children:[(0,gd.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,gd.jsx)(Rc,{className:"h-5 w-5 text-secondary-400"})}),(0,gd.jsx)("input",{...u("name",{required:"Name is required",minLength:{value:2,message:"Name must be at least 2 characters"}}),type:"text",className:"input-field pl-10",placeholder:"Enter your full name",autoComplete:"name"})]}),p.name&&(0,gd.jsx)("p",{className:"mt-1 text-sm text-red-600",children:p.name.message})]}),(0,gd.jsxs)("div",{children:[(0,gd.jsx)("label",{htmlFor:"language",className:"block text-sm font-medium text-secondary-700",children:"Preferred Language"}),(0,gd.jsxs)("div",{className:"mt-1 relative",children:[(0,gd.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,gd.jsx)(Pc,{className:"h-5 w-5 text-secondary-400"})}),(0,gd.jsxs)("select",{...u("language",{required:"Language is required"}),className:"input-field pl-10",children:[(0,gd.jsx)("option",{value:"",children:"Select your preferred language"}),lp.map(e=>(0,gd.jsx)("option",{value:e.code,children:e.name},e.code))]})]}),p.language&&(0,gd.jsx)("p",{className:"mt-1 text-sm text-red-600",children:p.language.message})]}),(0,gd.jsxs)("button",{type:"button",onClick:m,className:"btn-primary w-full flex justify-center items-center py-3 text-lg",children:["Continue",(0,gd.jsx)(cp,{className:"ml-2 h-5 w-5"})]})]},"step1"),2===e&&(0,gd.jsxs)(Tc.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[(0,gd.jsxs)("div",{children:[(0,gd.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-secondary-700",children:"Email Address"}),(0,gd.jsxs)("div",{className:"mt-1 relative",children:[(0,gd.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,gd.jsx)(wd,{className:"h-5 w-5 text-secondary-400"})}),(0,gd.jsx)("input",{...u("email",{required:"Email is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Invalid email address"}}),type:"email",className:"input-field pl-10",placeholder:"Enter your email",autoComplete:"email"})]}),p.email&&(0,gd.jsx)("p",{className:"mt-1 text-sm text-red-600",children:p.email.message})]}),(0,gd.jsxs)("div",{children:[(0,gd.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-secondary-700",children:"Password"}),(0,gd.jsxs)("div",{className:"mt-1 relative",children:[(0,gd.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,gd.jsx)(Sd,{className:"h-5 w-5 text-secondary-400"})}),(0,gd.jsx)("input",{...u("password",{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"}}),type:i?"text":"password",className:"input-field pl-10 pr-10",placeholder:"Create a password",autoComplete:"new-password"}),(0,gd.jsx)("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>r(!i),children:i?(0,gd.jsx)(Td,{className:"h-5 w-5 text-secondary-400"}):(0,gd.jsx)(Cd,{className:"h-5 w-5 text-secondary-400"})})]}),p.password&&(0,gd.jsx)("p",{className:"mt-1 text-sm text-red-600",children:p.password.message})]}),(0,gd.jsxs)("div",{children:[(0,gd.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-secondary-700",children:"Confirm Password"}),(0,gd.jsxs)("div",{className:"mt-1 relative",children:[(0,gd.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,gd.jsx)(Sd,{className:"h-5 w-5 text-secondary-400"})}),(0,gd.jsx)("input",{...u("confirmPassword",{required:"Please confirm your password",validate:e=>e===f||"Passwords do not match"}),type:s?"text":"password",className:"input-field pl-10 pr-10",placeholder:"Confirm your password",autoComplete:"new-password"}),(0,gd.jsx)("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>o(!s),children:s?(0,gd.jsx)(Td,{className:"h-5 w-5 text-secondary-400"}):(0,gd.jsx)(Cd,{className:"h-5 w-5 text-secondary-400"})})]}),p.confirmPassword&&(0,gd.jsx)("p",{className:"mt-1 text-sm text-red-600",children:p.confirmPassword.message})]}),(0,gd.jsxs)("div",{className:"flex space-x-4",children:[(0,gd.jsxs)("button",{type:"button",onClick:g,className:"btn-secondary flex-1 flex justify-center items-center py-3 text-lg",children:[(0,gd.jsx)($h,{className:"mr-2 h-5 w-5"}),"Back"]}),(0,gd.jsxs)("button",{type:"button",onClick:m,className:"btn-primary flex-1 flex justify-center items-center py-3 text-lg",children:["Continue",(0,gd.jsx)(cp,{className:"ml-2 h-5 w-5"})]})]})]},"step2"),3===e&&(0,gd.jsxs)(Tc.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[(0,gd.jsxs)("div",{children:[(0,gd.jsx)("label",{htmlFor:"aiTutorName",className:"block text-sm font-medium text-secondary-700",children:"Name Your AI Tutor"}),(0,gd.jsxs)("div",{className:"mt-1 relative",children:[(0,gd.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,gd.jsx)(Ec,{className:"h-5 w-5 text-secondary-400"})}),(0,gd.jsx)("input",{...u("aiTutorName",{required:"AI Tutor name is required",minLength:{value:2,message:"Name must be at least 2 characters"}}),type:"text",className:"input-field pl-10",placeholder:"What would you like to call your AI Tutor?"})]}),p.aiTutorName&&(0,gd.jsx)("p",{className:"mt-1 text-sm text-red-600",children:p.aiTutorName.message})]}),(0,gd.jsxs)("div",{className:"bg-primary-50 border border-primary-200 rounded-lg p-4",children:[(0,gd.jsx)("h3",{className:"text-sm font-medium text-primary-800 mb-2",children:"Default AI Tutor"}),(0,gd.jsx)("p",{className:"text-sm text-primary-700",children:"You'll be using our default AI Tutor with advanced capabilities including voice interaction and video avatar."})]}),(0,gd.jsxs)("div",{className:"flex space-x-4",children:[(0,gd.jsxs)("button",{type:"button",onClick:g,className:"btn-secondary flex-1 flex justify-center items-center py-3 text-lg",children:[(0,gd.jsx)($h,{className:"mr-2 h-5 w-5"}),"Back"]}),(0,gd.jsxs)("button",{type:"button",onClick:m,className:"btn-primary flex-1 flex justify-center items-center py-3 text-lg",children:["Continue",(0,gd.jsx)(cp,{className:"ml-2 h-5 w-5"})]})]})]},"step3"),4===e&&(0,gd.jsxs)(Tc.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[(0,gd.jsxs)("div",{className:"text-center",children:[(0,gd.jsx)("div",{className:"mx-auto h-16 w-16 bg-green-100 rounded-full flex items-center justify-center mb-4",children:(0,gd.jsx)(Ec,{className:"h-8 w-8 text-green-600"})}),(0,gd.jsx)("h3",{className:"text-lg font-medium text-secondary-900 mb-2",children:"Ready to Start Learning!"}),(0,gd.jsx)("p",{className:"text-sm text-secondary-600",children:"Your AI Tutor is ready to help you learn. Click the button below to complete your registration."})]}),(0,gd.jsxs)("div",{className:"bg-secondary-50 border border-secondary-200 rounded-lg p-4",children:[(0,gd.jsx)("h4",{className:"text-sm font-medium text-secondary-800 mb-2",children:"What you'll get:"}),(0,gd.jsxs)("ul",{className:"text-sm text-secondary-700 space-y-1",children:[(0,gd.jsx)("li",{children:"\u2022 Personalized AI Tutor with voice interaction"}),(0,gd.jsx)("li",{children:"\u2022 Real-time video avatar for immersive learning"}),(0,gd.jsx)("li",{children:"\u2022 Multi-language support"}),(0,gd.jsx)("li",{children:"\u2022 Interactive sessions with document upload"})]})]}),(0,gd.jsxs)("div",{className:"flex space-x-4",children:[(0,gd.jsxs)("button",{type:"button",onClick:g,className:"btn-secondary flex-1 flex justify-center items-center py-3 text-lg",children:[(0,gd.jsx)($h,{className:"mr-2 h-5 w-5"}),"Back"]}),(0,gd.jsx)("button",{type:"submit",disabled:c,className:"btn-primary flex-1 flex justify-center items-center py-3 text-lg",children:c?(0,gd.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-white"}):"Complete Registration"})]})]},"step4")]})}),(0,gd.jsxs)("div",{className:"text-center",children:[(0,gd.jsxs)("p",{className:"text-sm text-secondary-600",children:["Already have an account?"," ",(0,gd.jsx)(Et,{to:"/login",className:"font-medium text-primary-600 hover:text-primary-500",children:"Sign in here"})]}),(0,gd.jsx)("p",{className:"text-xs text-secondary-500 mt-2",children:"If you're getting an error about an existing account, try logging in instead."})]})]})})}function dp(e,t){return t.forEach(function(t){t&&"string"!==typeof t&&!Array.isArray(t)&&Object.keys(t).forEach(function(n){if("default"!==n&&!(n in e)){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}})}),Object.freeze(e)}var hp=Object.defineProperty,pp=(e,t,n)=>((e,t,n)=>t in e?hp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class fp{constructor(){pp(this,"_locking"),pp(this,"_locks"),this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){let e;this._locks+=1;const t=new Promise(t=>e=()=>{this._locks-=1,t()}),n=this._locking.then(()=>e);return this._locking=this._locking.then(()=>t),n}}function mp(e,t){if(!e)throw new Error(t)}function gp(e){if("number"!==typeof e)throw new Error("invalid int 32: "+typeof e);if(!Number.isInteger(e)||e>2147483647||e<-2147483648)throw new Error("invalid int 32: "+e)}function vp(e){if("number"!==typeof e)throw new Error("invalid uint 32: "+typeof e);if(!Number.isInteger(e)||e>4294967295||e<0)throw new Error("invalid uint 32: "+e)}function yp(e){if("number"!==typeof e)throw new Error("invalid float 32: "+typeof e);if(Number.isFinite(e)&&(e>34028234663852886e22||e<-34028234663852886e22))throw new Error("invalid float 32: "+e)}const bp=Symbol("@bufbuild/protobuf/enum-type");function kp(e){const t=e[bp];return mp(t,"missing enum type on enum object"),t}function wp(e,t,n,i){e[bp]=Sp(t,n.map(t=>({no:t.no,name:t.name,localName:e[t.no]})))}function Sp(e,t,n){const i=Object.create(null),r=Object.create(null),s=[];for(const o of t){const e=Cp(o);s.push(e),i[o.name]=e,r[o.no]=e}return{typeName:e,values:s,findName:e=>i[e],findNumber:e=>r[e]}}function Tp(e,t,n){const i={};for(const r of t){const e=Cp(r);i[e.localName]=e.no,i[e.no]=e.localName}return wp(i,e,t),i}function Cp(e){return"localName"in e?e:Object.assign(Object.assign({},e),{localName:e.name})}class xp{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,t){const n=this.getType().runtime.bin,i=n.makeReadOptions(t);return n.readMessage(this,i.readerFactory(e),e.byteLength,i),this}fromJson(e,t){const n=this.getType(),i=n.runtime.json,r=i.makeReadOptions(t);return i.readMessage(n,e,r,this),this}fromJsonString(e,t){let n;try{n=JSON.parse(e)}catch(r){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(r instanceof Error?r.message:String(r)))}return this.fromJson(n,t)}toBinary(e){const t=this.getType().runtime.bin,n=t.makeWriteOptions(e),i=n.writerFactory();return t.writeMessage(this,i,n),i.finish()}toJson(e){const t=this.getType().runtime.json,n=t.makeWriteOptions(e);return t.writeMessage(this,n)}toJsonString(e){var t;const n=this.toJson(e);return JSON.stringify(n,null,null!==(t=null===e||void 0===e?void 0:e.prettySpaces)&&void 0!==t?t:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function Ep(){let e=0,t=0;for(let i=0;i<28;i+=7){let n=this.buf[this.pos++];if(e|=(127&n)<<i,0==(128&n))return this.assertBounds(),[e,t]}let n=this.buf[this.pos++];if(e|=(15&n)<<28,t=(112&n)>>4,0==(128&n))return this.assertBounds(),[e,t];for(let i=3;i<=31;i+=7){let n=this.buf[this.pos++];if(t|=(127&n)<<i,0==(128&n))return this.assertBounds(),[e,t]}throw new Error("invalid varint")}function Pp(e,t,n){for(let s=0;s<28;s+=7){const i=e>>>s,r=!(i>>>7==0&&0==t),o=255&(r?128|i:i);if(n.push(o),!r)return}const i=e>>>28&15|(7&t)<<4,r=!(t>>3==0);if(n.push(255&(r?128|i:i)),r){for(let e=3;e<31;e+=7){const i=t>>>e,r=!(i>>>7==0),s=255&(r?128|i:i);if(n.push(s),!r)return}n.push(t>>>31&1)}}const Rp=4294967296;function Op(e){const t="-"===e[0];t&&(e=e.slice(1));const n=1e6;let i=0,r=0;function s(t,s){const o=Number(e.slice(t,s));r*=n,i=i*n+o,i>=Rp&&(r+=i/Rp|0,i%=Rp)}return s(-24,-18),s(-18,-12),s(-12,-6),s(-6),t?Ap(i,r):Np(i,r)}function _p(e,t){if(({lo:e,hi:t}=function(e,t){return{lo:e>>>0,hi:t>>>0}}(e,t)),t<=2097151)return String(Rp*t+e);const n=16777215&(e>>>24|t<<8),i=t>>16&65535;let r=(16777215&e)+6777216*n+6710656*i,s=n+8147497*i,o=2*i;const a=1e7;return r>=a&&(s+=Math.floor(r/a),r%=a),s>=a&&(o+=Math.floor(s/a),s%=a),o.toString()+Ip(s)+Ip(r)}function Np(e,t){return{lo:0|e,hi:0|t}}function Ap(e,t){return t=~t,e?e=1+~e:t+=1,Np(e,t)}const Ip=e=>{const t=String(e);return"0000000".slice(t.length)+t};function jp(e,t){if(e>=0){for(;e>127;)t.push(127&e|128),e>>>=7;t.push(e)}else{for(let n=0;n<9;n++)t.push(127&e|128),e>>=7;t.push(1)}}function Dp(){let e=this.buf[this.pos++],t=127&e;if(0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<7,0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<14,0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<21,0==(128&e))return this.assertBounds(),t;e=this.buf[this.pos++],t|=(15&e)<<28;for(let n=5;0!==(128&e)&&n<10;n++)e=this.buf[this.pos++];if(0!=(128&e))throw new Error("invalid varint");return this.assertBounds(),t>>>0}const Mp=function(){const e=new DataView(new ArrayBuffer(8));if("function"===typeof BigInt&&"function"===typeof e.getBigInt64&&"function"===typeof e.getBigUint64&&"function"===typeof e.setBigInt64&&"function"===typeof e.setBigUint64&&("object"!=typeof process||"1"!=={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_HEYGEN_AVATAR_ID:"Graham_ProfessionalLook2_public"}.BUF_BIGINT_DISABLE)){const t=BigInt("-9223372036854775808"),n=BigInt("9223372036854775807"),i=BigInt("0"),r=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(e){const i="bigint"==typeof e?e:BigInt(e);if(i>n||i<t)throw new Error("int64 invalid: ".concat(e));return i},uParse(e){const t="bigint"==typeof e?e:BigInt(e);if(t>r||t<i)throw new Error("uint64 invalid: ".concat(e));return t},enc(t){return e.setBigInt64(0,this.parse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},uEnc(t){return e.setBigInt64(0,this.uParse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},dec:(t,n)=>(e.setInt32(0,t,!0),e.setInt32(4,n,!0),e.getBigInt64(0,!0)),uDec:(t,n)=>(e.setInt32(0,t,!0),e.setInt32(4,n,!0),e.getBigUint64(0,!0))}}const t=e=>mp(/^-?[0-9]+$/.test(e),"int64 invalid: ".concat(e)),n=e=>mp(/^[0-9]+$/.test(e),"uint64 invalid: ".concat(e));return{zero:"0",supported:!1,parse:e=>("string"!=typeof e&&(e=e.toString()),t(e),e),uParse:e=>("string"!=typeof e&&(e=e.toString()),n(e),e),enc:e=>("string"!=typeof e&&(e=e.toString()),t(e),Op(e)),uEnc:e=>("string"!=typeof e&&(e=e.toString()),n(e),Op(e)),dec:(e,t)=>function(e,t){let n=Np(e,t);const i=2147483648&n.hi;i&&(n=Ap(n.lo,n.hi));const r=_p(n.lo,n.hi);return i?"-"+r:r}(e,t),uDec:(e,t)=>_p(e,t)}}();var Lp,Fp,Up;function Bp(e,t,n){if(t===n)return!0;if(e==Lp.BYTES){if(!(t instanceof Uint8Array)||!(n instanceof Uint8Array))return!1;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==n[e])return!1;return!0}switch(e){case Lp.UINT64:case Lp.FIXED64:case Lp.INT64:case Lp.SFIXED64:case Lp.SINT64:return t==n}return!1}function Vp(e,t){switch(e){case Lp.BOOL:return!1;case Lp.UINT64:case Lp.FIXED64:case Lp.INT64:case Lp.SFIXED64:case Lp.SINT64:return 0==t?Mp.zero:"0";case Lp.DOUBLE:case Lp.FLOAT:return 0;case Lp.BYTES:return new Uint8Array(0);case Lp.STRING:return"";default:return 0}}function qp(e,t){switch(e){case Lp.BOOL:return!1===t;case Lp.STRING:return""===t;case Lp.BYTES:return t instanceof Uint8Array&&!t.byteLength;default:return 0==t}}!function(e){e[e.DOUBLE=1]="DOUBLE",e[e.FLOAT=2]="FLOAT",e[e.INT64=3]="INT64",e[e.UINT64=4]="UINT64",e[e.INT32=5]="INT32",e[e.FIXED64=6]="FIXED64",e[e.FIXED32=7]="FIXED32",e[e.BOOL=8]="BOOL",e[e.STRING=9]="STRING",e[e.BYTES=12]="BYTES",e[e.UINT32=13]="UINT32",e[e.SFIXED32=15]="SFIXED32",e[e.SFIXED64=16]="SFIXED64",e[e.SINT32=17]="SINT32",e[e.SINT64=18]="SINT64"}(Lp||(Lp={})),function(e){e[e.BIGINT=0]="BIGINT",e[e.STRING=1]="STRING"}(Fp||(Fp={})),function(e){e[e.Varint=0]="Varint",e[e.Bit64=1]="Bit64",e[e.LengthDelimited=2]="LengthDelimited",e[e.StartGroup=3]="StartGroup",e[e.EndGroup=4]="EndGroup",e[e.Bit32=5]="Bit32"}(Up||(Up={}));class zp{constructor(e){this.stack=[],this.textEncoder=null!==e&&void 0!==e?e:new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let i=0;i<this.chunks.length;i++)e+=this.chunks[i].length;let t=new Uint8Array(e),n=0;for(let i=0;i<this.chunks.length;i++)t.set(this.chunks[i],n),n+=this.chunks[i].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(vp(e);e>127;)this.buf.push(127&e|128),e>>>=7;return this.buf.push(e),this}int32(e){return gp(e),jp(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){yp(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){vp(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){gp(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return gp(e),jp(e=(e<<1^e>>31)>>>0,this.buf),this}sfixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),i=Mp.enc(e);return n.setInt32(0,i.lo,!0),n.setInt32(4,i.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),i=Mp.uEnc(e);return n.setInt32(0,i.lo,!0),n.setInt32(4,i.hi,!0),this.raw(t)}int64(e){let t=Mp.enc(e);return Pp(t.lo,t.hi,this.buf),this}sint64(e){let t=Mp.enc(e),n=t.hi>>31;return Pp(t.lo<<1^n,(t.hi<<1|t.lo>>>31)^n,this.buf),this}uint64(e){let t=Mp.uEnc(e);return Pp(t.lo,t.hi,this.buf),this}}class Hp{constructor(e,t){this.varint64=Ep,this.uint32=Dp,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=null!==t&&void 0!==t?t:new TextDecoder}tag(){let e=this.uint32(),t=e>>>3,n=7&e;if(t<=0||n<0||n>5)throw new Error("illegal tag: field no "+t+" wire type "+n);return[t,n]}skip(e,t){let n=this.pos;switch(e){case Up.Varint:for(;128&this.buf[this.pos++];);break;case Up.Bit64:this.pos+=4;case Up.Bit32:this.pos+=4;break;case Up.LengthDelimited:let n=this.uint32();this.pos+=n;break;case Up.StartGroup:for(;;){const[e,n]=this.tag();if(n===Up.EndGroup){if(void 0!==t&&e!==t)throw new Error("invalid end group tag");break}this.skip(n,e)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(n,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return 0|this.uint32()}sint32(){let e=this.uint32();return e>>>1^-(1&e)}int64(){return Mp.dec(...this.varint64())}uint64(){return Mp.uDec(...this.varint64())}sint64(){let[e,t]=this.varint64(),n=-(1&e);return e=(e>>>1|(1&t)<<31)^n,t=t>>>1^n,Mp.dec(e,t)}bool(){let[e,t]=this.varint64();return 0!==e||0!==t}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return Mp.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return Mp.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}}function Wp(e){const t=e.field.localName,n=Object.create(null);return n[t]=function(e){const t=e.field;if(t.repeated)return[];if(void 0!==t.default)return t.default;switch(t.kind){case"enum":return t.T.values[0].no;case"scalar":return Vp(t.T,t.L);case"message":const e=t.T,n=new e;return e.fieldWrapper?e.fieldWrapper.unwrapField(n):n;case"map":throw"map fields are not allowed to be extensions"}}(e),[n,()=>n[t]]}let Kp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),$p=[];for(let fT=0;fT<Kp.length;fT++)$p[Kp[fT].charCodeAt(0)]=fT;$p["-".charCodeAt(0)]=Kp.indexOf("+"),$p["_".charCodeAt(0)]=Kp.indexOf("/");const Gp={dec(e){let t=3*e.length/4;"="==e[e.length-2]?t-=2:"="==e[e.length-1]&&(t-=1);let n,i=new Uint8Array(t),r=0,s=0,o=0;for(let a=0;a<e.length;a++){if(n=$p[e.charCodeAt(a)],void 0===n)switch(e[a]){case"=":s=0;case"\n":case"\r":case"\t":case" ":continue;default:throw Error("invalid base64 string.")}switch(s){case 0:o=n,s=1;break;case 1:i[r++]=o<<2|(48&n)>>4,o=n,s=2;break;case 2:i[r++]=(15&o)<<4|(60&n)>>2,o=n,s=3;break;case 3:i[r++]=(3&o)<<6|n,s=0}}if(1==s)throw Error("invalid base64 string.");return i.subarray(0,r)},enc(e){let t,n="",i=0,r=0;for(let s=0;s<e.length;s++)switch(t=e[s],i){case 0:n+=Kp[t>>2],r=(3&t)<<4,i=1;break;case 1:n+=Kp[r|t>>4],r=(15&t)<<2,i=2;break;case 2:n+=Kp[r|t>>6],n+=Kp[63&t],i=0}return i&&(n+=Kp[r],n+="=",1==i&&(n+="=")),n}};function Qp(e,t,n){Xp(t,e);const i=t.runtime.bin.makeReadOptions(n),r=function(e,t){if(!t.repeated&&("enum"==t.kind||"scalar"==t.kind)){for(let n=e.length-1;n>=0;--n)if(e[n].no==t.no)return[e[n]];return[]}return e.filter(e=>e.no===t.no)}(e.getType().runtime.bin.listUnknownFields(e),t.field),[s,o]=Wp(t);for(const a of r)t.runtime.bin.readField(s,i.readerFactory(a.data),t.field,a.wireType,i);return o()}function Jp(e,t,n,i){Xp(t,e);const r=t.runtime.bin.makeReadOptions(i),s=t.runtime.bin.makeWriteOptions(i);if(Yp(e,t)){const n=e.getType().runtime.bin.listUnknownFields(e).filter(e=>e.no!=t.field.no);e.getType().runtime.bin.discardUnknownFields(e);for(const t of n)e.getType().runtime.bin.onUnknownField(e,t.no,t.wireType,t.data)}const o=s.writerFactory();let a=t.field;a.opt||a.repeated||"enum"!=a.kind&&"scalar"!=a.kind||(a=Object.assign(Object.assign({},t.field),{opt:!0})),t.runtime.bin.writeField(a,n,o,s);const c=r.readerFactory(o.finish());for(;c.pos<c.len;){const[t,n]=c.tag(),i=c.skip(n,t);e.getType().runtime.bin.onUnknownField(e,t,n,i)}}function Yp(e,t){const n=e.getType();return t.extendee.typeName===n.typeName&&!!n.runtime.bin.listUnknownFields(e).find(e=>e.no==t.field.no)}function Xp(e,t){mp(e.extendee.typeName==t.getType().typeName,"extension ".concat(e.typeName," can only be applied to message ").concat(e.extendee.typeName))}function Zp(e,t){const n=e.localName;if(e.repeated)return t[n].length>0;if(e.oneof)return t[e.oneof.localName].case===n;switch(e.kind){case"enum":case"scalar":return e.opt||e.req?void 0!==t[n]:"enum"==e.kind?t[n]!==e.T.values[0].no:!qp(e.T,t[n]);case"message":return void 0!==t[n];case"map":return Object.keys(t[n]).length>0}}function ef(e,t){const n=e.localName,i=!e.opt&&!e.req;if(e.repeated)t[n]=[];else if(e.oneof)t[e.oneof.localName]={case:void 0};else switch(e.kind){case"map":t[n]={};break;case"enum":t[n]=i?e.T.values[0].no:void 0;break;case"scalar":t[n]=i?Vp(e.T,e.L):void 0;break;case"message":t[n]=void 0}}function tf(e,t){if(null===e||"object"!=typeof e)return!1;if(!Object.getOwnPropertyNames(xp.prototype).every(t=>t in e&&"function"==typeof e[t]))return!1;const n=e.getType();return null!==n&&"function"==typeof n&&"typeName"in n&&"string"==typeof n.typeName&&(void 0===t||n.typeName==t.typeName)}function nf(e,t){return tf(t)||!e.fieldWrapper?t:e.fieldWrapper.wrapField(t)}Lp.DOUBLE,Lp.FLOAT,Lp.INT64,Lp.UINT64,Lp.INT32,Lp.UINT32,Lp.BOOL,Lp.STRING,Lp.BYTES;const rf={ignoreUnknownFields:!1},sf={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function of(e){return e?Object.assign(Object.assign({},rf),e):rf}function af(e){return e?Object.assign(Object.assign({},sf),e):sf}const cf=Symbol(),lf=Symbol();function uf(e){if(null===e)return"null";switch(typeof e){case"object":return Array.isArray(e)?"array":"object";case"string":return e.length>100?"string":'"'.concat(e.split('"').join('\\"'),'"');default:return String(e)}}function df(e,t,n,i,s){let o=n.localName;if(n.repeated){if(mp("map"!=n.kind),null===t)return;if(!Array.isArray(t))throw new Error("cannot decode field ".concat(s.typeName,".").concat(n.name," from JSON: ").concat(uf(t)));const a=e[o];for(const e of t){if(null===e)throw new Error("cannot decode field ".concat(s.typeName,".").concat(n.name," from JSON: ").concat(uf(e)));switch(n.kind){case"message":a.push(n.T.fromJson(e,i));break;case"enum":const t=ff(n.T,e,i.ignoreUnknownFields,!0);t!==lf&&a.push(t);break;case"scalar":try{a.push(pf(n.T,e,n.L,!0))}catch(r){let i="cannot decode field ".concat(s.typeName,".").concat(n.name," from JSON: ").concat(uf(e));throw r instanceof Error&&r.message.length>0&&(i+=": ".concat(r.message)),new Error(i)}}}}else if("map"==n.kind){if(null===t)return;if("object"!=typeof t||Array.isArray(t))throw new Error("cannot decode field ".concat(s.typeName,".").concat(n.name," from JSON: ").concat(uf(t)));const a=e[o];for(const[e,o]of Object.entries(t)){if(null===o)throw new Error("cannot decode field ".concat(s.typeName,".").concat(n.name," from JSON: map value null"));let c;try{c=hf(n.K,e)}catch(r){let i="cannot decode map key for field ".concat(s.typeName,".").concat(n.name," from JSON: ").concat(uf(t));throw r instanceof Error&&r.message.length>0&&(i+=": ".concat(r.message)),new Error(i)}switch(n.V.kind){case"message":a[c]=n.V.T.fromJson(o,i);break;case"enum":const e=ff(n.V.T,o,i.ignoreUnknownFields,!0);e!==lf&&(a[c]=e);break;case"scalar":try{a[c]=pf(n.V.T,o,Fp.BIGINT,!0)}catch(r){let i="cannot decode map value for field ".concat(s.typeName,".").concat(n.name," from JSON: ").concat(uf(t));throw r instanceof Error&&r.message.length>0&&(i+=": ".concat(r.message)),new Error(i)}}}}else switch(n.oneof&&(e=e[n.oneof.localName]={case:o},o="value"),n.kind){case"message":const a=n.T;if(null===t&&"google.protobuf.Value"!=a.typeName)return;let c=e[o];tf(c)?c.fromJson(t,i):(e[o]=c=a.fromJson(t,i),a.fieldWrapper&&!n.oneof&&(e[o]=a.fieldWrapper.unwrapField(c)));break;case"enum":const l=ff(n.T,t,i.ignoreUnknownFields,!1);switch(l){case cf:ef(n,e);break;case lf:break;default:e[o]=l}break;case"scalar":try{const i=pf(n.T,t,n.L,!1);if(i===cf)ef(n,e);else e[o]=i}catch(r){let i="cannot decode field ".concat(s.typeName,".").concat(n.name," from JSON: ").concat(uf(t));throw r instanceof Error&&r.message.length>0&&(i+=": ".concat(r.message)),new Error(i)}}}function hf(e,t){if(e===Lp.BOOL)switch(t){case"true":t=!0;break;case"false":t=!1}return pf(e,t,Fp.BIGINT,!0).toString()}function pf(e,t,n,i){if(null===t)return i?Vp(e,n):cf;switch(e){case Lp.DOUBLE:case Lp.FLOAT:if("NaN"===t)return Number.NaN;if("Infinity"===t)return Number.POSITIVE_INFINITY;if("-Infinity"===t)return Number.NEGATIVE_INFINITY;if(""===t)break;if("string"==typeof t&&t.trim().length!==t.length)break;if("string"!=typeof t&&"number"!=typeof t)break;const i=Number(t);if(Number.isNaN(i))break;if(!Number.isFinite(i))break;return e==Lp.FLOAT&&yp(i),i;case Lp.INT32:case Lp.FIXED32:case Lp.SFIXED32:case Lp.SINT32:case Lp.UINT32:let s;if("number"==typeof t?s=t:"string"==typeof t&&t.length>0&&t.trim().length===t.length&&(s=Number(t)),void 0===s)break;return e==Lp.UINT32||e==Lp.FIXED32?vp(s):gp(s),s;case Lp.INT64:case Lp.SFIXED64:case Lp.SINT64:if("number"!=typeof t&&"string"!=typeof t)break;const o=Mp.parse(t);return n?o.toString():o;case Lp.FIXED64:case Lp.UINT64:if("number"!=typeof t&&"string"!=typeof t)break;const a=Mp.uParse(t);return n?a.toString():a;case Lp.BOOL:if("boolean"!==typeof t)break;return t;case Lp.STRING:if("string"!==typeof t)break;try{encodeURIComponent(t)}catch(r){throw new Error("invalid UTF8")}return t;case Lp.BYTES:if(""===t)return new Uint8Array(0);if("string"!==typeof t)break;return Gp.dec(t)}throw new Error}function ff(e,t,n,i){if(null===t)return"google.protobuf.NullValue"==e.typeName?0:i?e.values[0].no:cf;switch(typeof t){case"number":if(Number.isInteger(t))return t;break;case"string":const i=e.findName(t);if(void 0!==i)return i.no;if(n)return lf}throw new Error("cannot decode enum ".concat(e.typeName," from JSON: ").concat(uf(t)))}function mf(e){return!(!e.repeated&&"map"!=e.kind)||!e.oneof&&("message"!=e.kind&&(!e.opt&&!e.req))}function gf(e,t,n){if("map"==e.kind){mp("object"==typeof t&&null!=t);const i={},r=Object.entries(t);switch(e.V.kind){case"scalar":for(const[n,s]of r)i[n.toString()]=yf(e.V.T,s);break;case"message":for(const[e,s]of r)i[e.toString()]=s.toJson(n);break;case"enum":const t=e.V.T;for(const[e,s]of r)i[e.toString()]=vf(t,s,n.enumAsInteger)}return n.emitDefaultValues||r.length>0?i:void 0}if(e.repeated){mp(Array.isArray(t));const i=[];switch(e.kind){case"scalar":for(let n=0;n<t.length;n++)i.push(yf(e.T,t[n]));break;case"enum":for(let r=0;r<t.length;r++)i.push(vf(e.T,t[r],n.enumAsInteger));break;case"message":for(let e=0;e<t.length;e++)i.push(t[e].toJson(n))}return n.emitDefaultValues||i.length>0?i:void 0}switch(e.kind){case"scalar":return yf(e.T,t);case"enum":return vf(e.T,t,n.enumAsInteger);case"message":return nf(e.T,t).toJson(n)}}function vf(e,t,n){var i;if(mp("number"==typeof t),"google.protobuf.NullValue"==e.typeName)return null;if(n)return t;const r=e.findNumber(t);return null!==(i=null===r||void 0===r?void 0:r.name)&&void 0!==i?i:t}function yf(e,t){switch(e){case Lp.INT32:case Lp.SFIXED32:case Lp.SINT32:case Lp.FIXED32:case Lp.UINT32:return mp("number"==typeof t),t;case Lp.FLOAT:case Lp.DOUBLE:return mp("number"==typeof t),Number.isNaN(t)?"NaN":t===Number.POSITIVE_INFINITY?"Infinity":t===Number.NEGATIVE_INFINITY?"-Infinity":t;case Lp.STRING:return mp("string"==typeof t),t;case Lp.BOOL:return mp("boolean"==typeof t),t;case Lp.UINT64:case Lp.FIXED64:case Lp.INT64:case Lp.SFIXED64:case Lp.SINT64:return mp("bigint"==typeof t||"string"==typeof t||"number"==typeof t),t.toString();case Lp.BYTES:return mp(t instanceof Uint8Array),Gp.enc(t)}}const bf=Symbol("@bufbuild/protobuf/unknown-fields"),kf={readUnknownFields:!0,readerFactory:e=>new Hp(e)},wf={writeUnknownFields:!0,writerFactory:()=>new zp};function Sf(e){return e?Object.assign(Object.assign({},kf),e):kf}function Tf(e){return e?Object.assign(Object.assign({},wf),e):wf}function Cf(e,t,n,i,r){let{repeated:s,localName:o}=n;switch(n.oneof&&((e=e[n.oneof.localName]).case!=o&&delete e.value,e.case=o,o="value"),n.kind){case"scalar":case"enum":const a="enum"==n.kind?Lp.INT32:n.T;let c=Pf;if("scalar"==n.kind&&n.L>0&&(c=Ef),s){let n=e[o];if(i==Up.LengthDelimited&&a!=Lp.STRING&&a!=Lp.BYTES){let e=t.uint32()+t.pos;for(;t.pos<e;)n.push(c(t,a))}else n.push(c(t,a))}else e[o]=c(t,a);break;case"message":const l=n.T;s?e[o].push(xf(t,new l,r,n)):tf(e[o])?xf(t,e[o],r,n):(e[o]=xf(t,new l,r,n),!l.fieldWrapper||n.oneof||n.repeated||(e[o]=l.fieldWrapper.unwrapField(e[o])));break;case"map":let[u,d]=function(e,t,n){const i=t.uint32(),r=t.pos+i;let s,o;for(;t.pos<r;){const[i]=t.tag();switch(i){case 1:s=Pf(t,e.K);break;case 2:switch(e.V.kind){case"scalar":o=Pf(t,e.V.T);break;case"enum":o=t.int32();break;case"message":o=xf(t,new e.V.T,n,void 0)}}}void 0===s&&(s=Vp(e.K,Fp.BIGINT));"string"!=typeof s&&"number"!=typeof s&&(s=s.toString());if(void 0===o)switch(e.V.kind){case"scalar":o=Vp(e.V.T,Fp.BIGINT);break;case"enum":o=e.V.T.values[0].no;break;case"message":o=new e.V.T}return[s,o]}(n,t,r);e[o][u]=d}}function xf(e,t,n,i){const r=t.getType().runtime.bin,s=null===i||void 0===i?void 0:i.delimited;return r.readMessage(t,e,s?i.no:e.uint32(),n,s),t}function Ef(e,t){const n=Pf(e,t);return"bigint"==typeof n?n.toString():n}function Pf(e,t){switch(t){case Lp.STRING:return e.string();case Lp.BOOL:return e.bool();case Lp.DOUBLE:return e.double();case Lp.FLOAT:return e.float();case Lp.INT32:return e.int32();case Lp.INT64:return e.int64();case Lp.UINT64:return e.uint64();case Lp.FIXED64:return e.fixed64();case Lp.BYTES:return e.bytes();case Lp.FIXED32:return e.fixed32();case Lp.SFIXED32:return e.sfixed32();case Lp.SFIXED64:return e.sfixed64();case Lp.SINT64:return e.sint64();case Lp.UINT32:return e.uint32();case Lp.SINT32:return e.sint32()}}function Rf(e,t,n,i){mp(void 0!==t);const r=e.repeated;switch(e.kind){case"scalar":case"enum":let s="enum"==e.kind?Lp.INT32:e.T;if(r)if(mp(Array.isArray(t)),e.packed)!function(e,t,n,i){if(!i.length)return;e.tag(n,Up.LengthDelimited).fork();let[,r]=Af(t);for(let s=0;s<i.length;s++)e[r](i[s]);e.join()}(n,s,e.no,t);else for(const i of t)Nf(n,s,e.no,i);else Nf(n,s,e.no,t);break;case"message":if(r){mp(Array.isArray(t));for(const r of t)_f(n,i,e,r)}else _f(n,i,e,t);break;case"map":mp("object"==typeof t&&null!=t);for(const[r,o]of Object.entries(t))Of(n,i,e,r,o)}}function Of(e,t,n,i,r){e.tag(n.no,Up.LengthDelimited),e.fork();let s=i;switch(n.K){case Lp.INT32:case Lp.FIXED32:case Lp.UINT32:case Lp.SFIXED32:case Lp.SINT32:s=Number.parseInt(i);break;case Lp.BOOL:mp("true"==i||"false"==i),s="true"==i}switch(Nf(e,n.K,1,s),n.V.kind){case"scalar":Nf(e,n.V.T,2,r);break;case"enum":Nf(e,Lp.INT32,2,r);break;case"message":mp(void 0!==r),e.tag(2,Up.LengthDelimited).bytes(r.toBinary(t))}e.join()}function _f(e,t,n,i){const r=nf(n.T,i);n.delimited?e.tag(n.no,Up.StartGroup).raw(r.toBinary(t)).tag(n.no,Up.EndGroup):e.tag(n.no,Up.LengthDelimited).bytes(r.toBinary(t))}function Nf(e,t,n,i){mp(void 0!==i);let[r,s]=Af(t);e.tag(n,r)[s](i)}function Af(e){let t=Up.Varint;switch(e){case Lp.BYTES:case Lp.STRING:t=Up.LengthDelimited;break;case Lp.DOUBLE:case Lp.FIXED64:case Lp.SFIXED64:t=Up.Bit64;break;case Lp.FIXED32:case Lp.SFIXED32:case Lp.FLOAT:t=Up.Bit32}return[t,Lp[e].toLowerCase()]}function If(e){if(void 0===e)return e;if(tf(e))return e.clone();if(e instanceof Uint8Array){const t=new Uint8Array(e.byteLength);return t.set(e),t}return e}function jf(e){return e instanceof Uint8Array?e:new Uint8Array(e)}class Df{constructor(e,t){this._fields=e,this._normalizer=t}findJsonName(e){if(!this.jsonNames){const e={};for(const t of this.list())e[t.jsonName]=e[t.name]=t;this.jsonNames=e}return this.jsonNames[e]}find(e){if(!this.numbers){const e={};for(const t of this.list())e[t.no]=t;this.numbers=e}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,t)=>e.no-t.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let t;for(const n of this.list())n.oneof?n.oneof!==t&&(t=n.oneof,e.push(t)):e.push(n)}return this.members}}function Mf(e,t){const n=Ff(e);return t?n:zf(qf(n))}const Lf=Ff;function Ff(e){let t=!1;const n=[];for(let i=0;i<e.length;i++){let r=e.charAt(i);switch(r){case"_":t=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(r),t=!1;break;default:t&&(t=!1,r=r.toUpperCase()),n.push(r)}}return n.join("")}const Uf=new Set(["constructor","toString","toJSON","valueOf"]),Bf=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),Vf=e=>"".concat(e,"$"),qf=e=>Bf.has(e)?Vf(e):e,zf=e=>Uf.has(e)?Vf(e):e;class Hf{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=Mf(e,!1)}addField(e){mp(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let e=0;e<this.fields.length;e++)this._lookup[this.fields[e].localName]=this.fields[e]}return this._lookup[e]}}const Wf=(Kf=e=>new Df(e,e=>function(e){var t,n,i,r,s,o;const a=[];let c;for(const l of"function"==typeof e?e():e){const e=l;if(e.localName=Mf(l.name,void 0!==l.oneof),e.jsonName=null!==(t=l.jsonName)&&void 0!==t?t:Lf(l.name),e.repeated=null!==(n=l.repeated)&&void 0!==n&&n,"scalar"==l.kind&&(e.L=null!==(i=l.L)&&void 0!==i?i:Fp.BIGINT),e.delimited=null!==(r=l.delimited)&&void 0!==r&&r,e.req=null!==(s=l.req)&&void 0!==s&&s,e.opt=null!==(o=l.opt)&&void 0!==o&&o,void 0===l.packed&&(e.packed="enum"==l.kind||"scalar"==l.kind&&l.T!=Lp.BYTES&&l.T!=Lp.STRING),void 0!==l.oneof){const t="string"==typeof l.oneof?l.oneof:l.oneof.name;c&&c.name==t||(c=new Hf(t)),e.oneof=c,c.addField(e)}a.push(e)}return a}(e)),$f=e=>{for(const t of e.getType().fields.byMember()){if(t.opt)continue;const n=t.localName,i=e;if(t.repeated)i[n]=[];else switch(t.kind){case"oneof":i[n]={case:void 0};break;case"enum":i[n]=0;break;case"map":i[n]={};break;case"scalar":i[n]=Vp(t.T,t.L)}}},{syntax:"proto3",json:{makeReadOptions:of,makeWriteOptions:af,readMessage(e,t,n,i){if(null==t||Array.isArray(t)||"object"!=typeof t)throw new Error("cannot decode message ".concat(e.typeName," from JSON: ").concat(uf(t)));i=null!==i&&void 0!==i?i:new e;const r=new Map,s=n.typeRegistry;for(const[o,a]of Object.entries(t)){const t=e.fields.findJsonName(o);if(t){if(t.oneof){if(null===a&&"scalar"==t.kind)continue;const n=r.get(t.oneof);if(void 0!==n)throw new Error("cannot decode message ".concat(e.typeName,' from JSON: multiple keys for oneof "').concat(t.oneof.name,'" present: "').concat(n,'", "').concat(o,'"'));r.set(t.oneof,o)}df(i,a,t,n,e)}else{let t=!1;if((null===s||void 0===s?void 0:s.findExtension)&&o.startsWith("[")&&o.endsWith("]")){const r=s.findExtension(o.substring(1,o.length-1));if(r&&r.extendee.typeName==e.typeName){t=!0;const[e,s]=Wp(r);df(e,a,r.field,n,r),Jp(i,r,s(),n)}}if(!t&&!n.ignoreUnknownFields)throw new Error("cannot decode message ".concat(e.typeName,' from JSON: key "').concat(o,'" is unknown'))}}return i},writeMessage(e,t){const n=e.getType(),i={};let s;try{for(s of n.fields.byNumber()){if(!Zp(s,e)){if(s.req)throw"required field not set";if(!t.emitDefaultValues)continue;if(!mf(s))continue}const n=gf(s,s.oneof?e[s.oneof.localName].value:e[s.localName],t);void 0!==n&&(i[t.useProtoFieldName?s.name:s.jsonName]=n)}const r=t.typeRegistry;if(null===r||void 0===r?void 0:r.findExtensionFor)for(const s of n.runtime.bin.listUnknownFields(e)){const o=r.findExtensionFor(n.typeName,s.no);if(o&&Yp(e,o)){const n=Qp(e,o,t),r=gf(o.field,n,t);void 0!==r&&(i[o.field.jsonName]=r)}}}catch(r){const t=s?"cannot encode field ".concat(n.typeName,".").concat(s.name," to JSON"):"cannot encode message ".concat(n.typeName," to JSON"),i=r instanceof Error?r.message:String(r);throw new Error(t+(i.length>0?": ".concat(i):""))}return i},readScalar:(e,t,n)=>pf(e,t,null!==n&&void 0!==n?n:Fp.BIGINT,!0),writeScalar(e,t,n){if(void 0!==t)return n||qp(e,t)?yf(e,t):void 0},debug:uf},bin:{makeReadOptions:Sf,makeWriteOptions:Tf,listUnknownFields(e){var t;return null!==(t=e[bf])&&void 0!==t?t:[]},discardUnknownFields(e){delete e[bf]},writeUnknownFields(e,t){const n=e[bf];if(n)for(const i of n)t.tag(i.no,i.wireType).raw(i.data)},onUnknownField(e,t,n,i){const r=e;Array.isArray(r[bf])||(r[bf]=[]),r[bf].push({no:t,wireType:n,data:i})},readMessage(e,t,n,i,r){const s=e.getType(),o=r?t.len:t.pos+n;let a,c;for(;t.pos<o&&([a,c]=t.tag(),!0!==r||c!=Up.EndGroup);){const n=s.fields.find(a);if(!n){const n=t.skip(c,a);i.readUnknownFields&&this.onUnknownField(e,a,c,n);continue}Cf(e,t,n,c,i)}if(r&&(c!=Up.EndGroup||a!==n))throw new Error("invalid end group tag")},readField:Cf,writeMessage(e,t,n){const i=e.getType();for(const r of i.fields.byNumber())if(Zp(r,e))Rf(r,r.oneof?e[r.oneof.localName].value:e[r.localName],t,n);else if(r.req)throw new Error("cannot encode field ".concat(i.typeName,".").concat(r.name," to binary: required field not set"));return n.writeUnknownFields&&this.writeUnknownFields(e,t),t},writeField(e,t,n,i){void 0!==t&&Rf(e,t,n,i)}},util:Object.assign(Object.assign({},{setEnumType:wp,initPartial(e,t){if(void 0===e)return;const n=t.getType();for(const i of n.fields.byMember()){const n=i.localName,r=t,s=e;if(null!=s[n])switch(i.kind){case"oneof":const e=s[n].case;if(void 0===e)continue;const t=i.findField(e);let o=s[n].value;t&&"message"==t.kind&&!tf(o,t.T)?o=new t.T(o):t&&"scalar"===t.kind&&t.T===Lp.BYTES&&(o=jf(o)),r[n]={case:e,value:o};break;case"scalar":case"enum":let a=s[n];i.T===Lp.BYTES&&(a=i.repeated?a.map(jf):jf(a)),r[n]=a;break;case"map":switch(i.V.kind){case"scalar":case"enum":if(i.V.T===Lp.BYTES)for(const[t,i]of Object.entries(s[n]))r[n][t]=jf(i);else Object.assign(r[n],s[n]);break;case"message":const e=i.V.T;for(const t of Object.keys(s[n])){let i=s[n][t];e.fieldWrapper||(i=new e(i)),r[n][t]=i}}break;case"message":const c=i.T;if(i.repeated)r[n]=s[n].map(e=>tf(e,c)?e:new c(e));else{const e=s[n];c.fieldWrapper?"google.protobuf.BytesValue"===c.typeName?r[n]=jf(e):r[n]=e:r[n]=tf(e,c)?e:new c(e)}}}},equals:(e,t,n)=>t===n||!(!t||!n)&&e.fields.byMember().every(e=>{const i=t[e.localName],r=n[e.localName];if(e.repeated){if(i.length!==r.length)return!1;switch(e.kind){case"message":return i.every((t,n)=>e.T.equals(t,r[n]));case"scalar":return i.every((t,n)=>Bp(e.T,t,r[n]));case"enum":return i.every((e,t)=>Bp(Lp.INT32,e,r[t]))}throw new Error("repeated cannot contain ".concat(e.kind))}switch(e.kind){case"message":let t=i,n=r;return e.T.fieldWrapper&&(void 0===t||tf(t)||(t=e.T.fieldWrapper.wrapField(t)),void 0===n||tf(n)||(n=e.T.fieldWrapper.wrapField(n))),e.T.equals(t,n);case"enum":return Bp(Lp.INT32,i,r);case"scalar":return Bp(e.T,i,r);case"oneof":if(i.case!==r.case)return!1;const s=e.findField(i.case);if(void 0===s)return!0;switch(s.kind){case"message":return s.T.equals(i.value,r.value);case"enum":return Bp(Lp.INT32,i.value,r.value);case"scalar":return Bp(s.T,i.value,r.value)}throw new Error("oneof cannot contain ".concat(s.kind));case"map":const o=Object.keys(i).concat(Object.keys(r));switch(e.V.kind){case"message":const t=e.V.T;return o.every(e=>t.equals(i[e],r[e]));case"enum":return o.every(e=>Bp(Lp.INT32,i[e],r[e]));case"scalar":const n=e.V.T;return o.every(e=>Bp(n,i[e],r[e]))}}}),clone(e){const t=e.getType(),n=new t,i=n;for(const r of t.fields.byMember()){const t=e[r.localName];let n;if(r.repeated)n=t.map(If);else if("map"==r.kind){n=i[r.localName];for(const[e,i]of Object.entries(t))n[e]=If(i)}else n="oneof"==r.kind?r.findField(t.case)?{case:t.case,value:If(t.value)}:{case:void 0}:If(t);i[r.localName]=n}for(const r of t.runtime.bin.listUnknownFields(e))t.runtime.bin.onUnknownField(i,r.no,r.wireType,r.data);return n}}),{newFieldList:Kf,initFields:$f}),makeMessageType(e,t,n){return function(e,t,n,i){var r;const s=null!==(r=null===i||void 0===i?void 0:i.localName)&&void 0!==r?r:t.substring(t.lastIndexOf(".")+1),o={[s]:function(t){e.util.initFields(this),e.util.initPartial(t,this)}}[s];return Object.setPrototypeOf(o.prototype,new xp),Object.assign(o,{runtime:e,typeName:t,fields:e.util.newFieldList(n),fromBinary:(e,t)=>(new o).fromBinary(e,t),fromJson:(e,t)=>(new o).fromJson(e,t),fromJsonString:(e,t)=>(new o).fromJsonString(e,t),equals:(t,n)=>e.util.equals(o,t,n)}),o}(this,e,t,n)},makeEnum:Tp,makeEnumType:Sp,getEnumType:kp,makeExtension(e,t,n){return function(e,t,n,i){let r;return{typeName:t,extendee:n,get field(){if(!r){const n="function"==typeof i?i():i;n.name=t.split(".").pop(),n.jsonName="[".concat(t,"]"),r=e.util.newFieldList([n]).list()[0]}return r},runtime:e}}(this,e,t,n)}});var Kf,$f;class Gf extends xp{constructor(e){super(),this.seconds=Mp.zero,this.nanos=0,Wf.util.initPartial(e,this)}fromJson(e,t){if("string"!==typeof e)throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(Wf.json.debug(e)));const n=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!n)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const i=Date.parse(n[1]+"-"+n[2]+"-"+n[3]+"T"+n[4]+":"+n[5]+":"+n[6]+(n[8]?n[8]:"Z"));if(Number.isNaN(i))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(i<Date.parse("0001-01-01T00:00:00Z")||i>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=Mp.parse(i/1e3),this.nanos=0,n[7]&&(this.nanos=parseInt("1"+n[7]+"0".repeat(9-n[7].length))-1e9),this}toJson(e){const t=1e3*Number(this.seconds);if(t<Date.parse("0001-01-01T00:00:00Z")||t>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let n="Z";if(this.nanos>0){const e=(this.nanos+1e9).toString().substring(1);n="000000"===e.substring(3)?"."+e.substring(0,3)+"Z":"000"===e.substring(6)?"."+e.substring(0,6)+"Z":"."+e+"Z"}return new Date(t).toISOString().replace(".000Z",n)}toDate(){return new Date(1e3*Number(this.seconds)+Math.ceil(this.nanos/1e6))}static now(){return Gf.fromDate(new Date)}static fromDate(e){const t=e.getTime();return new Gf({seconds:Mp.parse(Math.floor(t/1e3)),nanos:t%1e3*1e6})}static fromBinary(e,t){return(new Gf).fromBinary(e,t)}static fromJson(e,t){return(new Gf).fromJson(e,t)}static fromJsonString(e,t){return(new Gf).fromJsonString(e,t)}static equals(e,t){return Wf.util.equals(Gf,e,t)}}Gf.runtime=Wf,Gf.typeName="google.protobuf.Timestamp",Gf.fields=Wf.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);const Qf=Wf.makeMessageType("livekit.MetricsBatch",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:Gf},{no:3,name:"str_data",kind:"scalar",T:9,repeated:!0},{no:4,name:"time_series",kind:"message",T:Jf,repeated:!0},{no:5,name:"events",kind:"message",T:Xf,repeated:!0}]),Jf=Wf.makeMessageType("livekit.TimeSeriesMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"samples",kind:"message",T:Yf,repeated:!0},{no:5,name:"rid",kind:"scalar",T:13}]),Yf=Wf.makeMessageType("livekit.MetricSample",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:Gf},{no:3,name:"value",kind:"scalar",T:2}]),Xf=Wf.makeMessageType("livekit.EventMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"start_timestamp_ms",kind:"scalar",T:3},{no:5,name:"end_timestamp_ms",kind:"scalar",T:3,opt:!0},{no:6,name:"normalized_start_timestamp",kind:"message",T:Gf},{no:7,name:"normalized_end_timestamp",kind:"message",T:Gf,opt:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"rid",kind:"scalar",T:13}]),Zf=Wf.makeEnum("livekit.BackupCodecPolicy",[{no:0,name:"PREFER_REGRESSION"},{no:1,name:"SIMULCAST"},{no:2,name:"REGRESSION"}]),em=Wf.makeEnum("livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]),tm=Wf.makeEnum("livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]),nm=Wf.makeEnum("livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]),im=Wf.makeEnum("livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]),rm=Wf.makeEnum("livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]),sm=Wf.makeEnum("livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"},{no:8,name:"MIGRATION"},{no:9,name:"SIGNAL_CLOSE"},{no:10,name:"ROOM_CLOSED"},{no:11,name:"USER_UNAVAILABLE"},{no:12,name:"USER_REJECTED"},{no:13,name:"SIP_TRUNK_FAILURE"},{no:14,name:"CONNECTION_TIMEOUT"},{no:15,name:"MEDIA_FAILURE"}]),om=Wf.makeEnum("livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]),am=Wf.makeEnum("livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]),cm=Wf.makeEnum("livekit.AudioTrackFeature",[{no:0,name:"TF_STEREO"},{no:1,name:"TF_NO_DTX"},{no:2,name:"TF_AUTO_GAIN_CONTROL"},{no:3,name:"TF_ECHO_CANCELLATION"},{no:4,name:"TF_NOISE_SUPPRESSION"},{no:5,name:"TF_ENHANCED_NOISE_CANCELLATION"},{no:6,name:"TF_PRECONNECT_BUFFER"}]),lm=Wf.makeMessageType("livekit.Room",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:14,name:"departure_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:15,name:"creation_time_ms",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:um,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8},{no:13,name:"version",kind:"message",T:Vm}]),um=Wf.makeMessageType("livekit.Codec",()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]),dm=Wf.makeMessageType("livekit.ParticipantPermission",()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:Wf.getEnumType(tm),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8},{no:12,name:"can_subscribe_metrics",kind:"scalar",T:8}]),hm=Wf.makeMessageType("livekit.ParticipantInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:Wf.getEnumType(pm)},{no:4,name:"tracks",kind:"message",T:ym,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:17,name:"joined_at_ms",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:dm},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8},{no:14,name:"kind",kind:"enum",T:Wf.getEnumType(fm)},{no:15,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:16,name:"disconnect_reason",kind:"enum",T:Wf.getEnumType(sm)},{no:18,name:"kind_details",kind:"enum",T:Wf.getEnumType(mm),repeated:!0}]),pm=Wf.makeEnum("livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]),fm=Wf.makeEnum("livekit.ParticipantInfo.Kind",[{no:0,name:"STANDARD"},{no:1,name:"INGRESS"},{no:2,name:"EGRESS"},{no:3,name:"SIP"},{no:4,name:"AGENT"}]),mm=Wf.makeEnum("livekit.ParticipantInfo.KindDetail",[{no:0,name:"CLOUD_AGENT"},{no:1,name:"FORWARDED"}]),gm=Wf.makeEnum("livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]),vm=Wf.makeMessageType("livekit.SimulcastCodecInfo",()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:bm,repeated:!0}]),ym=Wf.makeMessageType("livekit.TrackInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:Wf.getEnumType(em)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:Wf.getEnumType(tm)},{no:10,name:"layers",kind:"message",T:bm,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:vm,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:Wf.getEnumType(gm)},{no:17,name:"stream",kind:"scalar",T:9},{no:18,name:"version",kind:"message",T:Vm},{no:19,name:"audio_features",kind:"enum",T:Wf.getEnumType(cm),repeated:!0},{no:20,name:"backup_codec_policy",kind:"enum",T:Wf.getEnumType(Zf)}]),bm=Wf.makeMessageType("livekit.VideoLayer",()=>[{no:1,name:"quality",kind:"enum",T:Wf.getEnumType(nm)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13},{no:6,name:"spatial_layer",kind:"scalar",T:5},{no:7,name:"rid",kind:"scalar",T:9}]),km=Wf.makeMessageType("livekit.DataPacket",()=>[{no:1,name:"kind",kind:"enum",T:Wf.getEnumType(wm)},{no:4,name:"participant_identity",kind:"scalar",T:9},{no:5,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:2,name:"user",kind:"message",T:Cm,oneof:"value"},{no:3,name:"speaker",kind:"message",T:Sm,oneof:"value"},{no:6,name:"sip_dtmf",kind:"message",T:xm,oneof:"value"},{no:7,name:"transcription",kind:"message",T:Em,oneof:"value"},{no:8,name:"metrics",kind:"message",T:Qf,oneof:"value"},{no:9,name:"chat_message",kind:"message",T:Rm,oneof:"value"},{no:10,name:"rpc_request",kind:"message",T:Om,oneof:"value"},{no:11,name:"rpc_ack",kind:"message",T:_m,oneof:"value"},{no:12,name:"rpc_response",kind:"message",T:Nm,oneof:"value"},{no:13,name:"stream_header",kind:"message",T:Wm,oneof:"value"},{no:14,name:"stream_chunk",kind:"message",T:Km,oneof:"value"},{no:15,name:"stream_trailer",kind:"message",T:$m,oneof:"value"},{no:16,name:"sequence",kind:"scalar",T:13},{no:17,name:"participant_sid",kind:"scalar",T:9}]),wm=Wf.makeEnum("livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]),Sm=Wf.makeMessageType("livekit.ActiveSpeakerUpdate",()=>[{no:1,name:"speakers",kind:"message",T:Tm,repeated:!0}]),Tm=Wf.makeMessageType("livekit.SpeakerInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]),Cm=Wf.makeMessageType("livekit.UserPacket",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0},{no:8,name:"id",kind:"scalar",T:9,opt:!0},{no:9,name:"start_time",kind:"scalar",T:4,opt:!0},{no:10,name:"end_time",kind:"scalar",T:4,opt:!0},{no:11,name:"nonce",kind:"scalar",T:12}]),xm=Wf.makeMessageType("livekit.SipDTMF",()=>[{no:3,name:"code",kind:"scalar",T:13},{no:4,name:"digit",kind:"scalar",T:9}]),Em=Wf.makeMessageType("livekit.Transcription",()=>[{no:2,name:"transcribed_participant_identity",kind:"scalar",T:9},{no:3,name:"track_id",kind:"scalar",T:9},{no:4,name:"segments",kind:"message",T:Pm,repeated:!0}]),Pm=Wf.makeMessageType("livekit.TranscriptionSegment",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"text",kind:"scalar",T:9},{no:3,name:"start_time",kind:"scalar",T:4},{no:4,name:"end_time",kind:"scalar",T:4},{no:5,name:"final",kind:"scalar",T:8},{no:6,name:"language",kind:"scalar",T:9}]),Rm=Wf.makeMessageType("livekit.ChatMessage",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"edit_timestamp",kind:"scalar",T:3,opt:!0},{no:4,name:"message",kind:"scalar",T:9},{no:5,name:"deleted",kind:"scalar",T:8},{no:6,name:"generated",kind:"scalar",T:8}]),Om=Wf.makeMessageType("livekit.RpcRequest",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"method",kind:"scalar",T:9},{no:3,name:"payload",kind:"scalar",T:9},{no:4,name:"response_timeout_ms",kind:"scalar",T:13},{no:5,name:"version",kind:"scalar",T:13}]),_m=Wf.makeMessageType("livekit.RpcAck",()=>[{no:1,name:"request_id",kind:"scalar",T:9}]),Nm=Wf.makeMessageType("livekit.RpcResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:9,oneof:"value"},{no:3,name:"error",kind:"message",T:Am,oneof:"value"}]),Am=Wf.makeMessageType("livekit.RpcError",()=>[{no:1,name:"code",kind:"scalar",T:13},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"data",kind:"scalar",T:9}]),Im=Wf.makeMessageType("livekit.ParticipantTracks",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]),jm=Wf.makeMessageType("livekit.ServerInfo",()=>[{no:1,name:"edition",kind:"enum",T:Wf.getEnumType(Dm)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9},{no:7,name:"agent_protocol",kind:"scalar",T:5}]),Dm=Wf.makeEnum("livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]),Mm=Wf.makeMessageType("livekit.ClientInfo",()=>[{no:1,name:"sdk",kind:"enum",T:Wf.getEnumType(Lm)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9},{no:11,name:"other_sdks",kind:"scalar",T:9}]),Lm=Wf.makeEnum("livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"},{no:11,name:"UNITY_WEB"},{no:12,name:"NODE"},{no:13,name:"UNREAL"},{no:14,name:"ESP32"}]),Fm=Wf.makeMessageType("livekit.ClientConfiguration",()=>[{no:1,name:"video",kind:"message",T:Um},{no:2,name:"screen",kind:"message",T:Um},{no:3,name:"resume_connection",kind:"enum",T:Wf.getEnumType(rm)},{no:4,name:"disabled_codecs",kind:"message",T:Bm},{no:5,name:"force_relay",kind:"enum",T:Wf.getEnumType(rm)}]),Um=Wf.makeMessageType("livekit.VideoConfiguration",()=>[{no:1,name:"hardware_encoder",kind:"enum",T:Wf.getEnumType(rm)}]),Bm=Wf.makeMessageType("livekit.DisabledCodecs",()=>[{no:1,name:"codecs",kind:"message",T:um,repeated:!0},{no:2,name:"publish",kind:"message",T:um,repeated:!0}]),Vm=Wf.makeMessageType("livekit.TimedVersion",()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]),qm=Wf.makeEnum("livekit.DataStream.OperationType",[{no:0,name:"CREATE"},{no:1,name:"UPDATE"},{no:2,name:"DELETE"},{no:3,name:"REACTION"}]),zm=Wf.makeMessageType("livekit.DataStream.TextHeader",()=>[{no:1,name:"operation_type",kind:"enum",T:Wf.getEnumType(qm)},{no:2,name:"version",kind:"scalar",T:5},{no:3,name:"reply_to_stream_id",kind:"scalar",T:9},{no:4,name:"attached_stream_ids",kind:"scalar",T:9,repeated:!0},{no:5,name:"generated",kind:"scalar",T:8}],{localName:"DataStream_TextHeader"}),Hm=Wf.makeMessageType("livekit.DataStream.ByteHeader",()=>[{no:1,name:"name",kind:"scalar",T:9}],{localName:"DataStream_ByteHeader"}),Wm=Wf.makeMessageType("livekit.DataStream.Header",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"mime_type",kind:"scalar",T:9},{no:5,name:"total_length",kind:"scalar",T:4,opt:!0},{no:7,name:"encryption_type",kind:"enum",T:Wf.getEnumType(gm)},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:9,name:"text_header",kind:"message",T:zm,oneof:"content_header"},{no:10,name:"byte_header",kind:"message",T:Hm,oneof:"content_header"}],{localName:"DataStream_Header"}),Km=Wf.makeMessageType("livekit.DataStream.Chunk",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"chunk_index",kind:"scalar",T:4},{no:3,name:"content",kind:"scalar",T:12},{no:4,name:"version",kind:"scalar",T:5},{no:5,name:"iv",kind:"scalar",T:12,opt:!0}],{localName:"DataStream_Chunk"}),$m=Wf.makeMessageType("livekit.DataStream.Trailer",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"reason",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}],{localName:"DataStream_Trailer"}),Gm=Wf.makeEnum("livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]),Qm=Wf.makeEnum("livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]),Jm=Wf.makeEnum("livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]),Ym=Wf.makeMessageType("livekit.SignalRequest",()=>[{no:1,name:"offer",kind:"message",T:ag,oneof:"message"},{no:2,name:"answer",kind:"message",T:ag,oneof:"message"},{no:3,name:"trickle",kind:"message",T:tg,oneof:"message"},{no:4,name:"add_track",kind:"message",T:eg,oneof:"message"},{no:5,name:"mute",kind:"message",T:ng,oneof:"message"},{no:6,name:"subscription",kind:"message",T:lg,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:ug,oneof:"message"},{no:8,name:"leave",kind:"message",T:pg,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:mg,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:Rg,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:Ng,oneof:"message"},{no:13,name:"simulate",kind:"message",T:jg,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:gg,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:Dg,oneof:"message"},{no:17,name:"update_audio_track",kind:"message",T:dg,oneof:"message"},{no:18,name:"update_video_track",kind:"message",T:hg,oneof:"message"}]),Xm=Wf.makeMessageType("livekit.SignalResponse",()=>[{no:1,name:"join",kind:"message",T:ig,oneof:"message"},{no:2,name:"answer",kind:"message",T:ag,oneof:"message"},{no:3,name:"offer",kind:"message",T:ag,oneof:"message"},{no:4,name:"trickle",kind:"message",T:tg,oneof:"message"},{no:5,name:"update",kind:"message",T:cg,oneof:"message"},{no:6,name:"track_published",kind:"message",T:sg,oneof:"message"},{no:8,name:"leave",kind:"message",T:pg,oneof:"message"},{no:9,name:"mute",kind:"message",T:ng,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:yg,oneof:"message"},{no:11,name:"room_update",kind:"message",T:bg,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:wg,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:Tg,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:Eg,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:Og,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:og,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:rg,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:Mg,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:Ug,oneof:"message"},{no:22,name:"request_response",kind:"message",T:Bg,oneof:"message"},{no:23,name:"track_subscribed",kind:"message",T:qg,oneof:"message"},{no:24,name:"room_moved",kind:"message",T:_g,oneof:"message"}]),Zm=Wf.makeMessageType("livekit.SimulcastCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9}]),eg=Wf.makeMessageType("livekit.AddTrackRequest",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:Wf.getEnumType(em)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:Wf.getEnumType(tm)},{no:9,name:"layers",kind:"message",T:bm,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:Zm,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:Wf.getEnumType(gm)},{no:15,name:"stream",kind:"scalar",T:9},{no:16,name:"backup_codec_policy",kind:"enum",T:Wf.getEnumType(Zf)},{no:17,name:"audio_features",kind:"enum",T:Wf.getEnumType(cm),repeated:!0}]),tg=Wf.makeMessageType("livekit.TrickleRequest",()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:Wf.getEnumType(Gm)},{no:3,name:"final",kind:"scalar",T:8}]),ng=Wf.makeMessageType("livekit.MuteTrackRequest",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]),ig=Wf.makeMessageType("livekit.JoinResponse",()=>[{no:1,name:"room",kind:"message",T:lm},{no:2,name:"participant",kind:"message",T:hm},{no:3,name:"other_participants",kind:"message",T:hm,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:vg,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:Fm},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:jm},{no:13,name:"sif_trailer",kind:"scalar",T:12},{no:14,name:"enabled_publish_codecs",kind:"message",T:um,repeated:!0},{no:15,name:"fast_publish",kind:"scalar",T:8}]),rg=Wf.makeMessageType("livekit.ReconnectResponse",()=>[{no:1,name:"ice_servers",kind:"message",T:vg,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:Fm},{no:3,name:"server_info",kind:"message",T:jm},{no:4,name:"last_message_seq",kind:"scalar",T:13}]),sg=Wf.makeMessageType("livekit.TrackPublishedResponse",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:ym}]),og=Wf.makeMessageType("livekit.TrackUnpublishedResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),ag=Wf.makeMessageType("livekit.SessionDescription",()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9},{no:3,name:"id",kind:"scalar",T:13}]),cg=Wf.makeMessageType("livekit.ParticipantUpdate",()=>[{no:1,name:"participants",kind:"message",T:hm,repeated:!0}]),lg=Wf.makeMessageType("livekit.UpdateSubscription",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:Im,repeated:!0}]),ug=Wf.makeMessageType("livekit.UpdateTrackSettings",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:Wf.getEnumType(nm)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]),dg=Wf.makeMessageType("livekit.UpdateLocalAudioTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"features",kind:"enum",T:Wf.getEnumType(cm),repeated:!0}]),hg=Wf.makeMessageType("livekit.UpdateLocalVideoTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13}]),pg=Wf.makeMessageType("livekit.LeaveRequest",()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:Wf.getEnumType(sm)},{no:3,name:"action",kind:"enum",T:Wf.getEnumType(fg)},{no:4,name:"regions",kind:"message",T:Lg}]),fg=Wf.makeEnum("livekit.LeaveRequest.Action",[{no:0,name:"DISCONNECT"},{no:1,name:"RESUME"},{no:2,name:"RECONNECT"}]),mg=Wf.makeMessageType("livekit.UpdateVideoLayers",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:bm,repeated:!0}]),gg=Wf.makeMessageType("livekit.UpdateParticipantMetadata",()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:4,name:"request_id",kind:"scalar",T:13}]),vg=Wf.makeMessageType("livekit.ICEServer",()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]),yg=Wf.makeMessageType("livekit.SpeakersChanged",()=>[{no:1,name:"speakers",kind:"message",T:Tm,repeated:!0}]),bg=Wf.makeMessageType("livekit.RoomUpdate",()=>[{no:1,name:"room",kind:"message",T:lm}]),kg=Wf.makeMessageType("livekit.ConnectionQualityInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:Wf.getEnumType(im)},{no:3,name:"score",kind:"scalar",T:2}]),wg=Wf.makeMessageType("livekit.ConnectionQualityUpdate",()=>[{no:1,name:"updates",kind:"message",T:kg,repeated:!0}]),Sg=Wf.makeMessageType("livekit.StreamStateInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:Wf.getEnumType(Qm)}]),Tg=Wf.makeMessageType("livekit.StreamStateUpdate",()=>[{no:1,name:"stream_states",kind:"message",T:Sg,repeated:!0}]),Cg=Wf.makeMessageType("livekit.SubscribedQuality",()=>[{no:1,name:"quality",kind:"enum",T:Wf.getEnumType(nm)},{no:2,name:"enabled",kind:"scalar",T:8}]),xg=Wf.makeMessageType("livekit.SubscribedCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:Cg,repeated:!0}]),Eg=Wf.makeMessageType("livekit.SubscribedQualityUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:Cg,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:xg,repeated:!0}]),Pg=Wf.makeMessageType("livekit.TrackPermission",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]),Rg=Wf.makeMessageType("livekit.SubscriptionPermission",()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:Pg,repeated:!0}]),Og=Wf.makeMessageType("livekit.SubscriptionPermissionUpdate",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]),_g=Wf.makeMessageType("livekit.RoomMovedResponse",()=>[{no:1,name:"room",kind:"message",T:lm},{no:2,name:"token",kind:"scalar",T:9},{no:3,name:"participant",kind:"message",T:hm},{no:4,name:"other_participants",kind:"message",T:hm,repeated:!0}]),Ng=Wf.makeMessageType("livekit.SyncState",()=>[{no:1,name:"answer",kind:"message",T:ag},{no:2,name:"subscription",kind:"message",T:lg},{no:3,name:"publish_tracks",kind:"message",T:sg,repeated:!0},{no:4,name:"data_channels",kind:"message",T:Ig,repeated:!0},{no:5,name:"offer",kind:"message",T:ag},{no:6,name:"track_sids_disabled",kind:"scalar",T:9,repeated:!0},{no:7,name:"datachannel_receive_states",kind:"message",T:Ag,repeated:!0}]),Ag=Wf.makeMessageType("livekit.DataChannelReceiveState",()=>[{no:1,name:"publisher_sid",kind:"scalar",T:9},{no:2,name:"last_seq",kind:"scalar",T:13}]),Ig=Wf.makeMessageType("livekit.DataChannelInfo",()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:Wf.getEnumType(Gm)}]),jg=Wf.makeMessageType("livekit.SimulateScenario",()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:Wf.getEnumType(Jm),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"},{no:9,name:"leave_request_full_reconnect",kind:"scalar",T:8,oneof:"scenario"}]),Dg=Wf.makeMessageType("livekit.Ping",()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]),Mg=Wf.makeMessageType("livekit.Pong",()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]),Lg=Wf.makeMessageType("livekit.RegionSettings",()=>[{no:1,name:"regions",kind:"message",T:Fg,repeated:!0}]),Fg=Wf.makeMessageType("livekit.RegionInfo",()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]),Ug=Wf.makeMessageType("livekit.SubscriptionResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:Wf.getEnumType(am)}]),Bg=Wf.makeMessageType("livekit.RequestResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:13},{no:2,name:"reason",kind:"enum",T:Wf.getEnumType(Vg)},{no:3,name:"message",kind:"scalar",T:9}]),Vg=Wf.makeEnum("livekit.RequestResponse.Reason",[{no:0,name:"OK"},{no:1,name:"NOT_FOUND"},{no:2,name:"NOT_ALLOWED"},{no:3,name:"LIMIT_EXCEEDED"}]),qg=Wf.makeMessageType("livekit.TrackSubscribed",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]);function zg(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Hg,Wg={exports:{}},Kg=Wg.exports;var $g,Gg,Qg=function(){return Hg||(Hg=1,e=Wg,function(t,n){e.exports?e.exports=n():t.log=n()}(Kg,function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],s={},o=null;function a(e,t){var n=e[t];if("function"===typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(r){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function c(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function l(){for(var n=this.getLevel(),r=0;r<i.length;r++){var s=i[r];this[s]=r<n?e:this.methodFactory(s,n,this.name)}if(this.log=this.debug,typeof console===t&&n<this.levels.SILENT)return"No console available for logging"}function u(e){return function(){typeof console!==t&&(l.call(this),this[e].apply(this,arguments))}}function d(i,r,s){return function(i){return"debug"===i&&(i="log"),typeof console!==t&&("trace"===i&&n?c:void 0!==console[i]?a(console,i):void 0!==console.log?a(console,"log"):e)}(i)||u.apply(this,arguments)}function h(e,n){var r,a,c,u=this,h="loglevel";function p(){var e;if(typeof window!==t&&h){try{e=window.localStorage[h]}catch(s){}if(typeof e===t)try{var n=window.document.cookie,i=encodeURIComponent(h),r=n.indexOf(i+"=");-1!==r&&(e=/^([^;]+)/.exec(n.slice(r+i.length+1))[1])}catch(s){}return void 0===u.levels[e]&&(e=void 0),e}}function f(e){var t=e;if("string"===typeof t&&void 0!==u.levels[t.toUpperCase()]&&(t=u.levels[t.toUpperCase()]),"number"===typeof t&&t>=0&&t<=u.levels.SILENT)return t;throw new TypeError("log.setLevel() called with invalid level: "+e)}"string"===typeof e?h+=":"+e:"symbol"===typeof e&&(h=void 0),u.name=e,u.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},u.methodFactory=n||d,u.getLevel=function(){return null!=c?c:null!=a?a:r},u.setLevel=function(e,n){return c=f(e),!1!==n&&function(e){var n=(i[e]||"silent").toUpperCase();if(typeof window!==t&&h){try{return void(window.localStorage[h]=n)}catch(r){}try{window.document.cookie=encodeURIComponent(h)+"="+n+";"}catch(r){}}}(c),l.call(u)},u.setDefaultLevel=function(e){a=f(e),p()||u.setLevel(e,!1)},u.resetLevel=function(){c=null,function(){if(typeof window!==t&&h){try{window.localStorage.removeItem(h)}catch(e){}try{window.document.cookie=encodeURIComponent(h)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}(),l.call(u)},u.enableAll=function(e){u.setLevel(u.levels.TRACE,e)},u.disableAll=function(e){u.setLevel(u.levels.SILENT,e)},u.rebuild=function(){if(o!==u&&(r=f(o.getLevel())),l.call(u),o===u)for(var e in s)s[e].rebuild()},r=f(o?o.getLevel():"WARN");var m=p();null!=m&&(c=f(m)),l.call(u)}(o=new h).getLogger=function(e){if("symbol"!==typeof e&&"string"!==typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=s[e];return t||(t=s[e]=new h(e,o.methodFactory)),t};var p=typeof window!==t?window.log:void 0;return o.noConflict=function(){return typeof window!==t&&window.log===o&&(window.log=p),o},o.getLoggers=function(){return s},o.default=o,o})),Wg.exports;var e}();!function(e){e[e.trace=0]="trace",e[e.debug=1]="debug",e[e.info=2]="info",e[e.warn=3]="warn",e[e.error=4]="error",e[e.silent=5]="silent"}($g||($g={})),function(e){e.Default="livekit",e.Room="livekit-room",e.Participant="livekit-participant",e.Track="livekit-track",e.Publication="livekit-track-publication",e.Engine="livekit-engine",e.Signal="livekit-signal",e.PCManager="livekit-pc-manager",e.PCTransport="livekit-pc-transport",e.E2EE="lk-e2ee"}(Gg||(Gg={}));let Jg=Qg.getLogger("livekit");Object.values(Gg).map(e=>Qg.getLogger(e));function Yg(e){const t=Qg.getLogger(e);return t.setDefaultLevel(Jg.getLevel()),t}Jg.setDefaultLevel($g.info);const Xg=Qg.getLogger("lk-e2ee"),Zg=7e3,ev=[0,300,1200,2700,4800,Zg,Zg,Zg,Zg,Zg];function tv(e,t,n,i){return new(n||(n=Promise))(function(s,o){function a(e){try{l(i.next(e))}catch(r){o(r)}}function c(e){try{l(i.throw(e))}catch(r){o(r)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,c)}l((i=i.apply(e,t||[])).next())})}function nv(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function iv(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=nv(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise(function(i,r){(function(e,t,n,i){Promise.resolve(i).then(function(t){e({value:t,done:n})},t)})(i,r,(t=e[n](t)).done,t.value)})}}}"function"===typeof SuppressedError&&SuppressedError;var rv,sv={exports:{}};var ov=function(){if(rv)return sv.exports;rv=1;var e,t="object"===typeof Reflect?Reflect:null,n=t&&"function"===typeof t.apply?t.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};e=t&&"function"===typeof t.ownKeys?t.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!==e};function r(){r.init.call(this)}sv.exports=r,sv.exports.once=function(e,t){return new Promise(function(n,i){function r(n){e.removeListener(t,s),i(n)}function s(){"function"===typeof e.removeListener&&e.removeListener("error",r),n([].slice.call(arguments))}f(e,t,s,{once:!0}),"error"!==t&&function(e,t,n){"function"===typeof e.on&&f(e,"error",t,n)}(e,r,{once:!0})})},r.EventEmitter=r,r.prototype._events=void 0,r.prototype._eventsCount=0,r.prototype._maxListeners=void 0;var s=10;function o(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function a(e){return void 0===e._maxListeners?r.defaultMaxListeners:e._maxListeners}function c(e,t,n,i){var r,s,c;if(o(n),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),c=s[t]),void 0===c)c=s[t]=n,++e._eventsCount;else if("function"===typeof c?c=s[t]=i?[n,c]:[c,n]:i?c.unshift(n):c.push(n),(r=a(e))>0&&c.length>r&&!c.warned){c.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+c.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=c.length,function(e){console&&console.warn&&console.warn(e)}(l)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=l.bind(i);return r.listener=n,i.wrapFn=r,r}function d(e,t,n){var i=e._events;if(void 0===i)return[];var r=i[t];return void 0===r?[]:"function"===typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):p(r,r.length)}function h(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"===typeof n)return 1;if(void 0!==n)return n.length}return 0}function p(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}function f(e,t,n,i){if("function"===typeof e.on)i.once?e.once(t,n):e.on(t,n);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,function r(s){i.once&&e.removeEventListener(t,r),n(s)})}}return Object.defineProperty(r,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!==typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),r.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},r.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},r.prototype.getMaxListeners=function(){return a(this)},r.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var r="error"===e,s=this._events;if(void 0!==s)r=r&&void 0===s.error;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(void 0===c)return!1;if("function"===typeof c)n(c,this,t);else{var l=c.length,u=p(c,l);for(i=0;i<l;++i)n(u[i],this,t)}return!0},r.prototype.addListener=function(e,t){return c(this,e,t,!1)},r.prototype.on=r.prototype.addListener,r.prototype.prependListener=function(e,t){return c(this,e,t,!0)},r.prototype.once=function(e,t){return o(t),this.on(e,u(this,e,t)),this},r.prototype.prependOnceListener=function(e,t){return o(t),this.prependListener(e,u(this,e,t)),this},r.prototype.removeListener=function(e,t){var n,i,r,s,a;if(o(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!==typeof n){for(r=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){a=n[s].listener,r=s;break}if(r<0)return this;0===r?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,r),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,a||t)}return this},r.prototype.off=r.prototype.removeListener,r.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var r,s=Object.keys(n);for(i=0;i<s.length;++i)"removeListener"!==(r=s[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},r.prototype.listeners=function(e){return d(this,e,!0)},r.prototype.rawListeners=function(e){return d(this,e,!1)},r.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},r.prototype.listenerCount=h,r.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]},sv.exports}();let av=!0,cv=!0;function lv(e,t,n){const i=e.match(t);return i&&i.length>=n&&parseFloat(i[n],10)}function uv(e,t,n){if(!e.RTCPeerConnection)return;const i=e.RTCPeerConnection.prototype,r=i.addEventListener;i.addEventListener=function(e,i){if(e!==t)return r.apply(this,arguments);const s=e=>{const t=n(e);t&&(i.handleEvent?i.handleEvent(t):i(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(i,s),r.apply(this,[e,s])};const s=i.removeEventListener;i.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return s.apply(this,arguments);if(!this._eventMap[t].has(n))return s.apply(this,arguments);const i=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,s.apply(this,[e,i])},Object.defineProperty(i,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function dv(e){return"boolean"!==typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(av=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function hv(e){return"boolean"!==typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(cv=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function pv(){if("object"===typeof window){if(av)return;"undefined"!==typeof console&&"function"===typeof console.log&&console.log.apply(console,arguments)}}function fv(e,t){cv&&console.warn(e+" is deprecated, please use "+t+" instead.")}function mv(e){return"[object Object]"===Object.prototype.toString.call(e)}function gv(e){return mv(e)?Object.keys(e).reduce(function(t,n){const i=mv(e[n]),r=i?gv(e[n]):e[n],s=i&&!Object.keys(r).length;return void 0===r||s?t:Object.assign(t,{[n]:r})},{}):e}function vv(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach(i=>{i.endsWith("Id")?vv(e,e.get(t[i]),n):i.endsWith("Ids")&&t[i].forEach(t=>{vv(e,e.get(t),n)})}))}function yv(e,t,n){const i=n?"outbound-rtp":"inbound-rtp",r=new Map;if(null===t)return r;const s=[];return e.forEach(e=>{"track"===e.type&&e.trackIdentifier===t.id&&s.push(e)}),s.forEach(t=>{e.forEach(n=>{n.type===i&&n.trackId===t.id&&vv(e,n,r)})}),r}const bv=pv;function kv(e,t){const n=e&&e.navigator;if(!n.mediaDevices)return;const i=function(e){if("object"!==typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach(n=>{if("require"===n||"advanced"===n||"mediaSource"===n)return;const i="object"===typeof e[n]?e[n]:{ideal:e[n]};void 0!==i.exact&&"number"===typeof i.exact&&(i.min=i.max=i.exact);const r=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==i.ideal){t.optional=t.optional||[];let e={};"number"===typeof i.ideal?(e[r("min",n)]=i.ideal,t.optional.push(e),e={},e[r("max",n)]=i.ideal,t.optional.push(e)):(e[r("",n)]=i.ideal,t.optional.push(e))}void 0!==i.exact&&"number"!==typeof i.exact?(t.mandatory=t.mandatory||{},t.mandatory[r("",n)]=i.exact):["min","max"].forEach(e=>{void 0!==i[e]&&(t.mandatory=t.mandatory||{},t.mandatory[r(e,n)]=i[e])})}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},r=function(e,r){if(t.version>=61)return r(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===typeof e.audio){const t=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=i(e.audio)}if(e&&"object"===typeof e.video){let s=e.video.facingMode;s=s&&("object"===typeof s?s:{ideal:s});const o=t.version<66;if(s&&("user"===s.exact||"environment"===s.exact||"user"===s.ideal||"environment"===s.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||o)){let t;if(delete e.video.facingMode,"environment"===s.exact||"environment"===s.ideal?t=["back","rear"]:"user"!==s.exact&&"user"!==s.ideal||(t=["front"]),t)return n.mediaDevices.enumerateDevices().then(n=>{n=n.filter(e=>"videoinput"===e.kind);let o=n.find(e=>t.some(t=>e.label.toLowerCase().includes(t)));return!o&&n.length&&t.includes("back")&&(o=n[n.length-1]),o&&(e.video.deviceId=s.exact?{exact:o.deviceId}:{ideal:o.deviceId}),e.video=i(e.video),bv("chrome: "+JSON.stringify(e)),r(e)})}e.video=i(e.video)}return bv("chrome: "+JSON.stringify(e)),r(e)},s=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(e,t,i){r(e,e=>{n.webkitGetUserMedia(e,t,e=>{i&&i(s(e))})})}.bind(n),n.mediaDevices.getUserMedia){const e=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(t){return r(t,t=>e(t).then(e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(e=>{e.stop()}),new DOMException("","NotFoundError");return e},e=>Promise.reject(s(e))))}}}function wv(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function Sv(e){if("object"===typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",n=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(e=>e.track&&e.track.id===n.track.id):{track:n.track};const r=new Event("track");r.track=n.track,r.receiver=i,r.transceiver={receiver:i},r.streams=[t.stream],this.dispatchEvent(r)}),t.stream.getTracks().forEach(n=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(e=>e.track&&e.track.id===n.id):{track:n};const r=new Event("track");r.track=n,r.receiver=i,r.transceiver={receiver:i},r.streams=[t.stream],this.dispatchEvent(r)})},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else uv(e,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function Tv(e){if("object"===typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,i){let r=n.apply(this,arguments);return r||(r=t(this,e),this._senders.push(r)),r};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){i.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach(e=>{this._senders.push(t(this,e))})};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach(e=>{const t=this._senders.find(t=>t.track===e);t&&this._senders.splice(this._senders.indexOf(t),1)})}}else if("object"===typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Cv(e){if(!("object"===typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then(t=>yv(t,e.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e}),uv(e,"track",e=>(e.receiver._pc=e.srcElement,e)),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then(t=>yv(t,e.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,n,i;return this.getSenders().forEach(n=>{n.track===e&&(t?i=!0:t=n)}),this.getReceivers().forEach(t=>(t.track===e&&(n?i=!0:n=t),t.track===e)),i||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function xv(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(e=>this._shimmedLocalStreams[e][0])};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const i=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(i)&&this._shimmedLocalStreams[n.id].push(i):this._shimmedLocalStreams[n.id]=[n,i],i};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(e=>{const t=this.getSenders().find(t=>t.track===e);if(t)throw new DOMException("Track already exists.","InvalidAccessError")});const t=this.getSenders();n.apply(this,arguments);const i=this.getSenders().filter(e=>-1===t.indexOf(e));this._shimmedLocalStreams[e.id]=[e].concat(i)};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],i.apply(this,arguments)};const r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach(t=>{const n=this._shimmedLocalStreams[t].indexOf(e);-1!==n&&this._shimmedLocalStreams[t].splice(n,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]}),r.apply(this,arguments)}}function Ev(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return xv(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map(e=>this._reverseStreams[e.id])};const i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach(e=>{const t=this.getSenders().find(t=>t.track===e);if(t)throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[t.id]){const n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}i.apply(this,[t])};const r=e.RTCPeerConnection.prototype.removeStream;function s(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(t=>{const i=e._reverseStreams[t],r=e._streams[i.id];n=n.replace(new RegExp(r.id,"g"),i.id)}),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},r.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find(e=>e===t))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");const r=this.getSenders().find(e=>e.track===t);if(r)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const s=this._streams[n.id];if(s)s.addTrack(t),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const i=new e.MediaStream([t]);this._streams[n.id]=i,this._reverseStreams[i.id]=n,this.addStream(i)}return this.getSenders().find(e=>e.track===t)},["createOffer","createAnswer"].forEach(function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){const e=arguments;return arguments.length&&"function"===typeof arguments[0]?n.apply(this,[t=>{const n=s(this,t);e[0].apply(null,[n])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):n.apply(this,arguments).then(e=>s(this,e))}};e.RTCPeerConnection.prototype[t]=i[t]});const o=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(t=>{const i=e._reverseStreams[t],r=e._streams[i.id];n=n.replace(new RegExp(i.id,"g"),r.id)}),new RTCSessionDescription({type:t.type,sdp:n})}(this,arguments[0]),o.apply(this,arguments)):o.apply(this,arguments)};const a=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=a.get.apply(this);return""===e.type?e:s(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach(n=>{this._streams[n].getTracks().find(t=>e.track===t)&&(t=this._streams[n])}),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Pv(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]})}function Rv(e,t){uv(e,"negotiationneeded",e=>{const n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e})}var Ov=Object.freeze({__proto__:null,fixNegotiationNeeded:Rv,shimAddTrackRemoveTrack:Ev,shimAddTrackRemoveTrackWithNative:xv,shimGetSendersWithDtmf:Tv,shimGetUserMedia:kv,shimMediaStream:wv,shimOnTrack:Sv,shimPeerConnection:Pv,shimSenderReceiverGetStats:Cv});function _v(e,t){const n=e&&e.navigator,i=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,i){fv("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,i)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},t=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(n){return"object"===typeof n&&"object"===typeof n.audio&&(n=JSON.parse(JSON.stringify(n)),e(n.audio,"autoGainControl","mozAutoGainControl"),e(n.audio,"noiseSuppression","mozNoiseSuppression")),t(n)},i&&i.prototype.getSettings){const t=i.prototype.getSettings;i.prototype.getSettings=function(){const n=t.apply(this,arguments);return e(n,"mozAutoGainControl","autoGainControl"),e(n,"mozNoiseSuppression","noiseSuppression"),n}}if(i&&i.prototype.applyConstraints){const t=i.prototype.applyConstraints;i.prototype.applyConstraints=function(n){return"audio"===this.kind&&"object"===typeof n&&(n=JSON.parse(JSON.stringify(n)),e(n,"autoGainControl","mozAutoGainControl"),e(n,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[n])}}}}function Nv(e){"object"===typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Av(e,t){if("object"!==typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,s,o]=arguments;return i.apply(this,[e||null]).then(e=>{if(t.version<53&&!s)try{e.forEach(e=>{e.type=n[e.type]||e.type})}catch(r){if("TypeError"!==r.name)throw r;e.forEach((t,i)=>{e.set(i,Object.assign({},t,{type:n[t.type]||t.type}))})}return e}).then(s,o)}}function Iv(e){if("object"!==typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function jv(e){if("object"!==typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e}),uv(e,"track",e=>(e.receiver._pc=e.srcElement,e)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function Dv(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){fv("removeStream","removeTrack"),this.getSenders().forEach(t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)})})}function Mv(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function Lv(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let e=arguments[1]&&arguments[1].sendEncodings;void 0===e&&(e=[]),e=[...e];const n=e.length>0;n&&e.forEach(e=>{if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const i=t.apply(this,arguments);if(n){const{sender:t}=i,n=t.getParameters();(!("encodings"in n)||1===n.encodings.length&&0===Object.keys(n.encodings[0]).length)&&(n.encodings=e,t.sendEncodings=e,this.setParametersPromises.push(t.setParameters(n).then(()=>{delete t.sendEncodings}).catch(()=>{delete t.sendEncodings})))}return i})}function Fv(e){if("object"!==typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}function Uv(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}function Bv(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}var Vv=Object.freeze({__proto__:null,shimAddTransceiver:Lv,shimCreateAnswer:Bv,shimCreateOffer:Uv,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})},shimGetParameters:Fv,shimGetUserMedia:_v,shimOnTrack:Nv,shimPeerConnection:Av,shimRTCDataChannel:Mv,shimReceiverGetStats:jv,shimRemoveStream:Dv,shimSenderGetStats:Iv});function qv(e){if("object"===typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach(n=>t.call(this,n,e)),e.getVideoTracks().forEach(n=>t.call(this,n,e))},e.RTCPeerConnection.prototype.addTrack=function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return i&&i.forEach(e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]}),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const n=e.getTracks();this.getSenders().forEach(e=>{n.includes(e.track)&&this.removeTrack(e)})})}}function zv(e){if("object"===typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach(e=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(e))return;this._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)})})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach(t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const n=new Event("addstream");n.stream=t,e.dispatchEvent(n)})}),t.apply(e,arguments)}}}function Hv(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,i=t.createAnswer,r=t.setLocalDescription,s=t.setRemoteDescription,o=t.addIceCandidate;t.createOffer=function(e,t){const i=arguments.length>=2?arguments[2]:arguments[0],r=n.apply(this,[i]);return t?(r.then(e,t),Promise.resolve()):r},t.createAnswer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],r=i.apply(this,[n]);return t?(r.then(e,t),Promise.resolve()):r};let a=function(e,t,n){const i=r.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i};t.setLocalDescription=a,a=function(e,t,n){const i=s.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.setRemoteDescription=a,a=function(e,t,n){const i=o.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.addIceCandidate=a}function Wv(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,n=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>n(Kv(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,i){t.mediaDevices.getUserMedia(e).then(n,i)}.bind(t))}function Kv(e){return e&&void 0!==e.video?Object.assign({},e,{video:gv(e.video)}):e}function $v(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){const t=[];for(let n=0;n<e.iceServers.length;n++){let i=e.iceServers[n];void 0===i.urls&&i.url?(fv("RTCIceServer.url","RTCIceServer.urls"),i=JSON.parse(JSON.stringify(i)),i.urls=i.url,delete i.url,t.push(i)):t.push(e.iceServers[n])}e.iceServers=t}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function Gv(e){"object"===typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Qv(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){"undefined"!==typeof e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find(e=>"audio"===e.receiver.track.kind);!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio",{direction:"recvonly"}),"undefined"!==typeof e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const n=this.getTransceivers().find(e=>"video"===e.receiver.track.kind);!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function Jv(e){"object"!==typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var Yv,Xv=Object.freeze({__proto__:null,shimAudioContext:Jv,shimCallbacksAPI:Hv,shimConstraints:Kv,shimCreateOfferLegacy:Qv,shimGetUserMedia:Wv,shimLocalStreamsAPI:qv,shimRTCIceServerUrls:$v,shimRemoteStreamsAPI:zv,shimTrackEventTransceiver:Gv}),Zv={exports:{}};var ey=(Yv||(Yv=1,function(e){const t={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map(e=>e.trim())},t.splitSections=function(e){return e.split("\nm=").map((e,t)=>(t>0?"m="+e:e).trim()+"\r\n")},t.getDescription=function(e){const n=t.splitSections(e);return n&&n[0]},t.getMediaSections=function(e){const n=t.splitSections(e);return n.shift(),n},t.matchPrefix=function(e,n){return t.splitLines(e).filter(e=>0===e.indexOf(n))},t.parseCandidate=function(e){let t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");const n={foundation:t[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]};for(let i=8;i<t.length;i+=2)switch(t[i]){case"raddr":n.relatedAddress=t[i+1];break;case"rport":n.relatedPort=parseInt(t[i+1],10);break;case"tcptype":n.tcpType=t[i+1];break;case"ufrag":n.ufrag=t[i+1],n.usernameFragment=t[i+1];break;default:void 0===n[t[i]]&&(n[t[i]]=t[i+1])}return n},t.writeCandidate=function(e){const t=[];t.push(e.foundation);const n=e.component;"rtp"===n?t.push(1):"rtcp"===n?t.push(2):t.push(n),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);const i=e.type;return t.push("typ"),t.push(i),"host"!==i&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substring(14).split(" ")},t.parseRtpMap=function(e){let t=e.substring(9).split(" ");const n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},t.writeRtpMap=function(e){let t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);const n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},t.parseExtmap=function(e){const t=e.substring(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1],attributes:t.slice(2).join(" ")}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+(e.attributes?" "+e.attributes:"")+"\r\n"},t.parseFmtp=function(e){const t={};let n;const i=e.substring(e.indexOf(" ")+1).split(";");for(let r=0;r<i.length;r++)n=i[r].trim().split("="),t[n[0].trim()]=n[1];return t},t.writeFmtp=function(e){let t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){const i=[];Object.keys(e.parameters).forEach(t=>{void 0!==e.parameters[t]?i.push(t+"="+e.parameters[t]):i.push(t)}),t+="a=fmtp:"+n+" "+i.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){const t=e.substring(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){let t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(e=>{t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},t.parseSsrcMedia=function(e){const t=e.indexOf(" "),n={ssrc:parseInt(e.substring(7,t),10)},i=e.indexOf(":",t);return i>-1?(n.attribute=e.substring(t+1,i),n.value=e.substring(i+1)):n.attribute=e.substring(t+1),n},t.parseSsrcGroup=function(e){const t=e.substring(13).split(" ");return{semantics:t.shift(),ssrcs:t.map(e=>parseInt(e,10))}},t.getMid=function(e){const n=t.matchPrefix(e,"a=mid:")[0];if(n)return n.substring(6)},t.parseFingerprint=function(e){const t=e.substring(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},t.getDtlsParameters=function(e,n){return{role:"auto",fingerprints:t.matchPrefix(e+n,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){let n="a=setup:"+t+"\r\n";return e.fingerprints.forEach(e=>{n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),n},t.parseCryptoLine=function(e){const t=e.substring(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"===typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;const t=e.substring(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,n){return t.matchPrefix(e+n,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,n){const i=t.matchPrefix(e+n,"a=ice-ufrag:")[0],r=t.matchPrefix(e+n,"a=ice-pwd:")[0];return i&&r?{usernameFragment:i.substring(12),password:r.substring(10)}:null},t.writeIceParameters=function(e){let t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},t.parseRtpParameters=function(e){const n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},i=t.splitLines(e)[0].split(" ");n.profile=i[2];for(let s=3;s<i.length;s++){const r=i[s],o=t.matchPrefix(e,"a=rtpmap:"+r+" ")[0];if(o){const i=t.parseRtpMap(o),s=t.matchPrefix(e,"a=fmtp:"+r+" ");switch(i.parameters=s.length?t.parseFmtp(s[0]):{},i.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+r+" ").map(t.parseRtcpFb),n.codecs.push(i),i.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(i.name.toUpperCase())}}}t.matchPrefix(e,"a=extmap:").forEach(e=>{n.headerExtensions.push(t.parseExtmap(e))});const r=t.matchPrefix(e,"a=rtcp-fb:* ").map(t.parseRtcpFb);return n.codecs.forEach(e=>{r.forEach(t=>{e.rtcpFeedback.find(e=>e.type===t.type&&e.parameter===t.parameter)||e.rtcpFeedback.push(t)})}),n},t.writeRtpDescription=function(e,n){let i="";i+="m="+e+" ",i+=n.codecs.length>0?"9":"0",i+=" "+(n.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=n.codecs.map(e=>void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType).join(" ")+"\r\n",i+="c=IN IP4 0.0.0.0\r\n",i+="a=rtcp:9 IN IP4 0.0.0.0\r\n",n.codecs.forEach(e=>{i+=t.writeRtpMap(e),i+=t.writeFmtp(e),i+=t.writeRtcpFb(e)});let r=0;return n.codecs.forEach(e=>{e.maxptime>r&&(r=e.maxptime)}),r>0&&(i+="a=maxptime:"+r+"\r\n"),n.headerExtensions&&n.headerExtensions.forEach(e=>{i+=t.writeExtmap(e)}),i},t.parseRtpEncodingParameters=function(e){const n=[],i=t.parseRtpParameters(e),r=-1!==i.fecMechanisms.indexOf("RED"),s=-1!==i.fecMechanisms.indexOf("ULPFEC"),o=t.matchPrefix(e,"a=ssrc:").map(e=>t.parseSsrcMedia(e)).filter(e=>"cname"===e.attribute),a=o.length>0&&o[0].ssrc;let c;const l=t.matchPrefix(e,"a=ssrc-group:FID").map(e=>e.substring(17).split(" ").map(e=>parseInt(e,10)));l.length>0&&l[0].length>1&&l[0][0]===a&&(c=l[0][1]),i.codecs.forEach(e=>{if("RTX"===e.name.toUpperCase()&&e.parameters.apt){let t={ssrc:a,codecPayloadType:parseInt(e.parameters.apt,10)};a&&c&&(t.rtx={ssrc:c}),n.push(t),r&&(t=JSON.parse(JSON.stringify(t)),t.fec={ssrc:a,mechanism:s?"red+ulpfec":"red"},n.push(t))}}),0===n.length&&a&&n.push({ssrc:a});let u=t.matchPrefix(e,"b=");return u.length&&(u=0===u[0].indexOf("b=TIAS:")?parseInt(u[0].substring(7),10):0===u[0].indexOf("b=AS:")?1e3*parseInt(u[0].substring(5),10)*.95-16e3:void 0,n.forEach(e=>{e.maxBitrate=u})),n},t.parseRtcpParameters=function(e){const n={},i=t.matchPrefix(e,"a=ssrc:").map(e=>t.parseSsrcMedia(e)).filter(e=>"cname"===e.attribute)[0];i&&(n.cname=i.value,n.ssrc=i.ssrc);const r=t.matchPrefix(e,"a=rtcp-rsize");n.reducedSize=r.length>0,n.compound=0===r.length;const s=t.matchPrefix(e,"a=rtcp-mux");return n.mux=s.length>0,n},t.writeRtcpParameters=function(e){let t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},t.parseMsid=function(e){let n;const i=t.matchPrefix(e,"a=msid:");if(1===i.length)return n=i[0].substring(7).split(" "),{stream:n[0],track:n[1]};const r=t.matchPrefix(e,"a=ssrc:").map(e=>t.parseSsrcMedia(e)).filter(e=>"msid"===e.attribute);return r.length>0?(n=r[0].value.split(" "),{stream:n[0],track:n[1]}):void 0},t.parseSctpDescription=function(e){const n=t.parseMLine(e),i=t.matchPrefix(e,"a=max-message-size:");let r;i.length>0&&(r=parseInt(i[0].substring(19),10)),isNaN(r)&&(r=65536);const s=t.matchPrefix(e,"a=sctp-port:");if(s.length>0)return{port:parseInt(s[0].substring(12),10),protocol:n.fmt,maxMessageSize:r};const o=t.matchPrefix(e,"a=sctpmap:");if(o.length>0){const e=o[0].substring(10).split(" ");return{port:parseInt(e[0],10),protocol:e[1],maxMessageSize:r}}},t.writeSctpDescription=function(e,t){let n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,22)},t.writeSessionBoilerplate=function(e,n,i){let r;const s=void 0!==n?n:2;return r=e||t.generateSessionId(),"v=0\r\no="+(i||"thisisadapterortc")+" "+r+" "+s+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.getDirection=function(e,n){const i=t.splitLines(e);for(let t=0;t<i.length;t++)switch(i[t]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[t].substring(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substring(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){const n=t.splitLines(e)[0].substring(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},t.parseOLine=function(e){const n=t.matchPrefix(e,"o=")[0].substring(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},t.isValidSDP=function(e){if("string"!==typeof e||0===e.length)return!1;const n=t.splitLines(e);for(let t=0;t<n.length;t++)if(n[t].length<2||"="!==n[t].charAt(1))return!1;return!0},e.exports=t}(Zv)),Zv.exports),ty=zg(ey),ny=dp({__proto__:null,default:ty},[ey]);function iy(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substring(2)),e.candidate&&e.candidate.length){const n=new t(e),i=ty.parseCandidate(e.candidate);for(const e in i)e in n||Object.defineProperty(n,e,{value:i[e]});return n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}},n}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,uv(e,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t))}function ry(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||uv(e,"icecandidate",e=>{if(e.candidate){const t=ty.parseCandidate(e.candidate.candidate);"relay"===t.type&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e})}function sy(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return"undefined"===typeof this._sctp?null:this._sctp}});const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return"undefined"===typeof this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;const t=ty.splitSections(e.sdp);return t.shift(),t.some(e=>{const t=ty.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")})}(arguments[0])){const e=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const n=parseInt(t[1],10);return n!==n?-1:n}(arguments[0]),n=function(e){let n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n}(e),i=function(e,n){let i=65536;"firefox"===t.browser&&57===t.version&&(i=65535);const r=ty.matchPrefix(e.sdp,"a=max-message-size:");return r.length>0?i=parseInt(r[0].substring(19),10):"firefox"===t.browser&&-1!==n&&(i=2147483637),i}(arguments[0],e);let r;r=0===n&&0===i?Number.POSITIVE_INFINITY:0===n||0===i?Math.max(n,i):Math.min(n,i);const s={};Object.defineProperty(s,"maxMessageSize",{get:()=>r}),this._sctp=s}return n.apply(this,arguments)}}function oy(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const n=e.send;e.send=function(){const i=arguments[0],r=i.length||i.size||i.byteLength;if("open"===e.readyState&&t.sctp&&r>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=n.apply(this,arguments);return t(e,this),e},uv(e,"datachannel",e=>(t(e.channel,e.target),e))}function ay(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(e=>{const n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}})}function cy(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t._safariVersion>=13.1)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){const n=t.sdp.split("\n").filter(e=>"a=extmap-allow-mixed"!==e.trim()).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:n}):t.sdp=n}return n.apply(this,arguments)}}function ly(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function uy(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.setLocalDescription;n&&0!==n.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){let e=arguments[0]||{};if("object"!==typeof e||e.type&&e.sdp)return n.apply(this,arguments);if(e={type:e.type,sdp:e.sdp},!e.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":e.type="offer";break;default:e.type="answer"}if(e.sdp||"offer"!==e.type&&"answer"!==e.type)return n.apply(this,[e]);return("offer"===e.type?this.createOffer:this.createAnswer).apply(this).then(e=>n.apply(this,[e]))})}var dy=Object.freeze({__proto__:null,removeExtmapAllowMixed:cy,shimAddIceCandidateNullOrEmpty:ly,shimConnectionState:ay,shimMaxMessageSize:sy,shimParameterlessSetLocalDescription:uy,shimRTCIceCandidate:iy,shimRTCIceCandidateRelayProtocol:ry,shimSendThrowTypeError:oy});!function(){let{window:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=pv,i=function(e){const t={browser:null,version:null};if("undefined"===typeof e||!e.navigator||!e.navigator.userAgent)return t.browser="Not a browser.",t;const{navigator:n}=e;if(n.userAgentData&&n.userAgentData.brands){const e=n.userAgentData.brands.find(e=>"Chromium"===e.brand);if(e)return{browser:"chrome",version:parseInt(e.version,10)}}if(n.mozGetUserMedia)t.browser="firefox",t.version=parseInt(lv(n.userAgent,/Firefox\/(\d+)\./,1));else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection)t.browser="chrome",t.version=parseInt(lv(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=parseInt(lv(n.userAgent,/AppleWebKit\/(\d+)\./,1)),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype,t._safariVersion=lv(n.userAgent,/Version\/(\d+(\.?\d+))/,1)}return t}(e),r={browserDetails:i,commonShim:dy,extractVersion:lv,disableLog:dv,disableWarnings:hv,sdp:ny};switch(i.browser){case"chrome":if(!Ov||!Pv||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),r;if(null===i.version)return n("Chrome shim can not determine version, not shimming."),r;n("adapter.js shimming chrome."),r.browserShim=Ov,ly(e,i),uy(e),kv(e,i),wv(e),Pv(e,i),Sv(e),Ev(e,i),Tv(e),Cv(e),Rv(e,i),iy(e),ry(e),ay(e),sy(e,i),oy(e),cy(e,i);break;case"firefox":if(!Vv||!Av||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),r;n("adapter.js shimming firefox."),r.browserShim=Vv,ly(e,i),uy(e),_v(e,i),Av(e,i),Nv(e),Dv(e),Iv(e),jv(e),Mv(e),Lv(e),Fv(e),Uv(e),Bv(e),iy(e),ay(e),sy(e,i),oy(e);break;case"safari":if(!Xv||!t.shimSafari)return n("Safari shim is not included in this adapter release."),r;n("adapter.js shimming safari."),r.browserShim=Xv,ly(e,i),uy(e),$v(e),Qv(e),Hv(e),qv(e),zv(e),Gv(e),Wv(e),Jv(e),iy(e),ry(e),sy(e,i),oy(e),cy(e,i);break;default:n("Unsupported browser!")}}({window:"undefined"===typeof window?void 0:window});const hy="lk_e2ee";var py,fy,my,gy;function vy(){return"undefined"!==typeof window.RTCRtpSender&&"undefined"!==typeof window.RTCRtpSender.prototype.createEncodedStreams||yy()}function yy(){return"undefined"!==typeof window.RTCRtpScriptTransform}!function(e){e.SetKey="setKey",e.RatchetRequest="ratchetRequest",e.KeyRatcheted="keyRatcheted"}(py||(py={})),function(e){e.KeyRatcheted="keyRatcheted"}(fy||(fy={})),function(e){e.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",e.EncryptionError="encryptionError"}(my||(my={})),function(e){e.Error="cryptorError"}(gy||(gy={}));ov.EventEmitter;class by extends Error{constructor(e,t){super(t||"an error has occured"),this.name="LiveKitError",this.code=e}}var ky,wy,Sy,Ty,Cy,xy,Ey;!function(e){e[e.NotAllowed=0]="NotAllowed",e[e.ServerUnreachable=1]="ServerUnreachable",e[e.InternalError=2]="InternalError",e[e.Cancelled=3]="Cancelled",e[e.LeaveRequest=4]="LeaveRequest",e[e.Timeout=5]="Timeout"}(ky||(ky={}));class Py extends by{constructor(e,t,n,i){super(1,e),this.name="ConnectionError",this.status=n,this.reason=t,this.context=i,this.reasonName=ky[t]}}class Ry extends by{constructor(e){super(21,null!==e&&void 0!==e?e:"device is unsupported"),this.name="DeviceUnsupportedError"}}class Oy extends by{constructor(e){super(20,null!==e&&void 0!==e?e:"track is invalid"),this.name="TrackInvalidError"}}class _y extends by{constructor(e){super(10,null!==e&&void 0!==e?e:"unsupported server"),this.name="UnsupportedServer"}}class Ny extends by{constructor(e){super(12,null!==e&&void 0!==e?e:"unexpected connection state"),this.name="UnexpectedConnectionState"}}class Ay extends by{constructor(e){super(13,null!==e&&void 0!==e?e:"unable to negotiate"),this.name="NegotiationError"}}class Iy extends by{constructor(e,t){super(15,e),this.name="PublishTrackError",this.status=t}}class jy extends by{constructor(e,t){super(15,e),this.reason=t,this.reasonName="string"===typeof t?t:Vg[t]}}!function(e){e.PermissionDenied="PermissionDenied",e.NotFound="NotFound",e.DeviceInUse="DeviceInUse",e.Other="Other"}(wy||(wy={})),function(e){e.getFailure=function(t){if(t&&"name"in t)return"NotFoundError"===t.name||"DevicesNotFoundError"===t.name?e.NotFound:"NotAllowedError"===t.name||"PermissionDeniedError"===t.name?e.PermissionDenied:"NotReadableError"===t.name||"TrackStartError"===t.name?e.DeviceInUse:e.Other}}(wy||(wy={})),function(e){e[e.InvalidKey=0]="InvalidKey",e[e.MissingKey=1]="MissingKey",e[e.InternalError=2]="InternalError"}(Sy||(Sy={}));!function(e){e.Connected="connected",e.Reconnecting="reconnecting",e.SignalReconnecting="signalReconnecting",e.Reconnected="reconnected",e.Disconnected="disconnected",e.ConnectionStateChanged="connectionStateChanged",e.Moved="moved",e.MediaDevicesChanged="mediaDevicesChanged",e.ParticipantConnected="participantConnected",e.ParticipantDisconnected="participantDisconnected",e.TrackPublished="trackPublished",e.TrackSubscribed="trackSubscribed",e.TrackSubscriptionFailed="trackSubscriptionFailed",e.TrackUnpublished="trackUnpublished",e.TrackUnsubscribed="trackUnsubscribed",e.TrackMuted="trackMuted",e.TrackUnmuted="trackUnmuted",e.LocalTrackPublished="localTrackPublished",e.LocalTrackUnpublished="localTrackUnpublished",e.LocalAudioSilenceDetected="localAudioSilenceDetected",e.ActiveSpeakersChanged="activeSpeakersChanged",e.ParticipantMetadataChanged="participantMetadataChanged",e.ParticipantNameChanged="participantNameChanged",e.ParticipantAttributesChanged="participantAttributesChanged",e.ParticipantActive="participantActive",e.RoomMetadataChanged="roomMetadataChanged",e.DataReceived="dataReceived",e.SipDTMFReceived="sipDTMFReceived",e.TranscriptionReceived="transcriptionReceived",e.ConnectionQualityChanged="connectionQualityChanged",e.TrackStreamStateChanged="trackStreamStateChanged",e.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",e.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",e.AudioPlaybackStatusChanged="audioPlaybackChanged",e.VideoPlaybackStatusChanged="videoPlaybackChanged",e.MediaDevicesError="mediaDevicesError",e.ParticipantPermissionsChanged="participantPermissionsChanged",e.SignalConnected="signalConnected",e.RecordingStatusChanged="recordingStatusChanged",e.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",e.EncryptionError="encryptionError",e.DCBufferStatusChanged="dcBufferStatusChanged",e.ActiveDeviceChanged="activeDeviceChanged",e.ChatMessage="chatMessage",e.LocalTrackSubscribed="localTrackSubscribed",e.MetricsReceived="metricsReceived"}(Ty||(Ty={})),function(e){e.TrackPublished="trackPublished",e.TrackSubscribed="trackSubscribed",e.TrackSubscriptionFailed="trackSubscriptionFailed",e.TrackUnpublished="trackUnpublished",e.TrackUnsubscribed="trackUnsubscribed",e.TrackMuted="trackMuted",e.TrackUnmuted="trackUnmuted",e.LocalTrackPublished="localTrackPublished",e.LocalTrackUnpublished="localTrackUnpublished",e.LocalTrackCpuConstrained="localTrackCpuConstrained",e.LocalSenderCreated="localSenderCreated",e.ParticipantMetadataChanged="participantMetadataChanged",e.ParticipantNameChanged="participantNameChanged",e.DataReceived="dataReceived",e.SipDTMFReceived="sipDTMFReceived",e.TranscriptionReceived="transcriptionReceived",e.IsSpeakingChanged="isSpeakingChanged",e.ConnectionQualityChanged="connectionQualityChanged",e.TrackStreamStateChanged="trackStreamStateChanged",e.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",e.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",e.TrackCpuConstrained="trackCpuConstrained",e.MediaDevicesError="mediaDevicesError",e.AudioStreamAcquired="audioStreamAcquired",e.ParticipantPermissionsChanged="participantPermissionsChanged",e.PCTrackAdded="pcTrackAdded",e.AttributesChanged="attributesChanged",e.LocalTrackSubscribed="localTrackSubscribed",e.ChatMessage="chatMessage",e.Active="active"}(Cy||(Cy={})),function(e){e.TransportsCreated="transportsCreated",e.Connected="connected",e.Disconnected="disconnected",e.Resuming="resuming",e.Resumed="resumed",e.Restarting="restarting",e.Restarted="restarted",e.SignalResumed="signalResumed",e.SignalRestarted="signalRestarted",e.Closing="closing",e.MediaTrackAdded="mediaTrackAdded",e.ActiveSpeakersUpdate="activeSpeakersUpdate",e.DataPacketReceived="dataPacketReceived",e.RTPVideoMapUpdate="rtpVideoMapUpdate",e.DCBufferStatusChanged="dcBufferStatusChanged",e.ParticipantUpdate="participantUpdate",e.RoomUpdate="roomUpdate",e.SpeakersChanged="speakersChanged",e.StreamStateChanged="streamStateChanged",e.ConnectionQualityUpdate="connectionQualityUpdate",e.SubscriptionError="subscriptionError",e.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",e.RemoteMute="remoteMute",e.SubscribedQualityUpdate="subscribedQualityUpdate",e.LocalTrackUnpublished="localTrackUnpublished",e.LocalTrackSubscribed="localTrackSubscribed",e.Offline="offline",e.SignalRequestResponse="signalRequestResponse",e.SignalConnected="signalConnected",e.RoomMoved="roomMoved"}(xy||(xy={})),function(e){e.Message="message",e.Muted="muted",e.Unmuted="unmuted",e.Restarted="restarted",e.Ended="ended",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed",e.CpuConstrained="cpuConstrained",e.UpdateSettings="updateSettings",e.UpdateSubscription="updateSubscription",e.AudioPlaybackStarted="audioPlaybackStarted",e.AudioPlaybackFailed="audioPlaybackFailed",e.AudioSilenceDetected="audioSilenceDetected",e.VisibilityChanged="visibilityChanged",e.VideoDimensionsChanged="videoDimensionsChanged",e.VideoPlaybackStarted="videoPlaybackStarted",e.VideoPlaybackFailed="videoPlaybackFailed",e.ElementAttached="elementAttached",e.ElementDetached="elementDetached",e.UpstreamPaused="upstreamPaused",e.UpstreamResumed="upstreamResumed",e.SubscriptionPermissionChanged="subscriptionPermissionChanged",e.SubscriptionStatusChanged="subscriptionStatusChanged",e.SubscriptionFailed="subscriptionFailed",e.TrackProcessorUpdate="trackProcessorUpdate",e.AudioTrackFeatureUpdate="audioTrackFeatureUpdate",e.TranscriptionReceived="transcriptionReceived",e.TimeSyncUpdate="timeSyncUpdate",e.PreConnectBufferFlushed="preConnectBufferFlushed"}(Ey||(Ey={}));const Dy=/version\/(\d+(\.?_?\d+)+)/i;let My;function Ly(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("undefined"===typeof e&&"undefined"===typeof navigator)return;const n=(null!==e&&void 0!==e?e:navigator.userAgent).toLowerCase();if(void 0===My||t){const e=Fy.find(e=>{let{test:t}=e;return t.test(n)});My=null===e||void 0===e?void 0:e.describe(n)}return My}const Fy=[{test:/firefox|iceweasel|fxios/i,describe:e=>({name:"Firefox",version:Uy(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e),os:e.toLowerCase().includes("fxios")?"iOS":void 0,osVersion:By(e)})},{test:/chrom|crios|crmo/i,describe:e=>({name:"Chrome",version:Uy(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e),os:e.toLowerCase().includes("crios")?"iOS":void 0,osVersion:By(e)})},{test:/safari|applewebkit/i,describe:e=>({name:"Safari",version:Uy(Dy,e),os:e.includes("mobile/")?"iOS":"macOS",osVersion:By(e)})}];function Uy(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const i=t.match(e);return i&&i.length>=n&&i[n]||""}function By(e){return e.includes("mac os")?Uy(/\(.+?(\d+_\d+(:?_\d+)?)/,e,1).replace(/_/g,"."):void 0}class Vy{}Vy.setTimeout=function(){return setTimeout(...arguments)},Vy.setInterval=function(){return setInterval(...arguments)},Vy.clearTimeout=function(){return clearTimeout(...arguments)},Vy.clearInterval=function(){return clearInterval(...arguments)};const qy=[];var zy;!function(e){e[e.LOW=0]="LOW",e[e.MEDIUM=1]="MEDIUM",e[e.HIGH=2]="HIGH"}(zy||(zy={}));class Hy extends ov.EventEmitter{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var i;super(),this.attachedElements=[],this.isMuted=!1,this.streamState=Hy.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=Jg,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),"hidden"===document.visibilityState?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),5e3):this.handleAppVisibilityChanged()},this.log=Yg(null!==(i=n.loggerName)&&void 0!==i?i:Gg.Track),this.loggerContextCb=n.loggerContextCb,this.setMaxListeners(100),this.kind=t,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=Hy.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},null===(e=this.loggerContextCb)||void 0===e?void 0:e.call(this)),Zb(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let t="audio";this.kind===Hy.Kind.Video&&(t="video"),0===this.attachedElements.length&&this.kind===Hy.Kind.Video&&this.addAppVisibilityListener(),e||("audio"===t&&(qy.forEach(t=>{null!==t.parentElement||e||(e=t)}),e&&qy.splice(qy.indexOf(e),1)),e||(e=document.createElement(t))),this.attachedElements.includes(e)||this.attachedElements.push(e),Wy(this.mediaStreamTrack,e);const n=e.srcObject.getTracks(),i=n.some(e=>"audio"===e.kind);return e.play().then(()=>{this.emit(i?Ey.AudioPlaybackStarted:Ey.VideoPlaybackStarted)}).catch(t=>{"NotAllowedError"===t.name?this.emit(i?Ey.AudioPlaybackFailed:Ey.VideoPlaybackFailed,t):"AbortError"===t.name?Jg.debug("".concat(i?"audio":"video"," playback aborted, likely due to new play request")):Jg.warn("could not playback ".concat(i?"audio":"video"),t),i&&e&&n.some(e=>"video"===e.kind)&&"NotAllowedError"===t.name&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(Ey.ElementAttached,e),e}detach(e){try{if(e){Ky(this.mediaStreamTrack,e);const t=this.attachedElements.indexOf(e);return t>=0&&(this.attachedElements.splice(t,1),this.recycleElement(e),this.emit(Ey.ElementDetached,e)),e}const t=[];return this.attachedElements.forEach(e=>{Ky(this.mediaStreamTrack,e),t.push(e),this.recycleElement(e),this.emit(Ey.ElementDetached,e)}),this.attachedElements=[],t}finally{0===this.attachedElements.length&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval),this.timeSyncHandle&&cancelAnimationFrame(this.timeSyncHandle)}updateLoggerOptions(e){e.loggerName&&(this.log=Yg(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let t=!0;e.pause(),qy.forEach(e=>{e.parentElement||(t=!1)}),t&&qy.push(e)}}handleAppVisibilityChanged(){return tv(this,void 0,void 0,function*(){this.isInBackground="hidden"===document.visibilityState,this.isInBackground||this.kind!==Hy.Kind.Video||setTimeout(()=>this.attachedElements.forEach(e=>e.play().catch(()=>{})),0)})}addAppVisibilityListener(){pb()?(this.isInBackground="hidden"===document.visibilityState,document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){pb()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function Wy(e,t){let n,i;n=t.srcObject instanceof MediaStream?t.srcObject:new MediaStream,i="audio"===e.kind?n.getAudioTracks():n.getVideoTracks(),i.includes(e)||(i.forEach(e=>{n.removeTrack(e)}),n.addTrack(e)),lb()&&t instanceof HTMLVideoElement||(t.autoplay=!0),t.muted=0===n.getAudioTracks().length,t instanceof HTMLVideoElement&&(t.playsInline=!0),t.srcObject!==n&&(t.srcObject=n,(lb()||cb())&&t instanceof HTMLVideoElement&&setTimeout(()=>{t.srcObject=n,t.play().catch(()=>{})},0))}function Ky(e,t){if(t.srcObject instanceof MediaStream){const n=t.srcObject;n.removeTrack(e),n.getTracks().length>0?t.srcObject=n:t.srcObject=null}}!function(e){let t,n,i;!function(e){e.Audio="audio",e.Video="video",e.Unknown="unknown"}(t=e.Kind||(e.Kind={})),function(e){e.Camera="camera",e.Microphone="microphone",e.ScreenShare="screen_share",e.ScreenShareAudio="screen_share_audio",e.Unknown="unknown"}(n=e.Source||(e.Source={})),function(e){e.Active="active",e.Paused="paused",e.Unknown="unknown"}(i=e.StreamState||(e.StreamState={})),e.kindToProto=function(e){switch(e){case t.Audio:return em.AUDIO;case t.Video:return em.VIDEO;default:return em.DATA}},e.kindFromProto=function(e){switch(e){case em.AUDIO:return t.Audio;case em.VIDEO:return t.Video;default:return t.Unknown}},e.sourceToProto=function(e){switch(e){case n.Camera:return tm.CAMERA;case n.Microphone:return tm.MICROPHONE;case n.ScreenShare:return tm.SCREEN_SHARE;case n.ScreenShareAudio:return tm.SCREEN_SHARE_AUDIO;default:return tm.UNKNOWN}},e.sourceFromProto=function(e){switch(e){case tm.CAMERA:return n.Camera;case tm.MICROPHONE:return n.Microphone;case tm.SCREEN_SHARE:return n.ScreenShare;case tm.SCREEN_SHARE_AUDIO:return n.ScreenShareAudio;default:return n.Unknown}},e.streamStateFromProto=function(e){switch(e){case Qm.ACTIVE:return i.Active;case Qm.PAUSED:return i.Paused;default:return i.Unknown}}}(Hy||(Hy={}));class $y{constructor(e,t,n,i,r){if("object"===typeof e)this.width=e.width,this.height=e.height,this.aspectRatio=e.aspectRatio,this.encoding={maxBitrate:e.maxBitrate,maxFramerate:e.maxFramerate,priority:e.priority};else{if(void 0===t||void 0===n)throw new TypeError("Unsupported options: provide at least width, height and maxBitrate");this.width=e,this.height=t,this.aspectRatio=e/t,this.encoding={maxBitrate:n,maxFramerate:i,priority:r}}}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.aspectRatio}}}const Gy=["vp8","h264"],Qy=["vp8","h264","vp9","av1","h265"];function Jy(e){return!!Gy.find(t=>t===e)}var Yy,Xy;!function(e){e[e.PREFER_REGRESSION=0]="PREFER_REGRESSION",e[e.SIMULCAST=1]="SIMULCAST",e[e.REGRESSION=2]="REGRESSION"}(Yy||(Yy={})),function(e){e.telephone={maxBitrate:12e3},e.speech={maxBitrate:24e3},e.music={maxBitrate:48e3},e.musicStereo={maxBitrate:64e3},e.musicHighQuality={maxBitrate:96e3},e.musicHighQualityStereo={maxBitrate:128e3}}(Xy||(Xy={}));const Zy={h90:new $y(160,90,9e4,20),h180:new $y(320,180,16e4,20),h216:new $y(384,216,18e4,20),h360:new $y(640,360,45e4,20),h540:new $y(960,540,8e5,25),h720:new $y(1280,720,17e5,30),h1080:new $y(1920,1080,3e6,30),h1440:new $y(2560,1440,5e6,30),h2160:new $y(3840,2160,8e6,30)},eb={h120:new $y(160,120,7e4,20),h180:new $y(240,180,125e3,20),h240:new $y(320,240,14e4,20),h360:new $y(480,360,33e4,20),h480:new $y(640,480,5e5,20),h540:new $y(720,540,6e5,25),h720:new $y(960,720,13e5,30),h1080:new $y(1440,1080,23e5,30),h1440:new $y(1920,1440,38e5,30)},tb={h360fps3:new $y(640,360,2e5,3,"medium"),h360fps15:new $y(640,360,4e5,15,"medium"),h720fps5:new $y(1280,720,8e5,5,"medium"),h720fps15:new $y(1280,720,15e5,15,"medium"),h720fps30:new $y(1280,720,2e6,30,"medium"),h1080fps15:new $y(1920,1080,25e5,15,"medium"),h1080fps30:new $y(1920,1080,5e6,30,"medium"),original:new $y(0,0,7e6,30,"medium")},nb="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function ib(e){return tv(this,void 0,void 0,function*(){return new Promise(t=>Vy.setTimeout(t,e))})}function rb(){return"addTransceiver"in RTCPeerConnection.prototype}function sb(){return"addTrack"in RTCPeerConnection.prototype}function ob(e){return"av1"===e||"vp9"===e}function ab(e){return!(!document||ub())&&(e||(e=document.createElement("audio")),"setSinkId"in e)}function cb(){var e;return"Firefox"===(null===(e=Ly())||void 0===e?void 0:e.name)}function lb(){var e;return"Safari"===(null===(e=Ly())||void 0===e?void 0:e.name)}function ub(){const e=Ly();return"Safari"===(null===e||void 0===e?void 0:e.name)||"iOS"===(null===e||void 0===e?void 0:e.os)}function db(){const e=Ly();return"Safari"===(null===e||void 0===e?void 0:e.name)&&e.version.startsWith("17.")||"iOS"===(null===e||void 0===e?void 0:e.os)&&!!(null===e||void 0===e?void 0:e.osVersion)&&bb(e.osVersion,"17")>=0}function hb(){var e,t;return!!pb()&&(null!==(t=null===(e=navigator.userAgentData)||void 0===e?void 0:e.mobile)&&void 0!==t?t:/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent))}function pb(){return"undefined"!==typeof document}function fb(){return"ReactNative"==navigator.product}function mb(e){return e.hostname.endsWith(".livekit.cloud")||e.hostname.endsWith(".livekit.run")}function gb(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function vb(){if(!fb())return;let e=gb();return e?e.platform:void 0}function yb(){if(pb())return window.devicePixelRatio;if(fb()){let e=gb();if(e)return e.devicePixelRatio}return 1}function bb(e,t){const n=e.split("."),i=t.split("."),r=Math.min(n.length,i.length);for(let s=0;s<r;++s){const e=parseInt(n[s],10),t=parseInt(i[s],10);if(e>t)return 1;if(e<t)return-1;if(s===r-1&&e===t)return 0}return""===e&&""!==t?-1:""===t?1:n.length==i.length?0:n.length<i.length?-1:1}function kb(e){for(const t of e)t.target.handleResize(t)}function wb(e){for(const t of e)t.target.handleVisibilityChanged(t)}let Sb=null;const Tb=()=>(Sb||(Sb=new ResizeObserver(kb)),Sb);let Cb=null;const xb=()=>(Cb||(Cb=new IntersectionObserver(wb,{root:null,rootMargin:"0px"})),Cb);let Eb;function Pb(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=document.createElement("canvas");r.width=e,r.height=t;const s=r.getContext("2d");null===s||void 0===s||s.fillRect(0,0,r.width,r.height),i&&s&&(s.beginPath(),s.arc(e/2,t/2,50,0,2*Math.PI,!0),s.closePath(),s.fillStyle="grey",s.fill());const o=r.captureStream(),[a]=o.getTracks();if(!a)throw Error("Could not get empty media stream video track");return a.enabled=n,a}function Rb(){if(!Eb){const e=new AudioContext,t=e.createOscillator(),n=e.createGain();n.gain.setValueAtTime(0,0);const i=e.createMediaStreamDestination();if(t.connect(n),n.connect(i),t.start(),[Eb]=i.stream.getAudioTracks(),!Eb)throw Error("Could not get empty media stream audio track");Eb.enabled=!1}return Eb.clone()}class Ob{get isResolved(){return this._isResolved}constructor(e,t){this._isResolved=!1,this.onFinally=t,this.promise=new Promise((t,n)=>tv(this,void 0,void 0,function*(){this.resolve=t,this.reject=n,e&&(yield e(t,n))})).finally(()=>{var e;this._isResolved=!0,null===(e=this.onFinally)||void 0===e||e.call(this)})}}function _b(e){if("string"===typeof e||"number"===typeof e)return e;if(Array.isArray(e))return e[0];if(e.exact)return Array.isArray(e.exact)?e.exact[0]:e.exact;if(e.ideal)return Array.isArray(e.ideal)?e.ideal[0]:e.ideal;throw Error("could not unwrap constraint")}function Nb(e){return e.startsWith("ws")?e.replace(/^(ws)/,"http"):e}function Ab(e){switch(e.reason){case ky.LeaveRequest:return e.context;case ky.Cancelled:return sm.CLIENT_INITIATED;case ky.NotAllowed:return sm.USER_REJECTED;case ky.ServerUnreachable:return sm.JOIN_FAILURE;default:return sm.UNKNOWN_REASON}}function Ib(e){return void 0!==e?Number(e):void 0}function jb(e){return void 0!==e?BigInt(e):void 0}function Db(e){return!!e&&!(e instanceof MediaStreamTrack)&&e.isLocal}function Mb(e){return!!e&&e.kind==Hy.Kind.Audio}function Lb(e){return!!e&&e.kind==Hy.Kind.Video}function Fb(e){return Db(e)&&Lb(e)}function Ub(e){return Db(e)&&Mb(e)}function Bb(e){return!!e&&!e.isLocal}function Vb(e){return!!e&&!e.isLocal}function qb(e){return Bb(e)&&Lb(e)}function zb(e,t,n){var i,r,s,o;const{optionsWithoutProcessor:a,audioProcessor:c,videoProcessor:l}=ek(null!==e&&void 0!==e?e:{}),u=null===t||void 0===t?void 0:t.processor,d=null===n||void 0===n?void 0:n.processor,h=null!==a&&void 0!==a?a:{};return!0===h.audio&&(h.audio={}),!0===h.video&&(h.video={}),h.audio&&(Hb(h.audio,t),null!==(i=(s=h.audio).deviceId)&&void 0!==i||(s.deviceId={ideal:"default"}),(c||u)&&(h.audio.processor=null!==c&&void 0!==c?c:u)),h.video&&(Hb(h.video,n),null!==(r=(o=h.video).deviceId)&&void 0!==r||(o.deviceId={ideal:"default"}),(l||d)&&(h.video.processor=null!==l&&void 0!==l?l:d)),h}function Hb(e,t){return Object.keys(t).forEach(n=>{void 0===e[n]&&(e[n]=t[n])}),e}function Wb(e){var t,n,i,r;const s={};if(e.video)if("object"===typeof e.video){const n={},r=n,o=e.video;Object.keys(o).forEach(e=>{if("resolution"===e)Hb(r,o.resolution);else r[e]=o[e]}),s.video=n,null!==(t=(i=s.video).deviceId)&&void 0!==t||(i.deviceId={ideal:"default"})}else s.video=!!e.video&&{deviceId:{ideal:"default"}};else s.video=!1;return e.audio?"object"===typeof e.audio?(s.audio=e.audio,null!==(n=(r=s.audio).deviceId)&&void 0!==n||(r.deviceId={ideal:"default"})):s.audio={deviceId:{ideal:"default"}}:s.audio=!1,s}function Kb(e){return tv(this,arguments,void 0,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;return function*(){const n=$b();if(n){const i=n.createAnalyser();i.fftSize=2048;const r=i.frequencyBinCount,s=new Uint8Array(r);n.createMediaStreamSource(new MediaStream([e.mediaStreamTrack])).connect(i),yield ib(t),i.getByteTimeDomainData(s);const o=s.some(e=>128!==e&&0!==e);return n.close(),!o}return!1}()})}function $b(){var e;const t="undefined"!==typeof window&&(window.AudioContext||window.webkitAudioContext);if(t){const n=new t({latencyHint:"interactive"});if("suspended"===n.state&&"undefined"!==typeof window&&(null===(e=window.document)||void 0===e?void 0:e.body)){const e=()=>tv(this,void 0,void 0,function*(){var t;try{"suspended"===n.state&&(yield n.resume())}catch(r){console.warn("Error trying to auto-resume audio context",r)}null===(t=window.document.body)||void 0===t||t.removeEventListener("click",e)});window.document.body.addEventListener("click",e)}return n}}function Gb(e){return"audioinput"===e?Hy.Source.Microphone:"videoinput"===e?Hy.Source.Camera:Hy.Source.Unknown}function Qb(e){return e===Hy.Source.Microphone?"audioinput":e===Hy.Source.Camera?"videoinput":void 0}function Jb(e){var t,n;let i=null===(t=e.video)||void 0===t||t;return e.resolution&&e.resolution.width>0&&e.resolution.height>0&&(i="boolean"===typeof i?{}:i,i=lb()?Object.assign(Object.assign({},i),{width:{max:e.resolution.width},height:{max:e.resolution.height},frameRate:e.resolution.frameRate}):Object.assign(Object.assign({},i),{width:{ideal:e.resolution.width},height:{ideal:e.resolution.height},frameRate:e.resolution.frameRate})),{audio:null!==(n=e.audio)&&void 0!==n&&n,video:i,controller:e.controller,selfBrowserSurface:e.selfBrowserSurface,surfaceSwitching:e.surfaceSwitching,systemAudio:e.systemAudio,preferCurrentTab:e.preferCurrentTab}}function Yb(e){return e.split("/")[1].toLowerCase()}function Xb(e){const t=[];return e.forEach(e=>{void 0!==e.track&&t.push(new sg({cid:e.track.mediaStreamID,track:e.trackInfo}))}),t}function Zb(e){return"mediaStreamTrack"in e?{trackID:e.sid,source:e.source,muted:e.isMuted,enabled:e.mediaStreamTrack.enabled,kind:e.kind,streamID:e.mediaStreamID,streamTrackID:e.mediaStreamTrack.id}:{trackID:e.trackSid,enabled:e.isEnabled,muted:e.isMuted,trackInfo:Object.assign({mimeType:e.mimeType,name:e.trackName,encrypted:e.isEncrypted,kind:e.kind,source:e.source},e.track?Zb(e.track):{})}}function ek(e){const t=Object.assign({},e);let n,i;return"object"===typeof t.audio&&t.audio.processor&&(n=t.audio.processor,t.audio=Object.assign(Object.assign({},t.audio),{processor:void 0})),"object"===typeof t.video&&t.video.processor&&(i=t.video.processor,t.video=Object.assign(Object.assign({},t.video),{processor:void 0})),{audioProcessor:n,videoProcessor:i,optionsWithoutProcessor:(r=t,"undefined"===typeof r?r:"function"===typeof structuredClone?"object"===typeof r&&null!==r?structuredClone(Object.assign({},r)):structuredClone(r):JSON.parse(JSON.stringify(r)))};var r}function tk(e,t){return e.width*e.height<t.width*t.height}class nk extends ov.EventEmitter{constructor(e){super(),this.onWorkerMessage=e=>{var t,n;const{kind:i,data:r}=e.data;switch(i){case"error":Jg.error(r.error.message),this.emit(my.EncryptionError,r.error);break;case"initAck":r.enabled&&this.keyProvider.getKeys().forEach(e=>{this.postKey(e)});break;case"enable":if(r.enabled&&this.keyProvider.getKeys().forEach(e=>{this.postKey(e)}),this.encryptionEnabled!==r.enabled&&r.participantIdentity===(null===(t=this.room)||void 0===t?void 0:t.localParticipant.identity))this.emit(my.ParticipantEncryptionStatusChanged,r.enabled,this.room.localParticipant),this.encryptionEnabled=r.enabled;else if(r.participantIdentity){const e=null===(n=this.room)||void 0===n?void 0:n.getParticipantByIdentity(r.participantIdentity);if(!e)throw TypeError("couldn't set encryption status, participant not found".concat(r.participantIdentity));this.emit(my.ParticipantEncryptionStatusChanged,r.enabled,e)}break;case"ratchetKey":this.keyProvider.emit(py.KeyRatcheted,r.ratchetResult,r.participantIdentity,r.keyIndex)}},this.onWorkerError=e=>{Jg.error("e2ee worker encountered an error:",{error:e.error}),this.emit(my.EncryptionError,e.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1}setup(e){if(!vy())throw new Ry("tried to setup end-to-end encryption on an unsupported browser");if(Jg.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const t={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions(),loglevel:Xg.getLevel()}};this.worker&&(Jg.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(t))}}setParticipantCryptorEnabled(e,t){Jg.debug("set e2ee to ".concat(e," for participant ").concat(t)),this.postEnable(e,t)}setSifTrailer(e){e&&0!==e.length?this.postSifTrailer(e):Jg.warn("ignoring server sent trailer as it's empty")}setupEngine(e){e.on(xy.RTPVideoMapUpdate,e=>{this.postRTPMap(e)})}setupEventListeners(e,t){e.on(Ty.TrackPublished,(e,t)=>this.setParticipantCryptorEnabled(e.trackInfo.encryption!==gm.NONE,t.identity)),e.on(Ty.ConnectionStateChanged,t=>{t===Vw.Connected&&e.remoteParticipants.forEach(e=>{e.trackPublications.forEach(t=>{this.setParticipantCryptorEnabled(t.trackInfo.encryption!==gm.NONE,e.identity)})})}).on(Ty.TrackUnsubscribed,(e,t,n)=>{var i;const r={kind:"removeTransform",data:{participantIdentity:n.identity,trackId:e.mediaStreamID}};null===(i=this.worker)||void 0===i||i.postMessage(r)}).on(Ty.TrackSubscribed,(e,t,n)=>{this.setupE2EEReceiver(e,n.identity,t.trackInfo)}).on(Ty.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");t.getKeys().forEach(e=>{this.postKey(e)}),this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity)}),e.localParticipant.on(Cy.LocalSenderCreated,(e,t)=>tv(this,void 0,void 0,function*(){this.setupE2EESender(t,e)})),t.on(py.SetKey,e=>this.postKey(e)).on(py.RatchetRequest,(e,t)=>this.postRatchetRequest(e,t))}postRatchetRequest(e,t){if(!this.worker)throw Error("could not ratchet key, worker is missing");const n={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:t}};this.worker.postMessage(n)}postKey(e){let{key:t,participantIdentity:n,keyIndex:i}=e;var r;if(!this.worker)throw Error("could not set key, worker is missing");const s={kind:"setKey",data:{participantIdentity:n,isPublisher:n===(null===(r=this.room)||void 0===r?void 0:r.localParticipant.identity),key:t,keyIndex:i}};this.worker.postMessage(s)}postEnable(e,t){if(!this.worker)throw new ReferenceError("failed to enable e2ee, worker is not ready");{const n={kind:"enable",data:{enabled:e,participantIdentity:t}};this.worker.postMessage(n)}}postRTPMap(e){var t;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(null===(t=this.room)||void 0===t?void 0:t.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const n={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(n)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const t={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(t)}setupE2EEReceiver(e,t,n){if(e.receiver){if(!(null===n||void 0===n?void 0:n.mimeType)||""===n.mimeType)throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,t,"video"===e.kind?Yb(n.mimeType):void 0)}}setupE2EESender(e,t){Db(e)&&t?this.handleSender(t,e.mediaStreamID,void 0):t||Jg.warn("early return because sender is not ready")}handleReceiver(e,t,n,i){return tv(this,void 0,void 0,function*(){if(this.worker){if(yy()){const r={kind:"decode",participantIdentity:n,trackId:t,codec:i};e.transform=new RTCRtpScriptTransform(this.worker,r)}else{if(hy in e&&i){const e={kind:"updateCodec",data:{trackId:t,codec:i,participantIdentity:n}};return void this.worker.postMessage(e)}let r=e.writableStream,s=e.readableStream;if(!r||!s){const t=e.createEncodedStreams();e.writableStream=t.writable,r=t.writable,e.readableStream=t.readable,s=t.readable}const o={kind:"decode",data:{readableStream:s,writableStream:r,trackId:t,codec:i,participantIdentity:n,isReuse:hy in e}};this.worker.postMessage(o,[s,r])}e[hy]=!0}})}handleSender(e,t,n){var i;if(!(hy in e)&&this.worker){if(!(null===(i=this.room)||void 0===i?void 0:i.localParticipant.identity)||""===this.room.localParticipant.identity)throw TypeError("local identity needs to be known in order to set up encrypted sender");if(yy()){Jg.info("initialize script transform");const i={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:t,codec:n};e.transform=new RTCRtpScriptTransform(this.worker,i)}else{Jg.info("initialize encoded streams");const i=e.createEncodedStreams(),r={kind:"encode",data:{readableStream:i.readable,writableStream:i.writable,codec:n,trackId:t,participantIdentity:this.room.localParticipant.identity,isReuse:!1}};this.worker.postMessage(r,[i.readable,i.writable])}e[hy]=!0}}}const ik="default";class rk{constructor(){this._previousDevices=[]}static getInstance(){return void 0===this.instance&&(this.instance=new rk),this.instance}get previousDevices(){return this._previousDevices}getDevices(e){return tv(this,arguments,void 0,function(e){var t=this;let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function*(){var i;if((null===(i=rk.userMediaPromiseMap)||void 0===i?void 0:i.size)>0){Jg.debug("awaiting getUserMedia promise");try{e?yield rk.userMediaPromiseMap.get(e):yield Promise.all(rk.userMediaPromiseMap.values())}catch(r){Jg.warn("error waiting for media permissons")}}let s=yield navigator.mediaDevices.enumerateDevices();if(n&&(!lb()||!t.hasDeviceInUse(e))){const t=0===s.filter(t=>t.kind===e).length||s.some(t=>{const n=""===t.label,i=!e||t.kind===e;return n&&i});if(t){const t={video:"audioinput"!==e&&"audiooutput"!==e,audio:"videoinput"!==e&&{deviceId:{ideal:"default"}}},n=yield navigator.mediaDevices.getUserMedia(t);s=yield navigator.mediaDevices.enumerateDevices(),n.getTracks().forEach(e=>{e.stop()})}}return t._previousDevices=s,e&&(s=s.filter(t=>t.kind===e)),s}()})}normalizeDeviceId(e,t,n){return tv(this,void 0,void 0,function*(){if(t!==ik)return t;const i=yield this.getDevices(e),r=i.find(e=>e.deviceId===ik);if(!r)return void Jg.warn("could not reliably determine default device");const s=i.find(e=>e.deviceId!==ik&&e.groupId===(null!==n&&void 0!==n?n:r.groupId));if(s)return null===s||void 0===s?void 0:s.deviceId;Jg.warn("could not reliably determine default device")})}hasDeviceInUse(e){return e?rk.userMediaPromiseMap.has(e):rk.userMediaPromiseMap.size>0}}var sk;rk.mediaDeviceKinds=["audioinput","audiooutput","videoinput"],rk.userMediaPromiseMap=new Map,function(e){e[e.WAITING=0]="WAITING",e[e.RUNNING=1]="RUNNING",e[e.COMPLETED=2]="COMPLETED"}(sk||(sk={}));class ok{constructor(){this.pendingTasks=new Map,this.taskMutex=new fp,this.nextTaskIndex=0}run(e){return tv(this,void 0,void 0,function*(){const t={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:sk.WAITING};this.pendingTasks.set(t.id,t);const n=yield this.taskMutex.lock();try{return t.executedAt=Date.now(),t.status=sk.RUNNING,yield e()}finally{t.status=sk.COMPLETED,this.pendingTasks.delete(t.id),n()}})}flush(){return tv(this,void 0,void 0,function*(){return this.run(()=>tv(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}function ak(e,t){return e.pathname="".concat(function(e){return e.endsWith("/")?e:"".concat(e,"/")}(e.pathname)).concat(t),e.toString()}const ck=["syncState","trickle","offer","answer","simulate","leave"];var lk;!function(e){e[e.CONNECTING=0]="CONNECTING",e[e.CONNECTED=1]="CONNECTED",e[e.RECONNECTING=2]="RECONNECTING",e[e.DISCONNECTING=3]="DISCONNECTING",e[e.DISCONNECTED=4]="DISCONNECTED"}(lk||(lk={}));class uk{get currentState(){return this.state}get isDisconnected(){return this.state===lk.DISCONNECTING||this.state===lk.DISCONNECTED}get isEstablishingConnection(){return this.state===lk.CONNECTING||this.state===lk.RECONNECTING}getNextRequestId(){return this._requestId+=1,this._requestId}constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;this.rtt=0,this.state=lk.DISCONNECTED,this.log=Jg,this._requestId=0,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.log=Yg(null!==(n=t.loggerName)&&void 0!==n?n:Gg.Signal),this.loggerContextCb=t.loggerContextCb,this.useJSON=e,this.requestQueue=new ok,this.queuedRequests=[],this.closingLock=new fp,this.connectionLock=new fp,this.state=lk.DISCONNECTED}get logContext(){var e,t;return null!==(t=null===(e=this.loggerContextCb)||void 0===e?void 0:e.call(this))&&void 0!==t?t:{}}join(e,t,n,i){return tv(this,void 0,void 0,function*(){this.state=lk.CONNECTING,this.options=n;return yield this.connect(e,t,n,i)})}reconnect(e,t,n,i){return tv(this,void 0,void 0,function*(){if(!this.options)return void this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);this.state=lk.RECONNECTING,this.clearPingInterval();return yield this.connect(e,t,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:n,reconnectReason:i}))})}connect(e,t,n,i){this.connectOptions=n;const s=function(e,t,n){var i;const r=new URLSearchParams;r.set("access_token",e),n.reconnect&&(r.set("reconnect","1"),n.sid&&r.set("sid",n.sid));r.set("auto_subscribe",n.autoSubscribe?"1":"0"),r.set("sdk",fb()?"reactnative":"js"),r.set("version",t.version),r.set("protocol",t.protocol.toString()),t.deviceModel&&r.set("device_model",t.deviceModel);t.os&&r.set("os",t.os);t.osVersion&&r.set("os_version",t.osVersion);t.browser&&r.set("browser",t.browser);t.browserVersion&&r.set("browser_version",t.browserVersion);n.adaptiveStream&&r.set("adaptive_stream","1");n.reconnectReason&&r.set("reconnect_reason",n.reconnectReason.toString());(null===(i=navigator.connection)||void 0===i?void 0:i.type)&&r.set("network",navigator.connection.type);return r}(t,function(){var e;const t=new Mm({sdk:Lm.JS,protocol:16,version:"2.15.4"});return fb()&&(t.os=null!==(e=vb())&&void 0!==e?e:""),t}(),n),o=function(e,t){const n=new URL(function(e){return e.startsWith("http")?e.replace(/^(http)/,"ws"):e}(e));return t.forEach((e,t)=>{n.searchParams.set(t,e)}),ak(n,"rtc")}(e,s),a=ak(new URL(Nb(o)),"validate");return new Promise((e,t)=>tv(this,void 0,void 0,function*(){const s=yield this.connectionLock.lock();try{const s=()=>tv(this,void 0,void 0,function*(){this.close(),clearTimeout(c),t(new Py("room connection has been cancelled (signal)",ky.Cancelled))}),c=setTimeout(()=>{this.close(),t(new Py("room connection has timed out (signal)",ky.ServerUnreachable))},n.websocketTimeout);(null===i||void 0===i?void 0:i.aborted)&&s(),null===i||void 0===i||i.addEventListener("abort",s);const l=new URL(o);l.searchParams.has("access_token")&&l.searchParams.set("access_token","<redacted>"),this.log.debug("connecting to ".concat(l),Object.assign({reconnect:n.reconnect,reconnectReason:n.reconnectReason},this.logContext)),this.ws&&(yield this.close(!1)),this.ws=new WebSocket(o),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(c)},this.ws.onerror=e=>tv(this,void 0,void 0,function*(){if(this.state===lk.CONNECTED)this.handleWSError(e);else{this.state=lk.DISCONNECTED,clearTimeout(c);try{const n=yield fetch(a);if(n.status.toFixed(0).startsWith("4")){const e=yield n.text();t(new Py(e,ky.NotAllowed,n.status))}else t(new Py("Encountered unknown websocket error during connection: ".concat(e.toString()),ky.InternalError,n.status))}catch(r){t(new Py(r instanceof Error?r.message:"server was not reachable",ky.ServerUnreachable))}}}),this.ws.onmessage=r=>tv(this,void 0,void 0,function*(){var o,a,c;let l;if("string"===typeof r.data){const e=JSON.parse(r.data);l=Xm.fromJson(e,{ignoreUnknownFields:!0})}else{if(!(r.data instanceof ArrayBuffer))return void this.log.error("could not decode websocket message: ".concat(typeof r.data),this.logContext);l=Xm.fromBinary(new Uint8Array(r.data))}if(this.state!==lk.CONNECTED){let r=!1;if("join"===(null===(o=l.message)||void 0===o?void 0:o.case)?(this.state=lk.CONNECTED,null===i||void 0===i||i.removeEventListener("abort",s),this.pingTimeoutDuration=l.message.value.pingTimeout,this.pingIntervalDuration=l.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})),this.startPingInterval()),e(l.message.value)):this.state===lk.RECONNECTING&&"leave"!==l.message.case?(this.state=lk.CONNECTED,null===i||void 0===i||i.removeEventListener("abort",s),this.startPingInterval(),"reconnect"===(null===(a=l.message)||void 0===a?void 0:a.case)?e(l.message.value):(this.log.debug("declaring signal reconnected without reconnect response received",this.logContext),e(void 0),r=!0)):this.isEstablishingConnection&&"leave"===l.message.case?t(new Py("Received leave request while trying to (re)connect",ky.LeaveRequest,void 0,l.message.value.reason)):n.reconnect||t(new Py("did not receive join response, got ".concat(null===(c=l.message)||void 0===c?void 0:c.case," instead"),ky.InternalError)),!r)return}this.signalLatency&&(yield ib(this.signalLatency)),this.handleSignalResponse(l)}),this.ws.onclose=e=>{this.isEstablishingConnection&&t(new Py("Websocket got closed during a (re)connection attempt",ky.InternalError)),this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:e.reason,code:e.code,wasClean:e.wasClean,state:this.state})),this.handleOnClose(e.reason)}}finally{s()}}))}close(){return tv(this,arguments,void 0,function(){var e=this;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function*(){const n=yield e.closingLock.lock();try{if(e.clearPingInterval(),t&&(e.state=lk.DISCONNECTING),e.ws){e.ws.onmessage=null,e.ws.onopen=null,e.ws.onclose=null;const t=new Promise(t=>{e.ws?e.ws.onclose=()=>{t()}:t()});e.ws.readyState<e.ws.CLOSING&&(e.ws.close(),yield Promise.race([t,ib(250)])),e.ws=void 0}}finally{t&&(e.state=lk.DISCONNECTED),n()}}()})}sendOffer(e,t){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:hk(e,t)})}sendAnswer(e,t){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:hk(e,t)})}sendIceCandidate(e,t){return this.log.debug("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new tg({candidateInit:JSON.stringify(e),target:t})})}sendMuteTrack(e,t){return this.sendRequest({case:"mute",value:new ng({sid:e,muted:t})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,t){return tv(this,arguments,void 0,function(e,t){var n=this;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function*(){const r=n.getNextRequestId();return yield n.sendRequest({case:"updateMetadata",value:new gg({requestId:r,metadata:e,name:t,attributes:i})}),r}()})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,t){return this.sendRequest({case:"updateLayers",value:new mg({trackSid:e,layers:t})})}sendUpdateSubscriptionPermissions(e,t){return this.sendRequest({case:"subscriptionPermission",value:new Rg({allParticipants:e,trackPermissions:t})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:Mp.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new Dg({timestamp:Mp.parse(Date.now()),rtt:Mp.parse(this.rtt)})})])}sendUpdateLocalAudioTrack(e,t){return this.sendRequest({case:"updateAudioTrack",value:new dg({trackSid:e,features:t})})}sendLeave(){return this.sendRequest({case:"leave",value:new pg({reason:sm.CLIENT_INITIATED,action:fg.DISCONNECT})})}sendRequest(e){return tv(this,arguments,void 0,function(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function*(){const i=!n&&!function(e){const t=ck.indexOf(e.case)>=0;return Jg.trace("request allowed to bypass queue:",{canPass:t,req:e}),t}(e);if(i&&t.state===lk.RECONNECTING)return void t.queuedRequests.push(()=>tv(t,void 0,void 0,function*(){yield this.sendRequest(e,!0)}));if(n||(yield t.requestQueue.flush()),t.signalLatency&&(yield ib(t.signalLatency)),t.isDisconnected)return void t.log.debug("skipping signal request (type: ".concat(e.case,") - SignalClient disconnected"));if(!t.ws||t.ws.readyState!==t.ws.OPEN)return void t.log.error("cannot send signal request before connected, type: ".concat(null===e||void 0===e?void 0:e.case),t.logContext);const s=new Ym({message:e});try{t.useJSON?t.ws.send(s.toJsonString()):t.ws.send(s.toBinary())}catch(r){t.log.error("error sending signal message",Object.assign(Object.assign({},t.logContext),{error:r}))}}()})}handleSignalResponse(e){var t,n;const i=e.message;if(void 0==i)return void this.log.debug("received unsupported message",this.logContext);let r=!1;if("answer"===i.case){const e=dk(i.value);this.onAnswer&&this.onAnswer(e,i.value.id)}else if("offer"===i.case){const e=dk(i.value);this.onOffer&&this.onOffer(e,i.value.id)}else if("trickle"===i.case){const e=JSON.parse(i.value.candidateInit);this.onTrickle&&this.onTrickle(e,i.value.target)}else"update"===i.case?this.onParticipantUpdate&&this.onParticipantUpdate(null!==(t=i.value.participants)&&void 0!==t?t:[]):"trackPublished"===i.case?this.onLocalTrackPublished&&this.onLocalTrackPublished(i.value):"speakersChanged"===i.case?this.onSpeakersChanged&&this.onSpeakersChanged(null!==(n=i.value.speakers)&&void 0!==n?n:[]):"leave"===i.case?this.onLeave&&this.onLeave(i.value):"mute"===i.case?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(i.value.sid,i.value.muted):"roomUpdate"===i.case?this.onRoomUpdate&&i.value.room&&this.onRoomUpdate(i.value.room):"connectionQuality"===i.case?this.onConnectionQuality&&this.onConnectionQuality(i.value):"streamStateUpdate"===i.case?this.onStreamStateUpdate&&this.onStreamStateUpdate(i.value):"subscribedQualityUpdate"===i.case?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(i.value):"subscriptionPermissionUpdate"===i.case?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(i.value):"refreshToken"===i.case?this.onTokenRefresh&&this.onTokenRefresh(i.value):"trackUnpublished"===i.case?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(i.value):"subscriptionResponse"===i.case?this.onSubscriptionError&&this.onSubscriptionError(i.value):"pong"===i.case||("pongResp"===i.case?(this.rtt=Date.now()-Number.parseInt(i.value.lastPingTimestamp.toString()),this.resetPingTimeout(),r=!0):"requestResponse"===i.case?this.onRequestResponse&&this.onRequestResponse(i.value):"trackSubscribed"===i.case?this.onLocalTrackSubscribed&&this.onLocalTrackSubscribed(i.value.trackSid):"roomMoved"===i.case?(this.onTokenRefresh&&this.onTokenRefresh(i.value.token),this.onRoomMoved&&this.onRoomMoved(i.value)):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:i.case})));r||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return tv(this,void 0,void 0,function*(){if(this.state===lk.DISCONNECTED)return;const t=this.onClose;yield this.close(),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),t&&t(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){this.clearPingTimeout(),this.pingTimeoutDuration?this.pingTimeout=Vy.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-1e3*this.pingTimeoutDuration).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},1e3*this.pingTimeoutDuration):this.log.warn("ping timeout duration not set",this.logContext)}clearPingTimeout(){this.pingTimeout&&Vy.clearTimeout(this.pingTimeout)}startPingInterval(){this.clearPingInterval(),this.resetPingTimeout(),this.pingIntervalDuration?(this.log.debug("start ping interval",this.logContext),this.pingInterval=Vy.setInterval(()=>{this.sendPing()},1e3*this.pingIntervalDuration)):this.log.warn("ping interval duration not set",this.logContext)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&Vy.clearInterval(this.pingInterval)}}function dk(e){const t={type:"offer",sdp:e.sdp};switch(e.type){case"answer":case"offer":case"pranswer":case"rollback":t.type=e.type}return t}function hk(e,t){return new ag({sdp:e.sdp,type:e.type,id:t})}class pk{constructor(){this.buffer=[],this._totalSize=0}push(e){this.buffer.push(e),this._totalSize+=e.data.byteLength}pop(){const e=this.buffer.shift();return e&&(this._totalSize-=e.data.byteLength),e}getAll(){return this.buffer.slice()}popToSequence(e){for(;this.buffer.length>0;){if(!(this.buffer[0].sequence<=e))break;this.pop()}}alignBufferedAmount(e){for(;this.buffer.length>0;){const t=this.buffer[0];if(this._totalSize-t.data.byteLength<=e)break;this.pop()}}get length(){return this.buffer.length}}class fk{constructor(e){this._map=new Map,this._lastCleanup=0,this.ttl=e}set(e,t){const n=Date.now();n-this._lastCleanup>this.ttl/2&&this.cleanup();const i=n+this.ttl;return this._map.set(e,{value:t,expiresAt:i}),this}get(e){const t=this._map.get(e);if(t){if(!(t.expiresAt<Date.now()))return t.value;this._map.delete(e)}}has(e){const t=this._map.get(e);return!!t&&(!(t.expiresAt<Date.now())||(this._map.delete(e),!1))}delete(e){return this._map.delete(e)}clear(){this._map.clear()}cleanup(){const e=Date.now();for(const[t,n]of this._map.entries())n.expiresAt<e&&this._map.delete(t);this._lastCleanup=e}get size(){return this.cleanup(),this._map.size}forEach(e){this.cleanup();for(const[t,n]of this._map.entries())n.expiresAt>=Date.now()&&e(n.value,t,this.asValueMap())}map(e){this.cleanup();const t=[],n=this.asValueMap();for(const[i,r]of n.entries())t.push(e(r,i,n));return t}asValueMap(){const e=new Map;for(const[t,n]of this._map.entries())n.expiresAt>=Date.now()&&e.set(t,n.value);return e}}var mk,gk,vk,yk,bk,kk={},wk={},Sk={exports:{}};function Tk(){if(mk)return Sk.exports;mk=1;var e=Sk.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t+=null!=e["network-id"]?" network-id %d":"%v",t+=null!=e["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=null!=e.id?"id=%s %s":"%v%s",t+=null!=e.mediaClockValue?"=%s":"",t+=null!=e.rateNumerator?" rate=%s":"",t+=null!=e.rateDenominator?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};return Object.keys(e).forEach(function(t){e[t].forEach(function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")})}),Sk.exports}function Ck(){return gk||(gk=1,function(e){var t=function(e){return String(Number(e))===e?Number(e):e},n=function(e,n,i){var r=e.name&&e.names;e.push&&!n[e.push]?n[e.push]=[]:r&&!n[e.name]&&(n[e.name]={});var s=e.push?{}:r?n[e.name]:n;!function(e,n,i,r){if(r&&!i)n[r]=t(e[1]);else for(var s=0;s<i.length;s+=1)null!=e[s+1]&&(n[i[s]]=t(e[s+1]))}(i.match(e.reg),s,e.names,e.name),e.push&&n[e.push].push(s)},i=Tk(),r=RegExp.prototype.test.bind(/^([a-z])=(.*)/);e.parse=function(e){var t={},s=[],o=t;return e.split(/(\r\n|\r|\n)/).filter(r).forEach(function(e){var t=e[0],r=e.slice(2);"m"===t&&(s.push({rtp:[],fmtp:[]}),o=s[s.length-1]);for(var a=0;a<(i[t]||[]).length;a+=1){var c=i[t][a];if(c.reg.test(r))return n(c,o,r)}}),t.media=s,t};var s=function(e,n){var i=n.split(/=(.+)/,2);return 2===i.length?e[i[0]]=t(i[1]):1===i.length&&n.length>1&&(e[i[0]]=void 0),e};e.parseParams=function(e){return e.split(/;\s?/).reduce(s,{})},e.parseFmtpConfig=e.parseParams,e.parsePayloads=function(e){return e.toString().split(" ").map(Number)},e.parseRemoteCandidates=function(e){for(var n=[],i=e.split(" ").map(t),r=0;r<i.length;r+=3)n.push({component:i[r],ip:i[r+1],port:i[r+2]});return n},e.parseImageAttributes=function(e){return e.split(" ").map(function(e){return e.substring(1,e.length-1).split(",").reduce(s,{})})},e.parseSimulcastStreamList=function(e){return e.split(";").map(function(e){return e.split(",").map(function(e){var n,i=!1;return"~"!==e[0]?n=t(e):(n=t(e.substring(1,e.length)),i=!0),{scid:n,paused:i}})})}}(wk)),wk}function xk(){if(yk)return vk;yk=1;var e=Tk(),t=/%[sdv%]/g,n=function(e){var n=1,i=arguments,r=i.length;return e.replace(t,function(e){if(n>=r)return e;var t=i[n];switch(n+=1,e){case"%%":return"%";case"%s":return String(t);case"%d":return Number(t);case"%v":return""}})},i=function(e,t,i){var r=[e+"="+(t.format instanceof Function?t.format(t.push?i:i[t.name]):t.format)];if(t.names)for(var s=0;s<t.names.length;s+=1){var o=t.names[s];t.name?r.push(i[t.name][o]):r.push(i[t.names[s]])}else r.push(i[t.name]);return n.apply(null,r)},r=["v","o","s","i","u","e","p","c","b","t","r","z","a"],s=["i","c","b","a"];return vk=function(t,n){n=n||{},null==t.version&&(t.version=0),null==t.name&&(t.name=" "),t.media.forEach(function(e){null==e.payloads&&(e.payloads="")});var o=n.outerOrder||r,a=n.innerOrder||s,c=[];return o.forEach(function(n){e[n].forEach(function(e){e.name in t&&null!=t[e.name]?c.push(i(n,e,t)):e.push in t&&null!=t[e.push]&&t[e.push].forEach(function(t){c.push(i(n,e,t))})})}),t.media.forEach(function(t){c.push(i("m",e.m[0],t)),a.forEach(function(n){e[n].forEach(function(e){e.name in t&&null!=t[e.name]?c.push(i(n,e,t)):e.push in t&&null!=t[e.push]&&t[e.push].forEach(function(t){c.push(i(n,e,t))})})})}),c.join("\r\n")+"\r\n"},vk}var Ek=function(){if(bk)return kk;bk=1;var e=Ck(),t=xk(),n=Tk();return kk.grammar=n,kk.write=t,kk.parse=e.parse,kk.parseParams=e.parseParams,kk.parseFmtpConfig=e.parseFmtpConfig,kk.parsePayloads=e.parsePayloads,kk.parseRemoteCandidates=e.parseRemoteCandidates,kk.parseImageAttributes=e.parseImageAttributes,kk.parseSimulcastStreamList=e.parseSimulcastStreamList,kk}();function Pk(e,t,n){var i,r,s;void 0===t&&(t=50),void 0===n&&(n={});var o=null!=(i=n.isImmediate)&&i,a=null!=(r=n.callback)&&r,c=n.maxWait,l=Date.now(),u=[];function d(){if(void 0!==c){var e=Date.now()-l;if(e+t>=c)return c-e}return t}var h=function(){var t=[].slice.call(arguments),n=this;return new Promise(function(i,r){var c=o&&void 0===s;if(void 0!==s&&clearTimeout(s),s=setTimeout(function(){if(s=void 0,l=Date.now(),!o){var i=e.apply(n,t);a&&a(i),u.forEach(function(e){return(0,e.resolve)(i)}),u=[]}},d()),c){var h=e.apply(n,t);return a&&a(h),i(h)}u.push({resolve:i,reject:r})})};return h.cancel=function(e){void 0!==s&&clearTimeout(s),u.forEach(function(t){return(0,t.reject)(e)}),u=[]},h}const Rk="negotiationStarted",Ok="negotiationComplete",_k="rtpVideoPayloadTypes";class Nk extends ov.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;super(),this.log=Jg,this.ddExtID=0,this.latestOfferId=0,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=Pk(e=>tv(this,void 0,void 0,function*(){this.emit(Rk);try{yield this.createAndSendOffer()}catch(r){if(!e)throw r;e(r)}}),20),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=Yg(null!==(n=t.loggerName)&&void 0!==n?n:Gg.PCTransport),this.loggerOptions=t,this.config=e,this._pc=this.createPC(),this.offerLock=new fp}createPC(){const e=new RTCPeerConnection(this.config);return e.onicecandidate=e=>{var t;e.candidate&&(null===(t=this.onIceCandidate)||void 0===t||t.call(this,e.candidate))},e.onicecandidateerror=e=>{var t;null===(t=this.onIceCandidateError)||void 0===t||t.call(this,e)},e.oniceconnectionstatechange=()=>{var t;null===(t=this.onIceConnectionStateChange)||void 0===t||t.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var t;null===(t=this.onSignalingStatechange)||void 0===t||t.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var t;null===(t=this.onConnectionStateChange)||void 0===t||t.call(this,e.connectionState)},e.ondatachannel=e=>{var t;null===(t=this.onDataChannel)||void 0===t||t.call(this,e)},e.ontrack=e=>{var t;null===(t=this.onTrack)||void 0===t||t.call(this,e)},e}get logContext(){var e,t;return Object.assign({},null===(t=(e=this.loggerOptions).loggerContextCb)||void 0===t?void 0:t.call(e))}get isICEConnected(){return null!==this._pc&&("connected"===this.pc.iceConnectionState||"completed"===this.pc.iceConnectionState)}addIceCandidate(e){return tv(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e,t){return tv(this,void 0,void 0,function*(){var n;if("answer"===e.type&&this.latestOfferId>0&&t>0&&t!==this.latestOfferId)return this.log.warn("ignoring answer for old offer",Object.assign(Object.assign({},this.logContext),{offerId:t,latestOfferId:this.latestOfferId})),!1;let i;if("offer"===e.type){let{stereoMids:t,nackMids:n}=function(e){var t;const n=[],i=[],r=Ek.parse(null!==(t=e.sdp)&&void 0!==t?t:"");let s=0;return r.media.forEach(e=>{var t;"audio"===e.type&&(e.rtp.some(e=>"opus"===e.codec&&(s=e.payload,!0)),(null===(t=e.rtcpFb)||void 0===t?void 0:t.some(e=>e.payload===s&&"nack"===e.type))&&i.push(e.mid),e.fmtp.some(t=>t.payload===s&&(t.config.includes("sprop-stereo=1")&&n.push(e.mid),!0)))}),{stereoMids:n,nackMids:i}}(e);this.remoteStereoMids=t,this.remoteNackMids=n}else if("answer"===e.type){const t=Ek.parse(null!==(n=e.sdp)&&void 0!==n?n:"");t.media.forEach(e=>{"audio"===e.type&&this.trackBitrates.some(t=>{if(!t.transceiver||e.mid!=t.transceiver.mid)return!1;let n=0;if(e.rtp.some(e=>e.codec.toUpperCase()===t.codec.toUpperCase()&&(n=e.payload,!0)),0===n)return!0;let i=!1;for(const r of e.fmtp)if(r.payload===n){r.config=r.config.split(";").filter(e=>!e.includes("maxaveragebitrate")).join(";"),t.maxbr>0&&(r.config+=";maxaveragebitrate=".concat(1e3*t.maxbr)),i=!0;break}return i||t.maxbr>0&&e.fmtp.push({payload:n,config:"maxaveragebitrate=".concat(1e3*t.maxbr)}),!0})}),i=Ek.write(t)}if(yield this.setMungedSDP(e,i,!0),this.pendingCandidates.forEach(e=>{this.pc.addIceCandidate(e)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate)this.renegotiate=!1,yield this.createAndSendOffer();else if("answer"===e.type&&(this.emit(Ok),e.sdp)){Ek.parse(e.sdp).media.forEach(e=>{"video"===e.type&&this.emit(_k,e.rtp)})}return!0})}createAndSendOffer(e){return tv(this,void 0,void 0,function*(){var t;const n=yield this.offerLock.lock();try{if(void 0===this.onOffer)return;if((null===e||void 0===e?void 0:e.iceRestart)&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&"have-local-offer"===this._pc.signalingState){const t=this._pc.remoteDescription;if(!(null===e||void 0===e?void 0:e.iceRestart)||!t)return void(this.renegotiate=!0);yield this._pc.setRemoteDescription(t)}else if(!this._pc||"closed"===this._pc.signalingState)return void this.log.warn("could not createOffer with closed peer connection",this.logContext);this.log.debug("starting to negotiate",this.logContext);const n=this.latestOfferId+1;this.latestOfferId=n;const i=yield this.pc.createOffer(e);this.log.debug("original offer",Object.assign({sdp:i.sdp},this.logContext));const r=Ek.parse(null!==(t=i.sdp)&&void 0!==t?t:"");if(r.media.forEach(e=>{Ik(e),"audio"===e.type?Ak(e,[],[]):"video"===e.type&&this.trackBitrates.some(t=>{if(!e.msid||!t.cid||!e.msid.includes(t.cid))return!1;let n=0;if(e.rtp.some(e=>e.codec.toUpperCase()===t.codec.toUpperCase()&&(n=e.payload,!0)),0===n)return!0;if(ob(t.codec)&&!lb()&&this.ensureVideoDDExtensionForSVC(e,r),"av1"!==t.codec)return!0;const i=Math.round(.7*t.maxbr);for(const r of e.fmtp)if(r.payload===n){r.config.includes("x-google-start-bitrate")||(r.config+=";x-google-start-bitrate=".concat(i));break}return!0})}),this.latestOfferId>n)return void this.log.warn("latestOfferId mismatch",Object.assign(Object.assign({},this.logContext),{latestOfferId:this.latestOfferId,offerId:n}));yield this.setMungedSDP(i,Ek.write(r)),this.onOffer(i,this.latestOfferId)}finally{n()}})}createAndSetAnswer(){return tv(this,void 0,void 0,function*(){var e;const t=yield this.pc.createAnswer(),n=Ek.parse(null!==(e=t.sdp)&&void 0!==e?e:"");return n.media.forEach(e=>{Ik(e),"audio"===e.type&&Ak(e,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(t,Ek.write(n)),t})}createDataChannel(e,t){return this.pc.createDataChannel(e,t)}addTransceiver(e,t){return this.pc.addTransceiver(e,t)}addTrack(e){if(!this._pc)throw new Ny("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var t;if(!this._pc)throw new Ny("PC closed, cannot configure");return null===(t=this._pc)||void 0===t?void 0:t.setConfiguration(e)}canRemoveTrack(){var e;return!!(null===(e=this._pc)||void 0===e?void 0:e.removeTrack)}removeTrack(e){var t;return null===(t=this._pc)||void 0===t?void 0:t.removeTrack(e)}getConnectionState(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.connectionState)&&void 0!==t?t:"closed"}getICEConnectionState(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.iceConnectionState)&&void 0!==t?t:"closed"}getSignallingState(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.signalingState)&&void 0!==t?t:"closed"}getTransceivers(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.getTransceivers())&&void 0!==t?t:[]}getSenders(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.getSenders())&&void 0!==t?t:[]}getLocalDescription(){var e;return null===(e=this._pc)||void 0===e?void 0:e.localDescription}getRemoteDescription(){var e;return null===(e=this.pc)||void 0===e?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){return tv(this,void 0,void 0,function*(){var e;if(!this._pc)return;let t="";const n=new Map,i=new Map;if((yield this._pc.getStats()).forEach(e=>{switch(e.type){case"transport":t=e.selectedCandidatePairId;break;case"candidate-pair":""===t&&e.selected&&(t=e.id),n.set(e.id,e);break;case"remote-candidate":i.set(e.id,"".concat(e.address,":").concat(e.port))}}),""===t)return;const r=null===(e=n.get(t))||void 0===e?void 0:e.remoteCandidateId;return void 0!==r?i.get(r):void 0})}setMungedSDP(e,t,n){return tv(this,void 0,void 0,function*(){if(t){const i=e.sdp;e.sdp=t;try{return this.log.debug("setting munged ".concat(n?"remote":"local"," description"),this.logContext),void(n?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e))}catch(r){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:r,sdp:t})),e.sdp=i}}try{n?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(r){let i="unknown error";r instanceof Error?i=r.message:"string"===typeof r&&(i=r);const s={error:i,sdp:e.sdp};throw!n&&this.pc.remoteDescription&&(s.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:s})),new Ay(i)}})}ensureVideoDDExtensionForSVC(e,t){var n,i;if(!(null===(n=e.ext)||void 0===n?void 0:n.some(e=>e.uri===nb))){if(0===this.ddExtID){let e=0;t.media.forEach(t=>{var n;"video"===t.type&&(null===(n=t.ext)||void 0===n||n.forEach(t=>{t.value>e&&(e=t.value)}))}),this.ddExtID=e+1}null===(i=e.ext)||void 0===i||i.push({value:this.ddExtID,uri:nb})}}}function Ak(e,t,n){let i=0;e.rtp.some(e=>"opus"===e.codec&&(i=e.payload,!0)),i>0&&(e.rtcpFb||(e.rtcpFb=[]),n.includes(e.mid)&&!e.rtcpFb.some(e=>e.payload===i&&"nack"===e.type)&&e.rtcpFb.push({payload:i,type:"nack"}),t.includes(e.mid)&&e.fmtp.some(e=>e.payload===i&&(e.config.includes("stereo=1")||(e.config+=";stereo=1"),!0)))}function Ik(e){if(e.connection){const t=e.connection.ip.indexOf(":")>=0;(4===e.connection.version&&t||6===e.connection.version&&!t)&&(e.connection.ip="0.0.0.0",e.connection.version=4)}}const jk="vp8",Dk={audioPreset:Xy.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:tb.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:jk,backupCodec:!0,preConnectBuffer:!1},Mk={deviceId:{ideal:"default"},autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0,voiceIsolation:!0},Lk={deviceId:{ideal:"default"},resolution:Zy.h720.resolution},Fk={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new class{constructor(e){this._retryDelays=void 0!==e?[...e]:ev}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const t=this._retryDelays[e.retryCount];return e.retryCount<=1?t:t+1e3*Math.random()}},disconnectOnPageLeave:!0,webAudioMix:!1},Uk={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var Bk;!function(e){e[e.NEW=0]="NEW",e[e.CONNECTING=1]="CONNECTING",e[e.CONNECTED=2]="CONNECTED",e[e.FAILED=3]="FAILED",e[e.CLOSING=4]="CLOSING",e[e.CLOSED=5]="CLOSED"}(Bk||(Bk={}));class Vk{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,t,n){var i;this.peerConnectionTimeout=Uk.peerConnectionTimeout,this.log=Jg,this.updateState=()=>{var e;const t=this.state,n=this.requiredTransports.map(e=>e.getConnectionState());n.every(e=>"connected"===e)?this.state=Bk.CONNECTED:n.some(e=>"failed"===e)?this.state=Bk.FAILED:n.some(e=>"connecting"===e)?this.state=Bk.CONNECTING:n.every(e=>"closed"===e)?this.state=Bk.CLOSED:n.some(e=>"closed"===e)?this.state=Bk.CLOSING:n.every(e=>"new"===e)&&(this.state=Bk.NEW),t!==this.state&&(this.log.debug("pc state change: from ".concat(Bk[t]," to ").concat(Bk[this.state]),this.logContext),null===(e=this.onStateChange)||void 0===e||e.call(this,this.state,this.publisher.getConnectionState(),this.subscriber.getConnectionState()))},this.log=Yg(null!==(i=n.loggerName)&&void 0!==i?i:Gg.PCManager),this.loggerOptions=n,this.isPublisherConnectionRequired=!t,this.isSubscriberConnectionRequired=t,this.publisher=new Nk(e,n),this.subscriber=new Nk(e,n),this.publisher.onConnectionStateChange=this.updateState,this.subscriber.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=e=>{var t;null===(t=this.onIceCandidate)||void 0===t||t.call(this,e,Gm.PUBLISHER)},this.subscriber.onIceCandidate=e=>{var t;null===(t=this.onIceCandidate)||void 0===t||t.call(this,e,Gm.SUBSCRIBER)},this.subscriber.onDataChannel=e=>{var t;null===(t=this.onDataChannel)||void 0===t||t.call(this,e)},this.subscriber.onTrack=e=>{var t;null===(t=this.onTrack)||void 0===t||t.call(this,e)},this.publisher.onOffer=(e,t)=>{var n;null===(n=this.onPublisherOffer)||void 0===n||n.call(this,e,t)},this.state=Bk.NEW,this.connectionLock=new fp,this.remoteOfferLock=new fp}get logContext(){var e,t;return Object.assign({},null===(t=(e=this.loggerOptions).loggerContextCb)||void 0===t?void 0:t.call(e))}requirePublisher(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isPublisherConnectionRequired=e,this.updateState()}requireSubscriber(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isSubscriberConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e,t){return this.publisher.setRemoteDescription(e,t)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return tv(this,void 0,void 0,function*(){if(this.publisher&&"closed"!==this.publisher.getSignallingState()){const e=this.publisher;for(const t of e.getSenders())try{e.canRemoveTrack()&&e.removeTrack(t)}catch(r){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:r}))}}yield Promise.all([this.publisher.close(),this.subscriber.close()]),this.updateState()})}triggerIceRestart(){return tv(this,void 0,void 0,function*(){this.subscriber.restartingIce=!0,this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,t){return tv(this,void 0,void 0,function*(){t===Gm.PUBLISHER?yield this.publisher.addIceCandidate(e):yield this.subscriber.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e,t){return tv(this,void 0,void 0,function*(){this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:this.subscriber.getSignallingState().toString()}));const n=yield this.remoteOfferLock.lock();try{if(!(yield this.subscriber.setRemoteDescription(e,t)))return;return yield this.subscriber.createAndSetAnswer()}finally{n()}})}updateConfiguration(e,t){this.publisher.setConfiguration(e),this.subscriber.setConfiguration(e),t&&this.triggerIceRestart()}ensurePCTransportConnection(e,t){return tv(this,void 0,void 0,function*(){var n;const i=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&"connected"!==this.publisher.getConnectionState()&&"connecting"!==this.publisher.getConnectionState()&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all(null===(n=this.requiredTransports)||void 0===n?void 0:n.map(n=>this.ensureTransportConnected(n,e,t)))}finally{i()}})}negotiate(e){return tv(this,void 0,void 0,function*(){return new Promise((t,n)=>tv(this,void 0,void 0,function*(){const i=setTimeout(()=>{n("negotiation timed out")},this.peerConnectionTimeout);e.signal.addEventListener("abort",()=>{clearTimeout(i),n("negotiation aborted")}),this.publisher.once(Rk,()=>{e.signal.aborted||this.publisher.once(Ok,()=>{clearTimeout(i),t()})}),yield this.publisher.negotiate(e=>{clearTimeout(i),n(e)})}))})}addPublisherTransceiver(e,t){return this.publisher.addTransceiver(e,t)}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,t){return this.publisher.createDataChannel(e,t)}getConnectedAddress(e){return e===Gm.PUBLISHER||e===Gm.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&e.push(this.subscriber),e}ensureTransportConnected(e,t){return tv(this,arguments,void 0,function(e,t){var n=this;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.peerConnectionTimeout;return function*(){if("connected"!==e.getConnectionState())return new Promise((e,r)=>tv(n,void 0,void 0,function*(){const n=()=>{this.log.warn("abort transport connection",this.logContext),Vy.clearTimeout(s),r(new Py("room connection has been cancelled",ky.Cancelled))};(null===t||void 0===t?void 0:t.signal.aborted)&&n(),null===t||void 0===t||t.signal.addEventListener("abort",n);const s=Vy.setTimeout(()=>{null===t||void 0===t||t.signal.removeEventListener("abort",n),r(new Py("could not establish pc connection",ky.InternalError))},i);for(;this.state!==Bk.CONNECTED;)if(yield ib(50),null===t||void 0===t?void 0:t.signal.aborted)return void r(new Py("room connection has been cancelled",ky.Cancelled));Vy.clearTimeout(s),null===t||void 0===t||t.signal.removeEventListener("abort",n),e()}))}()})}}class qk extends Error{constructor(e,t,n){super(t),this.code=e,this.message=Hk(t,qk.MAX_MESSAGE_BYTES),this.data=n?Hk(n,qk.MAX_DATA_BYTES):void 0}static fromProto(e){return new qk(e.code,e.message,e.data)}toProto(){return new Am({code:this.code,message:this.message,data:this.data})}static builtIn(e,t){return new qk(qk.ErrorCode[e],qk.ErrorMessage[e],t)}}qk.MAX_MESSAGE_BYTES=256,qk.MAX_DATA_BYTES=15360,qk.ErrorCode={APPLICATION_ERROR:1500,CONNECTION_TIMEOUT:1501,RESPONSE_TIMEOUT:1502,RECIPIENT_DISCONNECTED:1503,RESPONSE_PAYLOAD_TOO_LARGE:1504,SEND_FAILED:1505,UNSUPPORTED_METHOD:1400,RECIPIENT_NOT_FOUND:1401,REQUEST_PAYLOAD_TOO_LARGE:1402,UNSUPPORTED_SERVER:1403,UNSUPPORTED_VERSION:1404},qk.ErrorMessage={APPLICATION_ERROR:"Application error in method handler",CONNECTION_TIMEOUT:"Connection timeout",RESPONSE_TIMEOUT:"Response timeout",RECIPIENT_DISCONNECTED:"Recipient disconnected",RESPONSE_PAYLOAD_TOO_LARGE:"Response payload too large",SEND_FAILED:"Failed to send",UNSUPPORTED_METHOD:"Method not supported at destination",RECIPIENT_NOT_FOUND:"Recipient not found",REQUEST_PAYLOAD_TOO_LARGE:"Request payload too large",UNSUPPORTED_SERVER:"RPC not supported by server",UNSUPPORTED_VERSION:"Unsupported RPC version"};function zk(e){return(new TextEncoder).encode(e).length}function Hk(e,t){if(zk(e)<=t)return e;let n=0,i=e.length;const r=new TextEncoder;for(;n<i;){const s=Math.floor((n+i+1)/2);r.encode(e.slice(0,s)).length<=t?n=s:i=s-1}return e.slice(0,n)}const Wk=2e3;function Kk(e,t){if(!t)return 0;let n,i;return"bytesReceived"in e?(n=e.bytesReceived,i=t.bytesReceived):"bytesSent"in e&&(n=e.bytesSent,i=t.bytesSent),void 0===n||void 0===i||void 0===e.timestamp||void 0===t.timestamp?0:8*(n-i)*1e3/(e.timestamp-t.timestamp)}const $k="undefined"!==typeof MediaRecorder;const Gk=$k?MediaRecorder:class{constructor(){throw new Error("MediaRecorder is not available in this environment")}};class Qk extends Gk{constructor(e,t){if(!$k)throw new Error("MediaRecorder is not available in this environment");let n,i;super(new MediaStream([e.mediaStreamTrack]),t);const r=()=>{this.removeEventListener("dataavailable",n),this.removeEventListener("stop",r),this.removeEventListener("error",s),null===i||void 0===i||i.close(),i=void 0},s=e=>{null===i||void 0===i||i.error(e),this.removeEventListener("dataavailable",n),this.removeEventListener("stop",r),this.removeEventListener("error",s),i=void 0};this.byteStream=new ReadableStream({start:e=>{i=e,n=t=>tv(this,void 0,void 0,function*(){let n;if(t.data.arrayBuffer){const e=yield t.data.arrayBuffer();n=new Uint8Array(e)}else{if(!t.data.byteArray)throw new Error("no data available!");n=t.data.byteArray}void 0!==i&&e.enqueue(n)}),this.addEventListener("dataavailable",n)},cancel:()=>{r()}}),this.addEventListener("stop",r),this.addEventListener("error",s)}}class Jk extends Hy{get sender(){return this._sender}set sender(e){this._sender=e}get constraints(){return this._constraints}get hasPreConnectBuffer(){return!!this.localTrackRecorder}constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];super(e,t,arguments.length>4?arguments[4]:void 0),this.manuallyStopped=!1,this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=Pk(()=>tv(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>tv(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(Ey.Ended,this)},this.reacquireTrack=!1,this.providedByUser=i,this.muteLock=new fp,this.pauseUpstreamLock=new fp,this.processorLock=new fp,this.restartLock=new fp,this.setMediaStreamTrack(e,!0),this._constraints=e.getConstraints(),n&&(this._constraints=n)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==Hy.Kind.Video)return;const{width:e,height:t}=this._mediaStreamTrack.getSettings();return e&&t?{width:e,height:t}:void 0}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,t;return null!==(t=null===(e=this.processor)||void 0===e?void 0:e.processedTrack)&&void 0!==t?t:this._mediaStreamTrack}get isLocal(){return!0}getSourceTrackSettings(){return this._mediaStreamTrack.getSettings()}setMediaStreamTrack(e,t){return tv(this,void 0,void 0,function*(){var n;if(e===this._mediaStreamTrack&&!t)return;let i;if(this._mediaStreamTrack&&(this.attachedElements.forEach(e=>{Ky(this._mediaStreamTrack,e)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints()),this.processor&&e){const t=yield this.processorLock.lock();try{if(this.log.debug("restarting processor",this.logContext),"unknown"===this.kind)throw TypeError("cannot set processor on track of unknown kind");this.processorElement&&(Wy(e,this.processorElement),this.processorElement.muted=!0),yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),i=this.processor.processedTrack}finally{t()}}this.sender&&"closed"!==(null===(n=this.sender.transport)||void 0===n?void 0:n.state)&&(yield this.sender.replaceTrack(null!==i&&void 0!==i?i:e)),this.providedByUser||this._mediaStreamTrack===e||this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(t=>{Wy(null!==i&&void 0!==i?i:e,t)}))})}waitForDimensions(){return tv(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return function*(){var n;if(e.kind===Hy.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");"iOS"===(null===(n=Ly())||void 0===n?void 0:n.os)&&(yield ib(10));const i=Date.now();for(;Date.now()-i<t;){const t=e.dimensions;if(t)return t;yield ib(50)}throw new Oy("unable to get track dimensions after timeout")}()})}setDeviceId(e){return tv(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===_b(e)||(this._constraints.deviceId=e,!!this.isMuted||(yield this.restartTrack(),_b(e)===this._mediaStreamTrack.getSettings().deviceId))})}getDeviceId(){return tv(this,arguments,void 0,function(){var e=this;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function*(){if(e.source===Hy.Source.ScreenShare)return;const{deviceId:n,groupId:i}=e._mediaStreamTrack.getSettings(),r=e.kind===Hy.Kind.Audio?"audioinput":"videoinput";return t?rk.getInstance().normalizeDeviceId(r,n,i):n}()})}mute(){return tv(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return tv(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e,t){return tv(this,void 0,void 0,function*(){if(!this.sender)throw new Oy("unable to replace an unpublished track");let n,i;return"boolean"===typeof t?n=t:void 0!==t&&(n=t.userProvidedTrack,i=t.stopProcessor),this.providedByUser=null===n||void 0===n||n,this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),i&&this.processor&&(yield this.stopProcessor()),this})}restart(e){return tv(this,void 0,void 0,function*(){this.manuallyStopped=!1;const t=yield this.restartLock.lock();try{e||(e=this._constraints);const{deviceId:t,facingMode:n}=e,i=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(e,["deviceId","facingMode"]);this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const r={audio:!1,video:!1};this.kind===Hy.Kind.Video?r.video=!t&&!n||{deviceId:t,facingMode:n}:r.audio=!t||{deviceId:t},this.attachedElements.forEach(e=>{Ky(this.mediaStreamTrack,e)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const s=(yield navigator.mediaDevices.getUserMedia(r)).getTracks()[0];return yield s.applyConstraints(i),s.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(s),this._constraints=e,this.emit(Ey.Restarted,this),this.manuallyStopped&&(this.log.warn("track was stopped during a restart, stopping restarted track",this.logContext),this.stop()),this}finally{t()}})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),this.isMuted===e&&this._mediaStreamTrack.enabled!==e||(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?Ey.Muted:Ey.Unmuted,this))}get needsReAcquisition(){return"live"!==this._mediaStreamTrack.readyState||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return tv(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),hb()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),this.isInBackground||!this.needsReAcquisition||this.isUserProvided||this.isMuted||(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;this.manuallyStopped=!0,super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),null===(e=this.processor)||void 0===e||e.destroy(),this.processor=void 0}pauseUpstream(){return tv(this,void 0,void 0,function*(){var e;const t=yield this.pauseUpstreamLock.lock();try{if(!0===this._isUpstreamPaused)return;if(!this.sender)return void this.log.warn("unable to pause upstream for an unpublished track",this.logContext);this._isUpstreamPaused=!0,this.emit(Ey.UpstreamPaused,this);const t=Ly();if("Safari"===(null===t||void 0===t?void 0:t.name)&&bb(t.version,"12.0")<0)throw new Ry("pauseUpstream is not supported on Safari < 12.");"closed"!==(null===(e=this.sender.transport)||void 0===e?void 0:e.state)&&(yield this.sender.replaceTrack(null))}finally{t()}})}resumeUpstream(){return tv(this,void 0,void 0,function*(){var e;const t=yield this.pauseUpstreamLock.lock();try{if(!1===this._isUpstreamPaused)return;if(!this.sender)return void this.log.warn("unable to resume upstream for an unpublished track",this.logContext);this._isUpstreamPaused=!1,this.emit(Ey.UpstreamResumed,this),"closed"!==(null===(e=this.sender.transport)||void 0===e?void 0:e.state)&&(yield this.sender.replaceTrack(this.mediaStreamTrack))}finally{t()}})}getRTCStatsReport(){return tv(this,void 0,void 0,function*(){var e;if(!(null===(e=this.sender)||void 0===e?void 0:e.getStats))return;return yield this.sender.getStats()})}setProcessor(e){return tv(this,arguments,void 0,function(e){var t=this;let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function*(){var i;const r=yield t.processorLock.lock();try{t.log.debug("setting up processor",t.logContext);const r=document.createElement(t.kind),s={kind:t.kind,track:t._mediaStreamTrack,element:r,audioContext:t.audioContext};if(yield e.init(s),t.log.debug("processor initialized",t.logContext),t.processor&&(yield t.stopProcessor()),"unknown"===t.kind)throw TypeError("cannot set processor on track of unknown kind");if(Wy(t._mediaStreamTrack,r),r.muted=!0,r.play().catch(e=>{e instanceof DOMException&&"AbortError"===e.name?(t.log.warn("failed to play processor element, retrying",Object.assign(Object.assign({},t.logContext),{error:e})),setTimeout(()=>{r.play().catch(e=>{t.log.error("failed to play processor element",Object.assign(Object.assign({},t.logContext),{err:e}))})},100)):t.log.error("failed to play processor element",Object.assign(Object.assign({},t.logContext),{error:e}))}),t.processor=e,t.processorElement=r,t.processor.processedTrack){for(const e of t.attachedElements)e!==t.processorElement&&n&&(Ky(t._mediaStreamTrack,e),Wy(t.processor.processedTrack,e));yield null===(i=t.sender)||void 0===i?void 0:i.replaceTrack(t.processor.processedTrack)}t.emit(Ey.TrackProcessorUpdate,t.processor)}finally{r()}}()})}getProcessor(){return this.processor}stopProcessor(){return tv(this,arguments,void 0,function(){var e=this;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function*(){var n,i;e.processor&&(e.log.debug("stopping processor",e.logContext),null===(n=e.processor.processedTrack)||void 0===n||n.stop(),yield e.processor.destroy(),e.processor=void 0,t||(null===(i=e.processorElement)||void 0===i||i.remove(),e.processorElement=void 0),yield e._mediaStreamTrack.applyConstraints(e._constraints),yield e.setMediaStreamTrack(e._mediaStreamTrack,!0),e.emit(Ey.TrackProcessorUpdate))}()})}startPreConnectBuffer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;if($k)if(this.localTrackRecorder)this.log.warn("preconnect buffer already started");else{{let e="audio/webm;codecs=opus";MediaRecorder.isTypeSupported(e)||(e="video/mp4"),this.localTrackRecorder=new Qk(this,{mimeType:e})}this.localTrackRecorder.start(e),this.autoStopPreConnectBuffer=setTimeout(()=>{this.log.warn("preconnect buffer timed out, stopping recording automatically",this.logContext),this.stopPreConnectBuffer()},1e4)}else this.log.warn("MediaRecorder is not available, cannot start preconnect buffer",this.logContext)}stopPreConnectBuffer(){clearTimeout(this.autoStopPreConnectBuffer),this.localTrackRecorder&&(this.localTrackRecorder.stop(),this.localTrackRecorder=void 0)}getPreConnectBuffer(){var e;return null===(e=this.localTrackRecorder)||void 0===e?void 0:e.byteStream}getPreConnectBufferMimeType(){var e;return null===(e=this.localTrackRecorder)||void 0===e?void 0:e.mimeType}}class Yk extends Jk{get enhancedNoiseCancellation(){return this.isKrispNoiseFilterEnabled}constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;super(e,Hy.Kind.Audio,t,n,s),this.stopOnMute=!1,this.isKrispNoiseFilterEnabled=!1,this.monitorSender=()=>tv(this,void 0,void 0,function*(){if(!this.sender)return void(this._currentBitrate=0);let e;try{e=yield this.getSenderStats()}catch(r){return void this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:r}))}e&&this.prevStats&&(this._currentBitrate=Kk(e,this.prevStats)),this.prevStats=e}),this.handleKrispNoiseFilterEnable=()=>{this.isKrispNoiseFilterEnabled=!0,this.log.debug("Krisp noise filter enabled",this.logContext),this.emit(Ey.AudioTrackFeatureUpdate,this,cm.TF_ENHANCED_NOISE_CANCELLATION,!0)},this.handleKrispNoiseFilterDisable=()=>{this.isKrispNoiseFilterEnabled=!1,this.log.debug("Krisp noise filter disabled",this.logContext),this.emit(Ey.AudioTrackFeatureUpdate,this,cm.TF_ENHANCED_NOISE_CANCELLATION,!1)},this.audioContext=i,this.checkForSilence()}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return tv(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===Hy.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{t()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return tv(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{if(!this.isMuted)return this.log.debug("Track already unmuted",this.logContext),this;const t=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==_b(this._constraints.deviceId);return this.source!==Hy.Source.Microphone||!this.stopOnMute&&"ended"!==this._mediaStreamTrack.readyState&&!t||this.isUserProvided||(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{t()}})}restartTrack(e){return tv(this,void 0,void 0,function*(){let t;if(e){const n=Wb({audio:e});"boolean"!==typeof n.audio&&(t=n.audio)}yield this.restart(t)})}restart(e){const t=Object.create(null,{restart:{get:()=>super.restart}});return tv(this,void 0,void 0,function*(){const n=yield t.restart.call(this,e);return this.checkForSilence(),n})}startMonitor(){pb()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},Wk)))}setProcessor(e){return tv(this,void 0,void 0,function*(){var t;const n=yield this.processorLock.lock();try{if(!fb()&&!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");this.processor&&(yield this.stopProcessor());const n={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(n),this.processor=e,this.processor.processedTrack&&(yield null===(t=this.sender)||void 0===t?void 0:t.replaceTrack(this.processor.processedTrack),this.processor.processedTrack.addEventListener("enable-lk-krisp-noise-filter",this.handleKrispNoiseFilterEnable),this.processor.processedTrack.addEventListener("disable-lk-krisp-noise-filter",this.handleKrispNoiseFilterDisable)),this.emit(Ey.TrackProcessorUpdate,this.processor)}finally{n()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){return tv(this,void 0,void 0,function*(){var e;if(!(null===(e=this.sender)||void 0===e?void 0:e.getStats))return;let t;return(yield this.sender.getStats()).forEach(e=>{"outbound-rtp"===e.type&&(t={type:"audio",streamId:e.id,packetsSent:e.packetsSent,packetsLost:e.packetsLost,bytesSent:e.bytesSent,timestamp:e.timestamp,roundTripTime:e.roundTripTime,jitter:e.jitter})}),t})}checkForSilence(){return tv(this,void 0,void 0,function*(){const e=yield Kb(this);return e&&(this.isMuted||this.log.warn("silence detected on local audio track",this.logContext),this.emit(Ey.AudioSilenceDetected)),e})}}const Xk=Object.values(Zy),Zk=Object.values(eb),ew=Object.values(tb),tw=[Zy.h180,Zy.h360],nw=[eb.h180,eb.h360],iw=["q","h","f"];function rw(e,t,n,i){var r,s;let o=null===i||void 0===i?void 0:i.videoEncoding;e&&(o=null===i||void 0===i?void 0:i.screenShareEncoding);const a=null===i||void 0===i?void 0:i.simulcast,c=null===i||void 0===i?void 0:i.scalabilityMode,l=null===i||void 0===i?void 0:i.videoCodec;if(!o&&!a&&!c||!t||!n)return[{}];o||(o=function(e,t,n,i){const r=function(e,t,n){if(e)return ew;const i=t>n?t/n:n/t;if(Math.abs(i-16/9)<Math.abs(i-4/3))return Xk;return Zk}(e,t,n);let{encoding:s}=r[0];const o=Math.max(t,n);for(let a=0;a<r.length;a+=1){const e=r[a];if(s=e.encoding,e.width>=o)break}if(i)switch(i){case"av1":case"h265":s=Object.assign({},s),s.maxBitrate=.7*s.maxBitrate;break;case"vp9":s=Object.assign({},s),s.maxBitrate=.85*s.maxBitrate}return s}(e,t,n,l),Jg.debug("using video encoding",o));const u=o.maxFramerate,d=new $y(t,n,o.maxBitrate,o.maxFramerate,o.priority);if(c&&ob(l)){const e=new cw(c),t=[];if(e.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(c));const n=Ly();if(ub()||fb()||"Chrome"===(null===n||void 0===n?void 0:n.name)&&bb(null===n||void 0===n?void 0:n.version,"113")<0){const i="h"==e.suffix?2:3,r=function(e){return e||(e=Ly()),"Safari"===(null===e||void 0===e?void 0:e.name)&&bb(e.version,"18.3")>0||"iOS"===(null===e||void 0===e?void 0:e.os)&&!!(null===e||void 0===e?void 0:e.osVersion)&&bb(e.osVersion,"18.3")>0}(n);for(let n=0;n<e.spatial;n+=1)t.push({rid:iw[2-n],maxBitrate:o.maxBitrate/Math.pow(i,n),maxFramerate:d.encoding.maxFramerate,scaleResolutionDownBy:r?Math.pow(2,n):void 0});t[0].scalabilityMode=c}else t.push({maxBitrate:o.maxBitrate,maxFramerate:d.encoding.maxFramerate,scalabilityMode:c});return d.encoding.priority&&(t[0].priority=d.encoding.priority,t[0].networkPriority=d.encoding.priority),Jg.debug("using svc encoding",{encodings:t}),t}if(!a)return[o];let h,p=[];if(p=e?null!==(r=aw(null===i||void 0===i?void 0:i.screenShareSimulcastLayers))&&void 0!==r?r:sw(e,d):null!==(s=aw(null===i||void 0===i?void 0:i.videoSimulcastLayers))&&void 0!==s?s:sw(e,d),p.length>0){const e=p[0];p.length>1&&([,h]=p);const i=Math.max(t,n);if(i>=960&&h)return ow(t,n,[e,h,d],u);if(i>=480)return ow(t,n,[e,d],u)}return ow(t,n,[d])}function sw(e,t){if(e)return[{scaleResolutionDownBy:2,fps:(n=t).encoding.maxFramerate}].map(e=>{var t,i;return new $y(Math.floor(n.width/e.scaleResolutionDownBy),Math.floor(n.height/e.scaleResolutionDownBy),Math.max(15e4,Math.floor(n.encoding.maxBitrate/(Math.pow(e.scaleResolutionDownBy,2)*((null!==(t=n.encoding.maxFramerate)&&void 0!==t?t:30)/(null!==(i=e.fps)&&void 0!==i?i:30))))),e.fps,n.encoding.priority)});var n;const{width:i,height:r}=t,s=i>r?i/r:r/i;return Math.abs(s-16/9)<Math.abs(s-4/3)?tw:nw}function ow(e,t,n,i){const r=[];if(n.forEach((n,s)=>{if(s>=iw.length)return;const o=Math.min(e,t),a={rid:iw[s],scaleResolutionDownBy:Math.max(1,o/Math.min(n.width,n.height)),maxBitrate:n.encoding.maxBitrate},c=i&&n.encoding.maxFramerate?Math.min(i,n.encoding.maxFramerate):n.encoding.maxFramerate;c&&(a.maxFramerate=c);const l=cb()||0===s;n.encoding.priority&&l&&(a.priority=n.encoding.priority,a.networkPriority=n.encoding.priority),r.push(a)}),fb()&&"ios"===vb()){let e;r.forEach(t=>{e?t.maxFramerate&&t.maxFramerate>e&&(e=t.maxFramerate):e=t.maxFramerate});let t=!0;r.forEach(n=>{var i;n.maxFramerate!=e&&(t&&(t=!1,Jg.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),Jg.info('Setting framerate of encoding "'.concat(null!==(i=n.rid)&&void 0!==i?i:"",'" to ').concat(e)),n.maxFramerate=e)})}return r}function aw(e){if(e)return e.sort((e,t)=>{const{encoding:n}=e,{encoding:i}=t;return n.maxBitrate>i.maxBitrate?1:n.maxBitrate<i.maxBitrate?-1:n.maxBitrate===i.maxBitrate&&n.maxFramerate&&i.maxFramerate?n.maxFramerate>i.maxFramerate?1:-1:0})}class cw{constructor(e){const t=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!t)throw new Error("invalid scalability mode");if(this.spatial=parseInt(t[1]),this.temporal=parseInt(t[2]),t.length>3)switch(t[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=t[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat(null!==(e=this.suffix)&&void 0!==e?e:"")}}class lw extends Jk{get sender(){return this._sender}set sender(e){this._sender=e,this.degradationPreference&&this.setDegradationPreference(this.degradationPreference)}constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3?arguments[3]:void 0;super(e,Hy.Kind.Video,t,n,i),this.simulcastCodecs=new Map,this.degradationPreference="balanced",this.isCpuConstrained=!1,this.optimizeForPerformance=!1,this.monitorSender=()=>tv(this,void 0,void 0,function*(){if(!this.sender)return void(this._currentBitrate=0);let e;try{e=yield this.getSenderStats()}catch(r){return void this.log.error("could not get video sender stats",Object.assign(Object.assign({},this.logContext),{error:r}))}const t=new Map(e.map(e=>[e.rid,e])),n=e.some(e=>"cpu"===e.qualityLimitationReason);if(n!==this.isCpuConstrained&&(this.isCpuConstrained=n,this.isCpuConstrained&&this.emit(Ey.CpuConstrained)),this.prevStats){let e=0;t.forEach((t,n)=>{var i;const r=null===(i=this.prevStats)||void 0===i?void 0:i.get(n);e+=Kk(t,r)}),this._currentBitrate=e}this.prevStats=t}),this.senderLock=new fp}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var t;if(this.signalClient=e,!pb())return;const n=null===(t=this.sender)||void 0===t?void 0:t.getParameters();n&&(this.encodings=n.encodings),this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},Wk))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});return tv(this,void 0,void 0,function*(){var t,n,i,r,s;yield e.pauseUpstream.call(this);try{for(var o,a=!0,c=iv(this.simulcastCodecs.values());!(t=(o=yield c.next()).done);a=!0){r=o.value,a=!1;const e=r;yield null===(s=e.sender)||void 0===s?void 0:s.replaceTrack(null)}}catch(l){n={error:l}}finally{try{a||t||!(i=c.return)||(yield i.call(c))}finally{if(n)throw n.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});return tv(this,void 0,void 0,function*(){var t,n,i,r,s;yield e.resumeUpstream.call(this);try{for(var o,a=!0,c=iv(this.simulcastCodecs.values());!(t=(o=yield c.next()).done);a=!0){r=o.value,a=!1;const e=r;yield null===(s=e.sender)||void 0===s?void 0:s.replaceTrack(e.mediaStreamTrack)}}catch(l){n={error:l}}finally{try{a||t||!(i=c.return)||(yield i.call(c))}finally{if(n)throw n.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return tv(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source!==Hy.Source.Camera||this.isUserProvided||(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{t()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return tv(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.source!==Hy.Source.Camera||this.isUserProvided||(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this):(this.log.debug("Track already unmuted",this.logContext),this)}finally{t()}})}setTrackMuted(e){super.setTrackMuted(e);for(const t of this.simulcastCodecs.values())t.mediaStreamTrack.enabled=!e}getSenderStats(){return tv(this,void 0,void 0,function*(){var e;if(!(null===(e=this.sender)||void 0===e?void 0:e.getStats))return[];const t=[],n=yield this.sender.getStats();return n.forEach(e=>{var i;if("outbound-rtp"===e.type){const r={type:"video",streamId:e.id,frameHeight:e.frameHeight,frameWidth:e.frameWidth,framesPerSecond:e.framesPerSecond,framesSent:e.framesSent,firCount:e.firCount,pliCount:e.pliCount,nackCount:e.nackCount,packetsSent:e.packetsSent,bytesSent:e.bytesSent,qualityLimitationReason:e.qualityLimitationReason,qualityLimitationDurations:e.qualityLimitationDurations,qualityLimitationResolutionChanges:e.qualityLimitationResolutionChanges,rid:null!==(i=e.rid)&&void 0!==i?i:e.id,retransmittedPacketsSent:e.retransmittedPacketsSent,targetBitrate:e.targetBitrate,timestamp:e.timestamp},s=n.get(e.remoteId);s&&(r.jitter=s.jitter,r.packetsLost=s.packetsLost,r.roundTripTime=s.roundTripTime),t.push(r)}}),t.sort((e,t)=>{var n,i;return(null!==(n=t.frameWidth)&&void 0!==n?n:0)-(null!==(i=e.frameWidth)&&void 0!==i?i:0)}),t})}setPublishingQuality(e){const t=[];for(let n=zy.LOW;n<=zy.HIGH;n+=1)t.push(new Cg({quality:n,enabled:n<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(ob(this.codec),t)}restartTrack(e){return tv(this,void 0,void 0,function*(){var t,n,i,r,s;let o;if(e){const t=Wb({video:e});"boolean"!==typeof t.video&&(o=t.video)}yield this.restart(o),this.isCpuConstrained=!1;try{for(var a,c=!0,l=iv(this.simulcastCodecs.values());!(t=(a=yield l.next()).done);c=!0){r=a.value,c=!1;const e=r;e.sender&&"closed"!==(null===(s=e.sender.transport)||void 0===s?void 0:s.state)&&(e.mediaStreamTrack=this.mediaStreamTrack.clone(),yield e.sender.replaceTrack(e.mediaStreamTrack))}}catch(u){n={error:u}}finally{try{c||t||!(i=l.return)||(yield i.call(l))}finally{if(n)throw n.error}}})}setProcessor(e){const t=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});return tv(this,arguments,void 0,function(e){var n=this;let i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function*(){var r,s,o,a,c,l;if(yield t.setProcessor.call(n,e,i),null===(c=n.processor)||void 0===c?void 0:c.processedTrack)try{for(var u,d=!0,h=iv(n.simulcastCodecs.values());!(r=(u=yield h.next()).done);d=!0){a=u.value,d=!1;const e=a;yield null===(l=e.sender)||void 0===l?void 0:l.replaceTrack(n.processor.processedTrack)}}catch(p){s={error:p}}finally{try{d||r||!(o=h.return)||(yield o.call(h))}finally{if(s)throw s.error}}}()})}setDegradationPreference(e){return tv(this,void 0,void 0,function*(){if(this.degradationPreference=e,this.sender)try{this.log.debug("setting degradationPreference to ".concat(e),this.logContext);const t=this.sender.getParameters();t.degradationPreference=e,this.sender.setParameters(t)}catch(r){this.log.warn("failed to set degradationPreference",Object.assign({error:r},this.logContext))}})}addSimulcastTrack(e,t){if(this.simulcastCodecs.has(e))return void this.log.error("".concat(e," already added, skipping adding simulcast codec"),this.logContext);const n={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:t};return this.simulcastCodecs.set(e,n),n}setSimulcastTrackSender(e,t){const n=this.simulcastCodecs.get(e);n&&(n.sender=t,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},5e3))}setPublishingCodecs(e){return tv(this,void 0,void 0,function*(){var t,n,i,r,s,o,a;if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(ob(e[0].codec),e[0].qualities),[];this.subscribedCodecs=e;const c=[];try{for(t=!0,n=iv(e);!(r=(i=yield n.next()).done);t=!0){a=i.value,t=!1;const e=a;if(this.codec&&this.codec!==e.codec){const t=this.simulcastCodecs.get(e.codec);if(this.log.debug("try setPublishingCodec for ".concat(e.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:t})),t&&t.sender)t.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(e.codec),this.logContext),yield uw(t.sender,t.encodings,e.qualities,this.senderLock,ob(e.codec),this.log,this.logContext));else for(const n of e.qualities)if(n.enabled){c.push(e.codec);break}}else yield this.setPublishingLayers(ob(e.codec),e.qualities)}}catch(l){s={error:l}}finally{try{t||r||!(o=n.return)||(yield o.call(n))}finally{if(s)throw s.error}}return c})}setPublishingLayers(e,t){return tv(this,void 0,void 0,function*(){this.optimizeForPerformance?this.log.info("skipping setPublishingLayers due to optimized publishing performance",Object.assign(Object.assign({},this.logContext),{qualities:t})):(this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:t})),this.sender&&this.encodings&&(yield uw(this.sender,this.encodings,t,this.senderLock,e,this.log,this.logContext)))})}prioritizePerformance(){return tv(this,void 0,void 0,function*(){if(!this.sender)throw new Error("sender not found");const e=yield this.senderLock.lock();try{this.optimizeForPerformance=!0;const e=this.sender.getParameters();e.encodings=e.encodings.map((e,t)=>{var n;return Object.assign(Object.assign({},e),{active:0===t,scaleResolutionDownBy:Math.max(1,Math.ceil((null!==(n=this.mediaStreamTrack.getSettings().height)&&void 0!==n?n:360)/360)),scalabilityMode:0===t&&ob(this.codec)?"L1T3":void 0,maxFramerate:0===t?15:0,maxBitrate:0===t?e.maxBitrate:0})}),this.log.debug("setting performance optimised encodings",Object.assign(Object.assign({},this.logContext),{encodings:e.encodings})),this.encodings=e.encodings,yield this.sender.setParameters(e)}catch(r){this.log.error("failed to set performance optimised encodings",Object.assign(Object.assign({},this.logContext),{error:r})),this.optimizeForPerformance=!1}finally{e()}})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return tv(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),hb()&&this.isInBackground&&this.source===Hy.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function uw(e,t,n,i,r,s,o){return tv(this,void 0,void 0,function*(){const a=yield i.lock();s.debug("setPublishingLayersForSender",Object.assign(Object.assign({},o),{sender:e,qualities:n,senderEncodings:t}));try{const i=e.getParameters(),{encodings:a}=i;if(!a)return;if(a.length!==t.length)return void s.warn("cannot set publishing layers, encodings mismatch",Object.assign(Object.assign({},o),{encodings:a,senderEncodings:t}));let c=!1;if(!1&&a[0].scalabilityMode);else{if(r){const e=n.some(e=>e.enabled);e&&n.forEach(e=>e.enabled=!0)}a.forEach((e,i)=>{var r;let a=null!==(r=e.rid)&&void 0!==r?r:"";""===a&&(a="q");const l=dw(a),u=n.find(e=>e.quality===l);u&&e.active!==u.enabled&&(c=!0,e.active=u.enabled,s.debug("setting layer ".concat(u.quality," to ").concat(e.active?"enabled":"disabled"),o),cb()&&(u.enabled?(e.scaleResolutionDownBy=t[i].scaleResolutionDownBy,e.maxBitrate=t[i].maxBitrate,e.maxFrameRate=t[i].maxFrameRate):(e.scaleResolutionDownBy=4,e.maxBitrate=10,e.maxFrameRate=2)))})}c&&(i.encodings=a,s.debug("setting encodings",Object.assign(Object.assign({},o),{encodings:i.encodings})),yield e.setParameters(i))}finally{a()}})}function dw(e){switch(e){case"f":default:return zy.HIGH;case"h":return zy.MEDIUM;case"q":return zy.LOW}}function hw(e,t,n,i){if(!n)return[new bm({quality:zy.HIGH,width:e,height:t,bitrate:0,ssrc:0})];if(i){const i=n[0].scalabilityMode,r=new cw(i),s=[],o="h"==r.suffix?1.5:2,a="h"==r.suffix?2:3;for(let c=0;c<r.spatial;c+=1)s.push(new bm({quality:Math.min(zy.HIGH,r.spatial-1)-c,width:Math.ceil(e/Math.pow(o,c)),height:Math.ceil(t/Math.pow(o,c)),bitrate:n[0].maxBitrate?Math.ceil(n[0].maxBitrate/Math.pow(a,c)):0,ssrc:0}));return s}return n.map(n=>{var i,r,s;const o=null!==(i=n.scaleResolutionDownBy)&&void 0!==i?i:1;let a=dw(null!==(r=n.rid)&&void 0!==r?r:"");return new bm({quality:a,width:Math.ceil(e/o),height:Math.ceil(t/o),bitrate:null!==(s=n.maxBitrate)&&void 0!==s?s:0,ssrc:0})})}const pw="_lossy",fw="_reliable",mw="leave-reconnect";var gw;!function(e){e[e.New=0]="New",e[e.Connected=1]="Connected",e[e.Disconnected=2]="Disconnected",e[e.Reconnecting=3]="Reconnecting",e[e.Closed=4]="Closed"}(gw||(gw={}));class vw extends ov.EventEmitter{get isClosed(){return this._isClosed}get pendingReconnect(){return!!this.reconnectTimeout}constructor(e){var t;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=Uk.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.latestRemoteOfferId=0,this.subscriberPrimary=!1,this.pcState=gw.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=Jg,this.reliableDataSequence=1,this.reliableMessageBuffer=new pk,this.reliableReceivedState=new fk(3e4),this.handleDataChannel=e=>tv(this,[e],void 0,function(e){var t=this;let{channel:n}=e;return function*(){if(n){if(n.label===fw)t.reliableDCSub=n;else{if(n.label!==pw)return;t.lossyDCSub=n}t.log.debug("on data channel ".concat(n.id,", ").concat(n.label),t.logContext),n.onmessage=t.handleDataMessage}}()}),this.handleDataMessage=e=>tv(this,void 0,void 0,function*(){var t,n;const i=yield this.dataProcessLock.lock();try{let i;if(e.data instanceof ArrayBuffer)i=e.data;else{if(!(e.data instanceof Blob))return void this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:e.data}));i=yield e.data.arrayBuffer()}const r=km.fromBinary(new Uint8Array(i));if(r.sequence>0&&""!==r.participantSid){const e=this.reliableReceivedState.get(r.participantSid);if(e&&r.sequence<=e)return;this.reliableReceivedState.set(r.participantSid,r.sequence)}"speaker"===(null===(t=r.value)||void 0===t?void 0:t.case)?this.emit(xy.ActiveSpeakersUpdate,r.value.value.speakers):("user"===(null===(n=r.value)||void 0===n?void 0:n.case)&&function(e,t){const n=e.participantIdentity?e.participantIdentity:t.participantIdentity;e.participantIdentity=n,t.participantIdentity=n;const i=0!==e.destinationIdentities.length?e.destinationIdentities:t.destinationIdentities;e.destinationIdentities=i,t.destinationIdentities=i}(r,r.value.value),this.emit(xy.DataPacketReceived,r))}finally{i()}}),this.handleDataError=e=>{const t=0===e.currentTarget.maxRetransmits?"lossy":"reliable";if(e instanceof ErrorEvent&&e.error){const{error:n}=e.error;this.log.error("DataChannel error on ".concat(t,": ").concat(e.message),Object.assign(Object.assign({},this.logContext),{error:n}))}else this.log.error("Unknown DataChannel error on ".concat(t),Object.assign(Object.assign({},this.logContext),{event:e}))},this.handleBufferedAmountLow=e=>{const t=0===e.currentTarget.maxRetransmits?wm.LOSSY:wm.RELIABLE;this.updateAndEmitDCBufferStatus(t)},this.handleDisconnect=(e,t)=>{if(this._isClosed)return;this.log.warn("".concat(e," disconnected"),this.logContext),0===this.reconnectAttempts&&(this.reconnectStart=Date.now());const n=e=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(e,"ms. giving up"),this.logContext),this.emit(xy.Disconnected),this.close()},i=Date.now()-this.reconnectStart;let r=this.getNextRetryDelay({elapsedMs:i,retryCount:this.reconnectAttempts});null!==r?(e===mw&&(r=0),this.log.debug("reconnecting in ".concat(r,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=Vy.setTimeout(()=>this.attemptReconnect(t).finally(()=>this.reconnectTimeout=void 0),r)):n(i)},this.waitForRestarted=()=>new Promise((e,t)=>{this.pcState===gw.Connected&&e();const n=()=>{this.off(xy.Disconnected,i),e()},i=()=>{this.off(xy.Restarted,n),t()};this.once(xy.Restarted,n),this.once(xy.Disconnected,i)}),this.updateAndEmitDCBufferStatus=e=>{const t=this.isBufferStatusLow(e);"undefined"!==typeof t&&t!==this.dcBufferStatus.get(e)&&(this.dcBufferStatus.set(e,t),this.emit(xy.DCBufferStatusChanged,t,e))},this.isBufferStatusLow=e=>{const t=this.dataChannelForKind(e);if(t)return e===wm.RELIABLE&&this.reliableMessageBuffer.alignBufferedAmount(t.bufferedAmount),t.bufferedAmount<=t.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===lk.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(om.RR_SIGNAL_DISCONNECTED))},this.log=Yg(null!==(t=e.loggerName)&&void 0!==t?t:Gg.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new uk(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new fp,this.dataProcessLock=new fp,this.dcBufferStatus=new Map([[wm.LOSSY,!0],[wm.RELIABLE,!0]]),this.client.onParticipantUpdate=e=>this.emit(xy.ParticipantUpdate,e),this.client.onConnectionQuality=e=>this.emit(xy.ConnectionQualityUpdate,e),this.client.onRoomUpdate=e=>this.emit(xy.RoomUpdate,e),this.client.onSubscriptionError=e=>this.emit(xy.SubscriptionError,e),this.client.onSubscriptionPermissionUpdate=e=>this.emit(xy.SubscriptionPermissionUpdate,e),this.client.onSpeakersChanged=e=>this.emit(xy.SpeakersChanged,e),this.client.onStreamStateUpdate=e=>this.emit(xy.StreamStateChanged,e),this.client.onRequestResponse=e=>this.emit(xy.SignalRequestResponse,e)}get logContext(){var e,t,n,i,r,s;return{room:null===(t=null===(e=this.latestJoinResponse)||void 0===e?void 0:e.room)||void 0===t?void 0:t.name,roomID:null===(i=null===(n=this.latestJoinResponse)||void 0===n?void 0:n.room)||void 0===i?void 0:i.sid,participant:null===(s=null===(r=this.latestJoinResponse)||void 0===r?void 0:r.participant)||void 0===s?void 0:s.identity,pID:this.participantSid}}join(e,t,n,i){return tv(this,void 0,void 0,function*(){this.url=e,this.token=t,this.signalOpts=n,this.maxJoinAttempts=n.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const r=yield this.client.join(e,t,n,i);return this._isClosed=!1,this.latestJoinResponse=r,this.subscriberPrimary=r.subscriberPrimary,this.pcManager||(yield this.configure(r)),this.subscriberPrimary&&!r.fastPublish||this.negotiate(),this.clientConfiguration=r.clientConfiguration,this.emit(xy.SignalConnected,r),r}catch(r){if(r instanceof Py&&r.reason===ky.ServerUnreachable&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(e,t,n,i);throw r}})}close(){return tv(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed)e();else try{this._isClosed=!0,this.joinAttempts=0,this.emit(xy.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){return tv(this,void 0,void 0,function*(){var e;yield null===(e=this.pcManager)||void 0===e?void 0:e.close(),this.pcManager=void 0;const t=e=>{e&&(e.close(),e.onbufferedamountlow=null,e.onclose=null,e.onclosing=null,e.onerror=null,e.onmessage=null,e.onopen=null)};t(this.lossyDC),t(this.lossyDCSub),t(this.reliableDC),t(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0,this.reliableMessageBuffer=new pk,this.reliableDataSequence=1,this.reliableReceivedState.clear()})}cleanupClient(){return tv(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new Oy("a track with the same ID has already been published");return new Promise((t,n)=>{const i=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],n(new Py("publication of local track timed out, no response from server",ky.Timeout))},1e4);this.pendingTrackResolvers[e.cid]={resolve:e=>{clearTimeout(i),t(e)},reject:()=>{clearTimeout(i),n(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:t}=this.pendingTrackResolvers[e.track.id];t&&t(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(r){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:r}))}return!1}updateMuteStatus(e,t){this.client.sendMuteTrack(e,t)}get dataSubscriberReadyState(){var e;return null===(e=this.reliableDCSub)||void 0===e?void 0:e.readyState}getConnectedServerAddress(){return tv(this,void 0,void 0,function*(){var e;return null===(e=this.pcManager)||void 0===e?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){return tv(this,void 0,void 0,function*(){var t,n;if(this.pcManager&&this.pcManager.currentState!==Bk.NEW)return;this.participantSid=null===(t=e.participant)||void 0===t?void 0:t.sid;const i=this.makeRTCConfiguration(e);var r;this.pcManager=new Vk(i,e.subscriberPrimary,this.loggerOptions),this.emit(xy.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(e,t)=>{this.client.sendIceCandidate(e,t)},this.pcManager.onPublisherOffer=(e,t)=>{this.client.sendOffer(e,t)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(t,n,i)=>tv(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(t),this.logContext),["closed","disconnected","failed"].includes(n)&&(this.publisherConnectionPromise=void 0),t===Bk.CONNECTED){const t=this.pcState===gw.New;this.pcState=gw.Connected,t&&this.emit(xy.Connected,e)}else t===Bk.FAILED&&this.pcState===gw.Connected&&(this.pcState=gw.Disconnected,this.handleDisconnect("peerconnection failed","failed"===i?om.RR_SUBSCRIBER_FAILED:om.RR_PUBLISHER_FAILED));const r=this.client.isDisconnected||this.client.currentState===lk.RECONNECTING,s=[Bk.FAILED,Bk.CLOSING,Bk.CLOSED].includes(t);r&&s&&!this._isClosed&&this.emit(xy.Offline)}),this.pcManager.onTrack=e=>{this.emit(xy.MediaTrackAdded,e.track,e.streams[0],e.receiver)},void 0!==(r=null===(n=e.serverInfo)||void 0===n?void 0:n.protocol)&&r>13||this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=(e,t)=>tv(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type})),yield this.pcManager.setPublisherAnswer(e,t))}),this.client.onTrickle=(e,t)=>{this.pcManager&&(this.log.debug("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:t})),this.pcManager.addIceCandidate(e,t))},this.client.onOffer=(e,t)=>tv(this,void 0,void 0,function*(){if(this.latestRemoteOfferId=t,!this.pcManager)return;const n=yield this.pcManager.createSubscriberAnswerFromOffer(e,t);n&&this.client.sendAnswer(n,t)}),this.client.onLocalTrackPublished=e=>{var t;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:null===(t=e.track)||void 0===t?void 0:t.sid})),!this.pendingTrackResolvers[e.cid])return void this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));const{resolve:n}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],n(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(xy.LocalTrackUnpublished,e)},this.client.onLocalTrackSubscribed=e=>{this.emit(xy.LocalTrackSubscribed,e)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onRemoteMuteChanged=(e,t)=>{this.emit(xy.RemoteMute,e,t)},this.client.onSubscribedQualityUpdate=e=>{this.emit(xy.SubscribedQualityUpdate,e)},this.client.onRoomMoved=e=>{var t;this.participantSid=null===(t=e.participant)||void 0===t?void 0:t.sid,this.latestJoinResponse&&(this.latestJoinResponse.room=e.room),this.emit(xy.RoomMoved,e)},this.client.onClose=()=>{this.handleDisconnect("signal",om.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{switch(this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:null===e||void 0===e?void 0:e.reason})),e.regions&&this.regionUrlProvider&&(this.log.debug("updating regions",this.logContext),this.regionUrlProvider.setServerReportedRegions(e.regions)),e.action){case fg.DISCONNECT:this.emit(xy.Disconnected,null===e||void 0===e?void 0:e.reason),this.close();break;case fg.RECONNECT:this.fullReconnectOnNext=!0,this.handleDisconnect(mw);break;case fg.RESUME:this.handleDisconnect(mw)}}}makeRTCConfiguration(e){var t;const n=Object.assign({},this.rtcConfig);if((null===(t=this.signalOpts)||void 0===t?void 0:t.e2eeEnabled)&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),n.encodedInsertableStreams=!0),e.iceServers&&!n.iceServers){const t=[];e.iceServers.forEach(e=>{const n={urls:e.urls};e.username&&(n.username=e.username),e.credential&&(n.credential=e.credential),t.push(n)}),n.iceServers=t}return e.clientConfiguration&&e.clientConfiguration.forceRelay===rm.ENABLED&&(n.iceTransportPolicy="relay"),n.sdpSemantics="unified-plan",n.continualGatheringPolicy="gather_continually",n}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(pw,{ordered:!1,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(fw,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}createSender(e,t,n){return tv(this,void 0,void 0,function*(){if(rb()){return yield this.createTransceiverRTCRtpSender(e,t,n)}if(sb()){this.log.warn("using add-track fallback",this.logContext);return yield this.createRTCRtpSender(e.mediaStreamTrack)}throw new Ny("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,t,n,i){return tv(this,void 0,void 0,function*(){if(rb())return this.createSimulcastTransceiverSender(e,t,n,i);if(sb())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new Ny("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,t,n){return tv(this,void 0,void 0,function*(){if(!this.pcManager)throw new Ny("publisher is closed");const i=[];e.mediaStream&&i.push(e.mediaStream),Lb(e)&&(e.codec=t.videoCodec);const r={direction:"sendonly",streams:i};n&&(r.sendEncodings=n);return(yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,r)).sender})}createSimulcastTransceiverSender(e,t,n,i){return tv(this,void 0,void 0,function*(){if(!this.pcManager)throw new Ny("publisher is closed");const r={direction:"sendonly"};i&&(r.sendEncodings=i);const s=yield this.pcManager.addPublisherTransceiver(t.mediaStreamTrack,r);if(n.videoCodec)return e.setSimulcastTrackSender(n.videoCodec,s.sender),s.sender})}createRTCRtpSender(e){return tv(this,void 0,void 0,function*(){if(!this.pcManager)throw new Ny("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){return tv(this,void 0,void 0,function*(){var t,n,i;if(!this._isClosed)if(this.attemptingReconnect)Jg.warn("already attempting reconnect, returning early",this.logContext);else{(null===(t=this.clientConfiguration)||void 0===t?void 0:t.resumeConnection)!==rm.DISABLED&&(null!==(i=null===(n=this.pcManager)||void 0===n?void 0:n.currentState)&&void 0!==i?i:Bk.NEW)!==Bk.NEW||(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(r){this.reconnectAttempts+=1;let t=!0;r instanceof Ny?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:r})),t=!1):r instanceof yw||(this.fullReconnectOnNext=!0),t?this.handleDisconnect("reconnect",om.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(xy.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(r){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:r}))}return null}restartConnection(e){return tv(this,void 0,void 0,function*(){var t,n,i;try{if(!this.url||!this.token)throw new Ny("could not reconnect, url or token not saved");let n;this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(xy.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new yw;n=yield this.join(null!==e&&void 0!==e?e:this.url,this.token,this.signalOpts)}catch(r){if(r instanceof Py&&r.reason===ky.NotAllowed)throw new Ny("could not reconnect, token might be expired");throw new yw}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(xy.SignalRestarted,n),yield this.waitForPCReconnected(),this.client.currentState!==lk.CONNECTED)throw new yw("Signal connection got severed during reconnect");null===(t=this.regionUrlProvider)||void 0===t||t.resetAttempts(),this.emit(xy.Restarted)}catch(s){const e=yield null===(n=this.regionUrlProvider)||void 0===n?void 0:n.getNextBestRegionUrl();if(e)return void(yield this.restartConnection(e));throw null===(i=this.regionUrlProvider)||void 0===i||i.resetAttempts(),s}})}resumeConnection(e){return tv(this,void 0,void 0,function*(){var t;if(!this.url||!this.token)throw new Ny("could not reconnect, url or token not saved");if(!this.pcManager)throw new Ny("publisher and subscriber connections unset");let n;this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(xy.Resuming);try{this.setupSignalClientCallbacks(),n=yield this.client.reconnect(this.url,this.token,this.participantSid,e)}catch(i){let e="";if(i instanceof Error&&(e=i.message,this.log.error(i.message,Object.assign(Object.assign({},this.logContext),{error:i}))),i instanceof Py&&i.reason===ky.NotAllowed)throw new Ny("could not reconnect, token might be expired");if(i instanceof Py&&i.reason===ky.LeaveRequest)throw i;throw new yw(e)}if(this.emit(xy.SignalResumed),n){const e=this.makeRTCConfiguration(n);this.pcManager.updateConfiguration(e),this.latestJoinResponse&&(this.latestJoinResponse.serverInfo=n.serverInfo)}else this.log.warn("Did not receive reconnect response",this.logContext);if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==lk.CONNECTED)throw new yw("Signal connection got severed during reconnect");this.client.setReconnected(),"open"===(null===(t=this.reliableDC)||void 0===t?void 0:t.readyState)&&null===this.reliableDC.id&&this.createDataChannels(),(null===n||void 0===n?void 0:n.lastMessageSeq)&&this.resendReliableMessagesForResume(n.lastMessageSeq),this.emit(xy.Resumed)})}waitForPCInitialConnection(e,t){return tv(this,void 0,void 0,function*(){if(!this.pcManager)throw new Ny("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(t,e)})}waitForPCReconnected(){return tv(this,void 0,void 0,function*(){this.pcState=gw.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield ib(2e3),!this.pcManager)throw new Ny("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=gw.Connected}catch(r){throw this.pcState=gw.Disconnected,new Py("could not establish PC connection, ".concat(r.message),ky.InternalError)}})}publishRpcResponse(e,t,n,i){return tv(this,void 0,void 0,function*(){const r=new km({destinationIdentities:[e],kind:wm.RELIABLE,value:{case:"rpcResponse",value:new Nm({requestId:t,value:i?{case:"error",value:i.toProto()}:{case:"payload",value:null!==n&&void 0!==n?n:""}})}});yield this.sendDataPacket(r,wm.RELIABLE)})}publishRpcAck(e,t){return tv(this,void 0,void 0,function*(){const n=new km({destinationIdentities:[e],kind:wm.RELIABLE,value:{case:"rpcAck",value:new _m({requestId:t})}});yield this.sendDataPacket(n,wm.RELIABLE)})}sendDataPacket(e,t){return tv(this,void 0,void 0,function*(){yield this.ensurePublisherConnected(t),t===wm.RELIABLE&&(e.sequence=this.reliableDataSequence,this.reliableDataSequence+=1);const n=e.toBinary(),i=this.dataChannelForKind(t);if(i){if(t===wm.RELIABLE&&this.reliableMessageBuffer.push({data:n,sequence:e.sequence}),this.attemptingReconnect)return;i.send(n)}this.updateAndEmitDCBufferStatus(t)})}resendReliableMessagesForResume(e){return tv(this,void 0,void 0,function*(){yield this.ensurePublisherConnected(wm.RELIABLE);const t=this.dataChannelForKind(wm.RELIABLE);t&&(this.reliableMessageBuffer.popToSequence(e),this.reliableMessageBuffer.getAll().forEach(e=>{t.send(e.data)})),this.updateAndEmitDCBufferStatus(wm.RELIABLE)})}waitForBufferStatusLow(e){return new Promise((t,n)=>tv(this,void 0,void 0,function*(){if(this.isBufferStatusLow(e))t();else{const i=()=>n("Engine closed");for(this.once(xy.Closing,i);!this.dcBufferStatus.get(e);)yield ib(10);this.off(xy.Closing,i),t()}}))}ensureDataTransportConnected(e){return tv(this,arguments,void 0,function(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.subscriberPrimary;return function*(){var i;if(!t.pcManager)throw new Ny("PC manager is closed");const r=n?t.pcManager.subscriber:t.pcManager.publisher,s=n?"Subscriber":"Publisher";if(!r)throw new Py("".concat(s," connection not set"),ky.InternalError);let o=!1;n||t.dataChannelForKind(e,n)||(t.createDataChannels(),o=!0),o||n||t.pcManager.publisher.isICEConnected||"checking"===t.pcManager.publisher.getICEConnectionState()||(o=!0),o&&t.negotiate();const a=t.dataChannelForKind(e,n);if("open"===(null===a||void 0===a?void 0:a.readyState))return;const c=(new Date).getTime()+t.peerConnectionTimeout;for(;(new Date).getTime()<c;){if(r.isICEConnected&&"open"===(null===(i=t.dataChannelForKind(e,n))||void 0===i?void 0:i.readyState))return;yield ib(50)}throw new Py("could not establish ".concat(s," connection, state: ").concat(r.getICEConnectionState()),ky.InternalError)}()})}ensurePublisherConnected(e){return tv(this,void 0,void 0,function*(){this.publisherConnectionPromise||(this.publisherConnectionPromise=this.ensureDataTransportConnected(e,!1)),yield this.publisherConnectionPromise})}verifyTransport(){return!!this.pcManager&&(this.pcManager.currentState===Bk.CONNECTED&&!(!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED))}negotiate(){return tv(this,void 0,void 0,function*(){return new Promise((e,t)=>tv(this,void 0,void 0,function*(){if(!this.pcManager)return void t(new Ay("PC manager is closed"));this.pcManager.requirePublisher(),0!=this.pcManager.publisher.getTransceivers().length||this.lossyDC||this.reliableDC||this.createDataChannels();const n=new AbortController,i=()=>{n.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&t("cannot negotiate on closed engine"),this.on(xy.Closing,i),this.pcManager.publisher.once(_k,e=>{const t=new Map;e.forEach(e=>{const n=e.codec.toLowerCase();var i;i=n,Qy.includes(i)&&t.set(e.payload,n)}),this.emit(xy.RTPVideoMapUpdate,t)});try{yield this.pcManager.negotiate(n),e()}catch(r){r instanceof Ay&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",om.RR_UNKNOWN),t(r)}finally{this.off(xy.Closing,i)}}))})}dataChannelForKind(e,t){if(t){if(e===wm.LOSSY)return this.lossyDCSub;if(e===wm.RELIABLE)return this.reliableDCSub}else{if(e===wm.LOSSY)return this.lossyDC;if(e===wm.RELIABLE)return this.reliableDC}}sendSyncState(e,t){var n,i;if(!this.pcManager)return void this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);const r=this.pcManager.subscriber.getLocalDescription(),s=this.pcManager.subscriber.getRemoteDescription(),o=null===(i=null===(n=this.signalOpts)||void 0===n?void 0:n.autoSubscribe)||void 0===i||i,a=new Array,c=new Array;e.forEach(e=>{e.isDesired!==o&&a.push(e.trackSid),e.isEnabled||c.push(e.trackSid)}),this.client.sendSyncState(new Ng({answer:r?hk({sdp:r.sdp,type:r.type}):void 0,offer:s?hk({sdp:s.sdp,type:s.type}):void 0,subscription:new lg({trackSids:a,subscribe:!o,participantTracks:[]}),publishTracks:Xb(t),dataChannels:this.dataChannelsInfo(),trackSidsDisabled:c,datachannelReceiveStates:this.reliableReceivedState.map((e,t)=>new Ag({publisherSid:t,lastSeq:e}))}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],t=(t,n)=>{void 0!==(null===t||void 0===t?void 0:t.id)&&null!==t.id&&e.push(new Ig({label:t.label,id:t.id,target:n}))};return t(this.dataChannelForKind(wm.LOSSY),Gm.PUBLISHER),t(this.dataChannelForKind(wm.RELIABLE),Gm.PUBLISHER),t(this.dataChannelForKind(wm.LOSSY,!0),Gm.SUBSCRIBER),t(this.dataChannelForKind(wm.RELIABLE,!0),Gm.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&Vy.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){pb()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){pb()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class yw extends Error{}class bw{constructor(e,t){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=t}updateToken(e){this.token=e}isCloud(){return mb(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(e){return tv(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const t=this.regionSettings.regions.filter(e=>!this.attemptedRegions.find(t=>t.url===e.url));if(t.length>0){const e=t[0];return this.attemptedRegions.push(e),Jg.debug("next region: ".concat(e.region)),e.url}return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return tv(this,void 0,void 0,function*(){const t=yield fetch("".concat((n=this.serverUrl,"".concat(n.protocol.replace("ws","http"),"//").concat(n.host,"/settings")),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});var n;if(t.ok){const e=yield t.json();return this.lastUpdateAt=Date.now(),e}throw new Py("Could not fetch region settings: ".concat(t.statusText),401===t.status?ky.NotAllowed:ky.InternalError,t.status)})}setServerReportedRegions(e){this.regionSettings=e,this.lastUpdateAt=Date.now()}}class kw{get info(){return this._info}constructor(e,t,n){this.reader=t,this.totalByteSize=n,this._info=e,this.bytesReceived=0}}class ww extends kw{handleChunkReceived(e){var t;this.bytesReceived+=e.content.byteLength;const n=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;null===(t=this.onProgress)||void 0===t||t.call(this,n)}[Symbol.asyncIterator](){const e=this.reader.getReader();return{next:()=>tv(this,void 0,void 0,function*(){try{const{done:t,value:n}=yield e.read();return t?{done:!0,value:void 0}:(this.handleChunkReceived(n),{done:!1,value:n.content})}catch(t){return{done:!0,value:void 0}}}),return(){return tv(this,void 0,void 0,function*(){return e.releaseLock(),{done:!0,value:void 0}})}}}readAll(){return tv(this,void 0,void 0,function*(){var e,t,n,i;let r=new Set;try{for(var s,o=!0,a=iv(this);!(e=(s=yield a.next()).done);o=!0){i=s.value,o=!1;const e=i;r.add(e)}}catch(c){t={error:c}}finally{try{o||e||!(n=a.return)||(yield n.call(a))}finally{if(t)throw t.error}}return Array.from(r)})}}class Sw extends kw{constructor(e,t,n){super(e,t,n),this.receivedChunks=new Map}handleChunkReceived(e){var t;const n=Ib(e.chunkIndex),i=this.receivedChunks.get(n);if(i&&i.version>e.version)return;this.receivedChunks.set(n,e),this.bytesReceived+=e.content.byteLength;const r=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;null===(t=this.onProgress)||void 0===t||t.call(this,r)}[Symbol.asyncIterator](){const e=this.reader.getReader(),t=new TextDecoder;return{next:()=>tv(this,void 0,void 0,function*(){try{const{done:n,value:i}=yield e.read();return n?{done:!0,value:void 0}:(this.handleChunkReceived(i),{done:!1,value:t.decode(i.content)})}catch(n){return{done:!0,value:void 0}}}),return(){return tv(this,void 0,void 0,function*(){return e.releaseLock(),{done:!0,value:void 0}})}}}readAll(){return tv(this,void 0,void 0,function*(){var e,t,n,i;let r="";try{for(var s,o=!0,a=iv(this);!(e=(s=yield a.next()).done);o=!0){i=s.value,o=!1;r+=i}}catch(c){t={error:c}}finally{try{o||e||!(n=a.return)||(yield n.call(a))}finally{if(t)throw t.error}}return r})}}class Tw{constructor(e,t,n){this.writableStream=e,this.defaultWriter=e.getWriter(),this.onClose=n,this.info=t}write(e){return this.defaultWriter.write(e)}close(){return tv(this,void 0,void 0,function*(){var e;yield this.defaultWriter.close(),this.defaultWriter.releaseLock(),null===(e=this.onClose)||void 0===e||e.call(this)})}}class Cw extends Tw{}class xw extends Tw{}class Ew extends Hy{constructor(e,t,n,i,r){super(e,n,r),this.sid=t,this.receiver=i}get isLocal(){return!1}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?Ey.Muted:Ey.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const t=n=>{n.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",t),this.receiver&&"playoutDelayHint"in this.receiver&&(this.receiver.playoutDelayHint=void 0),this.receiver=void 0,this._currentBitrate=0,this.emit(Ey.Ended,this))};e.addEventListener("removetrack",t)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){return tv(this,void 0,void 0,function*(){var e;if(!(null===(e=this.receiver)||void 0===e?void 0:e.getStats))return;return yield this.receiver.getStats()})}setPlayoutDelay(e){this.receiver?"playoutDelayHint"in this.receiver?this.receiver.playoutDelayHint=e:this.log.warn("Playout delay not supported in this browser"):this.log.warn("Cannot set playout delay, track already ended")}getPlayoutDelay(){if(this.receiver){if("playoutDelayHint"in this.receiver)return this.receiver.playoutDelayHint;this.log.warn("Playout delay not supported in this browser")}else this.log.warn("Cannot get playout delay, track already ended");return 0}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),Wk)),"undefined"!==typeof RTCRtpReceiver&&"getSynchronizationSources"in RTCRtpReceiver&&this.registerTimeSyncUpdate()}registerTimeSyncUpdate(){const e=()=>{var t;this.timeSyncHandle=requestAnimationFrame(()=>e());const n=null===(t=this.receiver)||void 0===t?void 0:t.getSynchronizationSources()[0];if(n){const{timestamp:e,rtpTimestamp:t}=n;t&&this.rtpTimestamp!==t&&(this.emit(Ey.TimeSyncUpdate,{timestamp:e,rtpTimestamp:t}),this.rtpTimestamp=t)}};e()}}class Pw extends Ew{constructor(e,t,n,i,r,s){super(e,t,Hy.Kind.Audio,n,s),this.monitorReceiver=()=>tv(this,void 0,void 0,function*(){if(!this.receiver)return void(this._currentBitrate=0);const e=yield this.getReceiverStats();e&&this.prevStats&&this.receiver&&(this._currentBitrate=Kk(e,this.prevStats)),this.prevStats=e}),this.audioContext=i,this.webAudioPluginNodes=[],r&&(this.sinkId=r.deviceId)}setVolume(e){var t;for(const n of this.attachedElements)this.audioContext?null===(t=this.gainNode)||void 0===t||t.gain.setTargetAtTime(e,0,.1):n.volume=e;fb()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(fb())return 1;let e=0;return this.attachedElements.forEach(t=>{t.volume>e&&(e=t.volume)}),e}setSinkId(e){return tv(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(t=>{if(ab(t))return t.setSinkId(e)}))})}attach(e){const t=0===this.attachedElements.length;return e?super.attach(e):e=super.attach(),this.sinkId&&ab(e)&&e.setSinkId(this.sinkId).catch(e=>{this.log.error("Failed to set sink id on remote audio track",e,this.logContext)}),this.audioContext&&t&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let t;return e?(t=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(t=super.detach(),this.disconnectWebAudio()),t}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,t){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(t.srcObject);let n=this.sourceNode;this.webAudioPluginNodes.forEach(e=>{n.connect(e),n=e}),this.gainNode=e.createGain(),n.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),"running"!==e.state&&e.resume().then(()=>{"running"!==e.state&&this.emit(Ey.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(e=>{this.emit(Ey.AudioPlaybackFailed,e)})}disconnectWebAudio(){var e,t;null===(e=this.gainNode)||void 0===e||e.disconnect(),null===(t=this.sourceNode)||void 0===t||t.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return tv(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;let e;return(yield this.receiver.getStats()).forEach(t=>{"inbound-rtp"===t.type&&(e={type:"audio",streamId:t.id,timestamp:t.timestamp,jitter:t.jitter,bytesReceived:t.bytesReceived,concealedSamples:t.concealedSamples,concealmentEvents:t.concealmentEvents,silentConcealedSamples:t.silentConcealedSamples,silentConcealmentEvents:t.silentConcealmentEvents,totalAudioEnergy:t.totalAudioEnergy,totalSamplesDuration:t.totalSamplesDuration})}),e})}}class Rw extends Ew{constructor(e,t,n,i,r){super(e,t,Hy.Kind.Video,n,r),this.elementInfos=[],this.monitorReceiver=()=>tv(this,void 0,void 0,function*(){if(!this.receiver)return void(this._currentBitrate=0);const e=yield this.getReceiverStats();e&&this.prevStats&&this.receiver&&(this._currentBitrate=Kk(e,this.prevStats)),this.prevStats=e}),this.debouncedHandleResize=Pk(()=>{this.updateDimensions()},100),this.adaptiveStreamSettings=i}get isAdaptiveStream(){return void 0!==this.adaptiveStreamSettings}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(t=>{e?Ky(this._mediaStreamTrack,t):Wy(this._mediaStreamTrack,t)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&void 0===this.elementInfos.find(t=>t.element===e)){const t=new Ow(e);this.observeElementInfo(t)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&void 0===this.elementInfos.find(t=>t===e)?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream)return void this.log.warn("stopObservingElementInfo ignored",this.logContext);const t=this.elementInfos.filter(t=>t===e);for(const n of t)n.stopObserving();this.elementInfos=this.elementInfos.filter(t=>t!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let t=[];if(e)return this.stopObservingElement(e),super.detach(e);t=super.detach();for(const n of t)this.stopObservingElement(n);return t}getDecoderImplementation(){var e;return null===(e=this.prevStats)||void 0===e?void 0:e.decoderImplementation}getReceiverStats(){return tv(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let t,n="",i=new Map;return e.forEach(e=>{"inbound-rtp"===e.type?(n=e.codecId,t={type:"video",streamId:e.id,framesDecoded:e.framesDecoded,framesDropped:e.framesDropped,framesReceived:e.framesReceived,packetsReceived:e.packetsReceived,packetsLost:e.packetsLost,frameWidth:e.frameWidth,frameHeight:e.frameHeight,pliCount:e.pliCount,firCount:e.firCount,nackCount:e.nackCount,jitter:e.jitter,timestamp:e.timestamp,bytesReceived:e.bytesReceived,decoderImplementation:e.decoderImplementation}):"codec"===e.type&&i.set(e.id,e)}),t&&""!==n&&i.get(n)&&(t.mimeType=i.get(n).mimeType),t})}stopObservingElement(e){const t=this.elementInfos.filter(t=>t.element===e);for(const n of t)this.stopObservingElementInfo(n)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return tv(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(){var e,t;const n=this.elementInfos.reduce((e,t)=>Math.max(e,t.visibilityChangedAt||0),0),i=!(null!==(t=null===(e=this.adaptiveStreamSettings)||void 0===e?void 0:e.pauseVideoInBackground)&&void 0!==t&&!t)&&this.isInBackground,r=this.elementInfos.some(e=>e.pictureInPicture),s=this.elementInfos.some(e=>e.visible)&&!i||r;this.lastVisible!==s&&(!s&&Date.now()-n<100?Vy.setTimeout(()=>{this.updateVisibility()},100):(this.lastVisible=s,this.emit(Ey.VisibilityChanged,s,this)))}updateDimensions(){var e,t;let n=0,i=0;const r=this.getPixelDensity();for(const s of this.elementInfos){const e=s.width()*r,t=s.height()*r;e+t>n+i&&(n=e,i=t)}(null===(e=this.lastDimensions)||void 0===e?void 0:e.width)===n&&(null===(t=this.lastDimensions)||void 0===t?void 0:t.height)===i||(this.lastDimensions={width:n,height:i},this.emit(Ey.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const t=null===(e=this.adaptiveStreamSettings)||void 0===e?void 0:e.pixelDensity;if("screen"===t)return yb();if(!t){return yb()>2?2:1}return t}}class Ow{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,t){this.onVisibilityChanged=e=>{var t;const{target:n,isIntersecting:i}=e;n===this.element&&(this.isIntersecting=i,this.isPiP=_w(this.element),this.visibilityChangedAt=Date.now(),null===(t=this.handleVisibilityChanged)||void 0===t||t.call(this))},this.onEnterPiP=()=>{var e,t,n;null===(t=null===(e=window.documentPictureInPicture)||void 0===e?void 0:e.window)||void 0===t||t.addEventListener("pagehide",this.onLeavePiP),this.isPiP=_w(this.element),null===(n=this.handleVisibilityChanged)||void 0===n||n.call(this)},this.onLeavePiP=()=>{var e;this.isPiP=_w(this.element),null===(e=this.handleVisibilityChanged)||void 0===e||e.call(this)},this.element=e,this.isIntersecting=null!==t&&void 0!==t?t:Nw(e),this.isPiP=pb()&&_w(e),this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){var e,t,n;this.isIntersecting=Nw(this.element),this.isPiP=_w(this.element),this.element.handleResize=()=>{var e;null===(e=this.handleResize)||void 0===e||e.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,xb().observe(this.element),Tb().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP),null===(e=window.documentPictureInPicture)||void 0===e||e.addEventListener("enter",this.onEnterPiP),null===(n=null===(t=window.documentPictureInPicture)||void 0===t?void 0:t.window)||void 0===n||n.addEventListener("pagehide",this.onLeavePiP)}stopObserving(){var e,t,n,i,r;null===(e=xb())||void 0===e||e.unobserve(this.element),null===(t=Tb())||void 0===t||t.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP),null===(n=window.documentPictureInPicture)||void 0===n||n.removeEventListener("enter",this.onEnterPiP),null===(r=null===(i=window.documentPictureInPicture)||void 0===i?void 0:i.window)||void 0===r||r.removeEventListener("pagehide",this.onLeavePiP)}}function _w(e){var t,n;return document.pictureInPictureElement===e||!!(null===(t=window.documentPictureInPicture)||void 0===t?void 0:t.window)&&Nw(e,null===(n=window.documentPictureInPicture)||void 0===n?void 0:n.window)}function Nw(e,t){const n=t||window;let i=e.offsetTop,r=e.offsetLeft;const s=e.offsetWidth,o=e.offsetHeight,{hidden:a}=e,{display:c}=getComputedStyle(e);for(;e.offsetParent;)i+=(e=e.offsetParent).offsetTop,r+=e.offsetLeft;return i<n.pageYOffset+n.innerHeight&&r<n.pageXOffset+n.innerWidth&&i+o>n.pageYOffset&&r+s>n.pageXOffset&&!a&&"none"!==c}class Aw extends ov.EventEmitter{constructor(e,t,n,i){var r;super(),this.metadataMuted=!1,this.encryption=gm.NONE,this.log=Jg,this.handleMuted=()=>{this.emit(Ey.Muted)},this.handleUnmuted=()=>{this.emit(Ey.Unmuted)},this.log=Yg(null!==(r=null===i||void 0===i?void 0:i.loggerName)&&void 0!==r?r:Gg.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=t,this.trackName=n,this.source=Hy.Source.Unknown}setTrack(e){this.track&&(this.track.off(Ey.Muted,this.handleMuted),this.track.off(Ey.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(Ey.Muted,this.handleMuted),e.on(Ey.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},null===(e=this.loggerContextCb)||void 0===e?void 0:e.call(this)),Zb(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return void 0!==this.track}get isEncrypted(){return this.encryption!==gm.NONE}get audioTrack(){if(Mb(this.track))return this.track}get videoTrack(){if(Lb(this.track))return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=Hy.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===Hy.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}!function(e){var t,n;(t=e.SubscriptionStatus||(e.SubscriptionStatus={})).Desired="desired",t.Subscribed="subscribed",t.Unsubscribed="unsubscribed",(n=e.PermissionStatus||(e.PermissionStatus={})).Allowed="allowed",n.NotAllowed="not_allowed"}(Aw||(Aw={}));class Iw extends Aw{get isUpstreamPaused(){var e;return null===(e=this.track)||void 0===e?void 0:e.isUpstreamPaused}constructor(e,t,n,i){super(e,t.sid,t.name,i),this.track=void 0,this.handleTrackEnded=()=>{this.emit(Ey.Ended)},this.handleCpuConstrained=()=>{this.track&&Lb(this.track)&&this.emit(Ey.CpuConstrained,this.track)},this.updateInfo(t),this.setTrack(n)}setTrack(e){this.track&&(this.track.off(Ey.Ended,this.handleTrackEnded),this.track.off(Ey.CpuConstrained,this.handleCpuConstrained)),super.setTrack(e),e&&(e.on(Ey.Ended,this.handleTrackEnded),e.on(Ey.CpuConstrained,this.handleCpuConstrained))}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}get isLocal(){return!0}mute(){return tv(this,void 0,void 0,function*(){var e;return null===(e=this.track)||void 0===e?void 0:e.mute()})}unmute(){return tv(this,void 0,void 0,function*(){var e;return null===(e=this.track)||void 0===e?void 0:e.unmute()})}pauseUpstream(){return tv(this,void 0,void 0,function*(){var e;yield null===(e=this.track)||void 0===e?void 0:e.pauseUpstream()})}resumeUpstream(){return tv(this,void 0,void 0,function*(){var e;yield null===(e=this.track)||void 0===e?void 0:e.resumeUpstream()})}getTrackFeatures(){var e;if(Mb(this.track)){const t=this.track.getSourceTrackSettings(),n=new Set;return t.autoGainControl&&n.add(cm.TF_AUTO_GAIN_CONTROL),t.echoCancellation&&n.add(cm.TF_ECHO_CANCELLATION),t.noiseSuppression&&n.add(cm.TF_NOISE_SUPPRESSION),t.channelCount&&t.channelCount>1&&n.add(cm.TF_STEREO),(null===(e=this.options)||void 0===e?void 0:e.dtx)||n.add(cm.TF_NO_DTX),this.track.enhancedNoiseCancellation&&n.add(cm.TF_ENHANCED_NOISE_CANCELLATION),Array.from(n.values())}return[]}}function jw(e,t){return tv(this,void 0,void 0,function*(){null!==e&&void 0!==e||(e={});let n=!1;const{audioProcessor:i,videoProcessor:s,optionsWithoutProcessor:o}=ek(e);let a=o.audio,c=o.video;if(i&&"object"===typeof o.audio&&(o.audio.processor=i),s&&"object"===typeof o.video&&(o.video.processor=s),e.audio&&"object"===typeof o.audio&&"string"===typeof o.audio.deviceId){const e=o.audio.deviceId;o.audio.deviceId={exact:e},n=!0,a=Object.assign(Object.assign({},o.audio),{deviceId:{ideal:e}})}if(o.video&&"object"===typeof o.video&&"string"===typeof o.video.deviceId){const e=o.video.deviceId;o.video.deviceId={exact:e},n=!0,c=Object.assign(Object.assign({},o.video),{deviceId:{ideal:e}})}(!0===o.audio||"object"===typeof o.audio&&!o.audio.deviceId)&&(o.audio={deviceId:"default"}),!0===o.video?o.video={deviceId:"default"}:"object"!==typeof o.video||o.video.deviceId||(o.video.deviceId="default");const l=zb(o,Mk,Lk),u=Wb(l),d=navigator.mediaDevices.getUserMedia(u);o.audio&&(rk.userMediaPromiseMap.set("audioinput",d),d.catch(()=>rk.userMediaPromiseMap.delete("audioinput"))),o.video&&(rk.userMediaPromiseMap.set("videoinput",d),d.catch(()=>rk.userMediaPromiseMap.delete("videoinput")));try{const e=yield d;return yield Promise.all(e.getTracks().map(n=>tv(this,void 0,void 0,function*(){const r="audio"===n.kind;let o,a=r?l.audio:l.video;"boolean"!==typeof a&&a||(a={});const c=r?u.audio:u.video;"boolean"!==typeof c&&(o=c);const d=n.getSettings().deviceId;(null===o||void 0===o?void 0:o.deviceId)&&_b(o.deviceId)!==d?o.deviceId=d:o||(o={deviceId:d});const h=function(e,t,n){switch(e.kind){case"audio":return new Yk(e,t,!1,void 0,n);case"video":return new lw(e,t,!1,n);default:throw new Oy("unsupported track type: ".concat(e.kind))}}(n,o,t);return h.kind===Hy.Kind.Video?h.source=Hy.Source.Camera:h.kind===Hy.Kind.Audio&&(h.source=Hy.Source.Microphone),h.mediaStream=e,Mb(h)&&i?yield h.setProcessor(i):Lb(h)&&s&&(yield h.setProcessor(s)),h})))}catch(r){if(!n)throw r;return jw(Object.assign(Object.assign({},e),{audio:a,video:c}),t)}})}function Dw(e){return tv(this,void 0,void 0,function*(){return(yield jw({audio:null===e||void 0===e||e,video:!1}))[0]})}var Mw;!function(e){e.Excellent="excellent",e.Good="good",e.Poor="poor",e.Lost="lost",e.Unknown="unknown"}(Mw||(Mw={}));class Lw extends ov.EventEmitter{get logContext(){var e,t;return Object.assign({},null===(t=null===(e=this.loggerOptions)||void 0===e?void 0:e.loggerContextCb)||void 0===t?void 0:t.call(e))}get isEncrypted(){return this.trackPublications.size>0&&Array.from(this.trackPublications.values()).every(e=>e.isEncrypted)}get isAgent(){var e;return(null===(e=this.permissions)||void 0===e?void 0:e.agent)||this.kind===fm.AGENT}get isActive(){var e;return(null===(e=this.participantInfo)||void 0===e?void 0:e.state)===pm.ACTIVE}get kind(){return this._kind}get attributes(){return Object.freeze(Object.assign({},this._attributes))}constructor(e,t,n,i,r,s){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:fm.STANDARD;var a;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=Mw.Unknown,this.log=Jg,this.log=Yg(null!==(a=null===s||void 0===s?void 0:s.loggerName)&&void 0!==a?a:Gg.Participant),this.loggerOptions=s,this.setMaxListeners(100),this.sid=e,this.identity=t,this.name=n,this.metadata=i,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this._kind=o,this._attributes=null!==r&&void 0!==r?r:{}}getTrackPublications(){return Array.from(this.trackPublications.values())}getTrackPublication(e){for(const[,t]of this.trackPublications)if(t.source===e)return t}getTrackPublicationByName(e){for(const[,t]of this.trackPublications)if(t.trackName===e)return t}waitUntilActive(){return this.isActive?Promise.resolve():(this.activeFuture||(this.activeFuture=new Ob,this.once(Cy.Active,()=>{var e,t;null===(t=null===(e=this.activeFuture)||void 0===e?void 0:e.resolve)||void 0===t||t.call(e),this.activeFuture=void 0})),this.activeFuture.promise)}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const t=this.getTrackPublication(Hy.Source.Camera);return!(null===(e=null===t||void 0===t?void 0:t.isMuted)||void 0===e||e)}get isMicrophoneEnabled(){var e;const t=this.getTrackPublication(Hy.Source.Microphone);return!(null===(e=null===t||void 0===t?void 0:t.isMuted)||void 0===e||e)}get isScreenShareEnabled(){return!!this.getTrackPublication(Hy.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(1e3*Number.parseInt(this.participantInfo.joinedAt.toString())):new Date}updateInfo(e){var t;return!(this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version)&&(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),this._setAttributes(e.attributes),e.state===pm.ACTIVE&&(null===(t=this.participantInfo)||void 0===t?void 0:t.state)!==pm.ACTIVE&&this.emit(Cy.Active),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,!0)}_setMetadata(e){const t=this.metadata!==e,n=this.metadata;this.metadata=e,t&&this.emit(Cy.ParticipantMetadataChanged,n)}_setName(e){const t=this.name!==e;this.name=e,t&&this.emit(Cy.ParticipantNameChanged,e)}_setAttributes(e){const t=function(e,t){var n;void 0===e&&(e={}),void 0===t&&(t={});const i=[...Object.keys(t),...Object.keys(e)],r={};for(const s of i)e[s]!==t[s]&&(r[s]=null!==(n=t[s])&&void 0!==n?n:"");return r}(this.attributes,e);this._attributes=e,Object.keys(t).length>0&&this.emit(Cy.AttributesChanged,t)}setPermissions(e){var t,n,i,r,s,o;const a=this.permissions,c=e.canPublish!==(null===(t=this.permissions)||void 0===t?void 0:t.canPublish)||e.canSubscribe!==(null===(n=this.permissions)||void 0===n?void 0:n.canSubscribe)||e.canPublishData!==(null===(i=this.permissions)||void 0===i?void 0:i.canPublishData)||e.hidden!==(null===(r=this.permissions)||void 0===r?void 0:r.hidden)||e.recorder!==(null===(s=this.permissions)||void 0===s?void 0:s.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((e,t)=>{var n;return e!==(null===(n=this.permissions)||void 0===n?void 0:n.canPublishSources[t])})||e.canSubscribeMetrics!==(null===(o=this.permissions)||void 0===o?void 0:o.canSubscribeMetrics);return this.permissions=e,c&&this.emit(Cy.ParticipantPermissionsChanged,a),c}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(Cy.IsSpeakingChanged,e))}setConnectionQuality(e){const t=this._connectionQuality;this._connectionQuality=function(e){switch(e){case im.EXCELLENT:return Mw.Excellent;case im.GOOD:return Mw.Good;case im.POOR:return Mw.Poor;case im.LOST:return Mw.Lost;default:return Mw.Unknown}}(e),t!==this._connectionQuality&&this.emit(Cy.ConnectionQualityChanged,this._connectionQuality)}setDisconnected(){var e,t;this.activeFuture&&(null===(t=(e=this.activeFuture).reject)||void 0===t||t.call(e,new Error("Participant disconnected")),this.activeFuture=void 0)}setAudioContext(e){this.audioContext=e,this.audioTrackPublications.forEach(t=>Mb(t.track)&&t.track.setAudioContext(e))}addTrackPublication(e){e.on(Ey.Muted,()=>{this.emit(Cy.TrackMuted,e)}),e.on(Ey.Unmuted,()=>{this.emit(Cy.TrackUnmuted,e)});const t=e;switch(t.track&&(t.track.sid=e.trackSid),this.trackPublications.set(e.trackSid,e),e.kind){case Hy.Kind.Audio:this.audioTrackPublications.set(e.trackSid,e);break;case Hy.Kind.Video:this.videoTrackPublications.set(e.trackSid,e)}}}class Fw extends Lw{constructor(e,t,n,i,s){super(e,t,void 0,void 0,void 0,{loggerName:i.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=gm.NONE,this.enabledPublishVideoCodecs=[],this.pendingAcks=new Map,this.pendingResponses=new Map,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new Ob)},this.handleReconnected=()=>{var e,t;null===(t=null===(e=this.reconnectFuture)||void 0===e?void 0:e.resolve)||void 0===t||t.call(e),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleClosing=()=>{var e,t,n,i,r,s;this.reconnectFuture&&(this.reconnectFuture.promise.catch(e=>this.log.warn(e.message,this.logContext)),null===(t=null===(e=this.reconnectFuture)||void 0===e?void 0:e.reject)||void 0===t||t.call(e,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0),this.signalConnectedFuture&&(null===(i=(n=this.signalConnectedFuture).reject)||void 0===i||i.call(n,"Got disconnected without signal connected"),this.signalConnectedFuture=void 0),null===(s=null===(r=this.activeAgentFuture)||void 0===r?void 0:r.reject)||void 0===s||s.call(r,"Got disconnected without active agent present"),this.activeAgentFuture=void 0,this.firstActiveAgent=void 0},this.handleSignalConnected=e=>{var t,n;e.participant&&this.updateInfo(e.participant),this.signalConnectedFuture||(this.signalConnectedFuture=new Ob),null===(n=(t=this.signalConnectedFuture).resolve)||void 0===n||n.call(t)},this.handleSignalRequestResponse=e=>{const{requestId:t,reason:n,message:i}=e,r=this.pendingSignalRequests.get(t);r&&(n!==Vg.OK&&r.reject(new jy(i,n)),this.pendingSignalRequests.delete(t))},this.handleDataPacket=e=>{switch(e.value.case){case"rpcResponse":let t=e.value.value,n=null,i=null;"payload"===t.value.case?n=t.value.value:"error"===t.value.case&&(i=qk.fromProto(t.value.value)),this.handleIncomingRpcResponse(t.requestId,n,i);break;case"rpcAck":let r=e.value.value;this.handleIncomingRpcAck(r.requestId)}},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(e=>function(e){var t,n,i;if(!e.participantSid&&!e.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new Pg({participantIdentity:null!==(t=e.participantIdentity)&&void 0!==t?t:"",participantSid:null!==(n=e.participantSid)&&void 0!==n?n:"",allTracks:null!==(i=e.allowAll)&&void 0!==i&&i,trackSids:e.allowedTrackSids||[]})}(e)))},this.onTrackUnmuted=e=>{this.onTrackMuted(e,e.isUpstreamPaused)},this.onTrackMuted=(e,t)=>{void 0===t&&(t=!0),e.sid?this.engine.updateMuteStatus(e.sid,t):this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),Zb(e)))},this.onTrackUpstreamPaused=e=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),Zb(e))),this.onTrackMuted(e,!0)},this.onTrackUpstreamResumed=e=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),Zb(e))),this.onTrackMuted(e,e.isMuted)},this.onTrackFeatureUpdate=e=>{const t=this.audioTrackPublications.get(e.sid);t?this.engine.client.sendUpdateLocalAudioTrack(t.trackSid,t.getTrackFeatures()):this.log.warn("Could not update local audio track settings, missing publication for track ".concat(e.sid),this.logContext)},this.onTrackCpuConstrained=(e,t)=>{this.log.debug("track cpu constrained",Object.assign(Object.assign({},this.logContext),Zb(t))),this.emit(Cy.LocalTrackCpuConstrained,e,t)},this.handleSubscribedQualityUpdate=e=>tv(this,void 0,void 0,function*(){var t,n,i,r,s;if(!(null===(s=this.roomOptions)||void 0===s?void 0:s.dynacast))return;const o=this.videoTrackPublications.get(e.trackSid);if(!o)return void this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:e.trackSid}));if(!o.videoTrack)return;const a=yield o.videoTrack.setPublishingCodecs(e.subscribedCodecs);try{for(var c,l=!0,u=iv(a);!(t=(c=yield u.next()).done);l=!0){r=c.value,l=!1;const e=r;Jy(e)&&(this.log.debug("publish ".concat(e," for ").concat(o.videoTrack.sid),Object.assign(Object.assign({},this.logContext),Zb(o))),yield this.publishAdditionalCodecForTrack(o.videoTrack,e,o.options))}}catch(d){n={error:d}}finally{try{l||t||!(i=u.return)||(yield i.call(u))}finally{if(n)throw n.error}}}),this.handleLocalTrackUnpublished=e=>{const t=this.trackPublications.get(e.trackSid);t?this.unpublishTrack(t.track):this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:e.trackSid}))},this.handleTrackEnded=e=>tv(this,void 0,void 0,function*(){if(e.source===Hy.Source.ScreenShare||e.source===Hy.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),Zb(e))),this.unpublishTrack(e);else if(e.isUserProvided)yield e.mute();else if(Ub(e)||Fb(e))try{if(pb())try{const t=yield null===navigator||void 0===navigator?void 0:navigator.permissions.query({name:e.source===Hy.Source.Camera?"camera":"microphone"});if(t&&"denied"===t.state)throw this.log.warn("user has revoked access to ".concat(e.source),Object.assign(Object.assign({},this.logContext),Zb(e))),t.onchange=()=>{"denied"!==t.state&&(e.isMuted||e.restartTrack(),t.onchange=null)},new Error("GetUserMedia Permission denied")}catch(r){}e.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),Zb(e))),Ub(e)?yield e.restartTrack({deviceId:"default"}):yield e.restartTrack())}catch(r){this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),Zb(e))),yield e.mute()}}),this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this.engine=n,this.roomOptions=i,this.setupEngine(n),this.activeDeviceMap=new Map([["audioinput","default"],["videoinput","default"],["audiooutput","default"]]),this.pendingSignalRequests=new Map,this.rpcHandlers=s}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==gm.NONE}getTrackPublication(e){const t=super.getTrackPublication(e);if(t)return t}getTrackPublicationByName(e){const t=super.getTrackPublicationByName(e);if(t)return t}setupEngine(e){var t;this.engine=e,this.engine.on(xy.RemoteMute,(e,t)=>{const n=this.trackPublications.get(e);n&&n.track&&(t?n.mute():n.unmute())}),(null===(t=this.signalConnectedFuture)||void 0===t?void 0:t.isResolved)&&(this.signalConnectedFuture=void 0),this.engine.on(xy.Connected,this.handleReconnected).on(xy.SignalConnected,this.handleSignalConnected).on(xy.SignalRestarted,this.handleReconnected).on(xy.SignalResumed,this.handleReconnected).on(xy.Restarting,this.handleReconnecting).on(xy.Resuming,this.handleReconnecting).on(xy.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(xy.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(xy.Closing,this.handleClosing).on(xy.SignalRequestResponse,this.handleSignalRequestResponse).on(xy.DataPacketReceived,this.handleDataPacket)}setMetadata(e){return tv(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({metadata:e})})}setName(e){return tv(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({name:e})})}setAttributes(e){return tv(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({attributes:e})})}requestMetadataUpdate(e){return tv(this,arguments,void 0,function(e){var t=this;let{metadata:n,name:i,attributes:s}=e;return function*(){return new Promise((e,o)=>tv(t,void 0,void 0,function*(){var t,a;try{let r=!1;const c=yield this.engine.client.sendUpdateLocalMetadata(null!==(t=null!==n&&void 0!==n?n:this.metadata)&&void 0!==t?t:"",null!==(a=null!==i&&void 0!==i?i:this.name)&&void 0!==a?a:"",s),l=performance.now();for(this.pendingSignalRequests.set(c,{resolve:e,reject:e=>{o(e),r=!0},values:{name:i,metadata:n,attributes:s}});performance.now()-l<5e3&&!r;){if((!i||this.name===i)&&(!n||this.metadata===n)&&(!s||Object.entries(s).every(e=>{let[t,n]=e;return this.attributes[t]===n||""===n&&!this.attributes[t]})))return this.pendingSignalRequests.delete(c),void e();yield ib(50)}o(new jy("Request to update local metadata timed out","TimeoutError"))}catch(r){r instanceof Error&&o(r)}}))}()})}setCameraEnabled(e,t,n){return this.setTrackEnabled(Hy.Source.Camera,e,t,n)}setMicrophoneEnabled(e,t,n){return this.setTrackEnabled(Hy.Source.Microphone,e,t,n)}setScreenShareEnabled(e,t,n){return this.setTrackEnabled(Hy.Source.ScreenShare,e,t,n)}setPermissions(e){const t=this.permissions,n=super.setPermissions(e);return n&&t&&this.emit(Cy.ParticipantPermissionsChanged,t),n}setE2EEEnabled(e){return tv(this,void 0,void 0,function*(){this.encryptionType=e?gm.GCM:gm.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,t,n,i){return tv(this,void 0,void 0,function*(){var s,o;this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:t})),this.republishPromise&&(yield this.republishPromise);let a=this.getTrackPublication(e);if(t)if(a)yield a.unmute();else{let t;if(this.pendingPublishing.has(e)){const t=yield this.waitForPendingPublicationOfSource(e);return t||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e})),yield null===t||void 0===t?void 0:t.unmute(),t}this.pendingPublishing.add(e);try{switch(e){case Hy.Source.Camera:t=yield this.createTracks({video:null===(s=n)||void 0===s||s});break;case Hy.Source.Microphone:t=yield this.createTracks({audio:null===(o=n)||void 0===o||o});break;case Hy.Source.ScreenShare:t=yield this.createScreenTracks(Object.assign({},n));break;default:throw new Oy(e)}}catch(r){throw null===t||void 0===t||t.forEach(e=>{e.stop()}),r instanceof Error&&this.emit(Cy.MediaDevicesError,r,Qb(e)),this.pendingPublishing.delete(e),r}for(const i of t){const t=Object.assign(Object.assign({},this.roomOptions.publishDefaults),n);e===Hy.Source.Microphone&&Mb(i)&&t.preConnectBuffer&&(this.log.info("starting preconnect buffer for microphone",Object.assign({},this.logContext)),i.startPreConnectBuffer())}try{const e=[];for(const r of t)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),Zb(r))),e.push(this.publishTrack(r,i));const n=yield Promise.all(e);[a]=n}catch(r){throw null===t||void 0===t||t.forEach(e=>{e.stop()}),r}finally{this.pendingPublishing.delete(e)}}else if(!(null===a||void 0===a?void 0:a.track)&&this.pendingPublishing.has(e)&&(a=yield this.waitForPendingPublicationOfSource(e),a||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e}))),a&&a.track)if(e===Hy.Source.ScreenShare){a=yield this.unpublishTrack(a.track);const e=this.getTrackPublication(Hy.Source.ScreenShareAudio);e&&e.track&&this.unpublishTrack(e.track)}else yield a.mute();return a})}enableCameraAndMicrophone(){return tv(this,void 0,void 0,function*(){if(!this.pendingPublishing.has(Hy.Source.Camera)&&!this.pendingPublishing.has(Hy.Source.Microphone)){this.pendingPublishing.add(Hy.Source.Camera),this.pendingPublishing.add(Hy.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(e=>this.publishTrack(e)))}finally{this.pendingPublishing.delete(Hy.Source.Camera),this.pendingPublishing.delete(Hy.Source.Microphone)}}})}createTracks(e){return tv(this,void 0,void 0,function*(){var t,n;null!==e&&void 0!==e||(e={});const i=zb(e,null===(t=this.roomOptions)||void 0===t?void 0:t.audioCaptureDefaults,null===(n=this.roomOptions)||void 0===n?void 0:n.videoCaptureDefaults);try{const e=yield jw(i,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});return e.map(e=>(Mb(e)&&(this.microphoneError=void 0,e.setAudioContext(this.audioContext),e.source=Hy.Source.Microphone,this.emit(Cy.AudioStreamAcquired)),Lb(e)&&(this.cameraError=void 0,e.source=Hy.Source.Camera),e))}catch(r){throw r instanceof Error&&(e.audio&&(this.microphoneError=r),e.video&&(this.cameraError=r)),r}})}createScreenTracks(e){return tv(this,void 0,void 0,function*(){if(void 0===e&&(e={}),void 0===navigator.mediaDevices.getDisplayMedia)throw new Ry("getDisplayMedia not supported");void 0!==e.resolution||db()||(e.resolution=tb.h1080fps30.resolution);const t=Jb(e),n=yield navigator.mediaDevices.getDisplayMedia(t),i=n.getVideoTracks();if(0===i.length)throw new Oy("no video track found");const r=new lw(i[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});r.source=Hy.Source.ScreenShare,e.contentHint&&(r.mediaStreamTrack.contentHint=e.contentHint);const s=[r];if(n.getAudioTracks().length>0){this.emit(Cy.AudioStreamAcquired);const e=new Yk(n.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});e.source=Hy.Source.ScreenShareAudio,s.push(e)}return s})}publishTrack(e,t){return tv(this,void 0,void 0,function*(){return this.publishOrRepublishTrack(e,t)})}publishOrRepublishTrack(e,t){return tv(this,arguments,void 0,function(e,t){var n=this;let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function*(){var s,o,a,c;let l,u;if(Ub(e)&&e.setAudioContext(n.audioContext),yield null===(s=n.reconnectFuture)||void 0===s?void 0:s.promise,n.republishPromise&&!i&&(yield n.republishPromise),Db(e)&&n.pendingPublishPromises.has(e)&&(yield n.pendingPublishPromises.get(e)),e instanceof MediaStreamTrack)l=e.getConstraints();else{let t;switch(l=e.constraints,e.source){case Hy.Source.Microphone:t="audioinput";break;case Hy.Source.Camera:t="videoinput"}t&&n.activeDeviceMap.has(t)&&(l=Object.assign(Object.assign({},l),{deviceId:n.activeDeviceMap.get(t)}))}if(e instanceof MediaStreamTrack)switch(e.kind){case"audio":e=new Yk(e,l,!0,n.audioContext,{loggerName:n.roomOptions.loggerName,loggerContextCb:()=>n.logContext});break;case"video":e=new lw(e,l,!0,{loggerName:n.roomOptions.loggerName,loggerContextCb:()=>n.logContext});break;default:throw new Oy("unsupported MediaStreamTrack kind ".concat(e.kind))}else e.updateLoggerOptions({loggerName:n.roomOptions.loggerName,loggerContextCb:()=>n.logContext});if(n.trackPublications.forEach(t=>{t.track&&t.track===e&&(u=t)}),u)return n.log.warn("track has already been published, skipping",Object.assign(Object.assign({},n.logContext),Zb(u))),u;const d="channelCount"in e.mediaStreamTrack.getSettings()&&2===e.mediaStreamTrack.getSettings().channelCount||2===e.mediaStreamTrack.getConstraints().channelCount,h=null!==(o=null===t||void 0===t?void 0:t.forceStereo)&&void 0!==o?o:d;h&&(t||(t={}),void 0===t.dtx&&n.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},n.logContext),Zb(e))),void 0===t.red&&n.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),null!==(a=t.dtx)&&void 0!==a||(t.dtx=!1),null!==(c=t.red)&&void 0!==c||(t.red=!1));const p=Object.assign(Object.assign({},n.roomOptions.publishDefaults),t);!function(){const e=Ly(),t="17.2";if(e)return"Safari"!==e.name&&"iOS"!==e.os||!!("iOS"===e.os&&e.osVersion&&bb(t,e.osVersion)>=0)||"Safari"===e.name&&bb(t,e.version)>=0}()&&n.roomOptions.e2ee&&(n.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari versions and iOS browsers running iOS < v17.2",Object.assign({},n.logContext)),p.simulcast=!1),p.source&&(e.source=p.source);const f=new Promise((t,i)=>tv(n,void 0,void 0,function*(){try{if(this.engine.client.currentState!==lk.CONNECTED){this.log.debug("deferring track publication until signal is connected",Object.assign(Object.assign({},this.logContext),{track:Zb(e)}));const n=setTimeout(()=>{i(new Iy("publishing rejected as engine not connected within timeout",408))},15e3);yield this.waitUntilEngineConnected(),clearTimeout(n);const r=yield this.publish(e,p,h);t(r)}else try{const n=yield this.publish(e,p,h);t(n)}catch(r){i(r)}}catch(r){i(r)}}));n.pendingPublishPromises.set(e,f);try{return yield f}catch(r){throw r}finally{n.pendingPublishPromises.delete(e)}}()})}waitUntilEngineConnected(){return this.signalConnectedFuture||(this.signalConnectedFuture=new Ob),this.signalConnectedFuture.promise}hasPermissionsToPublish(e){if(!this.permissions)return this.log.warn("no permissions present for publishing track",Object.assign(Object.assign({},this.logContext),Zb(e))),!1;const{canPublish:t,canPublishSources:n}=this.permissions;return!(!t||0!==n.length&&!n.map(e=>function(e){switch(e){case tm.CAMERA:return Hy.Source.Camera;case tm.MICROPHONE:return Hy.Source.Microphone;case tm.SCREEN_SHARE:return Hy.Source.ScreenShare;case tm.SCREEN_SHARE_AUDIO:return Hy.Source.ScreenShareAudio;default:return Hy.Source.Unknown}}(e)).includes(e.source))||(this.log.warn("insufficient permissions to publish",Object.assign(Object.assign({},this.logContext),Zb(e))),!1)}publish(e,t,n){return tv(this,void 0,void 0,function*(){var i,s,o,a,c,l,u,d,h,p;if(!this.hasPermissionsToPublish(e))throw new Iy("failed to publish track, insufficient permissions",403);Array.from(this.trackPublications.values()).find(t=>Db(e)&&t.source===e.source)&&e.source!==Hy.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),Zb(e))),t.stopMicTrackOnMute&&Mb(e)&&(e.stopOnMute=!0),e.source===Hy.Source.ScreenShare&&cb()&&(t.simulcast=!1),"av1"!==t.videoCodec||function(){if(!("getCapabilities"in RTCRtpSender))return!1;if(lb())return!1;const e=RTCRtpSender.getCapabilities("video");let t=!1;if(e)for(const n of e.codecs)if("video/AV1"===n.mimeType){t=!0;break}return t}()||(t.videoCodec=void 0),"vp9"!==t.videoCodec||function(){if(!("getCapabilities"in RTCRtpSender))return!1;if(cb())return!1;if(lb()){const e=Ly();if((null===e||void 0===e?void 0:e.version)&&bb(e.version,"16")<0)return!1;if("iOS"===(null===e||void 0===e?void 0:e.os)&&(null===e||void 0===e?void 0:e.osVersion)&&bb(e.osVersion,"16")<0)return!1}const e=RTCRtpSender.getCapabilities("video");let t=!1;if(e)for(const n of e.codecs)if("video/VP9"===n.mimeType){t=!0;break}return t}()||(t.videoCodec=void 0),void 0===t.videoCodec&&(t.videoCodec=jk),this.enabledPublishVideoCodecs.length>0&&(this.enabledPublishVideoCodecs.some(e=>t.videoCodec===Yb(e.mime))||(t.videoCodec=Yb(this.enabledPublishVideoCodecs[0].mime)));const f=t.videoCodec;e.on(Ey.Muted,this.onTrackMuted),e.on(Ey.Unmuted,this.onTrackUnmuted),e.on(Ey.Ended,this.handleTrackEnded),e.on(Ey.UpstreamPaused,this.onTrackUpstreamPaused),e.on(Ey.UpstreamResumed,this.onTrackUpstreamResumed),e.on(Ey.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate);const m=[],g=!(null===(i=t.dtx)||void 0===i||i),v=e.getSourceTrackSettings();v.autoGainControl&&m.push(cm.TF_AUTO_GAIN_CONTROL),v.echoCancellation&&m.push(cm.TF_ECHO_CANCELLATION),v.noiseSuppression&&m.push(cm.TF_NOISE_SUPPRESSION),v.channelCount&&v.channelCount>1&&m.push(cm.TF_STEREO),g&&m.push(cm.TF_NO_DTX),Ub(e)&&e.hasPreConnectBuffer&&m.push(cm.TF_PRECONNECT_BUFFER);const y=new eg({cid:e.mediaStreamTrack.id,name:t.name,type:Hy.kindToProto(e.kind),muted:e.isMuted,source:Hy.sourceToProto(e.source),disableDtx:g,encryption:this.encryptionType,stereo:n,disableRed:this.isE2EEEnabled||!(null===(s=t.red)||void 0===s||s),stream:null===t||void 0===t?void 0:t.stream,backupCodecPolicy:null===t||void 0===t?void 0:t.backupCodecPolicy,audioFeatures:m});let b;if(e.kind===Hy.Kind.Video){let n={width:0,height:0};try{n=yield e.waitForDimensions()}catch(r){const i=null!==(a=null===(o=this.roomOptions.videoCaptureDefaults)||void 0===o?void 0:o.resolution)&&void 0!==a?a:Zy.h720.resolution;n={width:i.width,height:i.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),Zb(e)),{dims:n}))}y.width=n.width,y.height=n.height,Fb(e)&&(ob(f)&&(e.source===Hy.Source.ScreenShare&&(t.scalabilityMode="L1T3","contentHint"in e.mediaStreamTrack&&(e.mediaStreamTrack.contentHint="motion",this.log.info("forcing contentHint to motion for screenshare with SVC codecs",Object.assign(Object.assign({},this.logContext),Zb(e))))),t.scalabilityMode=null!==(c=t.scalabilityMode)&&void 0!==c?c:"L3T3_KEY"),y.simulcastCodecs=[new Zm({codec:f,cid:e.mediaStreamTrack.id})],!0===t.backupCodec&&(t.backupCodec={codec:jk}),t.backupCodec&&f!==t.backupCodec.codec&&y.encryption===gm.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),y.simulcastCodecs.push(new Zm({codec:t.backupCodec.codec,cid:""})))),b=rw(e.source===Hy.Source.ScreenShare,y.width,y.height,t),y.layers=hw(y.width,y.height,b,ob(t.videoCodec))}else e.kind===Hy.Kind.Audio&&(b=[{maxBitrate:null===(l=t.audioPreset)||void 0===l?void 0:l.maxBitrate,priority:null!==(d=null===(u=t.audioPreset)||void 0===u?void 0:u.priority)&&void 0!==d?d:"high",networkPriority:null!==(p=null===(h=t.audioPreset)||void 0===h?void 0:h.priority)&&void 0!==p?p:"high"}]);if(!this.engine||this.engine.isClosed)throw new Ny("cannot publish track when not connected");const k=()=>tv(this,void 0,void 0,function*(){var n,i,r;if(!this.engine.pcManager)throw new Ny("pcManager is not ready");if(e.sender=yield this.engine.createSender(e,t,b),this.emit(Cy.LocalSenderCreated,e.sender,e),Fb(e)&&(null!==(n=t.degradationPreference)&&void 0!==n||(t.degradationPreference=function(e){return e.source===Hy.Source.ScreenShare||e.constraints.height&&_b(e.constraints.height)>=1080?"maintain-resolution":"balanced"}(e)),e.setDegradationPreference(t.degradationPreference)),b)if(cb()&&e.kind===Hy.Kind.Audio){let t;for(const n of this.engine.pcManager.publisher.getTransceivers())if(n.sender===e.sender){t=n;break}t&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:t,codec:"opus",maxbr:(null===(i=b[0])||void 0===i?void 0:i.maxBitrate)?b[0].maxBitrate/1e3:0})}else e.codec&&ob(e.codec)&&(null===(r=b[0])||void 0===r?void 0:r.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:y.cid,codec:e.codec,maxbr:b[0].maxBitrate/1e3});yield this.engine.negotiate()});let w;const S=new Promise((t,n)=>tv(this,void 0,void 0,function*(){var i;try{w=yield this.engine.addTrack(y),t(w)}catch(r){e.sender&&(null===(i=this.engine.pcManager)||void 0===i?void 0:i.publisher)&&(this.engine.pcManager.publisher.removeTrack(e.sender),yield this.engine.negotiate().catch(t=>{this.log.error("failed to negotiate after removing track due to failed add track request",Object.assign(Object.assign(Object.assign({},this.logContext),Zb(e)),{error:t}))})),n(r)}}));if(this.enabledPublishVideoCodecs.length>0){const e=yield Promise.all([S,k()]);w=e[0]}else{let n;if(w=yield S,w.codecs.forEach(e=>{void 0===n&&(n=e.mimeType)}),n&&e.kind===Hy.Kind.Video){const i=Yb(n);i!==f&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),Zb(e)),{codec:i})),t.videoCodec=i,b=rw(e.source===Hy.Source.ScreenShare,y.width,y.height,t))}yield k()}const T=new Iw(e.kind,w,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(T.on(Ey.CpuConstrained,e=>this.onTrackCpuConstrained(e,T)),T.options=t,e.sid=w.sid,this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:b,trackInfo:w})),Fb(e)?e.startMonitor(this.engine.client):Ub(e)&&e.startMonitor(),this.addTrackPublication(T),this.emit(Cy.LocalTrackPublished,T),Ub(e)&&w.audioFeatures.includes(cm.TF_PRECONNECT_BUFFER)){const t=e.getPreConnectBuffer(),n=e.getPreConnectBufferMimeType();if(this.on(Cy.LocalTrackSubscribed,t=>{if(t.trackSid===w.sid){if(!e.hasPreConnectBuffer)return void this.log.warn("subscribe event came to late, buffer already closed",this.logContext);this.log.debug("finished recording preconnect buffer",Object.assign(Object.assign({},this.logContext),Zb(e))),e.stopPreConnectBuffer()}}),t){const i=new Promise((i,s)=>tv(this,void 0,void 0,function*(){var o,a,c,l,u,d;try{this.log.debug("waiting for agent",Object.assign(Object.assign({},this.logContext),Zb(e)));const r=setTimeout(()=>{s(new Error("agent not active within 10 seconds"))},1e4),g=yield this.waitUntilActiveAgentPresent();clearTimeout(r),this.log.debug("sending preconnect buffer",Object.assign(Object.assign({},this.logContext),Zb(e)));const y=yield this.streamBytes({name:"preconnect-buffer",mimeType:n,topic:"lk.agent.pre-connect-audio-buffer",destinationIdentities:[g.identity],attributes:{trackId:T.trackSid,sampleRate:String(null!==(u=v.sampleRate)&&void 0!==u?u:"48000"),channels:String(null!==(d=v.channelCount)&&void 0!==d?d:"1")}});try{for(var h,p=!0,f=iv(t);!(o=(h=yield f.next()).done);p=!0){l=h.value,p=!1;const e=l;yield y.write(e)}}catch(m){a={error:m}}finally{try{p||o||!(c=f.return)||(yield c.call(f))}finally{if(a)throw a.error}}yield y.close(),i()}catch(r){s(r)}}));i.then(()=>{this.log.debug("preconnect buffer sent successfully",Object.assign(Object.assign({},this.logContext),Zb(e)))}).catch(t=>{this.log.error("error sending preconnect buffer",Object.assign(Object.assign(Object.assign({},this.logContext),Zb(e)),{error:t}))})}}return T})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,t,n){return tv(this,void 0,void 0,function*(){var i;if(this.encryptionType!==gm.NONE)return;let r;if(this.trackPublications.forEach(t=>{t.track&&t.track===e&&(r=t)}),!r)throw new Oy("track is not published");if(!Fb(e))throw new Oy("track is not a video track");const s=Object.assign(Object.assign({},null===(i=this.roomOptions)||void 0===i?void 0:i.publishDefaults),n),o=function(e,t,n){var i,r,s,o;if(!n.backupCodec||!0===n.backupCodec||n.backupCodec.codec===n.videoCodec)return;t!==n.backupCodec.codec&&Jg.warn("requested a different codec than specified as backup",{serverRequested:t,backup:n.backupCodec.codec}),n.videoCodec=t,n.videoEncoding=n.backupCodec.encoding;const a=e.mediaStreamTrack.getSettings(),c=null!==(i=a.width)&&void 0!==i?i:null===(r=e.dimensions)||void 0===r?void 0:r.width,l=null!==(s=a.height)&&void 0!==s?s:null===(o=e.dimensions)||void 0===o?void 0:o.height;return e.source===Hy.Source.ScreenShare&&n.simulcast&&(n.simulcast=!1),rw(e.source===Hy.Source.ScreenShare,c,l,n)}(e,t,s);if(!o)return void this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),Zb(e)));const a=e.addSimulcastTrack(t,o);if(!a)return;const c=new eg({cid:a.mediaStreamTrack.id,type:Hy.kindToProto(e.kind),muted:e.isMuted,source:Hy.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:s.videoCodec,cid:a.mediaStreamTrack.id}]});if(c.layers=hw(c.width,c.height,o),!this.engine||this.engine.isClosed)throw new Ny("cannot publish track when not connected");const l=(yield Promise.all([this.engine.addTrack(c),(()=>tv(this,void 0,void 0,function*(){yield this.engine.createSimulcastSender(e,a,s,o),yield this.engine.negotiate()}))()]))[0];this.log.debug("published ".concat(t," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:o,trackInfo:l}))})}unpublishTrack(e,t){return tv(this,void 0,void 0,function*(){var n,i;if(Db(e)){const t=this.pendingPublishPromises.get(e);t&&(this.log.info("awaiting publish promise before attempting to unpublish",Object.assign(Object.assign({},this.logContext),Zb(e))),yield t)}const s=this.getPublicationForTrack(e),o=s?Zb(s):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),o)),!s||!s.track)return void this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),o));(e=s.track).off(Ey.Muted,this.onTrackMuted),e.off(Ey.Unmuted,this.onTrackUnmuted),e.off(Ey.Ended,this.handleTrackEnded),e.off(Ey.UpstreamPaused,this.onTrackUpstreamPaused),e.off(Ey.UpstreamResumed,this.onTrackUpstreamResumed),e.off(Ey.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate),void 0===t&&(t=null===(i=null===(n=this.roomOptions)||void 0===n?void 0:n.stopLocalTrackOnUnpublish)||void 0===i||i),t?e.stop():e.stopMonitor();let a=!1;const c=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<Bk.FAILED&&c)try{for(const e of this.engine.pcManager.publisher.getTransceivers())e.sender===c&&(e.direction="inactive",a=!0);if(this.engine.removeTrack(c)&&(a=!0),Fb(e)){for(const[,t]of e.simulcastCodecs)t.sender&&(this.engine.removeTrack(t.sender)&&(a=!0),t.sender=void 0);e.simulcastCodecs.clear()}}catch(r){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),o),{error:r}))}switch(this.trackPublications.delete(s.trackSid),s.kind){case Hy.Kind.Audio:this.audioTrackPublications.delete(s.trackSid);break;case Hy.Kind.Video:this.videoTrackPublications.delete(s.trackSid)}return this.emit(Cy.LocalTrackUnpublished,s),s.setTrack(void 0),a&&(yield this.engine.negotiate()),s})}unpublishTracks(e){return tv(this,void 0,void 0,function*(){return(yield Promise.all(e.map(e=>this.unpublishTrack(e)))).filter(e=>!!e)})}republishAllTracks(e){return tv(this,arguments,void 0,function(e){var t=this;let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function*(){t.republishPromise&&(yield t.republishPromise),t.republishPromise=new Promise((i,r)=>tv(t,void 0,void 0,function*(){try{const t=[];this.trackPublications.forEach(n=>{n.track&&(e&&(n.options=Object.assign(Object.assign({},n.options),e)),t.push(n))}),yield Promise.all(t.map(e=>tv(this,void 0,void 0,function*(){const t=e.track;yield this.unpublishTrack(t,!1),!n||t.isMuted||t.source===Hy.Source.ScreenShare||t.source===Hy.Source.ScreenShareAudio||!Ub(t)&&!Fb(t)||t.isUserProvided||(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:e.trackSid})),yield t.restartTrack()),yield this.publishOrRepublishTrack(t,e.options,!0)}))),i()}catch(t){r(t)}finally{this.republishPromise=void 0}})),yield t.republishPromise}()})}publishData(e){return tv(this,arguments,void 0,function(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){const i=n.reliable?wm.RELIABLE:wm.LOSSY,r=n.destinationIdentities,s=n.topic,o=new km({kind:i,value:{case:"user",value:new Cm({participantIdentity:t.identity,payload:e,destinationIdentities:r,topic:s})}});yield t.engine.sendDataPacket(o,i)}()})}publishDtmf(e,t){return tv(this,void 0,void 0,function*(){const n=new km({kind:wm.RELIABLE,value:{case:"sipDtmf",value:new xm({code:e,digit:t})}});yield this.engine.sendDataPacket(n,wm.RELIABLE)})}sendChatMessage(e,t){return tv(this,void 0,void 0,function*(){const n={id:crypto.randomUUID(),message:e,timestamp:Date.now(),attachedFiles:null===t||void 0===t?void 0:t.attachments},i=new km({value:{case:"chatMessage",value:new Rm(Object.assign(Object.assign({},n),{timestamp:Mp.parse(n.timestamp)}))}});return yield this.engine.sendDataPacket(i,wm.RELIABLE),this.emit(Cy.ChatMessage,n),n})}editChatMessage(e,t){return tv(this,void 0,void 0,function*(){const n=Object.assign(Object.assign({},t),{message:e,editTimestamp:Date.now()}),i=new km({value:{case:"chatMessage",value:new Rm(Object.assign(Object.assign({},n),{timestamp:Mp.parse(n.timestamp),editTimestamp:Mp.parse(n.editTimestamp)}))}});return yield this.engine.sendDataPacket(i,wm.RELIABLE),this.emit(Cy.ChatMessage,n),n})}sendText(e,t){return tv(this,void 0,void 0,function*(){var n;const i=crypto.randomUUID(),r=(new TextEncoder).encode(e).byteLength,s=null===(n=null===t||void 0===t?void 0:t.attachments)||void 0===n?void 0:n.map(()=>crypto.randomUUID()),o=new Array(s?s.length+1:1).fill(0),a=(e,n)=>{var i;o[n]=e;const r=o.reduce((e,t)=>e+t,0);null===(i=null===t||void 0===t?void 0:t.onProgress)||void 0===i||i.call(t,r)},c=yield this.streamText({streamId:i,totalSize:r,destinationIdentities:null===t||void 0===t?void 0:t.destinationIdentities,topic:null===t||void 0===t?void 0:t.topic,attachedStreamIds:s,attributes:null===t||void 0===t?void 0:t.attributes});return yield c.write(e),a(1,0),yield c.close(),(null===t||void 0===t?void 0:t.attachments)&&s&&(yield Promise.all(t.attachments.map((e,n)=>tv(this,void 0,void 0,function*(){return this._sendFile(s[n],e,{topic:t.topic,mimeType:e.type,onProgress:e=>{a(e,n+1)}})})))),c.info})}streamText(e){return tv(this,void 0,void 0,function*(){var t,n;const i=null!==(t=null===e||void 0===e?void 0:e.streamId)&&void 0!==t?t:crypto.randomUUID(),r={id:i,mimeType:"text/plain",timestamp:Date.now(),topic:null!==(n=null===e||void 0===e?void 0:e.topic)&&void 0!==n?n:"",size:null===e||void 0===e?void 0:e.totalSize,attributes:null===e||void 0===e?void 0:e.attributes},s=new Wm({streamId:i,mimeType:r.mimeType,topic:r.topic,timestamp:jb(r.timestamp),totalLength:jb(null===e||void 0===e?void 0:e.totalSize),attributes:r.attributes,contentHeader:{case:"textHeader",value:new zm({version:null===e||void 0===e?void 0:e.version,attachedStreamIds:null===e||void 0===e?void 0:e.attachedStreamIds,replyToStreamId:null===e||void 0===e?void 0:e.replyToStreamId,operationType:"update"===(null===e||void 0===e?void 0:e.type)?qm.UPDATE:qm.CREATE})}}),o=null===e||void 0===e?void 0:e.destinationIdentities,a=new km({destinationIdentities:o,value:{case:"streamHeader",value:s}});yield this.engine.sendDataPacket(a,wm.RELIABLE);let c=0;const l=this,u=new WritableStream({write(e){return tv(this,void 0,void 0,function*(){for(const t of function(e,t){const n=[];let i=(new TextEncoder).encode(e);for(;i.length>t;){let e=t;for(;e>0;){const t=i[e];if(void 0!==t&&128!==(192&t))break;e--}n.push(i.slice(0,e)),i=i.slice(e)}return i.length>0&&n.push(i),n}(e,15e3)){yield l.engine.waitForBufferStatusLow(wm.RELIABLE);const e=new Km({content:t,streamId:i,chunkIndex:jb(c)}),n=new km({destinationIdentities:o,value:{case:"streamChunk",value:e}});yield l.engine.sendDataPacket(n,wm.RELIABLE),c+=1}})},close(){return tv(this,void 0,void 0,function*(){const e=new $m({streamId:i}),t=new km({destinationIdentities:o,value:{case:"streamTrailer",value:e}});yield l.engine.sendDataPacket(t,wm.RELIABLE)})},abort(e){console.log("Sink error:",e)}});let d=()=>tv(this,void 0,void 0,function*(){yield h.close()});l.engine.once(xy.Closing,d);const h=new Cw(u,r,()=>this.engine.off(xy.Closing,d));return h})}sendFile(e,t){return tv(this,void 0,void 0,function*(){const n=crypto.randomUUID();return yield this._sendFile(n,e,t),{id:n}})}_sendFile(e,t,n){return tv(this,void 0,void 0,function*(){var i;const r=yield this.streamBytes({streamId:e,totalSize:t.size,name:t.name,mimeType:null!==(i=null===n||void 0===n?void 0:n.mimeType)&&void 0!==i?i:t.type,topic:null===n||void 0===n?void 0:n.topic,destinationIdentities:null===n||void 0===n?void 0:n.destinationIdentities}),s=t.stream().getReader();for(;;){const{done:e,value:t}=yield s.read();if(e)break;yield r.write(t)}return yield r.close(),r.info})}streamBytes(e){return tv(this,void 0,void 0,function*(){var t,n,i,r,s;const o=null!==(t=null===e||void 0===e?void 0:e.streamId)&&void 0!==t?t:crypto.randomUUID(),a=null===e||void 0===e?void 0:e.destinationIdentities,c={id:o,mimeType:null!==(n=null===e||void 0===e?void 0:e.mimeType)&&void 0!==n?n:"application/octet-stream",topic:null!==(i=null===e||void 0===e?void 0:e.topic)&&void 0!==i?i:"",timestamp:Date.now(),attributes:null===e||void 0===e?void 0:e.attributes,size:null===e||void 0===e?void 0:e.totalSize,name:null!==(r=null===e||void 0===e?void 0:e.name)&&void 0!==r?r:"unknown"},l=new Wm({totalLength:jb(null!==(s=c.size)&&void 0!==s?s:0),mimeType:c.mimeType,streamId:o,topic:c.topic,timestamp:jb(Date.now()),attributes:c.attributes,contentHeader:{case:"byteHeader",value:new Hm({name:c.name})}}),u=new km({destinationIdentities:a,value:{case:"streamHeader",value:l}});yield this.engine.sendDataPacket(u,wm.RELIABLE);let d=0;const h=new fp,p=this.engine,f=this.log,m=new WritableStream({write(e){return tv(this,void 0,void 0,function*(){const t=yield h.lock();let n=0;try{for(;n<e.byteLength;){const t=e.slice(n,n+15e3);yield p.waitForBufferStatusLow(wm.RELIABLE);const i=new km({destinationIdentities:a,value:{case:"streamChunk",value:new Km({content:t,streamId:o,chunkIndex:jb(d)})}});yield p.sendDataPacket(i,wm.RELIABLE),d+=1,n+=t.byteLength}}finally{t()}})},close(){return tv(this,void 0,void 0,function*(){const e=new $m({streamId:o}),t=new km({destinationIdentities:a,value:{case:"streamTrailer",value:e}});yield p.sendDataPacket(t,wm.RELIABLE)})},abort(e){f.error("Sink error:",e)}});return new xw(m,c)})}performRpc(e){return tv(this,arguments,void 0,function(e){var t=this;let{destinationIdentity:n,method:i,payload:r,responseTimeout:s=1e4}=e;return function*(){return new Promise((e,o)=>tv(t,void 0,void 0,function*(){var t,a,c,l;if(zk(r)>15360)return void o(qk.builtIn("REQUEST_PAYLOAD_TOO_LARGE"));if((null===(a=null===(t=this.engine.latestJoinResponse)||void 0===t?void 0:t.serverInfo)||void 0===a?void 0:a.version)&&bb(null===(l=null===(c=this.engine.latestJoinResponse)||void 0===c?void 0:c.serverInfo)||void 0===l?void 0:l.version,"1.8.0")<0)return void o(qk.builtIn("UNSUPPORTED_SERVER"));const u=crypto.randomUUID();yield this.publishRpcRequest(n,u,i,r,s-2e3);const d=setTimeout(()=>{this.pendingAcks.delete(u),o(qk.builtIn("CONNECTION_TIMEOUT")),this.pendingResponses.delete(u),clearTimeout(h)},2e3);this.pendingAcks.set(u,{resolve:()=>{clearTimeout(d)},participantIdentity:n});const h=setTimeout(()=>{this.pendingResponses.delete(u),o(qk.builtIn("RESPONSE_TIMEOUT"))},s);this.pendingResponses.set(u,{resolve:(t,n)=>{clearTimeout(h),this.pendingAcks.has(u)&&(console.warn("RPC response received before ack",u),this.pendingAcks.delete(u),clearTimeout(d)),n?o(n):e(null!==t&&void 0!==t?t:"")},participantIdentity:n})}))}()})}registerRpcMethod(e,t){this.rpcHandlers.has(e)&&this.log.warn("you're overriding the RPC handler for method ".concat(e,", in the future this will throw an error")),this.rpcHandlers.set(e,t)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setTrackSubscriptionPermissions(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.participantTrackPermissions=t,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}handleIncomingRpcAck(e){const t=this.pendingAcks.get(e);t?(t.resolve(),this.pendingAcks.delete(e)):console.error("Ack received for unexpected RPC request",e)}handleIncomingRpcResponse(e,t,n){const i=this.pendingResponses.get(e);i?(i.resolve(t,n),this.pendingResponses.delete(e)):console.error("Response received for unexpected RPC request",e)}publishRpcRequest(e,t,n,i,r){return tv(this,void 0,void 0,function*(){const s=new km({destinationIdentities:[e],kind:wm.RELIABLE,value:{case:"rpcRequest",value:new Om({id:t,method:n,payload:i,responseTimeoutMs:r,version:1})}});yield this.engine.sendDataPacket(s,wm.RELIABLE)})}handleParticipantDisconnected(e){for(const[t,{participantIdentity:n}]of this.pendingAcks)n===e&&this.pendingAcks.delete(t);for(const[t,{participantIdentity:n,resolve:i}]of this.pendingResponses)n===e&&(i(null,qk.builtIn("RECIPIENT_DISCONNECTED")),this.pendingResponses.delete(t))}setEnabledPublishCodecs(e){this.enabledPublishVideoCodecs=e.filter(e=>"video"===e.mime.split("/")[0].toLowerCase())}updateInfo(e){return!!super.updateInfo(e)&&(e.tracks.forEach(e=>{var t,n;const i=this.trackPublications.get(e.sid);if(i){const r=i.isMuted||null!==(n=null===(t=i.track)||void 0===t?void 0:t.isUpstreamPaused)&&void 0!==n&&n;r!==e.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),Zb(i)),{mutedOnServer:r})),this.engine.client.sendMuteTrack(e.sid,r))}}),!0)}setActiveAgent(e){var t,n,i,r;this.firstActiveAgent=e,e&&!this.firstActiveAgent&&(this.firstActiveAgent=e),e?null===(n=null===(t=this.activeAgentFuture)||void 0===t?void 0:t.resolve)||void 0===n||n.call(t,e):null===(r=null===(i=this.activeAgentFuture)||void 0===i?void 0:i.reject)||void 0===r||r.call(i,"Agent disconnected"),this.activeAgentFuture=void 0}waitUntilActiveAgentPresent(){return this.firstActiveAgent?Promise.resolve(this.firstActiveAgent):(this.activeAgentFuture||(this.activeAgentFuture=new Ob),this.activeAgentFuture.promise)}getPublicationForTrack(e){let t;return this.trackPublications.forEach(n=>{const i=n.track;i&&(e instanceof MediaStreamTrack?(Ub(i)||Fb(i))&&i.mediaStreamTrack===e&&(t=n):e===i&&(t=n))}),t}waitForPendingPublicationOfSource(e){return tv(this,void 0,void 0,function*(){const t=Date.now();for(;Date.now()<t+1e4;){const t=Array.from(this.pendingPublishPromises.entries()).find(t=>{let[n]=t;return n.source===e});if(t)return t[1];yield ib(20)}})}}class Uw extends Aw{constructor(e,t,n,i){super(e,t.sid,t.name,i),this.track=void 0,this.allowed=!0,this.requestedDisabled=void 0,this.visible=!0,this.handleEnded=e=>{this.setTrack(void 0),this.emit(Ey.Ended,e)},this.handleVisibilityChange=e=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(e),this.logContext),this.visible=e,this.emitTrackUpdate()},this.handleVideoDimensionsChange=e=>{this.log.debug("adaptivestream video dimensions ".concat(e.width,"x").concat(e.height),this.logContext),this.videoDimensionsAdaptiveStream=e,this.emitTrackUpdate()},this.subscribed=n,this.updateInfo(t)}setSubscribed(e){const t=this.subscriptionStatus,n=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const i=new lg({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new Im({participantSid:"",trackSids:[this.trackSid]})]});this.emit(Ey.UpdateSubscription,i),this.emitSubscriptionUpdateIfChanged(t),this.emitPermissionUpdateIfChanged(n)}get subscriptionStatus(){return!1===this.subscribed?Aw.SubscriptionStatus.Unsubscribed:super.isSubscribed?Aw.SubscriptionStatus.Subscribed:Aw.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?Aw.PermissionStatus.Allowed:Aw.PermissionStatus.NotAllowed}get isSubscribed(){return!1!==this.subscribed&&super.isSubscribed}get isDesired(){return!1!==this.subscribed}get isEnabled(){return void 0!==this.requestedDisabled?!this.requestedDisabled:!this.isAdaptiveStream||this.visible}get isLocal(){return!1}setEnabled(e){this.isManualOperationAllowed()&&this.requestedDisabled!==!e&&(this.requestedDisabled=!e,this.emitTrackUpdate())}setVideoQuality(e){this.isManualOperationAllowed()&&this.requestedMaxQuality!==e&&(this.requestedMaxQuality=e,this.requestedVideoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var t,n;this.isManualOperationAllowed()&&((null===(t=this.requestedVideoDimensions)||void 0===t?void 0:t.width)===e.width&&(null===(n=this.requestedVideoDimensions)||void 0===n?void 0:n.height)===e.height||(qb(this.track)&&(this.requestedVideoDimensions=e),this.requestedMaxQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&qb(this.track)&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){var e;return null!==(e=this.requestedMaxQuality)&&void 0!==e?e:zy.HIGH}setTrack(e){const t=this.subscriptionStatus,n=this.permissionStatus,i=this.track;i!==e&&(i&&(i.off(Ey.VideoDimensionsChanged,this.handleVideoDimensionsChange),i.off(Ey.VisibilityChanged,this.handleVisibilityChange),i.off(Ey.Ended,this.handleEnded),i.detach(),i.stopMonitor(),this.emit(Ey.Unsubscribed,i)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(Ey.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(Ey.VisibilityChanged,this.handleVisibilityChange),e.on(Ey.Ended,this.handleEnded),this.emit(Ey.Subscribed,e)),this.emitPermissionUpdateIfChanged(n),this.emitSubscriptionUpdateIfChanged(t))}setAllowed(e){const t=this.subscriptionStatus,n=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(n),this.emitSubscriptionUpdateIfChanged(t)}setSubscriptionError(e){this.emit(Ey.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const t=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):t!==e.muted&&this.emit(e.muted?Ey.Muted:Ey.Unmuted)}emitSubscriptionUpdateIfChanged(e){const t=this.subscriptionStatus;e!==t&&this.emit(Ey.SubscriptionStatusChanged,t,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(Ey.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return!!this.isDesired||(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return qb(this.track)&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new ug({trackSids:[this.trackSid],disabled:!this.isEnabled,fps:this.fps});if(this.kind===Hy.Kind.Video){let t=this.requestedVideoDimensions;if(void 0!==this.videoDimensionsAdaptiveStream)if(t){tk(this.videoDimensionsAdaptiveStream,t)&&(this.log.debug("using adaptive stream dimensions instead of requested",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),t=this.videoDimensionsAdaptiveStream)}else if(void 0!==this.requestedMaxQuality&&this.trackInfo){const e=function(e,t){var n;return null===(n=e.layers)||void 0===n?void 0:n.find(e=>e.quality===t)}(this.trackInfo,this.requestedMaxQuality);e&&tk(this.videoDimensionsAdaptiveStream,e)&&(this.log.debug("using adaptive stream dimensions instead of max quality layer",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),t=this.videoDimensionsAdaptiveStream)}else this.log.debug("using adaptive stream dimensions",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),t=this.videoDimensionsAdaptiveStream;t?(e.width=Math.ceil(t.width),e.height=Math.ceil(t.height)):void 0!==this.requestedMaxQuality?(this.log.debug("using requested max quality",Object.assign(Object.assign({},this.logContext),{quality:this.requestedMaxQuality})),e.quality=this.requestedMaxQuality):(this.log.debug("using default quality",Object.assign(Object.assign({},this.logContext),{quality:zy.HIGH})),e.quality=zy.HIGH)}this.emit(Ey.UpdateSettings,e)}}class Bw extends Lw{static fromParticipantInfo(e,t,n){return new Bw(e,t.sid,t.identity,t.name,t.metadata,t.attributes,n,t.kind)}get logContext(){return Object.assign(Object.assign({},super.logContext),{rpID:this.sid,remoteParticipant:this.identity})}constructor(e,t,n,i,r,s,o){super(t,n||"",i,r,s,o,arguments.length>7&&void 0!==arguments[7]?arguments[7]:fm.STANDARD),this.signalClient=e,this.trackPublications=new Map,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(Ey.UpdateSettings,t=>{this.log.debug("send update settings",Object.assign(Object.assign(Object.assign({},this.logContext),Zb(e)),{settings:t})),this.signalClient.sendUpdateTrackSettings(t)}),e.on(Ey.UpdateSubscription,e=>{e.participantTracks.forEach(e=>{e.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(e)}),e.on(Ey.SubscriptionPermissionChanged,t=>{this.emit(Cy.TrackSubscriptionPermissionChanged,e,t)}),e.on(Ey.SubscriptionStatusChanged,t=>{this.emit(Cy.TrackSubscriptionStatusChanged,e,t)}),e.on(Ey.Subscribed,t=>{this.emit(Cy.TrackSubscribed,t,e)}),e.on(Ey.Unsubscribed,t=>{this.emit(Cy.TrackUnsubscribed,t,e)}),e.on(Ey.SubscriptionFailed,t=>{this.emit(Cy.TrackSubscriptionFailed,e.trackSid,t)})}getTrackPublication(e){const t=super.getTrackPublication(e);if(t)return t}getTrackPublicationByName(e){const t=super.getTrackPublicationByName(e);if(t)return t}setVolume(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Hy.Source.Microphone;this.volumeMap.set(t,e);const n=this.getTrackPublication(t);n&&n.track&&n.track.setVolume(e)}getVolume(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Hy.Source.Microphone;const t=this.getTrackPublication(e);return t&&t.track?t.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,t,n,i,r,s){let o=this.getTrackPublicationBySid(t);if(o||t.startsWith("TR")||this.trackPublications.forEach(t=>{o||e.kind!==t.kind.toString()||(o=t)}),!o)return 0===s?(this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:t})),void this.emit(Cy.TrackSubscriptionFailed,t)):(void 0===s&&(s=20),void setTimeout(()=>{this.addSubscribedMediaTrack(e,t,n,i,r,s-1)},150));if("ended"===e.readyState)return this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),Zb(o))),void this.emit(Cy.TrackSubscriptionFailed,t);let a;return a="video"===e.kind?new Rw(e,t,i,r):new Pw(e,t,i,this.audioContext,this.audioOutput),a.source=o.source,a.isMuted=o.isMuted,a.setMediaStream(n),a.start(),o.setTrack(a),this.volumeMap.has(o.source)&&Bb(a)&&Mb(a)&&a.setVolume(this.volumeMap.get(o.source)),o}get hasMetadata(){return!!this.participantInfo}getTrackPublicationBySid(e){return this.trackPublications.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const t=new Map,n=new Map;return e.tracks.forEach(e=>{var i,r;let s=this.getTrackPublicationBySid(e.sid);if(s)s.updateInfo(e);else{const t=Hy.kindFromProto(e.type);if(!t)return;s=new Uw(t,e,null===(i=this.signalClient.connectOptions)||void 0===i?void 0:i.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:null===(r=this.loggerOptions)||void 0===r?void 0:r.loggerName}),s.updateInfo(e),n.set(e.sid,s);const o=Array.from(this.trackPublications.values()).find(e=>e.source===(null===s||void 0===s?void 0:s.source));o&&s.source!==Hy.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(s.source),Object.assign(Object.assign({},this.logContext),{oldTrack:Zb(o),newTrack:Zb(s)})),this.addTrackPublication(s)}t.set(e.sid,s)}),this.trackPublications.forEach(e=>{t.has(e.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),Zb(e))),this.unpublishTrack(e.trackSid,!0))}),n.forEach(e=>{this.emit(Cy.TrackPublished,e)}),!0}unpublishTrack(e,t){const n=this.trackPublications.get(e);if(!n)return;const{track:i}=n;switch(i&&(i.stop(),n.setTrack(void 0)),this.trackPublications.delete(e),n.kind){case Hy.Kind.Audio:this.audioTrackPublications.delete(e);break;case Hy.Kind.Video:this.videoTrackPublications.delete(e)}t&&this.emit(Cy.TrackUnpublished,n)}setAudioOutput(e){return tv(this,void 0,void 0,function*(){this.audioOutput=e;const t=[];this.audioTrackPublications.forEach(n=>{var i;Mb(n.track)&&Bb(n.track)&&t.push(n.track.setSinkId(null!==(i=e.deviceId)&&void 0!==i?i:"default"))}),yield Promise.all(t)})}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:n})),super.emit(e,...n)}}var Vw;!function(e){e.Disconnected="disconnected",e.Connecting="connecting",e.Connected="connected",e.Reconnecting="reconnecting",e.SignalReconnecting="signalReconnecting"}(Vw||(Vw={}));class qw extends ov.EventEmitter{constructor(e){var t,n,i,s;if(super(),t=this,this.state=Vw.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=Jg,this.bufferedEvents=[],this.isResuming=!1,this.byteStreamControllers=new Map,this.textStreamControllers=new Map,this.byteStreamHandlers=new Map,this.textStreamHandlers=new Map,this.rpcHandlers=new Map,this.connect=(e,t,n)=>tv(this,void 0,void 0,function*(){var i;if("undefined"===typeof RTCPeerConnection||!rb()&&!sb())throw fb()?Error("WebRTC isn't detected, have you called registerGlobals?"):Error("LiveKit doesn't seem to be supported on this browser. Try to update your browser and make sure no browser extensions are disabling webRTC.");const s=yield this.disconnectLock.lock();if(this.state===Vw.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),s(),Promise.resolve();if(this.connectFuture)return s(),this.connectFuture.promise;this.setAndEmitConnectionState(Vw.Connecting),(null===(i=this.regionUrlProvider)||void 0===i?void 0:i.getServerUrl().toString())!==e&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),mb(new URL(e))&&(void 0===this.regionUrlProvider?this.regionUrlProvider=new bw(e,t):this.regionUrlProvider.updateToken(t),this.regionUrlProvider.fetchRegionSettings().then(e=>{var t;null===(t=this.regionUrlProvider)||void 0===t||t.setServerReportedRegions(e)}).catch(e=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:e}))}));const o=(i,a,c)=>tv(this,void 0,void 0,function*(){var l,u;this.abortController&&this.abortController.abort();const d=new AbortController;this.abortController=d,null===s||void 0===s||s();try{yield this.attemptConnection(null!==c&&void 0!==c?c:e,t,n,d),this.abortController=void 0,i()}catch(r){if(this.regionUrlProvider&&r instanceof Py&&r.reason!==ky.Cancelled&&r.reason!==ky.NotAllowed){let t=null;try{t=yield this.regionUrlProvider.getNextBestRegionUrl(null===(l=this.abortController)||void 0===l?void 0:l.signal)}catch(h){if(h instanceof Py&&(401===h.status||h.reason===ky.Cancelled))return this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),void a(h)}t&&!(null===(u=this.abortController)||void 0===u?void 0:u.signal.aborted)?(this.log.info("Initial connection failed with ConnectionError: ".concat(r.message,". Retrying with another region: ").concat(t),this.logContext),this.recreateEngine(),yield o(i,a,t)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,Ab(r)),a(r))}else{let t=sm.UNKNOWN_REASON;r instanceof Py&&(t=Ab(r)),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,t),a(r)}}}),a=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new Ob((e,t)=>{o(e,t,a)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(e,t,n,i,r,s)=>tv(this,void 0,void 0,function*(){var o,a,c;const l=yield n.join(e,t,{autoSubscribe:i.autoSubscribe,adaptiveStream:"object"===typeof r.adaptiveStream||r.adaptiveStream,maxRetries:i.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:i.websocketTimeout},s.signal);let u=l.serverInfo;if(u||(u={version:l.serverVersion,region:l.serverRegion}),this.serverInfo=u,this.log.debug("connected to Livekit Server ".concat(Object.entries(u).map(e=>{let[t,n]=e;return"".concat(t,": ").concat(n)}).join(", ")),{room:null===(o=l.room)||void 0===o?void 0:o.name,roomSid:null===(a=l.room)||void 0===a?void 0:a.sid,identity:null===(c=l.participant)||void 0===c?void 0:c.identity}),!u.version)throw new _y("unknown server version");return"0.15.1"===u.version&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),r.dynacast=!1),l}),this.applyJoinResponse=e=>{const t=e.participant;if(this.localParticipant.sid=t.sid,this.localParticipant.identity=t.identity,this.localParticipant.setEnabledPublishCodecs(e.enabledPublishCodecs),this.options.e2ee&&this.e2eeManager)try{this.e2eeManager.setSifTrailer(e.sifTrailer)}catch(r){this.log.error(r instanceof Error?r.message:"Could not set SifTrailer",Object.assign(Object.assign({},this.logContext),{error:r}))}this.handleParticipantUpdates([t,...e.otherParticipants]),e.room&&this.handleRoomUpdate(e.room)},this.attemptConnection=(e,t,n,i)=>tv(this,void 0,void 0,function*(){var s,o;this.state===Vw.Reconnecting||this.isResuming||(null===(s=this.engine)||void 0===s?void 0:s.pendingReconnect)?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),(null===(o=this.regionUrlProvider)||void 0===o?void 0:o.isCloud())&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},Uk),n),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const n=yield this.connectSignal(e,t,this.engine,this.connOptions,this.options,i);this.applyJoinResponse(n),this.setupLocalParticipantEvents(),this.emit(Ty.SignalConnected)}catch(a){yield this.engine.close(),this.recreateEngine();const e=new Py("could not establish signal connection",ky.ServerUnreachable);throw a instanceof Error&&(e.message="".concat(e.message,": ").concat(a.message)),a instanceof Py&&(e.reason=a.reason,e.status=a.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:a})),e}if(i.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new Py("Connection attempt aborted",ky.Cancelled);try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,i)}catch(r){throw yield this.engine.close(),this.recreateEngine(),r}pb()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),pb()&&document.addEventListener("freeze",this.onPageLeave),this.setAndEmitConnectionState(Vw.Connected),this.emit(Ty.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return tv(t,[...n],void 0,function(){var e=this;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function*(){var n,i,r,s;const o=yield e.disconnectLock.lock();try{if(e.state===Vw.Disconnected)return void e.log.debug("already disconnected",e.logContext);e.log.info("disconnect from room",Object.assign({},e.logContext)),(e.state===Vw.Connecting||e.state===Vw.Reconnecting||e.isResuming)&&(e.log.warn("abort connection attempt",e.logContext),null===(n=e.abortController)||void 0===n||n.abort(),null===(r=null===(i=e.connectFuture)||void 0===i?void 0:i.reject)||void 0===r||r.call(i,new Py("Client initiated disconnect",ky.Cancelled)),e.connectFuture=void 0),(null===(s=e.engine)||void 0===s?void 0:s.client.isDisconnected)||(yield e.engine.client.sendLeave()),e.engine&&(yield e.engine.close()),e.handleDisconnect(t,sm.CLIENT_INITIATED),e.engine=void 0}finally{o()}}()})},this.onPageLeave=()=>tv(this,void 0,void 0,function*(){this.log.info("Page leave detected, disconnecting",this.logContext),yield this.disconnect()}),this.startAudio=()=>tv(this,void 0,void 0,function*(){const e=[],t=Ly();if(t&&"iOS"===t.os){const t="livekit-dummy-audio-el";let n=document.getElementById(t);if(!n){n=document.createElement("audio"),n.id=t,n.autoplay=!0,n.hidden=!0;const e=Rb();e.enabled=!0;const i=new MediaStream([e]);n.srcObject=i,document.addEventListener("visibilitychange",()=>{n&&(n.srcObject=document.hidden?null:i,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(n),this.once(Ty.Disconnected,()=>{null===n||void 0===n||n.remove(),n=null})}e.push(n)}this.remoteParticipants.forEach(t=>{t.audioTrackPublications.forEach(t=>{t.track&&t.track.attachedElements.forEach(t=>{e.push(t)})})});try{yield Promise.all([this.acquireAudioContext(),...e.map(e=>(e.muted=!1,e.play()))]),this.handleAudioPlaybackStarted()}catch(n){throw this.handleAudioPlaybackFailed(n),n}}),this.startVideo=()=>tv(this,void 0,void 0,function*(){const e=[];for(const t of this.remoteParticipants.values())t.videoTrackPublications.forEach(t=>{var n;null===(n=t.track)||void 0===n||n.attachedElements.forEach(t=>{e.includes(t)||e.push(t)})});yield Promise.all(e.map(e=>e.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(e=>{"NotAllowedError"===e.name?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile(),this.isResuming=!1;for(const e of this.remoteParticipants.values())this.handleParticipantDisconnected(e.identity,e);this.setAndEmitConnectionState(Vw.Reconnecting)&&this.emit(Ty.Reconnecting)},this.handleSignalRestarted=e=>tv(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(e.serverRegion),Object.assign(Object.assign({},this.logContext),{region:e.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(e);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(t){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:t}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:e.serverRegion}))}catch(n){return}this.setAndEmitConnectionState(Vw.Connected),this.emit(Ty.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=e=>{e.forEach(e=>{var t;if(e.identity===this.localParticipant.identity)return void this.localParticipant.updateInfo(e);""===e.identity&&(e.identity=null!==(t=this.sidToIdentity.get(e.sid))&&void 0!==t?t:"");let n=this.remoteParticipants.get(e.identity);e.state===pm.DISCONNECTED?this.handleParticipantDisconnected(e.identity,n):n=this.getOrCreateParticipant(e.identity,e)})},this.handleActiveSpeakersUpdate=e=>{const t=[],n={};e.forEach(e=>{if(n[e.sid]=!0,e.sid===this.localParticipant.sid)this.localParticipant.audioLevel=e.level,this.localParticipant.setIsSpeaking(!0),t.push(this.localParticipant);else{const n=this.getRemoteParticipantBySid(e.sid);n&&(n.audioLevel=e.level,n.setIsSpeaking(!0),t.push(n))}}),n[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.remoteParticipants.forEach(e=>{n[e.sid]||(e.audioLevel=0,e.setIsSpeaking(!1))}),this.activeSpeakers=t,this.emitWhenConnected(Ty.ActiveSpeakersChanged,t)},this.handleSpeakersChanged=e=>{const t=new Map;this.activeSpeakers.forEach(e=>{const n=this.remoteParticipants.get(e.identity);n&&n.sid!==e.sid||t.set(e.sid,e)}),e.forEach(e=>{let n=this.getRemoteParticipantBySid(e.sid);e.sid===this.localParticipant.sid&&(n=this.localParticipant),n&&(n.audioLevel=e.level,n.setIsSpeaking(e.active),e.active?t.set(e.sid,n):t.delete(e.sid))});const n=Array.from(t.values());n.sort((e,t)=>t.audioLevel-e.audioLevel),this.activeSpeakers=n,this.emitWhenConnected(Ty.ActiveSpeakersChanged,n)},this.handleStreamStateUpdate=e=>{e.streamStates.forEach(e=>{const t=this.getRemoteParticipantBySid(e.participantSid);if(!t)return;const n=t.getTrackPublicationBySid(e.trackSid);if(!n||!n.track)return;const i=Hy.streamStateFromProto(e.state);i!==n.track.streamState&&(n.track.streamState=i,t.emit(Cy.TrackStreamStateChanged,n,n.track.streamState),this.emitWhenConnected(Ty.TrackStreamStateChanged,n,n.track.streamState,t))})},this.handleSubscriptionPermissionUpdate=e=>{const t=this.getRemoteParticipantBySid(e.participantSid);if(!t)return;const n=t.getTrackPublicationBySid(e.trackSid);n&&n.setAllowed(e.allowed)},this.handleSubscriptionError=e=>{const t=Array.from(this.remoteParticipants.values()).find(t=>t.trackPublications.has(e.trackSid));if(!t)return;const n=t.getTrackPublicationBySid(e.trackSid);n&&n.setSubscriptionError(e.err)},this.handleDataPacket=e=>{const t=this.remoteParticipants.get(e.participantIdentity);if("user"===e.value.case)this.handleUserPacket(t,e.value.value,e.kind);else if("transcription"===e.value.case)this.handleTranscription(t,e.value.value);else if("sipDtmf"===e.value.case)this.handleSipDtmf(t,e.value.value);else if("chatMessage"===e.value.case)this.handleChatMessage(t,e.value.value);else if("metrics"===e.value.case)this.handleMetrics(e.value.value,t);else if("streamHeader"===e.value.case)this.handleStreamHeader(e.value.value,e.participantIdentity);else if("streamChunk"===e.value.case)this.handleStreamChunk(e.value.value);else if("streamTrailer"===e.value.case)this.handleStreamTrailer(e.value.value);else if("rpcRequest"===e.value.case){const t=e.value.value;this.handleIncomingRpcRequest(e.participantIdentity,t.id,t.method,t.payload,t.responseTimeoutMs,t.version)}},this.handleUserPacket=(e,t,n)=>{this.emit(Ty.DataReceived,t.payload,e,n,t.topic),null===e||void 0===e||e.emit(Cy.DataReceived,t.payload,n)},this.handleSipDtmf=(e,t)=>{this.emit(Ty.SipDTMFReceived,t,e),null===e||void 0===e||e.emit(Cy.SipDTMFReceived,t)},this.bufferedSegments=new Map,this.handleTranscription=(e,t)=>{const n=t.transcribedParticipantIdentity===this.localParticipant.identity?this.localParticipant:this.getParticipantByIdentity(t.transcribedParticipantIdentity),i=null===n||void 0===n?void 0:n.trackPublications.get(t.trackId),r=function(e,t){return e.segments.map(e=>{let{id:n,text:i,language:r,startTime:s,endTime:o,final:a}=e;var c;const l=null!==(c=t.get(n))&&void 0!==c?c:Date.now(),u=Date.now();return a?t.delete(n):t.set(n,l),{id:n,text:i,startTime:Number.parseInt(s.toString()),endTime:Number.parseInt(o.toString()),final:a,language:r,firstReceivedTime:l,lastReceivedTime:u}})}(t,this.transcriptionReceivedTimes);null===i||void 0===i||i.emit(Ey.TranscriptionReceived,r),null===n||void 0===n||n.emit(Cy.TranscriptionReceived,r,i),this.emit(Ty.TranscriptionReceived,r,n,i)},this.handleChatMessage=(e,t)=>{const n=function(e){const{id:t,timestamp:n,message:i,editTimestamp:r}=e;return{id:t,timestamp:Number.parseInt(n.toString()),editTimestamp:r?Number.parseInt(r.toString()):void 0,message:i}}(t);this.emit(Ty.ChatMessage,n,e)},this.handleMetrics=(e,t)=>{this.emit(Ty.MetricsReceived,e,t)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(Ty.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=e=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:e})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(Ty.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(Ty.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(Ty.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>tv(this,void 0,void 0,function*(){var e;"iOS"!==(null===(e=Ly())||void 0===e?void 0:e.os)&&(yield this.selectDefaultDevices()),this.emit(Ty.MediaDevicesChanged)}),this.handleRoomUpdate=e=>{const t=this.roomInfo;this.roomInfo=e,t&&t.metadata!==e.metadata&&this.emitWhenConnected(Ty.RoomMetadataChanged,e.metadata),(null===t||void 0===t?void 0:t.activeRecording)!==e.activeRecording&&this.emitWhenConnected(Ty.RecordingStatusChanged,e.activeRecording)},this.handleConnectionQualityUpdate=e=>{e.updates.forEach(e=>{if(e.participantSid===this.localParticipant.sid)return void this.localParticipant.setConnectionQuality(e.quality);const t=this.getRemoteParticipantBySid(e.participantSid);t&&t.setConnectionQuality(e.quality)})},this.onLocalParticipantMetadataChanged=e=>{this.emit(Ty.ParticipantMetadataChanged,e,this.localParticipant)},this.onLocalParticipantNameChanged=e=>{this.emit(Ty.ParticipantNameChanged,e,this.localParticipant)},this.onLocalAttributesChanged=e=>{this.emit(Ty.ParticipantAttributesChanged,e,this.localParticipant)},this.onLocalTrackMuted=e=>{this.emit(Ty.TrackMuted,e,this.localParticipant)},this.onLocalTrackUnmuted=e=>{this.emit(Ty.TrackUnmuted,e,this.localParticipant)},this.onTrackProcessorUpdate=e=>{var t;null===(t=null===e||void 0===e?void 0:e.onPublish)||void 0===t||t.call(e,this)},this.onLocalTrackPublished=e=>tv(this,void 0,void 0,function*(){var t,n,i,r,s,o;if(null===(t=e.track)||void 0===t||t.on(Ey.TrackProcessorUpdate,this.onTrackProcessorUpdate),null===(n=e.track)||void 0===n||n.on(Ey.Restarted,this.onLocalTrackRestarted),null===(s=null===(r=null===(i=e.track)||void 0===i?void 0:i.getProcessor())||void 0===r?void 0:r.onPublish)||void 0===s||s.call(r,this),this.emit(Ty.LocalTrackPublished,e,this.localParticipant),Ub(e.track)){(yield e.track.checkForSilence())&&this.emit(Ty.LocalAudioSilenceDetected,e)}const a=yield null===(o=e.track)||void 0===o?void 0:o.getDeviceId(!1),c=Qb(e.source);c&&a&&a!==this.localParticipant.activeDeviceMap.get(c)&&(this.localParticipant.activeDeviceMap.set(c,a),this.emit(Ty.ActiveDeviceChanged,c,a))}),this.onLocalTrackUnpublished=e=>{var t,n;null===(t=e.track)||void 0===t||t.off(Ey.TrackProcessorUpdate,this.onTrackProcessorUpdate),null===(n=e.track)||void 0===n||n.off(Ey.Restarted,this.onLocalTrackRestarted),this.emit(Ty.LocalTrackUnpublished,e,this.localParticipant)},this.onLocalTrackRestarted=e=>tv(this,void 0,void 0,function*(){const t=yield e.getDeviceId(!1),n=Qb(e.source);n&&t&&t!==this.localParticipant.activeDeviceMap.get(n)&&(this.log.debug("local track restarted, setting ".concat(n," ").concat(t," active"),this.logContext),this.localParticipant.activeDeviceMap.set(n,t),this.emit(Ty.ActiveDeviceChanged,n,t))}),this.onLocalConnectionQualityChanged=e=>{this.emit(Ty.ConnectionQualityChanged,e,this.localParticipant)},this.onMediaDevicesError=(e,t)=>{this.emit(Ty.MediaDevicesError,e,t)},this.onLocalParticipantPermissionsChanged=e=>{this.emit(Ty.ParticipantPermissionsChanged,e,this.localParticipant)},this.onLocalChatMessageSent=e=>{this.emit(Ty.ChatMessage,e,this.localParticipant)},this.setMaxListeners(100),this.remoteParticipants=new Map,this.sidToIdentity=new Map,this.options=Object.assign(Object.assign({},Fk),e),this.log=Yg(null!==(n=this.options.loggerName)&&void 0!==n?n:Gg.Room),this.transcriptionReceivedTimes=new Map,this.options.audioCaptureDefaults=Object.assign(Object.assign({},Mk),null===e||void 0===e?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},Lk),null===e||void 0===e?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},Dk),null===e||void 0===e?void 0:e.publishDefaults),this.maybeCreateEngine(),this.disconnectLock=new fp,this.localParticipant=new Fw("","",this.engine,this.options,this.rpcHandlers),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",_b(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",_b(this.options.audioCaptureDefaults.deviceId)),(null===(i=this.options.audioOutput)||void 0===i?void 0:i.deviceId)&&this.switchActiveDevice("audiooutput",_b(this.options.audioOutput.deviceId)).catch(e=>this.log.warn("Could not set audio output: ".concat(e.message),this.logContext)),this.options.e2ee&&this.setupE2EE(),pb()){const e=new AbortController;null===(s=navigator.mediaDevices)||void 0===s||s.addEventListener("devicechange",this.handleDeviceChange,{signal:e.signal}),qw.cleanupRegistry&&qw.cleanupRegistry.register(this,()=>{e.abort()})}}registerTextStreamHandler(e,t){if(this.textStreamHandlers.has(e))throw new TypeError('A text stream handler for topic "'.concat(e,'" has already been set.'));this.textStreamHandlers.set(e,t)}unregisterTextStreamHandler(e){this.textStreamHandlers.delete(e)}registerByteStreamHandler(e,t){if(this.byteStreamHandlers.has(e))throw new TypeError('A byte stream handler for topic "'.concat(e,'" has already been set.'));this.byteStreamHandlers.set(e,t)}unregisterByteStreamHandler(e){this.byteStreamHandlers.delete(e)}registerRpcMethod(e,t){if(this.rpcHandlers.has(e))throw Error("RPC handler already registered for method ".concat(e,", unregisterRpcMethod before trying to register again"));this.rpcHandlers.set(e,t)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}handleIncomingRpcRequest(e,t,n,i,r,s){return tv(this,void 0,void 0,function*(){if(yield this.engine.publishRpcAck(e,t),1!==s)return void(yield this.engine.publishRpcResponse(e,t,null,qk.builtIn("UNSUPPORTED_VERSION")));const o=this.rpcHandlers.get(n);if(!o)return void(yield this.engine.publishRpcResponse(e,t,null,qk.builtIn("UNSUPPORTED_METHOD")));let a=null,c=null;try{const s=yield o({requestId:t,callerIdentity:e,payload:i,responseTimeout:r});zk(s)>15360?(a=qk.builtIn("RESPONSE_PAYLOAD_TOO_LARGE"),console.warn("RPC Response payload too large for ".concat(n))):c=s}catch(l){l instanceof qk?a=l:(console.warn("Uncaught error returned by RPC handler for ".concat(n,". Returning APPLICATION_ERROR instead."),l),a=qk.builtIn("APPLICATION_ERROR"))}yield this.engine.publishRpcResponse(e,t,c,a)})}setE2EEEnabled(e){return tv(this,void 0,void 0,function*(){if(!this.e2eeManager)throw Error("e2ee not configured, please set e2ee settings within the room options");yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),""!==this.localParticipant.identity&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity)})}setupE2EE(){var e;this.options.e2ee&&("e2eeManager"in this.options.e2ee?this.e2eeManager=this.options.e2ee.e2eeManager:this.e2eeManager=new nk(this.options.e2ee),this.e2eeManager.on(my.ParticipantEncryptionStatusChanged,(e,t)=>{(function(e){return e.isLocal})(t)&&(this.isE2EEEnabled=e),this.emit(Ty.ParticipantEncryptionStatusChanged,e,t)}),this.e2eeManager.on(my.EncryptionError,e=>this.emit(Ty.EncryptionError,e)),null===(e=this.e2eeManager)||void 0===e||e.setup(this))}get logContext(){var e;return{room:this.name,roomID:null===(e=this.roomInfo)||void 0===e?void 0:e.sid,participant:this.localParticipant.identity,pID:this.localParticipant.sid}}get isRecording(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.activeRecording)&&void 0!==t&&t}getSid(){return tv(this,void 0,void 0,function*(){return this.state===Vw.Disconnected?"":this.roomInfo&&""!==this.roomInfo.sid?this.roomInfo.sid:new Promise((e,t)=>{const n=t=>{""!==t.sid&&(this.engine.off(xy.RoomUpdate,n),e(t.sid))};this.engine.on(xy.RoomUpdate,n),this.once(Ty.Disconnected,()=>{this.engine.off(xy.RoomUpdate,n),t("Room disconnected before room server id was available")})})})}get name(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.name)&&void 0!==t?t:""}get metadata(){var e;return null===(e=this.roomInfo)||void 0===e?void 0:e.metadata}get numParticipants(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.numParticipants)&&void 0!==t?t:0}get numPublishers(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.numPublishers)&&void 0!==t?t:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new vw(this.options),this.engine.on(xy.ParticipantUpdate,this.handleParticipantUpdates).on(xy.RoomUpdate,this.handleRoomUpdate).on(xy.SpeakersChanged,this.handleSpeakersChanged).on(xy.StreamStateChanged,this.handleStreamStateUpdate).on(xy.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(xy.SubscriptionError,this.handleSubscriptionError).on(xy.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(xy.MediaTrackAdded,(e,t,n)=>{this.onTrackAdded(e,t,n)}).on(xy.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(xy.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(xy.DataPacketReceived,this.handleDataPacket).on(xy.Resuming,()=>{this.clearConnectionReconcile(),this.isResuming=!0,this.log.info("Resuming signal connection",this.logContext),this.setAndEmitConnectionState(Vw.SignalReconnecting)&&this.emit(Ty.SignalReconnecting)}).on(xy.Resumed,()=>{this.registerConnectionReconcile(),this.isResuming=!1,this.log.info("Resumed signal connection",this.logContext),this.updateSubscriptions(),this.emitBufferedEvents(),this.setAndEmitConnectionState(Vw.Connected)&&this.emit(Ty.Reconnected)}).on(xy.SignalResumed,()=>{this.bufferedEvents=[],(this.state===Vw.Reconnecting||this.isResuming)&&this.sendSyncState()}).on(xy.Restarting,this.handleRestarting).on(xy.SignalRestarted,this.handleSignalRestarted).on(xy.Offline,()=>{this.setAndEmitConnectionState(Vw.Reconnecting)&&this.emit(Ty.Reconnecting)}).on(xy.DCBufferStatusChanged,(e,t)=>{this.emit(Ty.DCBufferStatusChanged,e,t)}).on(xy.LocalTrackSubscribed,e=>{const t=this.localParticipant.getTrackPublications().find(t=>{let{trackSid:n}=t;return n===e});t?(this.localParticipant.emit(Cy.LocalTrackSubscribed,t),this.emitWhenConnected(Ty.LocalTrackSubscribed,t,this.localParticipant)):this.log.warn("could not find local track subscription for subscribed event",this.logContext)}).on(xy.RoomMoved,e=>{this.log.debug("room moved",e),e.room&&this.handleRoomUpdate(e.room),this.remoteParticipants.forEach((e,t)=>{this.handleParticipantDisconnected(t,e)}),this.emit(Ty.Moved,e.room.name),e.participant?this.handleParticipantUpdates([e.participant,...e.otherParticipants]):this.handleParticipantUpdates(e.otherParticipants)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine))}static getLocalDevices(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return rk.getInstance().getDevices(e,t)}prepareConnection(e,t){return tv(this,void 0,void 0,function*(){if(this.state===Vw.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(mb(new URL(e))&&t){this.regionUrlProvider=new bw(e,t);const n=yield this.regionUrlProvider.getNextBestRegionUrl();n&&this.state===Vw.Disconnected&&(this.regionUrl=n,yield fetch(Nb(n),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(n),this.logContext))}else yield fetch(Nb(e),{method:"HEAD"})}catch(r){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:r}))}}})}getParticipantByIdentity(e){return this.localParticipant.identity===e?this.localParticipant:this.remoteParticipants.get(e)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,t){return tv(this,void 0,void 0,function*(){let n,i=()=>{};switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":n=new jg({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":n=new jg({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":n=new jg({scenario:{case:"serverLeave",value:!0}});break;case"migration":n=new jg({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":i=()=>tv(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),n=new jg({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":i=()=>tv(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),n=new jg({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":n=new jg({scenario:{case:"switchCandidateProtocol",value:"force-tls"===e?2:1}}),i=()=>tv(this,void 0,void 0,function*(){const e=this.engine.client.onLeave;e&&e(new pg({reason:sm.CLIENT_INITIATED,action:fg.RECONNECT}))});break;case"subscriber-bandwidth":if(void 0===t||"number"!==typeof t)throw new Error("subscriber-bandwidth requires a number as argument");n=new jg({scenario:{case:"subscriberBandwidth",value:jb(t)}});break;case"leave-full-reconnect":n=new jg({scenario:{case:"leaveRequestFullReconnect",value:!0}})}n&&(yield this.engine.client.sendSimulateScenario(n),yield i())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,t){return tv(this,arguments,void 0,function(e,t){var n=this;let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function*(){var s,o,a,c,l,u,d;let h=!0,p=!1;const f=i?{exact:t}:t;if("audioinput"===e){p=0===n.localParticipant.audioTrackPublications.size;const t=null!==(s=n.getActiveDevice(e))&&void 0!==s?s:n.options.audioCaptureDefaults.deviceId;n.options.audioCaptureDefaults.deviceId=f;const i=Array.from(n.localParticipant.audioTrackPublications.values()).filter(e=>e.source===Hy.Source.Microphone);try{h=(yield Promise.all(i.map(e=>{var t;return null===(t=e.audioTrack)||void 0===t?void 0:t.setDeviceId(f)}))).every(e=>!0===e)}catch(r){throw n.options.audioCaptureDefaults.deviceId=t,r}const o=i.some(e=>{var t,n;return null!==(n=null===(t=e.track)||void 0===t?void 0:t.isMuted)&&void 0!==n&&n});h&&o&&(p=!0)}else if("videoinput"===e){p=0===n.localParticipant.videoTrackPublications.size;const t=null!==(o=n.getActiveDevice(e))&&void 0!==o?o:n.options.videoCaptureDefaults.deviceId;n.options.videoCaptureDefaults.deviceId=f;const i=Array.from(n.localParticipant.videoTrackPublications.values()).filter(e=>e.source===Hy.Source.Camera);try{h=(yield Promise.all(i.map(e=>{var t;return null===(t=e.videoTrack)||void 0===t?void 0:t.setDeviceId(f)}))).every(e=>!0===e)}catch(r){throw n.options.videoCaptureDefaults.deviceId=t,r}const s=i.some(e=>{var t,n;return null!==(n=null===(t=e.track)||void 0===t?void 0:t.isMuted)&&void 0!==n&&n});h&&s&&(p=!0)}else if("audiooutput"===e){if(p=!0,!ab()&&!n.options.webAudioMix||n.options.webAudioMix&&n.audioContext&&!("setSinkId"in n.audioContext))throw new Error("cannot switch audio output, the current browser does not support it");n.options.webAudioMix&&(t=null!==(a=yield rk.getInstance().normalizeDeviceId("audiooutput",t))&&void 0!==a?a:""),null!==(c=(d=n.options).audioOutput)&&void 0!==c||(d.audioOutput={});const i=null!==(l=n.getActiveDevice(e))&&void 0!==l?l:n.options.audioOutput.deviceId;n.options.audioOutput.deviceId=t;try{n.options.webAudioMix&&(null===(u=n.audioContext)||void 0===u||u.setSinkId(t)),yield Promise.all(Array.from(n.remoteParticipants.values()).map(e=>e.setAudioOutput({deviceId:t})))}catch(r){throw n.options.audioOutput.deviceId=i,r}}return p&&(n.localParticipant.activeDeviceMap.set(e,t),n.emit(Ty.ActiveDeviceChanged,e,t)),h}()})}setupLocalParticipantEvents(){this.localParticipant.on(Cy.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(Cy.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(Cy.AttributesChanged,this.onLocalAttributesChanged).on(Cy.TrackMuted,this.onLocalTrackMuted).on(Cy.TrackUnmuted,this.onLocalTrackUnmuted).on(Cy.LocalTrackPublished,this.onLocalTrackPublished).on(Cy.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(Cy.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(Cy.MediaDevicesError,this.onMediaDevicesError).on(Cy.AudioStreamAcquired,this.startAudio).on(Cy.ChatMessage,this.onLocalChatMessageSent).on(Cy.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;null===(e=this.engine)||void 0===e||e.close(),this.engine=void 0,this.isResuming=!1,this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,t,n){if(this.state===Vw.Connecting||this.state===Vw.Reconnecting){const i=()=>{this.onTrackAdded(e,t,n),r()},r=()=>{this.off(Ty.Reconnected,i),this.off(Ty.Connected,i),this.off(Ty.Disconnected,r)};return this.once(Ty.Reconnected,i),this.once(Ty.Connected,i),void this.once(Ty.Disconnected,r)}if(this.state===Vw.Disconnected)return void this.log.warn("skipping incoming track after Room disconnected",this.logContext);if("ended"===e.readyState)return void this.log.info("skipping incoming track as it already ended",this.logContext);const i=function(e){const t=e.split("|");return t.length>1?[t[0],e.substr(t[0].length+1)]:[e,""]}(t.id),r=i[0];let s=i[1],o=e.id;if(s&&s.startsWith("TR")&&(o=s),r===this.localParticipant.sid)return void this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);const a=Array.from(this.remoteParticipants.values()).find(e=>e.sid===r);if(!a)return void this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(r),this.logContext);let c;this.options.adaptiveStream&&(c="object"===typeof this.options.adaptiveStream?this.options.adaptiveStream:{}),a.addSubscribedMediaTrack(e,o,t,n,c)}handleDisconnect(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;var n;if(this.clearConnectionReconcile(),this.isResuming=!1,this.bufferedEvents=[],this.transcriptionReceivedTimes.clear(),this.state!==Vw.Disconnected){this.regionUrl=void 0;try{this.remoteParticipants.forEach(e=>{e.trackPublications.forEach(t=>{e.unpublishTrack(t.trackSid)})}),this.localParticipant.trackPublications.forEach(t=>{var n,i,r;t.track&&this.localParticipant.unpublishTrack(t.track,e),e?(null===(n=t.track)||void 0===n||n.detach(),null===(i=t.track)||void 0===i||i.stop()):null===(r=t.track)||void 0===r||r.stopMonitor()}),this.localParticipant.off(Cy.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(Cy.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(Cy.AttributesChanged,this.onLocalAttributesChanged).off(Cy.TrackMuted,this.onLocalTrackMuted).off(Cy.TrackUnmuted,this.onLocalTrackUnmuted).off(Cy.LocalTrackPublished,this.onLocalTrackPublished).off(Cy.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(Cy.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(Cy.MediaDevicesError,this.onMediaDevicesError).off(Cy.AudioStreamAcquired,this.startAudio).off(Cy.ChatMessage,this.onLocalChatMessageSent).off(Cy.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.trackPublications.clear(),this.localParticipant.videoTrackPublications.clear(),this.localParticipant.audioTrackPublications.clear(),this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.activeSpeakers=[],this.audioContext&&"boolean"===typeof this.options.webAudioMix&&(this.audioContext.close(),this.audioContext=void 0),pb()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),null===(n=navigator.mediaDevices)||void 0===n||n.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(Vw.Disconnected),this.emit(Ty.Disconnected,t)}}}handleParticipantDisconnected(e,t){var n;this.remoteParticipants.delete(e),t&&(t.trackPublications.forEach(e=>{t.unpublishTrack(e.trackSid,!0)}),this.emit(Ty.ParticipantDisconnected,t),t.setDisconnected(),null===(n=this.localParticipant)||void 0===n||n.handleParticipantDisconnected(t.identity))}handleStreamHeader(e,t){return tv(this,void 0,void 0,function*(){var n;if("byteHeader"===e.contentHeader.case){const i=this.byteStreamHandlers.get(e.topic);if(!i)return void this.log.debug("ignoring incoming byte stream due to no handler for topic",e.topic);let r;const s={id:e.streamId,name:null!==(n=e.contentHeader.value.name)&&void 0!==n?n:"unknown",mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Ib(e.timestamp),attributes:e.attributes},o=new ReadableStream({start:t=>{r=t,this.byteStreamControllers.set(e.streamId,{info:s,controller:r,startTime:Date.now()})}});i(new ww(s,o,Ib(e.totalLength)),{identity:t})}else if("textHeader"===e.contentHeader.case){const n=this.textStreamHandlers.get(e.topic);if(!n)return void this.log.debug("ignoring incoming text stream due to no handler for topic",e.topic);let i;const r={id:e.streamId,mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Number(e.timestamp),attributes:e.attributes},s=new ReadableStream({start:t=>{i=t,this.textStreamControllers.set(e.streamId,{info:r,controller:i,startTime:Date.now()})}});n(new Sw(r,s,Ib(e.totalLength)),{identity:t})}})}handleStreamChunk(e){const t=this.byteStreamControllers.get(e.streamId);t&&e.content.length>0&&t.controller.enqueue(e);const n=this.textStreamControllers.get(e.streamId);n&&e.content.length>0&&n.controller.enqueue(e)}handleStreamTrailer(e){const t=this.textStreamControllers.get(e.streamId);t&&(t.info.attributes=Object.assign(Object.assign({},t.info.attributes),e.attributes),t.controller.close(),this.textStreamControllers.delete(e.streamId));const n=this.byteStreamControllers.get(e.streamId);n&&(n.info.attributes=Object.assign(Object.assign({},n.info.attributes),e.attributes),n.controller.close(),this.byteStreamControllers.delete(e.streamId))}selectDefaultDevices(){return tv(this,void 0,void 0,function*(){var e,t,n;const i=rk.getInstance().previousDevices,r=yield rk.getInstance().getDevices(void 0,!1),s=Ly();if("Chrome"===(null===s||void 0===s?void 0:s.name)&&"iOS"!==s.os)for(let a of r){const e=i.find(e=>e.deviceId===a.deviceId);e&&""!==e.label&&e.kind===a.kind&&e.label!==a.label&&"default"===this.getActiveDevice(a.kind)&&this.emit(Ty.ActiveDeviceChanged,a.kind,a.deviceId)}const o=["audiooutput","audioinput","videoinput"];for(let a of o){const s=Gb(a),o=this.localParticipant.getTrackPublication(s);if(o&&(null===(e=o.track)||void 0===e?void 0:e.isUserProvided))continue;const c=r.filter(e=>e.kind===a),l=this.getActiveDevice(a);l===(null===(t=i.filter(e=>e.kind===a)[0])||void 0===t?void 0:t.deviceId)&&c.length>0&&(null===(n=c[0])||void 0===n?void 0:n.deviceId)!==l?yield this.switchActiveDevice(a,c[0].deviceId):"audioinput"===a&&!ub()||"videoinput"===a||!(c.length>0)||c.find(e=>e.deviceId===this.getActiveDevice(a))||"audiooutput"===a&&ub()||(yield this.switchActiveDevice(a,c[0].deviceId))}})}acquireAudioContext(){return tv(this,void 0,void 0,function*(){var e,t;if("boolean"!==typeof this.options.webAudioMix&&this.options.webAudioMix.audioContext?this.audioContext=this.options.webAudioMix.audioContext:this.audioContext&&"closed"!==this.audioContext.state||(this.audioContext=null!==(e=$b())&&void 0!==e?e:void 0),this.options.webAudioMix&&this.remoteParticipants.forEach(e=>e.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext),this.audioContext&&"suspended"===this.audioContext.state)try{yield Promise.race([this.audioContext.resume(),ib(200)])}catch(r){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:r}))}const n="running"===(null===(t=this.audioContext)||void 0===t?void 0:t.state);n!==this.canPlaybackAudio&&(this.audioEnabled=n,this.emit(Ty.AudioPlaybackStatusChanged,n))})}createParticipant(e,t){var n;let i;return i=t?Bw.fromParticipantInfo(this.engine.client,t,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}):new Bw(this.engine.client,"",e,void 0,void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.webAudioMix&&i.setAudioContext(this.audioContext),(null===(n=this.options.audioOutput)||void 0===n?void 0:n.deviceId)&&i.setAudioOutput(this.options.audioOutput).catch(e=>this.log.warn("Could not set audio output: ".concat(e.message),this.logContext)),i}getOrCreateParticipant(e,t){if(this.remoteParticipants.has(e)){const n=this.remoteParticipants.get(e);if(t){n.updateInfo(t)&&this.sidToIdentity.set(t.sid,t.identity)}return n}const n=this.createParticipant(e,t);return this.remoteParticipants.set(e,n),this.sidToIdentity.set(t.sid,t.identity),this.emitWhenConnected(Ty.ParticipantConnected,n),n.on(Cy.TrackPublished,e=>{this.emitWhenConnected(Ty.TrackPublished,e,n)}).on(Cy.TrackSubscribed,(e,t)=>{e.kind===Hy.Kind.Audio?(e.on(Ey.AudioPlaybackStarted,this.handleAudioPlaybackStarted),e.on(Ey.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):e.kind===Hy.Kind.Video&&(e.on(Ey.VideoPlaybackFailed,this.handleVideoPlaybackFailed),e.on(Ey.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(Ty.TrackSubscribed,e,t,n)}).on(Cy.TrackUnpublished,e=>{this.emit(Ty.TrackUnpublished,e,n)}).on(Cy.TrackUnsubscribed,(e,t)=>{this.emit(Ty.TrackUnsubscribed,e,t,n)}).on(Cy.TrackMuted,e=>{this.emitWhenConnected(Ty.TrackMuted,e,n)}).on(Cy.TrackUnmuted,e=>{this.emitWhenConnected(Ty.TrackUnmuted,e,n)}).on(Cy.ParticipantMetadataChanged,e=>{this.emitWhenConnected(Ty.ParticipantMetadataChanged,e,n)}).on(Cy.ParticipantNameChanged,e=>{this.emitWhenConnected(Ty.ParticipantNameChanged,e,n)}).on(Cy.AttributesChanged,e=>{this.emitWhenConnected(Ty.ParticipantAttributesChanged,e,n)}).on(Cy.ConnectionQualityChanged,e=>{this.emitWhenConnected(Ty.ConnectionQualityChanged,e,n)}).on(Cy.ParticipantPermissionsChanged,e=>{this.emitWhenConnected(Ty.ParticipantPermissionsChanged,e,n)}).on(Cy.TrackSubscriptionStatusChanged,(e,t)=>{this.emitWhenConnected(Ty.TrackSubscriptionStatusChanged,e,t,n)}).on(Cy.TrackSubscriptionFailed,(e,t)=>{this.emit(Ty.TrackSubscriptionFailed,e,n,t)}).on(Cy.TrackSubscriptionPermissionChanged,(e,t)=>{this.emitWhenConnected(Ty.TrackSubscriptionPermissionChanged,e,t,n)}).on(Cy.Active,()=>{this.emitWhenConnected(Ty.ParticipantActive,n),n.kind===fm.AGENT&&this.localParticipant.setActiveAgent(n)}),t&&n.updateInfo(t),n}sendSyncState(){const e=Array.from(this.remoteParticipants.values()).reduce((e,t)=>(e.push(...t.getTrackPublications()),e),[]),t=this.localParticipant.getTrackPublications();this.engine.sendSyncState(e,t)}updateSubscriptions(){for(const e of this.remoteParticipants.values())for(const t of e.videoTrackPublications.values())t.isSubscribed&&Vb(t)&&t.emitTrackUpdate()}getRemoteParticipantBySid(e){const t=this.sidToIdentity.get(e);if(t)return this.remoteParticipants.get(t)}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=Vy.setInterval(()=>{this.engine&&!this.engine.isClosed&&this.engine.verifyTransport()?e=0:(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:this.engine?{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}:void 0})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,sm.STATE_MISMATCH)))},4e3)}clearConnectionReconcile(){this.connectionReconcileInterval&&Vy.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e!==this.state&&(this.state=e,this.emit(Ty.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[t,n]=e;this.emit(t,...n)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(this.state===Vw.Reconnecting||this.isResuming||!this.engine||this.engine.pendingReconnect)this.bufferedEvents.push([e,n]);else if(this.state===Vw.Connected)return this.emit(e,...n);return!1}simulateParticipants(e){return tv(this,void 0,void 0,function*(){var t,n;const i=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),r=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new lm({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:Mp.parse((new Date).getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new hm({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(Ty.SignalConnected),this.emit(Ty.Connected),this.setAndEmitConnectionState(Vw.Connected),i.video){const e=new Iw(Hy.Kind.Video,new ym({source:tm.CAMERA,sid:Math.floor(1e4*Math.random()).toString(),type:em.AUDIO,name:"video-dummy"}),new lw(i.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:Pb(160*(null!==(t=r.aspectRatios[0])&&void 0!==t?t:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(e),this.localParticipant.emit(Cy.LocalTrackPublished,e)}if(i.audio){const e=new Iw(Hy.Kind.Audio,new ym({source:tm.MICROPHONE,sid:Math.floor(1e4*Math.random()).toString(),type:em.AUDIO}),new Yk(i.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:Rb(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(e),this.localParticipant.emit(Cy.LocalTrackPublished,e)}for(let e=0;e<r.count-1;e+=1){let t=new hm({sid:Math.floor(1e4*Math.random()).toString(),identity:"simulated-".concat(e),state:pm.ACTIVE,tracks:[],joinedAt:Mp.parse(Date.now())});const i=this.getOrCreateParticipant(t.identity,t);if(r.video){const s=Pb(160*(null!==(n=r.aspectRatios[e%r.aspectRatios.length])&&void 0!==n?n:1),160,!1,!0),o=new ym({source:tm.CAMERA,sid:Math.floor(1e4*Math.random()).toString(),type:em.AUDIO});i.addSubscribedMediaTrack(s,o.sid,new MediaStream([s]),new RTCRtpReceiver),t.tracks=[...t.tracks,o]}if(r.audio){const e=Rb(),n=new ym({source:tm.MICROPHONE,sid:Math.floor(1e4*Math.random()).toString(),type:em.AUDIO});i.addSubscribedMediaTrack(e,n.sid,new MediaStream([e]),new RTCRtpReceiver),t.tracks=[...t.tracks,n]}i.updateInfo(t)}})}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(e!==Ty.ActiveSpeakersChanged&&e!==Ty.TranscriptionReceived){const t=zw(n).filter(e=>void 0!==e);this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:t}))}return super.emit(e,...n)}}function zw(e){return e.map(e=>{if(e)return Array.isArray(e)?zw(e):"object"===typeof e?"logContext"in e?e.logContext:void 0:e})}qw.cleanupRegistry="undefined"!==typeof FinalizationRegistry&&new FinalizationRegistry(e=>{e()});var Hw;!function(e){e[e.IDLE=0]="IDLE",e[e.RUNNING=1]="RUNNING",e[e.SKIPPED=2]="SKIPPED",e[e.SUCCESS=3]="SUCCESS",e[e.FAILED=4]="FAILED"}(Hw||(Hw={}));ov.EventEmitter;ov.EventEmitter;new Map([["obs virtual camera",{facingMode:"environment",confidence:"medium"}]]),new Map([["iphone",{facingMode:"environment",confidence:"medium"}],["ipad",{facingMode:"environment",confidence:"medium"}]]);var Ww=__webpack_require__(4412),Kw=function(e,t){return Kw=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},Kw(e,t)};function $w(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}Kw(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var Gw=function(){return Gw=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Gw.apply(this,arguments)};function Qw(e,t,n,i){return new(n||(n=Promise))(function(s,o){function a(e){try{l(i.next(e))}catch(r){o(r)}}function c(e){try{l(i.throw(e))}catch(r){o(r)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,c)}l((i=i.apply(e,t||[])).next())})}function Jw(e,t){var n,i,s,o,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(a=0)),a;)try{if(n=1,i&&(s=2&c[0]?i.return:c[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,c[1])).done)return s;switch(i=0,s&&(c=[2&c[0],s.value]),c[0]){case 0:case 1:s=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,i=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(s=(s=a.trys).length>0&&s[s.length-1])&&(6===c[0]||2===c[0])){a=0;continue}if(3===c[0]&&(!s||c[1]>s[0]&&c[1]<s[3])){a.label=c[1];break}if(6===c[0]&&a.label<s[1]){a.label=s[1],s=c;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(c);break}s[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(r){c=[6,r],i=0}finally{n=s=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}}"function"===typeof SuppressedError&&SuppressedError;var Yw,Xw={options:{syntax:"proto3"},nested:{pipecat:{nested:{TextFrame:{fields:{id:{type:"uint64",id:1},name:{type:"string",id:2},text:{type:"string",id:3}}},AudioRawFrame:{fields:{id:{type:"uint64",id:1},name:{type:"string",id:2},audio:{type:"bytes",id:3},sampleRate:{type:"uint32",id:4},numChannels:{type:"uint32",id:5}}},TranscriptionFrame:{fields:{id:{type:"uint64",id:1},name:{type:"string",id:2},text:{type:"string",id:3},userId:{type:"string",id:4},timestamp:{type:"string",id:5}}},Frame:{oneofs:{frame:{oneof:["text","audio","transcription"]}},fields:{text:{type:"TextFrame",id:1},audio:{type:"AudioRawFrame",id:2},transcription:{type:"TranscriptionFrame",id:3}}}}}}};!function(e){e.UNKNOWN="UNKNOWN",e.GOOD="GOOD",e.BAD="BAD"}(Yw||(Yw={}));var Zw=function(){function e(e){this._connectionQuality=Yw.UNKNOWN,this.onConnectionQualityChanged=e}return Object.defineProperty(e.prototype,"connectionQuality",{get:function(){return this._connectionQuality},enumerable:!1,configurable:!0}),e.prototype.handleStatsChanged=function(){var e=this.calculateConnectionQuality();e!==this._connectionQuality&&(this._connectionQuality=e,this.onConnectionQualityChanged(e))},e.prototype.start=function(e){this.stop(!0),this._start(e)},e.prototype.stop=function(e){void 0===e&&(e=!1),this._stop(),this._connectionQuality=Yw.UNKNOWN,e||this.onConnectionQualityChanged(Yw.UNKNOWN)},e}();var eS,tS,nS,iS,rS=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.room=null,t.liveKitConnectionQuality=Mw.Unknown,t.liveKitConnectionState=null,t.handleConnectionQualityChanged=function(e){t.liveKitConnectionQuality=e,t.handleStatsChanged()},t.handleConnectionStateChanged=function(e){t.liveKitConnectionState=e,t.handleStatsChanged()},t}return $w(t,e),t.prototype._start=function(e){this.room=e,this.room.localParticipant.on(Cy.ConnectionQualityChanged,this.handleConnectionQualityChanged),this.room.on(Ty.ConnectionStateChanged,this.handleConnectionStateChanged)},t.prototype._stop=function(){this.room&&(this.room.localParticipant.off(Ty.ConnectionQualityChanged,this.handleConnectionQualityChanged),this.room.off(Ty.ConnectionStateChanged,this.handleConnectionStateChanged))},t.prototype.calculateConnectionQuality=function(){return[Mw.Lost,Mw.Poor].includes(this.liveKitConnectionQuality)||this.liveKitConnectionState&&[Vw.Disconnected,Vw.Reconnecting,Vw.SignalReconnecting].includes(this.liveKitConnectionState)?Yw.BAD:Yw.GOOD},t}(Zw);function sS(){}function oS(){oS.init.call(this)}function aS(e){return void 0===e._maxListeners?oS.defaultMaxListeners:e._maxListeners}function cS(e,t,n,i){var r,s,o,a;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((s=e._events)?(s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),o=s[t]):(s=e._events=new sS,e._eventsCount=0),o){if("function"==typeof o?o=s[t]=i?[n,o]:[o,n]:i?o.unshift(n):o.push(n),!o.warned&&(r=aS(e))&&r>0&&o.length>r){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=o.length,a=c,"function"==typeof console.warn?console.warn(a):console.log(a)}}else o=s[t]=n,++e._eventsCount;return e}function lS(e,t,n){var i=!1;function r(){e.removeListener(t,r),i||(i=!0,n.apply(e,arguments))}return r.listener=n,r}function uS(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function dS(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}sS.prototype=Object.create(null),oS.EventEmitter=oS,oS.usingDomains=!1,oS.prototype.domain=void 0,oS.prototype._events=void 0,oS.prototype._maxListeners=void 0,oS.defaultMaxListeners=10,oS.init=function(){this.domain=null,oS.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new sS,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},oS.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},oS.prototype.getMaxListeners=function(){return aS(this)},oS.prototype.emit=function(e){var t,n,i,r,s,o,a,c="error"===e;if(o=this._events)c=c&&null==o.error;else if(!c)return!1;if(a=this.domain,c){if(t=arguments[1],!a){if(t instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=a,t.domainThrown=!1,a.emit("error",t),!1}if(!(n=o[e]))return!1;var u="function"==typeof n;switch(i=arguments.length){case 1:!function(e,t,n){if(t)e.call(n);else for(var i=e.length,r=dS(e,i),s=0;s<i;++s)r[s].call(n)}(n,u,this);break;case 2:!function(e,t,n,i){if(t)e.call(n,i);else for(var r=e.length,s=dS(e,r),o=0;o<r;++o)s[o].call(n,i)}(n,u,this,arguments[1]);break;case 3:!function(e,t,n,i,r){if(t)e.call(n,i,r);else for(var s=e.length,o=dS(e,s),a=0;a<s;++a)o[a].call(n,i,r)}(n,u,this,arguments[1],arguments[2]);break;case 4:!function(e,t,n,i,r,s){if(t)e.call(n,i,r,s);else for(var o=e.length,a=dS(e,o),c=0;c<o;++c)a[c].call(n,i,r,s)}(n,u,this,arguments[1],arguments[2],arguments[3]);break;default:for(r=new Array(i-1),s=1;s<i;s++)r[s-1]=arguments[s];!function(e,t,n,i){if(t)e.apply(n,i);else for(var r=e.length,s=dS(e,r),o=0;o<r;++o)s[o].apply(n,i)}(n,u,this,r)}return!0},oS.prototype.addListener=function(e,t){return cS(this,e,t,!1)},oS.prototype.on=oS.prototype.addListener,oS.prototype.prependListener=function(e,t){return cS(this,e,t,!0)},oS.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,lS(this,e,t)),this},oS.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,lS(this,e,t)),this},oS.prototype.removeListener=function(e,t){var n,i,r,s,o;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(i=this._events))return this;if(!(n=i[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new sS:(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(r=-1,s=n.length;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){o=n[s].listener,r=s;break}if(r<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new sS,this;delete i[e]}else!function(e,t){for(var n=t,i=n+1,r=e.length;i<r;n+=1,i+=1)e[n]=e[i];e.pop()}(n,r);i.removeListener&&this.emit("removeListener",e,o||t)}return this},oS.prototype.off=function(e,t){return this.removeListener(e,t)},oS.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new sS,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new sS:delete n[e]),this;if(0===arguments.length){for(var i,r=Object.keys(n),s=0;s<r.length;++s)"removeListener"!==(i=r[s])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=new sS,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},oS.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},oS.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):uS.call(e,t)},oS.prototype.listenerCount=uS,oS.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};class hS extends oS{}!function(e){e.Issue="issue",e.NetworkScoresUpdated="network-scores-updated",e.StatsParsingFinished="stats-parsing-finished"}(eS||(eS={})),function(e){e.Network="network",e.CPU="cpu",e.Server="server",e.Stream="stream"}(tS||(tS={})),function(e){e.OutboundNetworkQuality="outbound-network-quality",e.InboundNetworkQuality="inbound-network-quality",e.OutboundNetworkMediaLatency="outbound-network-media-latency",e.InboundNetworkMediaLatency="inbound-network-media-latency",e.NetworkMediaSyncFailure="network-media-sync-failure",e.OutboundNetworkThroughput="outbound-network-throughput",e.InboundNetworkThroughput="inbound-network-throughput",e.EncoderCPUThrottling="encoder-cpu-throttling",e.DecoderCPUThrottling="decoder-cpu-throttling",e.ServerIssue="server-issue",e.UnknownVideoDecoderIssue="unknown-video-decoder",e.LowInboundMOS="low-inbound-mean-opinion-score",e.LowOutboundMOS="low-outbound-mean-opinion-score",e.FrozenVideoTrack="frozen-video-track",e.MissingVideoStreamData="missing-video-stream-data",e.MissingAudioStreamData="missing-audio-stream-data"}(nS||(nS={})),function(e){e[e.BAD=2.1]="BAD",e[e.POOR=2.6]="POOR",e[e.FAIR=3.1]="FAIR",e[e.GOOD=3.8]="GOOD",e[e.EXCELLENT=4.3]="EXCELLENT"}(iS||(iS={}));class pS extends oS{static STATS_REPORT_READY_EVENT="stats-report-ready";static STATS_REPORTS_PARSED="stats-reports-parsed";isStopped=!1;reportTimer;getStatsInterval;compositeStatsParser;constructor(e){super(),this.compositeStatsParser=e.compositeStatsParser,this.getStatsInterval=e.getStatsInterval??1e4}get isRunning(){return!!this.reportTimer&&!this.isStopped}startReporting(){if(this.reportTimer)return;const e=()=>setTimeout(()=>{this.isStopped?this.reportTimer=void 0:this.parseReports().finally(()=>{this.reportTimer=e()})},this.getStatsInterval);this.isStopped=!1,this.reportTimer=e()}stopReporting(){this.isStopped=!0,this.reportTimer&&(clearTimeout(this.reportTimer),this.reportTimer=void 0)}async parseReports(){const e=Date.now(),t=await this.compositeStatsParser.parse(),n=Date.now()-e;this.emit(pS.STATS_REPORTS_PARSED,{timeTaken:n,reportItems:t}),t.forEach(e=>{this.emit(pS.STATS_REPORT_READY_EVENT,e)})}}const fS=(()=>{const e=new Map;return t=>{const{taskId:n,delayMs:i,maxJitterMs:r,callback:s}=t,o=Math.ceil(Math.random()*(r||0)),a=e.get(n);a&&clearTimeout(a);const c=setTimeout(()=>{s(),e.delete(n)},i+o);e.set(n,c)}})();class mS{#e={};calculate(e){const{connection:{id:t}}=e,{mos:n,stats:i}=this.calculateOutboundScore(e)||{},{mos:r,stats:s}=this.calculateInboundScore(e)||{};return this.#e[t]=e,fS({taskId:t,delayMs:35e3,callback:()=>delete this.#e[t]}),{outbound:n,inbound:r,connectionId:t,statsSamples:{inboundStatsSample:s,outboundStatsSample:i}}}calculateOutboundScore(e){const t=[...e.remote?.audio.inbound||[],...e.remote?.video.inbound||[]];if(!t.length)return;const n=this.#e[e.connection.id];if(!n)return;const i=[...n.remote?.audio.inbound||[],...n.remote?.video.inbound||[]],{packetsSent:r}=e.connection,s=n.connection.packetsSent,o=t.reduce((e,t)=>{const n=i.find(e=>e.ssrc===t.ssrc);return{sumJitter:e.sumJitter+t.jitter,packetsLost:e.packetsLost+t.packetsLost,lastPacketsLost:e.lastPacketsLost+(n?.packetsLost||0)}},{sumJitter:0,packetsLost:0,lastPacketsLost:0}),a=1e3*e.connection.currentRoundTripTime||0,{sumJitter:c}=o,l=c/t.length,u=r-s,d=o.packetsLost-o.lastPacketsLost,h=u&&d?Math.round(100*d/(u+d)):0;return{mos:this.calculateMOS({avgJitter:l,rtt:a,packetsLoss:h}),stats:{avgJitter:l,rtt:a,packetsLoss:h}}}calculateInboundScore(e){const t=[...e.audio?.inbound,...e.video?.inbound];if(!t.length)return;const n=this.#e[e.connection.id];if(!n)return;const i=[...n.video?.inbound,...n.audio?.inbound],{packetsReceived:r}=e.connection,s=n.connection.packetsReceived,o=t.reduce((e,t)=>{const n=i.find(e=>e.ssrc===t.ssrc);return{sumJitter:e.sumJitter+t.jitter,packetsLost:e.packetsLost+t.packetsLost,lastPacketsLost:e.lastPacketsLost+(n?.packetsLost||0)}},{sumJitter:0,packetsLost:0,lastPacketsLost:0}),a=1e3*e.connection.currentRoundTripTime||0,{sumJitter:c}=o,l=c/t.length,u=r-s,d=o.packetsLost-o.lastPacketsLost,h=u&&d?Math.round(100*d/(u+d)):0;return{mos:this.calculateMOS({avgJitter:l,rtt:a,packetsLoss:h}),stats:{avgJitter:l,rtt:a,packetsLoss:h}}}calculateMOS(e){let{avgJitter:t,rtt:n,packetsLoss:i}=e;const r=n+2*t+10;let s=r<160?93.2-r/40:93.2-r/120-10;return s-=2.5*i,1+.035*s+7e-6*s*(s-60)*(100-s)}}class gS{#t=(()=>new Map)();#n;#i;constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.#n=e.statsCleanupTtlMs??35e3,this.#i=e.maxParsedStatsStorageSize??5}detect(e,t){const n={...e,networkScores:{...t,statsSamples:t?.statsSamples||{}}},i=this.performDetection(n);return this.setLastProcessedStats(e.connection.id,n),this.performPrevStatsCleanup({connectionId:e.connection.id}),i}performPrevStatsCleanup(e){const{connectionId:t,cleanupCallback:n}=e;this.#t.has(t)&&fS({taskId:t,delayMs:this.#n,callback:()=>{this.deleteLastProcessedStats(t),"function"==typeof n&&n()}})}setLastProcessedStats(e,t){if(!e||t.connection.id!==e)return;const n=this.#t.get(e)??[];n.push(t),n.length>this.#i&&n.shift(),this.#t.set(e,n)}getLastProcessedStats(e){const t=this.#t.get(e);return t?.[t.length-1]}getAllLastProcessedStats(e){return this.#t.get(e)??[]}deleteLastProcessedStats(e){this.#t.delete(e)}}class vS extends gS{#r;constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),this.#r=e.availableOutgoingBitrateThreshold??1e5}performDetection(e){const t=[],{availableOutgoingBitrate:n}=e.connection;if(void 0===n)return t;const i=e.audio.outbound.reduce((e,t)=>e+t.targetBitrate,0),r=e.video.outbound.reduce((e,t)=>e+t.bitrate,0);if(!i&&!r)return t;const s={availableOutgoingBitrate:n,videoStreamsTotalBitrate:r,audioStreamsTotalTargetBitrate:i};return i>n||r>0&&n<this.#r?(t.push({statsSample:s,type:tS.Network,reason:nS.OutboundNetworkThroughput}),t):t}}class yS extends gS{#s;#o;#a;#c;constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this.#s=e.highPacketLossThresholdPct??5,this.#o=e.highJitterThreshold??200,this.#a=e.highJitterBufferDelayThresholdMs??500,this.#c=e.highRttThresholdMs??250}performDetection(e){return this.processData(e)}processData(e){const t=[],n=[...e.audio?.inbound,...e.video?.inbound];if(!n.length)return t;const i=this.getLastProcessedStats(e.connection.id);if(!i)return t;const r=[...i.video?.inbound,...i.audio?.inbound],{packetsReceived:s}=e.connection,o=i.connection.packetsReceived,a=n.reduce((e,t)=>{const n=r.find(e=>e.ssrc===t.ssrc),i=n?.jitterBufferDelay||0,s=n?.jitterBufferEmittedCount||0,o=t.jitterBufferDelay-i,a=t.jitterBufferEmittedCount-s,c=o&&a?1e3*o/a:0;return{sumJitter:e.sumJitter+t.jitter,sumJitterBufferDelayMs:e.sumJitterBufferDelayMs+c,packetsLost:e.packetsLost+t.packetsLost,lastPacketsLost:e.lastPacketsLost+(n?.packetsLost||0)}},{sumJitter:0,sumJitterBufferDelayMs:0,packetsLost:0,lastPacketsLost:0}),c=1e3*e.connection.currentRoundTripTime||0,{sumJitter:l,sumJitterBufferDelayMs:u}=a,d=l/n.length,h=u/n.length,p=s-o,f=a.packetsLost-a.lastPacketsLost,m=p&&f?Math.round(100*f/(p+f)):0,g=m>this.#s,v=d>=this.#o,y=c>=this.#c,b=h>this.#a,k=y&&!v&&!g,w=g&&v,S=v&&b,T={rtt:c,packetLossPct:m,avgJitter:d,avgJitterBufferDelay:h};return(v||g)&&t.push({statsSample:T,type:tS.Network,reason:nS.InboundNetworkQuality,iceCandidate:e.connection.local.id}),k&&t.push({statsSample:T,type:tS.Server,reason:nS.ServerIssue,iceCandidate:e.connection.remote.id}),w&&t.push({statsSample:T,type:tS.Network,reason:nS.InboundNetworkMediaLatency,iceCandidate:e.connection.local.id}),S&&t.push({statsSample:T,type:tS.Network,reason:nS.NetworkMediaSyncFailure,iceCandidate:e.connection.local.id}),t}}class bS extends gS{#l;constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this.#l=e.correctedSamplesThresholdPct??5}performDetection(e){return this.processData(e)}processData(e){const t=e.audio.inbound,n=[],i=this.getLastProcessedStats(e.connection.id)?.audio.inbound;return i?(t.forEach(e=>{const t=i.find(t=>t.ssrc===e.ssrc);if(!t)return;const r=e.track.insertedSamplesForDeceleration+e.track.removedSamplesForAcceleration,s=t.track.insertedSamplesForDeceleration+t.track.removedSamplesForAcceleration;if(r===s)return;const o=e.track.totalSamplesReceived-t.track.totalSamplesReceived,a=r-s,c=Math.round(100*a/o),l={correctedSamplesPct:c};c>this.#l&&n.push({statsSample:l,type:tS.Network,reason:nS.NetworkMediaSyncFailure,ssrc:e.ssrc})}),n):n}}class kS extends gS{#s;#o;constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this.#s=e.highPacketLossThresholdPct??5,this.#o=e.highJitterThreshold??200}performDetection(e){return this.processData(e)}processData(e){const t=[],n=[...e.remote?.audio.inbound||[],...e.remote?.video.inbound||[]];if(!n.length)return t;const i=this.getLastProcessedStats(e.connection.id);if(!i)return t;const r=[...i.remote?.audio.inbound||[],...i.remote?.video.inbound||[]],{packetsSent:s}=e.connection,o=i.connection.packetsSent,a=n.reduce((e,t)=>{const n=r.find(e=>e.ssrc===t.ssrc);return{sumJitter:e.sumJitter+t.jitter,packetsLost:e.packetsLost+t.packetsLost,lastPacketsLost:e.lastPacketsLost+(n?.packetsLost||0)}},{sumJitter:0,packetsLost:0,lastPacketsLost:0}),c=1e3*e.connection.currentRoundTripTime||0,{sumJitter:l}=a,u=l/n.length,d=s-o,h=a.packetsLost-a.lastPacketsLost,p=d&&h?Math.round(100*h/(d+h)):0,f=p>this.#s,m=u>=this.#o,g=!f&&m||m||f,v={rtt:c,avgJitter:u,packetLossPct:p};return f&&m&&t.push({statsSample:v,type:tS.Network,reason:nS.OutboundNetworkMediaLatency,iceCandidate:e.connection.local.id}),g&&t.push({statsSample:v,type:tS.Network,reason:nS.OutboundNetworkQuality,iceCandidate:e.connection.local.id}),t}}class wS extends gS{performDetection(e){return this.processData(e)}processData(e){const t=e.video.outbound.filter(e=>"none"!==e.qualityLimitationReason),n=[],i=this.getLastProcessedStats(e.connection.id)?.video.outbound;return i?(t.forEach(e=>{const t=i.find(t=>t.ssrc===e.ssrc);if(!t)return;const r={qualityLimitationReason:e.qualityLimitationReason};e.framesSent>t.framesSent||("cpu"===e.qualityLimitationReason&&n.push({statsSample:r,type:tS.CPU,reason:nS.EncoderCPUThrottling,ssrc:e.ssrc}),"bandwidth"===e.qualityLimitationReason&&n.push({statsSample:r,type:tS.Network,reason:nS.OutboundNetworkThroughput,ssrc:e.ssrc}))}),n):n}}class SS extends gS{UNKNOWN_DECODER="unknown";#u={};performDetection(e){return this.processData(e)}performPrevStatsCleanup(e){const{connectionId:t,cleanupCallback:n}=e;super.performPrevStatsCleanup({...e,cleanupCallback:()=>{delete this.#u[t],"function"==typeof n&&n()}})}processData(e){const t=[],{id:n}=e.connection,i=this.getLastProcessedStats(n)?.video.inbound;return e.video.inbound.forEach(e=>{const{decoderImplementation:r,ssrc:s}=e,o=i?.find(e=>e.ssrc===s);if(o)if(r===this.UNKNOWN_DECODER){if(!this.hadLastDecoderWithIssue(n,s)){this.setLastDecoderWithIssue(n,s,this.UNKNOWN_DECODER);const i={mimeType:e.mimeType,decoderImplementation:r};t.push({ssrc:s,statsSample:i,type:tS.Stream,reason:nS.UnknownVideoDecoderIssue,trackIdentifier:e.track.trackIdentifier})}}else this.setLastDecoderWithIssue(n,s,void 0)}),t}setLastDecoderWithIssue(e,t,n){const i=this.#u[e]??{};void 0===n?delete i[t]:i[t]=n,this.#u[e]=i}hadLastDecoderWithIssue(e,t){const n=this.#u[e];return(n&&n[t])===this.UNKNOWN_DECODER}}const TS=e=>e.reduce((e,t)=>e+t,0)/e.length,CS=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30;const i=[];for(let r=1;r<t.length-1;r+=1){const n=t[r]?.video?.inbound.find(t=>t.ssrc===e);if(!n)continue;const s=t[r-1]?.video?.inbound?.find(t=>t.ssrc===e);if(!n||!s)continue;const o=n.timestamp-s.timestamp,a=n.framesDecoded-s.framesDecoded;if(a>0){const e=o/a;i.push(e)}}return!(i.length<=1)&&(e=>{const t=((e,t)=>t.reduce((t,n)=>t+(n-e)**2,0)/t.length)(TS(e),e);return Math.sqrt(t)})(i)>n},xS=(e,t)=>{for(let n=1;n<t.length;n+=1){const i=t[n].video.inbound.find(t=>t.ssrc===e);if(!i)continue;const r=t[n-1].video.inbound.find(t=>t.ssrc===e),s=i.frameWidth!==r?.frameWidth,o=i.frameHeight!==r?.frameHeight;if(s||o)return!0}return!1};class ES extends gS{#d;#h;#p;constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this.#d=e.avgFreezeDurationThresholdMs??1e3,this.#h=e.frozenDurationThresholdPct??30,this.#p=e.minMosQuality??iS.BAD}performDetection(e){const t=e.networkScores.inbound;return void 0!==t&&t<=this.#p?[]:this.processData(e)}processData(e){const t=[],n=this.getAllLastProcessedStats(e.connection.id);if(0===n.length)return[];const i=e.video.inbound.map(t=>{const i=n[n.length-1].video.inbound.find(e=>e.ssrc===t.ssrc);if(!i)return;if(xS(t.ssrc,[n[n.length-1],e]))return;if(CS(t.ssrc,n))return;const r=t.freezeCount-(i.freezeCount??0),s=1e3*(t.totalFreezesDuration-(i.totalFreezesDuration??0)),o=r>0?s/r:0,a=s/(t.timestamp-i.timestamp)*100;return a>this.#h||o>this.#d?{ssrc:t.ssrc,avgFreezeDurationMs:o,frozenDurationPct:a}:void 0}).filter(e=>void 0!==e);return i.length>0&&(t.push({type:tS.Stream,reason:nS.FrozenVideoTrack,statsSample:{ssrcs:i.map(e=>e.ssrc)}}),this.deleteLastProcessedStats(e.connection.id)),t}}class PS extends gS{#f;#m;#p;constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),this.#f=e.volatilityThreshold??8,this.#m=e.affectedStreamsPercentThreshold??30,this.#p=e.minMosQuality??iS.BAD}performDetection(e){return[...this.getAllLastProcessedStats(e.connection.id),e].find(e=>void 0!==e.networkScores.inbound&&e.networkScores.inbound<=this.#p)?[]:this.processData(e)}processData(e){const t=[],n=[...this.getAllLastProcessedStats(e.connection.id),e],i=e.video.inbound.map(e=>{if(n.length<5)return;if(xS(e.ssrc,n))return;const t=[];for(let r=0;r<n.length-1;r+=1){const i=n[r].video.inbound.find(t=>t.ssrc===e.ssrc);void 0!==i?.framesPerSecond&&t.push(i.framesPerSecond)}if(t.length<5)return;if(CS(e.ssrc,n))return;const i=(e=>{if(0===e.length)throw new Error("Cannot calculate volatility for empty array");const t=TS(e);return e.reduce((e,n)=>e+Math.abs(n-t),0)/e.length*100/t})(t);return i>this.#f?{ssrc:e.ssrc,allFps:t,volatility:i}:void 0}).filter(e=>Boolean(e));if(0===i.length)return t;const r=i.length/(e.video.inbound.length/100);return r>this.#m&&(t.push({type:tS.CPU,reason:nS.DecoderCPUThrottling,statsSample:{affectedStreamsPercent:r,throtthedStreams:i}}),this.deleteLastProcessedStats(e.connection.id)),t}}const RS=e=>"closed"===e.iceConnectionState||"closed"===e.connectionState,OS=(e,t,n)=>8*((e,t,n)=>{if(!t)return 0;const i=e[n],r=t[n];if(null==i||null==r)return 0;const s=Math.floor(e.timestamp)-Math.floor(t.timestamp);return 0===s?0:(Number(i)-Number(r))/s*1e3})(e,t,n);class _S{connections=[];statsParser;constructor(e){this.statsParser=e.statsParser}listConnections(){return[...this.connections]}addPeerConnection(e){this.connections.push({id:e.id??String(Date.now()+Math.random().toString(32)),pc:e.pc})}removePeerConnection(e){const t=this.connections.findIndex(t=>{let{pc:n}=t;return n===e.pc});t>=0&&this.removeConnectionsByIndexes([t])}async parse(){const e=[],t=this.connections.map(async(t,n)=>{if(!RS(t.pc))return this.statsParser.parse(t);e.unshift(n)});return e.length&&this.removeConnectionsByIndexes(e),(await Promise.all(t)).filter(e=>void 0!==e)}removeConnectionsByIndexes(e){e.forEach(e=>{this.connections.splice(e,1)})}}class NS{prevStats=(()=>new Map)();allowedReportTypes=(()=>new Set(["candidate-pair","inbound-rtp","outbound-rtp","remote-outbound-rtp","remote-inbound-rtp","track","transport"]))();ignoreSSRCList;logger;constructor(e){this.ignoreSSRCList=e.ignoreSSRCList??[],this.logger=e.logger}get previouslyParsedStatsConnectionsIds(){return[...this.prevStats.keys()]}async parse(e){if(!RS(e.pc))return this.getConnectionStats(e);this.logger.debug("Skip stats parsing. Connection is closed.",{connection:e})}async getConnectionStats(e){const{pc:t,id:n}=e;try{const i=Date.now(),r=t.getReceivers().filter(e=>e.track?.enabled),s=t.getSenders().filter(e=>e.track?.enabled),o=await Promise.all(r.map(e=>e.getStats())),a=await Promise.all(s.map(e=>e.getStats()));return{id:n,stats:this.mapReportsStats([...o,...a],e),timeTaken:Date.now()-i}}catch(e){return void this.logger.error("Failed to get stats for PC",{id:n,pc:t,error:e})}}mapReportsStats(e,t){const n={audio:{inbound:[],outbound:[]},video:{inbound:[],outbound:[]},connection:{},remote:{video:{inbound:[],outbound:[]},audio:{inbound:[],outbound:[]}}};e.forEach(e=>{e.forEach(t=>{this.allowedReportTypes.has(t.type)&&this.updateMappedStatsWithReportItemData(t,n,e)})});const{id:i}=t,r=this.prevStats.get(i);return r&&this.propagateStatsWithRateValues(n,r.stats),this.prevStats.set(i,{stats:n,ts:Date.now()}),fS({taskId:i,delayMs:35e3,callback:()=>this.prevStats.delete(i)}),n}updateMappedStatsWithReportItemData(e,t,n){const i=e.type;if("candidate-pair"===i&&"succeeded"===e.state&&e.nominated)return void(t.connection=this.prepareConnectionStats(e,n));const r=this.getMediaType(e);if(!r)return;const s=e.ssrc;if(!s||!this.ignoreSSRCList.includes(s))if("outbound-rtp"!==i)if("inbound-rtp"!==i)"remote-outbound-rtp"!==i?"remote-inbound-rtp"===i&&(this.mapConnectionStatsIfNecessary(t,e,n),t.remote[r].inbound.push({...e})):t.remote[r].outbound.push({...e});else{const i=n.get(e.trackId)||n.get(e.mediaSourceId)||{};this.mapConnectionStatsIfNecessary(t,e,n);const s={...e,track:{...i}};t[r].inbound.push(s)}else{const i=n.get(e.trackId)||n.get(e.mediaSourceId)||{},s={...e,track:{...i}};t[r].outbound.push(s)}}getMediaType(e){const t=e.mediaType||e.kind;if(!["audio","video"].includes(t)){const{id:t}=e;if(!t)return;return String(t).includes("Video")?"video":String(t).includes("Audio")?"audio":void 0}return t}propagateStatsWithRateValues(e,t){e.audio.inbound.forEach(e=>{const n=t.audio.inbound.find(t=>{let{id:n}=t;return n===e.id});e.bitrate=OS(e,n,"bytesReceived"),e.packetRate=OS(e,n,"packetsReceived")}),e.audio.outbound.forEach(e=>{const n=t.audio.outbound.find(t=>{let{id:n}=t;return n===e.id});e.bitrate=OS(e,n,"bytesSent"),e.packetRate=OS(e,n,"packetsSent")}),e.video.inbound.forEach(e=>{const n=t.video.inbound.find(t=>{let{id:n}=t;return n===e.id});e.bitrate=OS(e,n,"bytesReceived"),e.packetRate=OS(e,n,"packetsReceived")}),e.video.outbound.forEach(e=>{const n=t.video.outbound.find(t=>{let{id:n}=t;return n===e.id});e.bitrate=OS(e,n,"bytesSent"),e.packetRate=OS(e,n,"packetsSent")})}mapConnectionStatsIfNecessary(e,t,n){if(e.connection.id||!t.transportId)return;const i=n.get(t.transportId);if(i&&i.selectedCandidatePairId){const t=n.get(i.selectedCandidatePairId);e.connection=this.prepareConnectionStats(t,n)}}prepareConnectionStats(e,t){if(!e||!t)return{};const n={...e};if(n.remoteCandidateId){const e=t.get(n.remoteCandidateId);n.remote={...e}}if(n.localCandidateId){const e=t.get(n.localCandidateId);n.local={...e}}return n}}class AS extends gS{#g=(()=>new Map)();#v;#y;constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this.#v=e.timeoutMs??15e3,this.#y=e.steps??3}performDetection(e){return this.processData(e)}processData(e){const t=[],n=[...this.getAllLastProcessedStats(e.connection.id),e];if(n.length<this.#y)return t;const i=n.slice(-this.#y),r=i.map(e=>e.video.inbound),s=i.map(e=>e.audio.inbound);return t.push(...this.detectMissingData(s,tS.Stream,nS.MissingAudioStreamData)),t.push(...this.detectMissingData(r,tS.Stream,nS.MissingVideoStreamData)),new Set(this.#g.keys()).forEach(e=>{const t=this.#g.get(e);t&&Date.now()-t>this.#v&&this.removeMarkedIssue(e)}),t}detectMissingData(e,t,n){const i=[],r=e.pop(),s=AS.mapStatsByTrackId(e);return r.forEach(e=>{const r=e.track.trackIdentifier,o=s.get(r);if(!Array.isArray(o)||0===o.length)return;if(e.track.detached||e.track.ended)return;if(!AS.isAllBytesReceivedDidntChange(e.bytesReceived,o))return void this.removeMarkedIssue(r);if(!this.markIssue(r))return;const a={bytesReceived:e.bytesReceived};i.push({type:t,reason:n,statsSample:a,trackIdentifier:r})}),i}static mapStatsByTrackId(e){const t=new Map;return e.forEach(e=>{e.forEach(e=>{const n=t.get(e.track.trackIdentifier)||[];n.push(e),t.set(e.track.trackIdentifier,n)})}),t}static isAllBytesReceivedDidntChange(e,t){for(let n=0;n<t.length;n+=1)if(t[n].bytesReceived!==e)return!1;return!0}markIssue(e){const t=Date.now(),n=this.#g.get(e);return(!n||t-n>this.#v)&&(this.#g.set(e,t),!0)}removeMarkedIssue(e){this.#g.delete(e)}}class IS{eventEmitter;#b=!1;detectors=[];networkScoresCalculator;statsReporter;compositeStatsParser;logger;autoAddPeerConnections;constructor(e){this.logger=e.logger??{debug:()=>{},info:()=>{},warn:()=>{},error:()=>{}},this.eventEmitter=e.issueEmitter??new hS,e.onIssues&&this.eventEmitter.on(eS.Issue,e.onIssues),e.onNetworkScoresUpdated&&this.eventEmitter.on(eS.NetworkScoresUpdated,e.onNetworkScoresUpdated),this.detectors=e.detectors??[new wS,new yS,new kS,new bS,new vS,new SS,new ES,new PS,new AS],this.networkScoresCalculator=e.networkScoresCalculator??new mS,this.compositeStatsParser=e.compositeStatsParser??new _S({statsParser:new NS({ignoreSSRCList:e.ignoreSSRCList,logger:this.logger})}),this.statsReporter=e.statsReporter??new pS({compositeStatsParser:this.compositeStatsParser,getStatsInterval:e.getStatsInterval??5e3}),window.wid=this,this.autoAddPeerConnections=e.autoAddPeerConnections??!0,this.autoAddPeerConnections&&this.wrapRTCPeerConnection(),this.statsReporter.on(pS.STATS_REPORT_READY_EVENT,e=>{const t=this.calculateNetworkScores(e.stats);this.detectIssues({data:e.stats},t)}),this.statsReporter.on(pS.STATS_REPORTS_PARSED,t=>{const n={timeTaken:t.timeTaken,ts:Date.now()};e.onStats&&e.onStats(t.reportItems),this.eventEmitter.emit(eS.StatsParsingFinished,n)})}watchNewPeerConnections(){if(!this.autoAddPeerConnections)throw new Error("Auto add peer connections was disabled in the constructor.");this.#b?this.logger.warn("WebRTCIssueDetector is already started. Skip processing"):(this.logger.info("Start watching peer connections"),this.#b=!0,this.statsReporter.startReporting())}stopWatchingNewPeerConnections(){this.#b?(this.logger.info("Stop watching peer connections"),this.#b=!1,this.statsReporter.stopReporting()):this.logger.warn("WebRTCIssueDetector is already stopped. Skip processing")}handleNewPeerConnection(e,t){this.#b||!this.autoAddPeerConnections?(this.#b||!1!==this.autoAddPeerConnections||(this.logger.info("Starting stats reporting for new peer connection"),this.#b=!0,this.statsReporter.startReporting()),this.logger.debug("Handling new peer connection",e),this.compositeStatsParser.addPeerConnection({pc:e,id:t})):this.logger.debug("Skip handling new peer connection. Detector is not running",e)}emitIssues(e){this.eventEmitter.emit(eS.Issue,e)}detectIssues(e,t){let{data:n}=e;const i=this.detectors.reduce((e,i)=>[...e,...i.detect(n,t)],[]);i.length>0&&this.emitIssues(i)}calculateNetworkScores(e){const t=this.networkScoresCalculator.calculate(e);return this.eventEmitter.emit(eS.NetworkScoresUpdated,t),t}wrapRTCPeerConnection(){if(!window.RTCPeerConnection)return void this.logger.warn("No RTCPeerConnection found in browser window. Skipping");const e=window.RTCPeerConnection,t=e=>this.handleNewPeerConnection(e);function n(n){const i=new e(n);return t(i),i}n.prototype=e.prototype,window.RTCPeerConnection=n}}var jS,DS=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.issueDetector=null,t.mosScores=null,t}return $w(t,e),t.prototype._start=function(e){var t=this;this.issueDetector=new IS({autoAddPeerConnections:!1,getStatsInterval:3e3,onNetworkScoresUpdated:function(e){t.mosScores=e,t.handleStatsChanged()}}),this.issueDetector.handleNewPeerConnection(e)},t.prototype._stop=function(){this.issueDetector&&(this.issueDetector.stopWatchingNewPeerConnections(),this.issueDetector=null),this.mosScores=null},t.prototype.calculateConnectionQuality=function(){return!this.mosScores||this.mosScores.inbound&&this.mosScores.outbound?Yw.UNKNOWN:this.mosScores.inbound&&this.mosScores.inbound<3||this.mosScores.outbound&&this.mosScores.outbound<3?Yw.BAD:Yw.GOOD},t}(Zw);!function(e){e.INACTIVE="inactive",e.STARTING="starting",e.ACTIVE="started",e.STOPPING="stopping"}(jS||(jS={}));var MS=function(){},LS=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._isMuted=!0,t.state=jS.INACTIVE,t}return $w(t,e),Object.defineProperty(t.prototype,"isMuted",{get:function(){return this._isMuted},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isVoiceChatting",{get:function(){return this.state!==jS.INACTIVE},enumerable:!1,configurable:!0}),t.prototype.startVoiceChat=function(e){return Qw(this,void 0,void 0,function(){var t;return Jw(this,function(n){switch(n.label){case 0:return this.state===jS.INACTIVE?[3,2]:[4,this.stopVoiceChat()];case 1:n.sent(),n.label=2;case 2:return n.trys.push([2,4,,6]),this.state=jS.STARTING,[4,this._startVoiceChat(e)];case 3:return n.sent(),this.state=jS.ACTIVE,[3,6];case 4:return t=n.sent(),[4,this.stopVoiceChat()];case 5:throw n.sent(),t;case 6:return[2]}})})},t.prototype.stopVoiceChat=function(){return Qw(this,void 0,void 0,function(){return Jw(this,function(e){switch(e.label){case 0:return this.state===jS.INACTIVE?[2]:(this.state=jS.STOPPING,[4,this._stopVoiceChat()]);case 1:return e.sent(),this._isMuted=!0,this.state=jS.INACTIVE,[2]}})})},t.prototype._mute=function(){},t.prototype._unmute=function(){},t.prototype.mute=function(){this.isVoiceChatting&&(this._mute(),this._isMuted=!0)},t.prototype.unmute=function(){this.isVoiceChatting&&(this._unmute(),this._isMuted=!1)},t}(MS);function FS(e){return new Promise(function(t){return setTimeout(t,e)})}var US,BS=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.room=null,t.track=null,t}return $w(t,e),t.prototype._startVoiceChat=function(e){return Qw(this,void 0,void 0,function(){var t,n;return Jw(this,function(i){switch(i.label){case 0:return this.room=e.room,t=this,[4,Dw({echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0})];case 1:return t.track=i.sent(),[4,this.room.localParticipant.publishTrack(this.track)];case 2:return i.sent(),(null===(n=e.config)||void 0===n?void 0:n.defaultMuted)?this.mute():this.unmute(),[4,FS(4e3)];case 3:return i.sent(),[2]}})})},t.prototype._stopVoiceChat=function(){return Qw(this,void 0,void 0,function(){var e;return Jw(this,function(t){return(null===(e=this.room)||void 0===e?void 0:e.localParticipant)&&this.room.localParticipant.getTrackPublications().forEach(function(e){e.track&&e.track.kind===Hy.Kind.Audio&&e.track.stop()}),this.track&&(this.track.stop(),this.track=null),[2]})})},t.prototype._mute=function(){this.track&&!this.track.isMuted&&this.track.mute()},t.prototype._unmute=function(){this.track&&this.track.isMuted&&this.track.unmute()},t}(LS),VS=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.audioContext=null,t.webSocket=null,t.scriptProcessor=null,t.mediaStreamAudioSource=null,t.mediaDevicesStream=null,t.audioRawFrame=null,t}return $w(t,e),t.prototype._startVoiceChat=function(e){return Qw(this,void 0,void 0,function(){var t,n,i,r,s,o=this;return Jw(this,function(a){switch(a.label){case 0:if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Cannot start voice chat without media devices");return this.webSocket=e.webSocket,this.audioRawFrame=e.audioRawFrame,this.audioContext=new window.AudioContext({latencyHint:"interactive",sampleRate:16e3}),(null===(n=e.config)||void 0===n?void 0:n.defaultMuted)||this.unmute(),[4,navigator.mediaDevices.getUserMedia({audio:{sampleRate:16e3,channelCount:1,autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0}})];case 1:return t=a.sent(),this.mediaDevicesStream=t,this.mediaStreamAudioSource=null===(i=this.audioContext)||void 0===i?void 0:i.createMediaStreamSource(t),this.scriptProcessor=null===(r=this.audioContext)||void 0===r?void 0:r.createScriptProcessor(512,1,1),this.mediaStreamAudioSource.connect(this.scriptProcessor),this.scriptProcessor.connect(null===(s=this.audioContext)||void 0===s?void 0:s.destination),this.scriptProcessor.onaudioprocess=function(e){var t;if(o.webSocket&&o.audioRawFrame){var n=function(e){for(var t=new Int16Array(e.length),n=0;n<e.length;n++){var i=Math.max(-1,Math.min(1,e[n]));t[n]=i<0?32768*i:32767*i}return t}(o.isMuted?new Float32Array(512):e.inputBuffer.getChannelData(0)),i=new Uint8Array(n.buffer),r=o.audioRawFrame.create({audio:{audio:Array.from(i),sampleRate:16e3,numChannels:1}}),s=new Uint8Array(o.audioRawFrame.encode(r).finish());null===(t=o.webSocket)||void 0===t||t.send(s)}},[4,FS(2e3)];case 2:return a.sent(),[2]}})})},t.prototype._stopVoiceChat=function(){return Qw(this,void 0,void 0,function(){var e,t;return Jw(this,function(n){return this.audioContext&&(this.audioContext=null),this.scriptProcessor&&(this.scriptProcessor.disconnect(),this.scriptProcessor=null),this.mediaStreamAudioSource&&(this.mediaStreamAudioSource.disconnect(),this.mediaStreamAudioSource=null),this.mediaDevicesStream&&(null===(t=null===(e=this.mediaDevicesStream)||void 0===e?void 0:e.getTracks())||void 0===t||t.forEach(function(e){return e.stop()}),this.mediaDevicesStream=null),[2]})})},t}(LS);!function(e){e.LIVEKIT="livekit",e.WEBSOCKET="websocket"}(US||(US={}));var qS,zS,HS,WS,KS,$S,GS,QS=function(e){function t(t){var n=t.voiceChatInstance,i=t.initialConfig,r=e.call(this)||this;return r.initialConfig=i,r.voiceChat=n,r}return $w(t,e),Object.defineProperty(t.prototype,"isMuted",{get:function(){return this.voiceChat.isMuted},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isVoiceChatting",{get:function(){return this.voiceChat.isVoiceChatting},enumerable:!1,configurable:!0}),t.prototype.startVoiceChat=function(e){return Qw(this,arguments,void 0,function(e){var t=e.config;return Jw(this,function(e){switch(e.label){case 0:return[4,this.voiceChat.startVoiceChat(Gw(Gw({},this.initialConfig),{config:t}))];case 1:return e.sent(),[2]}})})},t.prototype.stopVoiceChat=function(){return Qw(this,void 0,void 0,function(){return Jw(this,function(e){switch(e.label){case 0:return[4,this.voiceChat.stopVoiceChat()];case 1:return e.sent(),[2]}})})},t.prototype.mute=function(){this.voiceChat.mute()},t.prototype.unmute=function(){this.voiceChat.unmute()},t.createLiveKitVoiceChat=function(e){return new this({voiceChatInstance:new BS,initialConfig:e})},t.createWebSocketVoiceChat=function(e){return new this({voiceChatInstance:new VS,initialConfig:e})},t}(MS);!function(e){e.Low="low",e.Medium="medium",e.High="high"}(qS||(qS={})),function(e){e.EXCITED="excited",e.SERIOUS="serious",e.FRIENDLY="friendly",e.SOOTHING="soothing",e.BROADCASTER="broadcaster"}(zS||(zS={})),function(e){e.eleven_flash_v2_5="eleven_flash_v2_5",e.eleven_multilingual_v2="eleven_multilingual_v2"}(HS||(HS={})),function(e){e.DEEPGRAM="deepgram",e.GLADIA="gladia"}(WS||(WS={})),function(e){e.TALK="talk",e.REPEAT="repeat"}(KS||(KS={})),function(e){e.SYNC="sync",e.ASYNC="async"}($S||($S={})),function(e){e.AVATAR_START_TALKING="avatar_start_talking",e.AVATAR_STOP_TALKING="avatar_stop_talking",e.AVATAR_TALKING_MESSAGE="avatar_talking_message",e.AVATAR_END_MESSAGE="avatar_end_message",e.USER_TALKING_MESSAGE="user_talking_message",e.USER_END_MESSAGE="user_end_message",e.USER_START="user_start",e.USER_STOP="user_stop",e.USER_SILENCE="user_silence",e.STREAM_READY="stream_ready",e.STREAM_DISCONNECTED="stream_disconnected",e.CONNECTION_QUALITY_CHANGED="connection_quality_changed"}(GS||(GS={}));var JS=function(e){function t(t,n,i){var r=e.call(this,t)||this;return r.name="APIError",r.status=n,r.responseText=i,r}return $w(t,e),t}(Error),YS=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){function n(n){var i=t.call(this,n)||this;return i.childTrackers=e.map(function(e){var t=e.getParams;return{tracker:new(0,e.TrackerClass)(function(){return i.handleStatsChanged()}),getParams:t}}),i}return $w(n,t),n.prototype.calculateConnectionQuality=function(){var e=this.childTrackers.map(function(e){return e.tracker.connectionQuality});return e.some(function(e){return e===Yw.BAD})?Yw.BAD:e.every(function(e){return e===Yw.UNKNOWN})?Yw.UNKNOWN:Yw.GOOD},n.prototype._start=function(e){this.childTrackers.forEach(function(t){var n=t.tracker,i=t.getParams;return n.start(i(e))})},n.prototype._stop=function(){this.childTrackers.forEach(function(e){return e.tracker.stop(!0)})},n}(Zw)}({TrackerClass:rS,getParams:function(e){return e}},{TrackerClass:DS,getParams:function(e){var t;return(null===(t=e.engine.pcManager)||void 0===t?void 0:t.subscriber)._pc}}),XS=function(){function e(e){var t=e.token,n=e.basePath,i=void 0===n?"https://api.heygen.com":n,r=this;this.room=null,this.mediaStream=null,this.eventTarget=new EventTarget,this.webSocket=null,this.sessionId=null,this.voiceChat=null,this.isLiveKitTransport=!1,this.token=t,this.basePath=i,this.connectionQualityIndicator=new YS(function(e){return r.emit(GS.CONNECTION_QUALITY_CHANGED,e)})}return Object.defineProperty(e.prototype,"connectionQuality",{get:function(){return this.connectionQualityIndicator.connectionQuality},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isInputAudioMuted",{get:function(){var e,t;return null===(t=null===(e=this.voiceChat)||void 0===e?void 0:e.isMuted)||void 0===t||t},enumerable:!1,configurable:!0}),e.prototype.muteInputAudio=function(){var e;null===(e=this.voiceChat)||void 0===e||e.mute()},e.prototype.unmuteInputAudio=function(){var e;null===(e=this.voiceChat)||void 0===e||e.unmute()},e.prototype.createStartAvatar=function(e){return Qw(this,void 0,void 0,function(){var t;return Jw(this,function(n){switch(n.label){case 0:return[4,this.newSession(e)];case 1:return t=n.sent(),[2,this.startAvatar(e,t)]}})})},e.prototype.startAvatar=function(e,t){return Qw(this,void 0,void 0,function(){var n,i,s=this;return Jw(this,function(o){switch(o.label){case 0:this.sessionId=t.session_id,this.isLiveKitTransport=e.voiceChatTransport===US.LIVEKIT,n=new qw({adaptiveStream:!0,dynacast:!0,videoCaptureDefaults:{resolution:Zy.h720.resolution}}),this.room=n,this.mediaStream=null,n.on(Ty.DataReceived,function(e){var t=null;try{var n=(new TextDecoder).decode(e);t=JSON.parse(n)}catch(r){console.error(r)}t&&s.emit(t.type,t)}),i=new MediaStream,n.on(Ty.TrackSubscribed,function(e){if("video"===e.kind||"audio"===e.kind){i.addTrack(e.mediaStreamTrack);var t=i.getVideoTracks().length>0,n=i.getAudioTracks().length>0;t&&n&&!s.mediaStream&&(s.mediaStream=i,s.emit(GS.STREAM_READY,s.mediaStream))}}),n.on(Ty.TrackUnsubscribed,function(e){var t=e.mediaStreamTrack;t&&i.removeTrack(t)}),n.on(Ty.Disconnected,function(e){s.emit(GS.STREAM_DISCONNECTED,e)}),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,n.prepareConnection(t.url,t.access_token)];case 2:case 3:return o.sent(),[3,4];case 4:return[4,this.startSession()];case 5:return o.sent(),[4,n.connect(t.url,t.access_token)];case 6:return o.sent(),[4,this.connectWebSocket({useSilencePrompt:!!e.useSilencePrompt})];case 7:return o.sent(),this.initVoiceChat(e.voiceChatTransport||US.WEBSOCKET),this.connectionQualityIndicator.start(n),[2,t]}})})},e.prototype.startVoiceChat=function(){return Qw(this,arguments,void 0,function(e){var t,n=(void 0===e?{}:e).isInputAudioMuted;return Jw(this,function(e){switch(e.label){case 0:return[4,null===(t=this.voiceChat)||void 0===t?void 0:t.startVoiceChat({config:{defaultMuted:n}})];case 1:return e.sent(),[2]}})})},e.prototype.closeVoiceChat=function(){return Qw(this,void 0,void 0,function(){var e;return Jw(this,function(t){switch(t.label){case 0:return[4,null===(e=this.voiceChat)||void 0===e?void 0:e.stopVoiceChat()];case 1:return t.sent(),[2]}})})},e.prototype.newSession=function(e){return Qw(this,void 0,void 0,function(){var t,n,i,r,s;return Jw(this,function(o){return[2,this.request("/v1/streaming.new",{avatar_name:e.avatarName,quality:e.quality,knowledge_base_id:e.knowledgeId,knowledge_base:e.knowledgeBase,voice:{voice_id:null===(t=e.voice)||void 0===t?void 0:t.voiceId,rate:null===(n=e.voice)||void 0===n?void 0:n.rate,emotion:null===(i=e.voice)||void 0===i?void 0:i.emotion,elevenlabs_settings:Gw(Gw({},null===(r=null===e||void 0===e?void 0:e.voice)||void 0===r?void 0:r.elevenlabsSettings),{model_id:null===(s=e.voice)||void 0===s?void 0:s.model})},language:e.language,version:"v2",video_encoding:"H264",source:"sdk",disable_idle_timeout:e.disableIdleTimeout,stt_settings:e.sttSettings,ia_is_livekit_transport:e.voiceChatTransport===US.LIVEKIT,silence_response:e.useSilencePrompt,activity_idle_timeout:e.activityIdleTimeout})]})})},e.prototype.startSession=function(){return Qw(this,void 0,void 0,function(){return Jw(this,function(e){return[2,this.request("/v1/streaming.start",{session_id:this.sessionId})]})})},e.prototype.speak=function(e){return Qw(this,void 0,void 0,function(){var t,n;return Jw(this,function(i){if(t=e.taskType||e.task_type||KS.TALK,n=e.taskMode||$S.ASYNC,t===KS.TALK&&n===$S.ASYNC){if(this.isLiveKitTransport&&this.room)return this.sendLivekitMessage(e.text),[2];if(!this.isLiveKitTransport&&this.webSocket&&this.audioRawFrame)return this.sendWebsocketMessage(e.text),[2]}return[2,this.request("/v1/streaming.task",{text:e.text,session_id:this.sessionId,task_mode:e.taskMode,task_type:e.taskType})]})})},e.prototype.startListening=function(){return Qw(this,void 0,void 0,function(){return Jw(this,function(e){return[2,this.request("/v1/streaming.start_listening",{session_id:this.sessionId})]})})},e.prototype.stopListening=function(){return Qw(this,void 0,void 0,function(){return Jw(this,function(e){return[2,this.request("/v1/streaming.stop_listening",{session_id:this.sessionId})]})})},e.prototype.interrupt=function(){return Qw(this,void 0,void 0,function(){return Jw(this,function(e){return[2,this.request("/v1/streaming.interrupt",{session_id:this.sessionId})]})})},e.prototype.stopAvatar=function(){return Qw(this,void 0,void 0,function(){return Jw(this,function(e){return this.closeVoiceChat(),this.connectionQualityIndicator.stop(),this.voiceChat=null,this.webSocket&&(this.webSocket.close(),this.webSocket=null),[2,this.request("/v1/streaming.stop",{session_id:this.sessionId})]})})},e.prototype.keepAlive=function(){return Qw(this,void 0,void 0,function(){return Jw(this,function(e){return[2,this.request("/v1/streaming.keep_alive",{session_id:this.sessionId})]})})},e.prototype.on=function(e,t){return this.eventTarget.addEventListener(e,t),this},e.prototype.off=function(e,t){return this.eventTarget.removeEventListener(e,t),this},e.prototype.sendLivekitMessage=function(e){return Qw(this,void 0,void 0,function(){var t;return Jw(this,function(n){return this.room?(t=(new TextEncoder).encode(JSON.stringify(e)),this.room.localParticipant.publishData(t,{reliable:!0}),[2]):[2]})})},e.prototype.sendWebsocketMessage=function(e){return Qw(this,void 0,void 0,function(){var t,n,i,r;return Jw(this,function(s){return this.webSocket&&this.audioRawFrame?(t=null===(i=this.audioRawFrame)||void 0===i?void 0:i.create({text:{text:e}}),n=new Uint8Array(null===(r=this.audioRawFrame)||void 0===r?void 0:r.encode(t).finish()),this.webSocket.send(n),[2]):[2]})})},e.prototype.initVoiceChat=function(e){if(e===US.WEBSOCKET){if(this.loadAudioRawFrame(),!this.audioRawFrame||!this.webSocket)return;this.voiceChat=QS.createWebSocketVoiceChat({webSocket:this.webSocket,audioRawFrame:this.audioRawFrame})}else{if(!this.room)return;this.voiceChat=QS.createLiveKitVoiceChat({room:this.room})}},e.prototype.request=function(e,t,n){return Qw(this,void 0,void 0,function(){var n,i;return Jw(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),[4,fetch(this.getRequestUrl(e),{method:"POST",headers:{Authorization:"Bearer ".concat(this.token),"Content-Type":"application/json"},body:JSON.stringify(t)})];case 1:return(n=r.sent()).ok?[3,3]:[4,n.text()];case 2:throw i=r.sent(),new JS("API request failed with status ".concat(n.status),n.status,i);case 3:return[4,n.json()];case 4:return[2,r.sent().data];case 5:throw r.sent();case 6:return[2]}})})},e.prototype.emit=function(e,t){var n=new CustomEvent(e,{detail:t});this.eventTarget.dispatchEvent(n)},e.prototype.getRequestUrl=function(e){return"".concat(this.basePath).concat(e)},e.prototype.connectWebSocket=function(e){return Qw(this,void 0,void 0,function(){var t,n=this;return Jw(this,function(i){return t="wss://".concat(new URL(this.basePath).hostname,"/v1/ws/streaming.chat?session_id=").concat(this.sessionId,"&session_token=").concat(this.token).concat(this.isLiveKitTransport?"&arch_version=v2":"","&silence_response=").concat(e.useSilencePrompt),this.webSocket=new WebSocket(t),this.webSocket.addEventListener("message",function(e){var t=null;try{t=JSON.parse(e.data)}catch(r){return void console.error(r)}t&&n.emit(t.event_type,t)}),this.webSocket.addEventListener("close",function(e){n.webSocket=null}),[2,new Promise(function(e,t){var i,r;null===(i=n.webSocket)||void 0===i||i.addEventListener("error",function(e){n.webSocket=null,t(e)}),null===(r=n.webSocket)||void 0===r||r.addEventListener("open",function(){e(!0)})})]})})},e.prototype.loadAudioRawFrame=function(){return Qw(this,void 0,void 0,function(){var e;return Jw(this,function(t){return this.audioRawFrame||(e=Ww.Root.fromJSON(Xw),this.audioRawFrame=null===e||void 0===e?void 0:e.lookupType("pipecat.Frame")),[2]})})},e}();const ZS=xc("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),eT=xc("VideoOff",[["path",{d:"M10.66 6H14a2 2 0 0 1 2 2v2.34l1 1L22 8v8",key:"ubwiq0"}],["path",{d:"M16 16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2l10 10Z",key:"1l10zd"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),tT=xc("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]),nT=xc("VolumeX",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]),iT=xc("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]),rT=xc("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),sT=xc("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),oT=xc("PhoneOff",[["path",{d:"M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91",key:"z86iuo"}],["line",{x1:"22",x2:"2",y1:"2",y2:"22",key:"11kh81"}]]),aT=xc("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),cT=xc("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);function lT(){var e;const{sessionId:n}=function(){let{matches:e}=t.useContext(Ge),n=e[e.length-1];return n?n.params:{}}(),{user:i,token:r,loading:s}=yd(),o=Ze(),[a,c]=(0,t.useState)(!1),[l,u]=(0,t.useState)(!1),[d,h]=(0,t.useState)(!0),[p,f]=(0,t.useState)(!0),[m,g]=(0,t.useState)(!0),[v,y]=(0,t.useState)([]),[b,k]=(0,t.useState)(""),[w,S]=(0,t.useState)(!1),[T,C]=(0,t.useState)(n||null),[x,E]=(0,t.useState)(null),[P,R]=(0,t.useState)(!1),[O,_]=(0,t.useState)("medium"),[N,A]=(0,t.useState)(!1),[I,j]=(0,t.useState)(!1),[D,M]=(0,t.useState)(!1),L=(0,t.useRef)(null),F=(0,t.useRef)(null),U=(0,t.useRef)(null),B=(0,t.useRef)(null),V=(0,t.useRef)(null),q=(0,t.useRef)(null),z=(0,t.useRef)(null);if((0,t.useEffect)(()=>{if(console.log("\ud83d\udd10 Auth state:",{token:!!r,user:!!i,authLoading:s}),!s&&(!r||!i))return console.log("\u274c User not authenticated, redirecting to login"),void o("/login");r&&i&&console.log("\u2705 User authenticated:",i.name)},[r,i,s,o]),(0,t.useEffect)(()=>{if(T){(async()=>{try{S(!0);const e=await ld();e.data.success&&(C(e.data.session.id),y(e.data.session.messages||[]),c(!0),await W(e.data.session.id))}catch(e){console.error("Failed to get session:",e),c(!1)}finally{S(!1)}})()}else n?C(n):(console.log("No session ID available, redirecting to dashboard"),o("/dashboard"))},[T,n,o]),(0,t.useEffect)(()=>{H()},[]),(0,t.useEffect)(()=>{var e;null===(e=L.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[v]),(0,t.useEffect)(()=>{if(x&&U.current){const e=x.videoUrl||"";if(!/^https?:\/\//i.test(e))return;U.current.src=e,U.current.load()}},[x]),(0,t.useEffect)(()=>{if(x&&B.current){const e=x.audioUrl||"";if(!/^https?:\/\//i.test(e))return;B.current.src=e,B.current.load()}},[x]),s)return(0,gd.jsx)("div",{className:"h-screen bg-secondary-900 flex items-center justify-center",children:(0,gd.jsxs)("div",{className:"text-center",children:[(0,gd.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto mb-4"}),(0,gd.jsx)("p",{className:"text-white",children:"Loading..."})]})});if(!r||!i)return null;const H=()=>{const e=window.SpeechRecognition||window.webkitSpeechRecognition;e?(j(!0),V.current=new e,V.current.continuous=!1,V.current.interimResults=!1,V.current.lang="en-US",V.current.onstart=()=>{A(!0),ne.success("Listening... Speak now!")},V.current.onresult=e=>{const t=e.results[0][0].transcript;k(t),ne.success(`You said: "${t}"`)},V.current.onerror=e=>{console.error("Speech recognition error:",e.error),A(!1),ne.error("Voice recognition error. Please try again.")},V.current.onend=()=>{A(!1)}):(console.warn("Speech recognition not supported in this browser"),j(!1))},W=async e=>{try{console.log("\ud83c\udfac Starting video stream for session:",e),console.log("\ud83c\udfac User:",null===i||void 0===i?void 0:i.name),console.log("\ud83c\udfac Tutor:",null===i||void 0===i?void 0:i.aiTutorName);const t=await(async()=>{try{const{data:e}=await md(),t=null===e||void 0===e?void 0:e.token;if(!t)return console.warn("No HeyGen streaming token returned; falling back to demo video."),!1;console.log("\ud83c\udfac HeyGen token received:",t.substring(0,20)+"...");const n=new XS({token:t});q.current=n,console.log("\ud83c\udfac HeyGen SDK initialized"),n.on(GS.STREAM_READY,()=>{console.log("\ud83c\udfac HeyGen stream ready!"),M(!0)}),n.on(GS.STREAM_DISCONNECTED,()=>{console.log("\ud83c\udfac HeyGen stream disconnected"),M(!1)});const i="Graham_ProfessionalLook2_public";return console.log("\ud83c\udfac Creating HeyGen avatar with ID:",i),await n.createStartAvatar({quality:qS.Low,avatarName:i,language:"en"}),console.log("\ud83c\udfac HeyGen avatar created successfully"),z.current&&n.attach&&(console.log("\ud83c\udfac Attaching HeyGen avatar to DOM"),n.attach(z.current)),!0}catch(e){return console.error("\u274c HeyGen streaming init failed; falling back to demo video.",e),console.error("\u274c Error details:",{name:null===e||void 0===e?void 0:e.name,message:null===e||void 0===e?void 0:e.message,status:null===e||void 0===e?void 0:e.status,response:null===e||void 0===e?void 0:e.response}),!1}})();if(t)return void R(!0);const n=await hd(e,(null===i||void 0===i?void 0:i.aiTutorName)||"John",`Hello ${null===i||void 0===i?void 0:i.name}! I'm ${null===i||void 0===i?void 0:i.aiTutorName}, your AI tutor. How can I help you today?`);console.log("\u2705 Video stream response:",n.data),n.data.success&&(E(n.data.videoStream),R(!0),console.log("\u2705 Video stream started successfully"))}catch(t){console.error("\u274c Failed to start video stream:",t),ne.error("Failed to start video stream. Please try again.")}},K=async()=>{if(!b.trim()||!T)return;const e={id:Date.now().toString(),sender:"user",content:b,timestamp:new Date};y(t=>[...t,e]);const t=b;k("");try{const e=await cd(t,T);if(e.data.success){const t={id:(Date.now()+1).toString(),sender:"ai",content:e.data.response,timestamp:new Date};y(e=>[...e,t]),await $(e.data.response)}}catch(n){console.error("Failed to send message:",n),ne.error("Failed to send message")}},$=async e=>{try{if(!T)return;const t=await pd(T,e);t.data.success&&(E(t.data.stream),R(!0))}catch(t){console.error("Failed to generate talking response:",t)}},G=()=>{u(!l),ne.success(l?"Microphone enabled":"Microphone muted")},Q=()=>{h(!d),ne.success(d?"Video disabled":"Video enabled")};return(0,gd.jsxs)("div",{className:"h-screen bg-secondary-900 flex flex-col",children:[(0,gd.jsx)("header",{className:"bg-secondary-800 border-b border-secondary-700 p-4",children:(0,gd.jsxs)("div",{className:"flex items-center justify-between",children:[(0,gd.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,gd.jsx)("button",{onClick:()=>o("/dashboard"),className:"p-2 text-secondary-400 hover:text-white hover:bg-secondary-700 rounded-lg transition-colors",children:(0,gd.jsx)($h,{className:"h-5 w-5"})}),(0,gd.jsxs)("div",{children:[(0,gd.jsxs)("h1",{className:"text-lg font-semibold text-white",children:["Session with ",null===i||void 0===i?void 0:i.aiTutorName]}),(0,gd.jsxs)("p",{className:"text-sm text-secondary-400",children:["Session ID: ",T||"Not started"]})]})]}),(0,gd.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,gd.jsx)("button",{onClick:G,className:"p-2 rounded-lg transition-colors "+(l?"bg-red-600 text-white":"text-secondary-400 hover:text-white hover:bg-secondary-700"),children:l?(0,gd.jsx)(ZS,{className:"h-5 w-5"}):(0,gd.jsx)(Ic,{className:"h-5 w-5"})}),(0,gd.jsx)("button",{onClick:Q,className:"p-2 rounded-lg transition-colors "+(d?"text-secondary-400 hover:text-white hover:bg-secondary-700":"bg-red-600 text-white"),children:d?(0,gd.jsx)(Ac,{className:"h-5 w-5"}):(0,gd.jsx)(eT,{className:"h-5 w-5"})}),(0,gd.jsx)("button",{onClick:()=>{f(!p),B.current&&(B.current.muted=!p),ne.success(p?"Volume muted":"Volume enabled")},className:"p-2 rounded-lg transition-colors "+(p?"text-secondary-400 hover:text-white hover:bg-secondary-700":"bg-red-600 text-white"),children:p?(0,gd.jsx)(tT,{className:"h-5 w-5"}):(0,gd.jsx)(nT,{className:"h-5 w-5"})}),(0,gd.jsx)("button",{onClick:()=>{g(!m)},className:"p-2 rounded-lg transition-colors "+(m?"bg-primary-600 text-white":"text-secondary-400 hover:text-white hover:bg-secondary-700"),children:(0,gd.jsx)(Dc,{className:"h-5 w-5"})})]})]})}),(0,gd.jsxs)("main",{className:"flex h-[calc(100vh-80px)]",children:[(0,gd.jsx)("div",{className:"flex-1 p-6 "+(m?"mr-4":""),children:(0,gd.jsxs)(Tc.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"h-full flex flex-col",children:[(0,gd.jsxs)("div",{className:"flex-1 bg-secondary-800 rounded-xl border border-secondary-700 flex items-center justify-center mb-4 relative overflow-hidden",children:[a&&D?(0,gd.jsx)("div",{ref:z,className:"w-full h-full"}):a&&x?(0,gd.jsxs)("div",{className:"w-full h-full relative",children:[(0,gd.jsx)("video",{ref:U,className:"w-full h-full object-cover rounded-xl",autoPlay:!0,muted:!p,onPlay:()=>R(!0),onPause:()=>R(!1)}),(0,gd.jsx)("div",{className:"absolute top-4 right-4 flex space-x-2",children:(0,gd.jsx)("button",{onClick:()=>{U.current&&(P?U.current.pause():U.current.play(),R(!P))},className:"p-2 bg-black bg-opacity-50 text-white rounded-lg hover:bg-opacity-70 transition-colors",children:P?(0,gd.jsx)(iT,{className:"h-4 w-4"}):(0,gd.jsx)(rT,{className:"h-4 w-4"})})}),(0,gd.jsxs)("div",{className:"absolute bottom-4 left-4 bg-black bg-opacity-50 text-white px-3 py-1 rounded-lg text-sm",children:[O," Quality"]})]}):a?(0,gd.jsxs)("div",{className:"text-center",children:[(0,gd.jsx)("div",{className:"h-32 w-32 bg-gradient-to-r from-primary-600 to-accent-600 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,gd.jsx)("span",{className:"text-4xl font-bold text-white",children:(null===i||void 0===i||null===(e=i.aiTutorName)||void 0===e?void 0:e.charAt(0))||"A"})}),(0,gd.jsx)("h3",{className:"text-xl font-semibold text-white mb-2",children:null===i||void 0===i?void 0:i.aiTutorName}),(0,gd.jsx)("p",{className:"text-secondary-400",children:"Your AI Tutor"}),(0,gd.jsxs)("div",{className:"mt-4 flex items-center justify-center space-x-2",children:[(0,gd.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full animate-pulse"}),(0,gd.jsx)("span",{className:"text-sm text-green-400",children:"Live"})]})]}):(0,gd.jsxs)("div",{className:"text-center",children:[(0,gd.jsx)(Ac,{className:"h-16 w-16 text-secondary-400 mx-auto mb-4"}),(0,gd.jsx)("p",{className:"text-secondary-400 mb-4",children:"Ready to start your learning session"}),(0,gd.jsx)("button",{onClick:async()=>{try{S(!0);try{await dd(),console.log("Cleared any stale active sessions")}catch(n){console.log("No stale sessions to clear or error clearing:",n)}const e=await ad("General Learning");e.data.success&&(C(e.data.session.id),y(e.data.session.messages||[]),c(!0),await W(e.data.session.id),ne.success("Call started! Your AI tutor is ready."))}catch(n){var e,t;console.error("Failed to start call:",n);const i=(null===(e=n.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.error)||"Failed to start call";ne.error(i)}finally{S(!1)}},disabled:w,className:"btn-primary flex items-center space-x-2 mx-auto",children:w?(0,gd.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):(0,gd.jsxs)(gd.Fragment,{children:[(0,gd.jsx)(sT,{className:"h-4 w-4"}),(0,gd.jsx)("span",{children:"Start Call"})]})})]}),(0,gd.jsx)("audio",{ref:B,autoPlay:!0,muted:!p,style:{display:"none"}})]}),a&&(0,gd.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,gd.jsx)("button",{onClick:G,className:"p-3 rounded-full transition-colors "+(l?"bg-red-600 text-white":"bg-secondary-700 text-white hover:bg-secondary-600"),children:l?(0,gd.jsx)(ZS,{className:"h-6 w-6"}):(0,gd.jsx)(Ic,{className:"h-6 w-6"})},"mute-button"),(0,gd.jsx)("button",{onClick:async()=>{try{T&&(await ud(T),await fd(T));try{var e,t;await(null===(e=q.current)||void 0===e||null===(t=e.stopAvatar)||void 0===t?void 0:t.call(e))}catch{}c(!1),C(null),y([]),E(null),M(!1),R(!1),ne.success("Call ended"),o("/dashboard")}catch(n){console.error("Failed to end session:",n),ne.error("Failed to end session")}},className:"p-3 bg-red-600 text-white rounded-full hover:bg-red-700 transition-colors",children:(0,gd.jsx)(oT,{className:"h-6 w-6"})},"end-call-button"),(0,gd.jsx)("button",{onClick:Q,className:"p-3 rounded-full transition-colors "+(d?"bg-secondary-700 text-white hover:bg-secondary-600":"bg-red-600 text-white"),children:d?(0,gd.jsx)(Ac,{className:"h-6 w-6"}):(0,gd.jsx)(eT,{className:"h-6 w-6"})},"video-toggle-button")]})]},"video-container")}),m&&(0,gd.jsxs)(Tc.div,{initial:{opacity:0,x:100},animate:{opacity:1,x:0},className:"w-96 bg-secondary-800 border-l border-secondary-700 flex flex-col",children:[(0,gd.jsxs)("div",{className:"p-4 border-b border-secondary-700",children:[(0,gd.jsxs)("h3",{className:"text-lg font-semibold text-white",children:["Chat with ",null===i||void 0===i?void 0:i.aiTutorName]}),(0,gd.jsx)("p",{className:"text-sm text-secondary-400",children:a?"Live session":"Session not started"})]}),(0,gd.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[0===v.length?(0,gd.jsxs)("div",{className:"text-center text-secondary-400 mt-8",children:[(0,gd.jsx)(Dc,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,gd.jsx)("p",{children:"No messages yet"}),(0,gd.jsx)("p",{className:"text-sm",children:"Start the call to begin chatting"})]}):v.map((e,t)=>(0,gd.jsx)(Tc.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex "+("user"===e.sender?"justify-end":"justify-start"),children:(0,gd.jsxs)("div",{className:"max-w-xs lg:max-w-md px-4 py-2 rounded-lg "+("user"===e.sender?"bg-primary-600 text-white":"bg-secondary-700 text-white"),children:[(0,gd.jsx)("p",{className:"text-sm",children:e.content}),(0,gd.jsx)("p",{className:"text-xs opacity-70 mt-1",children:new Date(e.timestamp).toLocaleTimeString()})]})},`${e.id||e.timestamp||"msg"}-${t}`)),(0,gd.jsx)("div",{ref:L})]}),(0,gd.jsxs)("div",{className:"p-4 border-t border-secondary-700",children:[(0,gd.jsxs)("div",{className:"flex space-x-2",children:[(0,gd.jsx)("button",{className:"p-2 text-secondary-400 hover:text-white hover:bg-secondary-700 rounded-lg transition-colors",children:(0,gd.jsx)(aT,{className:"h-5 w-5"})}),(0,gd.jsx)("button",{className:"p-2 text-secondary-400 hover:text-white hover:bg-secondary-700 rounded-lg transition-colors",children:(0,gd.jsx)(jc,{className:"h-5 w-5"})}),I&&(0,gd.jsx)("button",{onClick:N?()=>{V.current&&V.current.stop()}:()=>{V.current&&I?V.current.start():ne.error("Voice recognition not supported in this browser")},disabled:!a,className:`p-2 rounded-lg transition-colors ${N?"bg-red-600 text-white animate-pulse":"text-secondary-400 hover:text-white hover:bg-secondary-700"} disabled:opacity-50 disabled:cursor-not-allowed`,title:N?"Stop listening":"Start voice input",children:N?(0,gd.jsx)(ZS,{className:"h-5 w-5"}):(0,gd.jsx)(Ic,{className:"h-5 w-5"})}),(0,gd.jsx)("div",{className:"flex-1 relative",children:(0,gd.jsx)("input",{ref:F,type:"text",value:b,onChange:e=>k(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),K())},placeholder:I?"Type your message or use voice input...":"Type your message...",disabled:!a,className:"w-full px-3 py-2 bg-secondary-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 disabled:opacity-50"})}),(0,gd.jsx)("button",{onClick:K,disabled:!b.trim()||!a,className:"p-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:(0,gd.jsx)(cT,{className:"h-5 w-5"})})]}),I&&(0,gd.jsx)("p",{className:"text-xs text-secondary-400 mt-2",children:"\ud83d\udca1 Tip: Click the microphone button to speak with your AI tutor!"})]})]},"chat-sidebar")]})]},`video-call-${T||"no-session"}`)}function uT(e){let{children:t}=e;const{user:n,loading:i}=yd();return i?(0,gd.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-secondary-50",children:(0,gd.jsxs)("div",{className:"text-center",children:[(0,gd.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),(0,gd.jsx)("p",{className:"mt-4 text-secondary-600",children:"Loading..."})]})}):n?(0,gd.jsx)(gd.Fragment,{children:t}):(0,gd.jsx)(ft,{to:"/login",replace:!0})}const dT=new ie.QueryClient({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1}}});const hT=function(){return(0,gd.jsx)(ie.QueryClientProvider,{client:dT,children:(0,gd.jsx)(bd,{children:(0,gd.jsx)(Tt,{children:(0,gd.jsxs)("div",{className:"min-h-screen bg-secondary-50",children:[(0,gd.jsxs)(vt,{children:[(0,gd.jsx)(mt,{path:"/login",element:(0,gd.jsx)(Kh,{})}),(0,gd.jsx)(mt,{path:"/register",element:(0,gd.jsx)(up,{})}),(0,gd.jsx)(mt,{path:"/dashboard",element:(0,gd.jsx)(uT,{children:(0,gd.jsx)(kd,{})})}),(0,gd.jsx)(mt,{path:"/video-call/:sessionId?",element:(0,gd.jsx)(uT,{children:(0,gd.jsx)(lT,{})})}),(0,gd.jsx)(mt,{path:"/profile",element:(0,gd.jsx)(uT,{children:(0,gd.jsx)(ep,{})})}),(0,gd.jsx)(mt,{path:"/",element:(0,gd.jsx)(ft,{to:"/dashboard",replace:!0})}),(0,gd.jsx)(mt,{path:"*",element:(0,gd.jsx)(ft,{to:"/dashboard",replace:!0})})]}),(0,gd.jsx)(te,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff"},success:{duration:3e3,iconTheme:{primary:"#10b981",secondary:"#fff"}},error:{duration:5e3,iconTheme:{primary:"#ef4444",secondary:"#fff"}}}})]})})})})};i.createRoot(document.getElementById("root")).render((0,gd.jsx)(t.StrictMode,{children:(0,gd.jsx)(hT,{})}))})()})();
//# sourceMappingURL=main.2eaba61e.js.map